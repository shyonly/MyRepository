<html>
<head>
<title>merge-map.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
merge-map.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_remapping&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;mergeSourceMap&quot;</span><span class="s0">,</span><span class="s1">&quot;inputMap&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceFileName&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;found&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;remapping&quot;</span><span class="s0">,</span><span class="s1">&quot;rootless&quot;</span><span class="s0">,</span><span class="s1">&quot;s&quot;</span><span class="s0">,</span><span class="s1">&quot;ctx&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceRoot&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/transformation/file/merge-map.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;type SourceMap = any;</span><span class="s3">\n</span><span class="s1">import remapping from </span><span class="s3">\&quot;</span><span class="s1">@ampproject/remapping</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">export default function mergeSourceMap(</span><span class="s3">\n  </span><span class="s1">inputMap: SourceMap,</span><span class="s3">\n  </span><span class="s1">map: SourceMap,</span><span class="s3">\n  </span><span class="s1">sourceFileName: string,</span><span class="s3">\n</span><span class="s1">): SourceMap {</span><span class="s3">\n  </span><span class="s1">// On win32 machines, the sourceFileName uses backslash paths like</span><span class="s3">\n  </span><span class="s1">// `C:</span><span class="s3">\\</span><span class="s1">foo</span><span class="s3">\\</span><span class="s1">bar.js`. But sourcemaps are always posix paths, so we need to</span><span class="s3">\n  </span><span class="s1">// normalize to regular slashes before we can merge (else we won't find the</span><span class="s3">\n  </span><span class="s1">// source associated with our input map).</span><span class="s3">\n  </span><span class="s1">// This mirrors code done while generating the output map at</span><span class="s3">\n  </span><span class="s1">// https://github.com/babel/babel/blob/5c2fcadc9ae34fd20dd72b1111d5cf50476d700d/packages/babel-generator/src/source-map.ts#L102</span><span class="s3">\n  </span><span class="s1">const source = sourceFileName.replace(/</span><span class="s3">\\\\</span><span class="s1">/g, </span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">// Prevent an infinite recursion if one of the input map's sources has the</span><span class="s3">\n  </span><span class="s1">// same resolved path as the input map. In the case, it would keep find the</span><span class="s3">\n  </span><span class="s1">// input map, then get it's sources which will include a path like the input</span><span class="s3">\n  </span><span class="s1">// map, on and on.</span><span class="s3">\n  </span><span class="s1">let found = false;</span><span class="s3">\n  </span><span class="s1">const result = remapping(rootless(map), (s, ctx) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (s === source &amp;&amp; !found) {</span><span class="s3">\n      </span><span class="s1">found = true;</span><span class="s3">\n      </span><span class="s1">// We empty the source location, which will prevent the sourcemap from</span><span class="s3">\n      </span><span class="s1">// becoming relative to the input's location. Eg, if we're transforming a</span><span class="s3">\n      </span><span class="s1">// file 'foo/bar.js', and it is a transformation of a `baz.js` file in the</span><span class="s3">\n      </span><span class="s1">// same directory, the expected output is just `baz.js`. Without this step,</span><span class="s3">\n      </span><span class="s1">// it would become `foo/baz.js`.</span><span class="s3">\n      </span><span class="s1">ctx.source = </span><span class="s3">\&quot;\&quot;</span><span class="s1">;</span><span class="s3">\n\n      </span><span class="s1">return rootless(inputMap);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return null;</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n\n  </span><span class="s1">if (typeof inputMap.sourceRoot === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">result.sourceRoot = inputMap.sourceRoot;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// remapping returns a SourceMap class type, but this breaks code downstream in</span><span class="s3">\n  </span><span class="s1">// @babel/traverse and @babel/types that relies on data being plain objects.</span><span class="s3">\n  </span><span class="s1">// When it encounters the sourcemap type it outputs a </span><span class="s3">\&quot;</span><span class="s1">don't know how to turn</span><span class="s3">\n  </span><span class="s1">// this value into a node</span><span class="s3">\&quot; </span><span class="s1">error. As a result, we are converting the merged</span><span class="s3">\n  </span><span class="s1">// sourcemap to a plain js object.</span><span class="s3">\n  </span><span class="s1">return { ...result };</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function rootless(map: SourceMap): SourceMap {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">...map,</span><span class="s3">\n\n    </span><span class="s1">// This is a bit hack. Remapping will create absolute sources in our</span><span class="s3">\n    </span><span class="s1">// sourcemap, but we want to maintain sources relative to the sourceRoot.</span><span class="s3">\n    </span><span class="s1">// We'll re-add the sourceRoot after remapping.</span><span class="s3">\n    </span><span class="s1">sourceRoot: null,</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;AACA,SAAAA,WAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,UAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAEe,SAASE,cAAcA,CACpCC,QAAmB,EACnBC,GAAc,EACdC,cAAsB,EACX;EAOX,MAAMC,MAAM,GAAGD,cAAc,CAACE,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;EAMjD,IAAIC,KAAK,GAAG,KAAK;EACjB,MAAMC,MAAM,GAAGC,WAAQA,CAAC,CAACC,QAAQ,CAACP,GAAG,CAAC,EAAE,CAACQ,CAAC,EAAEC,GAAG,KAAK;IAClD,IAAID,CAAC,KAAKN,MAAM,IAAI,CAACE,KAAK,EAAE;MAC1BA,KAAK,GAAG,IAAI;MAMZK,GAAG,CAACP,MAAM,GAAG,EAAE;MAEf,OAAOK,QAAQ,CAACR,QAAQ,CAAC;IAC3B;IAEA,OAAO,IAAI;EACb,CAAC,CAAC;EAEF,IAAI,OAAOA,QAAQ,CAACW,UAAU,KAAK,QAAQ,EAAE;IAC3CL,MAAM,CAACK,UAAU,GAAGX,QAAQ,CAACW,UAAU;EACzC;EAOA,OAAAC,MAAA,CAAAC,MAAA,KAAYP,MAAM;AACpB;AAEA,SAASE,QAAQA,CAACP,GAAc,EAAa;EAC3C,OAAAW,MAAA,CAAAC,MAAA,KACKZ,GAAG;IAKNU,UAAU,EAAE;EAAI;AAEpB;AAAC&quot;</span><span class="s0">}</span></pre>
</body>
</html>