<html>
<head>
<title>parse-cst.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #67a37c; font-style: italic;}
.s7 { color: #2aacb8;}
.s8 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
parse-cst.js</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s2">{ </span><span class="s1">j </span><span class="s2">as </span><span class="s1">_inherits</span><span class="s2">, </span><span class="s1">k </span><span class="s2">as </span><span class="s1">_createSuper</span><span class="s2">, </span><span class="s1">c </span><span class="s2">as </span><span class="s1">_classCallCheck</span><span class="s2">, </span><span class="s1">T </span><span class="s2">as </span><span class="s1">Type</span><span class="s2">, </span><span class="s1">b </span><span class="s2">as </span><span class="s1">_createClass</span><span class="s2">, </span><span class="s1">R </span><span class="s2">as </span><span class="s1">Range</span><span class="s2">, </span><span class="s1">N </span><span class="s2">as </span><span class="s1">Node</span><span class="s2">, </span><span class="s1">g </span><span class="s2">as </span><span class="s1">YAMLSemanticError</span><span class="s2">, </span><span class="s1">l </span><span class="s2">as </span><span class="s1">_get</span><span class="s2">, </span><span class="s1">m </span><span class="s2">as </span><span class="s1">_getPrototypeOf</span><span class="s2">, </span><span class="s1">Y </span><span class="s2">as </span><span class="s1">YAMLSyntaxError</span><span class="s2">, </span><span class="s1">C </span><span class="s2">as </span><span class="s1">Char</span><span class="s2">, </span><span class="s1">e </span><span class="s2">as </span><span class="s1">_defineProperty</span><span class="s2">, </span><span class="s1">P </span><span class="s2">as </span><span class="s1">PlainValue </span><span class="s2">} </span><span class="s1">from </span><span class="s3">'./PlainValue-b8036b75.js'</span><span class="s2">;</span>

<span class="s0">var </span><span class="s1">BlankLine </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">BlankLine</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">BlankLine</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">BlankLine</span><span class="s2">() {</span>
    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">BlankLine</span><span class="s2">);</span>

    <span class="s0">return </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLANK_LINE</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s4">/* istanbul ignore next */</span>


  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">BlankLine</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;includesTrailingLines&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s4">// This is never called from anywhere, but if it were,</span>
      <span class="s4">// this is the value it should return.</span>
      <span class="s0">return true</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses a blank line from the source</span>
     <span class="s5">*</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first \n character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">range </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">BlankLine</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">CollectionItem </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">CollectionItem</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">CollectionItem</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">CollectionItem</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">CollectionItem</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">node </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">CollectionItem</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;includesTrailingLines&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">return </span><span class="s2">!!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">node </span><span class="s2">&amp;&amp; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">.</span><span class="s1">includesTrailingLines</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">parseNode </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parseNode</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">atLineStart</span><span class="s2">,</span>
          <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s1">atLineStart </span><span class="s2">&amp;&amp; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM</span><span class="s2">) </span><span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Sequence items must not have preceding content on the same line'</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">indent </span><span class="s2">= </span><span class="s1">atLineStart </span><span class="s2">? </span><span class="s1">start </span><span class="s2">- </span><span class="s1">lineStart </span><span class="s2">: </span><span class="s1">context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s0">var </span><span class="s1">inlineComment </span><span class="s2">= </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">comments </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">blankLine </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">) {</span>
          <span class="s0">var </span><span class="s1">_end </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>

          <span class="s1">comments</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">_end</span><span class="s2">));</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">_end</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
          <span class="s0">var </span><span class="s1">wsEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">wsEnd</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">comments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s7">0</span><span class="s2">) {</span>
            <span class="s1">blankLine </span><span class="s2">= </span><span class="s0">new </span><span class="s1">BlankLine</span><span class="s2">();</span>
            <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">blankLine</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
              <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
            <span class="s2">}, </span><span class="s1">lineStart</span><span class="s2">);</span>
          <span class="s2">}</span>

          <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">nextNodeIsIndented</span><span class="s2">(</span><span class="s1">ch</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">- (</span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">), </span><span class="s0">this</span><span class="s2">.</span><span class="s1">type </span><span class="s2">!== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM</span><span class="s2">)) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">node </span><span class="s2">= </span><span class="s1">parseNode</span><span class="s2">({</span>
          <span class="s1">atLineStart</span><span class="s2">: </span><span class="s1">atLineStart</span><span class="s2">,</span>
          <span class="s1">inCollection</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
          <span class="s1">indent</span><span class="s2">: </span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">lineStart</span><span class="s2">: </span><span class="s1">lineStart</span><span class="s2">,</span>
          <span class="s1">parent</span><span class="s2">: </span><span class="s0">this</span>
        <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">&amp;&amp; </span><span class="s1">lineStart </span><span class="s2">&gt; </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">lineStart </span><span class="s2">- </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">) {</span>
          <span class="s4">// Only blank lines preceding non-empty nodes are captured. Note that</span>
          <span class="s4">// this means that collection item range start indices do not always</span>
          <span class="s4">// increase monotonically. -- eemeli/yaml#126</span>
          <span class="s0">var </span><span class="s1">items </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">.</span><span class="s1">items </span><span class="s2">|| </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">;</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">items</span><span class="s2">) </span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">comments</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) </span><span class="s1">Array</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">push</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">props</span><span class="s2">, </span><span class="s1">comments</span><span class="s2">);</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
      <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">inlineComment</span><span class="s2">) {</span>
          <span class="s0">var </span><span class="s1">c </span><span class="s2">= </span><span class="s1">comments</span><span class="s2">[</span><span class="s7">0</span><span class="s2">];</span>
          <span class="s0">this</span><span class="s2">.</span><span class="s1">props</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">c</span><span class="s2">);</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">c</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">var </span><span class="s1">end </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node </span><span class="s2">? </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">: </span><span class="s1">offset</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">end</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">_get</span><span class="s2">(</span><span class="s1">_getPrototypeOf</span><span class="s2">(</span><span class="s1">CollectionItem</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">), </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">, </span><span class="s0">this</span><span class="s2">).</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return this</span><span class="s2">.</span><span class="s1">node </span><span class="s2">? </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">.</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) : </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;toString&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">toString</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">,</span>
          <span class="s1">node </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">node</span><span class="s2">,</span>
          <span class="s1">range </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">range</span><span class="s2">,</span>
          <span class="s1">value </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) </span><span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s1">node </span><span class="s2">? </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">, </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">) + </span><span class="s1">String</span><span class="s2">(</span><span class="s1">node</span><span class="s2">) : </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">, </span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">addStringTerminator</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">, </span><span class="s1">str</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">CollectionItem</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">Comment </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">Comment</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">Comment</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">Comment</span><span class="s2">() {</span>
    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Comment</span><span class="s2">);</span>

    <span class="s0">return </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">COMMENT</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s5">/**</span>
   <span class="s5">* Parses a comment line from the source</span>
   <span class="s5">*</span>
   <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
   <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
   <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this scalar</span>
   <span class="s5">*/</span>


  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">Comment</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">start</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">range </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">Comment</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">function </span><span class="s1">grabCollectionEndComments</span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">cnode </span><span class="s2">= </span><span class="s1">node</span><span class="s2">;</span>

  <span class="s0">while </span><span class="s2">(</span><span class="s1">cnode </span><span class="s0">instanceof </span><span class="s1">CollectionItem</span><span class="s2">) {</span>
    <span class="s1">cnode </span><span class="s2">= </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">node</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(!(</span><span class="s1">cnode </span><span class="s0">instanceof </span><span class="s1">Collection</span><span class="s2">)) </span><span class="s0">return null</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">len </span><span class="s2">= </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">length</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">ci </span><span class="s2">= -</span><span class="s7">1</span><span class="s2">;</span>

  <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">len </span><span class="s2">- </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&gt;= </span><span class="s7">0</span><span class="s2">; --</span><span class="s1">i</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">n </span><span class="s2">= </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">items</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>

    <span class="s0">if </span><span class="s2">(</span><span class="s1">n</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">COMMENT</span><span class="s2">) {</span>
      <span class="s4">// Keep sufficiently indented comments with preceding node</span>
      <span class="s0">var </span><span class="s1">_n$context </span><span class="s2">= </span><span class="s1">n</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">indent </span><span class="s2">= </span><span class="s1">_n$context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">_n$context</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">indent </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">&amp;&amp; </span><span class="s1">n</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start </span><span class="s2">&gt;= </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>
      <span class="s1">ci </span><span class="s2">= </span><span class="s1">i</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">n</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLANK_LINE</span><span class="s2">) </span><span class="s1">ci </span><span class="s2">= </span><span class="s1">i</span><span class="s2">;</span><span class="s0">else break</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">ci </span><span class="s2">=== -</span><span class="s7">1</span><span class="s2">) </span><span class="s0">return null</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">ca </span><span class="s2">= </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">(</span><span class="s1">ci</span><span class="s2">, </span><span class="s1">len </span><span class="s2">- </span><span class="s1">ci</span><span class="s2">);</span>
  <span class="s0">var </span><span class="s1">prevEnd </span><span class="s2">= </span><span class="s1">ca</span><span class="s2">[</span><span class="s7">0</span><span class="s2">].</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">;</span>

  <span class="s0">while </span><span class="s2">(</span><span class="s0">true</span><span class="s2">) {</span>
    <span class="s1">cnode</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">prevEnd</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">&amp;&amp; </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">&gt; </span><span class="s1">prevEnd</span><span class="s2">) </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">prevEnd</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">cnode </span><span class="s2">=== </span><span class="s1">node</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>
    <span class="s1">cnode </span><span class="s2">= </span><span class="s1">cnode</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s0">return </span><span class="s1">ca</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s0">var </span><span class="s1">Collection </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">Collection</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">Collection</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">Collection</span><span class="s2">(</span><span class="s1">firstItem</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Collection</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM </span><span class="s2">? </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ </span><span class="s2">: </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">MAP</span><span class="s2">);</span>

    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props</span><span class="s2">.</span><span class="s1">length </span><span class="s2">- </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&gt;= </span><span class="s7">0</span><span class="s2">; --</span><span class="s1">i</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">start </span><span class="s2">&lt; </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">) {</span>
        <span class="s4">// props on previous line are assumed by the collection</span>
        <span class="s1">_this</span><span class="s2">.</span><span class="s1">props </span><span class="s2">= </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s7">0</span><span class="s2">, </span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
        <span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props </span><span class="s2">= </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
        <span class="s0">var </span><span class="s1">itemRange </span><span class="s2">= </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">props</span><span class="s2">[</span><span class="s7">0</span><span class="s2">] || </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">;</span>
        <span class="s1">firstItem</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start </span><span class="s2">= </span><span class="s1">itemRange</span><span class="s2">.</span><span class="s1">start</span><span class="s2">;</span>
        <span class="s0">break</span><span class="s2">;</span>
      <span class="s2">}</span>
    <span class="s2">}</span>

    <span class="s1">_this</span><span class="s2">.</span><span class="s1">items </span><span class="s2">= [</span><span class="s1">firstItem</span><span class="s2">];</span>
    <span class="s0">var </span><span class="s1">ec </span><span class="s2">= </span><span class="s1">grabCollectionEndComments</span><span class="s2">(</span><span class="s1">firstItem</span><span class="s2">);</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">ec</span><span class="s2">) </span><span class="s1">Array</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">push</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">_this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">, </span><span class="s1">ec</span><span class="s2">);</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">Collection</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;includesTrailingLines&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">return this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">parseNode </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parseNode</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">; </span><span class="s4">// It's easier to recalculate lineStart here rather than tracking down the</span>
      <span class="s4">// last context from which to read it -- eemeli/yaml#2</span>

      <span class="s0">var </span><span class="s1">lineStart </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">startOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">firstItem </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">[</span><span class="s7">0</span><span class="s2">]; </span><span class="s4">// First-item context needs to be correct for later comment handling</span>
      <span class="s4">// -- eemeli/yaml#17</span>

      <span class="s1">firstItem</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">parent </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s1">Range</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">(</span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">indent </span><span class="s2">= </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start </span><span class="s2">- </span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">normalizeOffset</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s0">var </span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">) === </span><span class="s1">offset</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">prevIncludesTrailingLines </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch</span><span class="s2">) {</span>
        <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">atLineStart </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; !</span><span class="s1">prevIncludesTrailingLines</span><span class="s2">) {</span>
            <span class="s0">var </span><span class="s1">blankLine </span><span class="s2">= </span><span class="s0">new </span><span class="s1">BlankLine</span><span class="s2">();</span>
            <span class="s1">offset </span><span class="s2">= </span><span class="s1">blankLine</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
              <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
            <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>

            <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&gt;= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
              <span class="s1">ch </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s2">}</span>

            <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">);</span>
            <span class="s1">offset </span><span class="s2">-= </span><span class="s7">1</span><span class="s2">; </span><span class="s4">// blankLine.parse() consumes terminal newline</span>
          <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent </span><span class="s2">&amp;&amp; !</span><span class="s1">Collection</span><span class="s2">.</span><span class="s1">nextContentHasIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">)) {</span>
              <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
            <span class="s2">}</span>

            <span class="s0">var </span><span class="s1">comment </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Comment</span><span class="s2">();</span>
            <span class="s1">offset </span><span class="s2">= </span><span class="s1">comment</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
              <span class="s1">indent</span><span class="s2">: </span><span class="s1">indent</span><span class="s2">,</span>
              <span class="s1">lineStart</span><span class="s2">: </span><span class="s1">lineStart</span><span class="s2">,</span>
              <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
            <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">comment</span><span class="s2">);</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>

            <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&gt;= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
              <span class="s1">ch </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s2">}</span>
          <span class="s2">}</span>

          <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atBlank</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">)) {</span>
            <span class="s0">var </span><span class="s1">wsEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
            <span class="s0">var </span><span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">wsEnd</span><span class="s2">];</span>

            <span class="s0">if </span><span class="s2">(!</span><span class="s1">next </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'#'</span><span class="s2">) {</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">wsEnd</span><span class="s2">;</span>
            <span class="s2">}</span>
          <span class="s2">}</span>

          <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
          <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(!</span><span class="s1">ch</span><span class="s2">) {</span>
          <span class="s0">break</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">!== </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent </span><span class="s2">&amp;&amp; (</span><span class="s1">atLineStart </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">':'</span><span class="s2">)) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">lineStart </span><span class="s2">&gt; </span><span class="s1">start</span><span class="s2">) </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">lineStart</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>
          <span class="s2">} </span><span class="s0">else if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">error</span><span class="s2">) {</span>
            <span class="s0">var </span><span class="s1">msg </span><span class="s2">= </span><span class="s3">'All collection items must start at the same column'</span><span class="s2">;</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">msg</span><span class="s2">);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">firstItem</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'-'</span><span class="s2">) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">lineStart </span><span class="s2">&gt; </span><span class="s1">start</span><span class="s2">) </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">lineStart</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>
          <span class="s2">}</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'-' </span><span class="s2">&amp;&amp; !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">error</span><span class="s2">) {</span>
          <span class="s4">// map key may start with -, as long as it's followed by a non-whitespace char</span>
          <span class="s0">var </span><span class="s1">_next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>

          <span class="s0">if </span><span class="s2">(!</span><span class="s1">_next </span><span class="s2">|| </span><span class="s1">_next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">_next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">_next </span><span class="s2">=== </span><span class="s3">' '</span><span class="s2">) {</span>
            <span class="s0">var </span><span class="s1">_msg </span><span class="s2">= </span><span class="s3">'A collection cannot be both a mapping and a sequence'</span><span class="s2">;</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">_msg</span><span class="s2">);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s0">var </span><span class="s1">node </span><span class="s2">= </span><span class="s1">parseNode</span><span class="s2">({</span>
          <span class="s1">atLineStart</span><span class="s2">: </span><span class="s1">atLineStart</span><span class="s2">,</span>
          <span class="s1">inCollection</span><span class="s2">: </span><span class="s0">true</span><span class="s2">,</span>
          <span class="s1">indent</span><span class="s2">: </span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">lineStart</span><span class="s2">: </span><span class="s1">lineStart</span><span class="s2">,</span>
          <span class="s1">parent</span><span class="s2">: </span><span class="s0">this</span>
        <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s2">(!</span><span class="s1">node</span><span class="s2">) </span><span class="s0">return </span><span class="s1">offset</span><span class="s2">; </span><span class="s4">// at next document start</span>

        <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">normalizeOffset</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">);</span>
        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
        <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
        <span class="s1">prevIncludesTrailingLines </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">includesTrailingLines</span><span class="s2">; </span><span class="s4">// Need to reset lineStart and atLineStart here if preceding node's range</span>
        <span class="s4">// has advanced to check the current line's indentation level</span>
        <span class="s4">// -- eemeli/yaml#10 &amp; eemeli/yaml#38</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch</span><span class="s2">) {</span>
          <span class="s0">var </span><span class="s1">ls </span><span class="s2">= </span><span class="s1">offset </span><span class="s2">- </span><span class="s7">1</span><span class="s2">;</span>
          <span class="s0">var </span><span class="s1">prev </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">ls</span><span class="s2">];</span>

          <span class="s0">while </span><span class="s2">(</span><span class="s1">prev </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">prev </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
            <span class="s1">prev </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[--</span><span class="s1">ls</span><span class="s2">];</span>
          <span class="s2">}</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">prev </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
            <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">ls </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
            <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s0">var </span><span class="s1">ec </span><span class="s2">= </span><span class="s1">grabCollectionEndComments</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">ec</span><span class="s2">) </span><span class="s1">Array</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">push</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">, </span><span class="s1">ec</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">_get</span><span class="s2">(</span><span class="s1">_getPrototypeOf</span><span class="s2">(</span><span class="s1">Collection</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">), </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">, </span><span class="s0">this</span><span class="s2">).</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">});</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;toString&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">toString</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">,</span>
          <span class="s1">items </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">,</span>
          <span class="s1">range </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">range</span><span class="s2">,</span>
          <span class="s1">value </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) </span><span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">, </span><span class="s1">items</span><span class="s2">[</span><span class="s7">0</span><span class="s2">].</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">) + </span><span class="s1">String</span><span class="s2">(</span><span class="s1">items</span><span class="s2">[</span><span class="s7">0</span><span class="s2">]);</span>

      <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">items</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">item </span><span class="s2">= </span><span class="s1">items</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
        <span class="s0">var </span><span class="s1">_item$context </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
            <span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">_item$context</span><span class="s2">.</span><span class="s1">atLineStart</span><span class="s2">,</span>
            <span class="s1">indent </span><span class="s2">= </span><span class="s1">_item$context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">;</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">atLineStart</span><span class="s2">) </span><span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">_i </span><span class="s2">= </span><span class="s7">0</span><span class="s2">; </span><span class="s1">_i </span><span class="s2">&lt; </span><span class="s1">indent</span><span class="s2">; ++</span><span class="s1">_i</span><span class="s2">) {</span>
          <span class="s1">str </span><span class="s2">+= </span><span class="s3">' '</span><span class="s2">;</span>
        <span class="s2">}</span>
        <span class="s1">str </span><span class="s2">+= </span><span class="s1">String</span><span class="s2">(</span><span class="s1">item</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">addStringTerminator</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">, </span><span class="s1">str</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}], [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;nextContentHasIndent&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">nextContentHasIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">lineStart </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) + </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s1">ch</span><span class="s2">) </span><span class="s0">return false</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&gt;= </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">) </span><span class="s0">return true</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'#' </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s0">return false</span><span class="s2">;</span>
      <span class="s0">return </span><span class="s1">Collection</span><span class="s2">.</span><span class="s1">nextContentHasIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">Collection</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">Directive </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">Directive</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">Directive</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">Directive</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Directive</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">DIRECTIVE</span><span class="s2">);</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">Directive</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parameters&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">raw </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">rawValue</span><span class="s2">;</span>
      <span class="s0">return </span><span class="s1">raw </span><span class="s2">? </span><span class="s1">raw</span><span class="s2">.</span><span class="s1">trim</span><span class="s2">().</span><span class="s1">split</span><span class="s2">(</span><span class="s8">/[ \t]+/</span><span class="s2">) : [];</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseName&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseName</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">' '</span><span class="s2">) {</span>
        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseParameters&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseParameters</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'#'</span><span class="s2">) {</span>
        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseName</span><span class="s2">(</span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseParameters</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">range </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">Directive</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">Document </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">Document</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">Document</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">Document</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Document</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">DOCUMENT</span><span class="s2">);</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">directives </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">contents </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">directivesEndMarker </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">documentEndMarker </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">Document</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseDirectives&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseDirectives</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">directives </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">hasDirectives </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>

      <span class="s0">while </span><span class="s2">(!</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">DIRECTIVES_END</span><span class="s2">)) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">Document</span><span class="s2">.</span><span class="s1">startCommentOrEndBlankLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>

        <span class="s0">switch </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
          <span class="s0">case </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">atLineStart</span><span class="s2">) {</span>
              <span class="s0">var </span><span class="s1">blankLine </span><span class="s2">= </span><span class="s0">new </span><span class="s1">BlankLine</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">blankLine</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>

              <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">src</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
                <span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">);</span>
              <span class="s2">}</span>
            <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
              <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
            <span class="s2">}</span>

            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'#'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">comment </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Comment</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">comment</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">comment</span><span class="s2">);</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'%'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">directive </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Directive</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">directive</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">parent</span><span class="s2">: </span><span class="s0">this</span><span class="s2">,</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">directive</span><span class="s2">);</span>
              <span class="s1">hasDirectives </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">default</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">hasDirectives</span><span class="s2">) {</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Missing directives-end indicator line'</span><span class="s2">);</span>
            <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0</span><span class="s2">) {</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">contents </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">;</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">directives </span><span class="s2">= [];</span>
            <span class="s2">}</span>

            <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">directivesEndMarker </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">3</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">3</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">hasDirectives</span><span class="s2">) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Missing directives-end indicator line'</span><span class="s2">);</span>
      <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0</span><span class="s2">) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">contents </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">;</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">directives </span><span class="s2">= [];</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseContents&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseContents</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">_this$context </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">parseNode </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">parseNode</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">) </span><span class="s0">this</span><span class="s2">.</span><span class="s1">contents </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">lineStart </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">lineStart </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] === </span><span class="s3">'-'</span><span class="s2">) {</span>
        <span class="s1">lineStart </span><span class="s2">-= </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">lineStart </span><span class="s2">=== </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>

      <span class="s0">while </span><span class="s2">(!</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">DOCUMENT_END</span><span class="s2">)) {</span>
        <span class="s0">switch </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
          <span class="s0">case </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">atLineStart</span><span class="s2">) {</span>
              <span class="s0">var </span><span class="s1">blankLine </span><span class="s2">= </span><span class="s0">new </span><span class="s1">BlankLine</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">blankLine</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>

              <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">src</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
                <span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">);</span>
              <span class="s2">}</span>
            <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
              <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
            <span class="s2">}</span>

            <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'#'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">comment </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Comment</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">comment</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">comment</span><span class="s2">);</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">default</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">iEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
              <span class="s0">var </span><span class="s1">context </span><span class="s2">= {</span>
                <span class="s1">atLineStart</span><span class="s2">: </span><span class="s1">atLineStart</span><span class="s2">,</span>
                <span class="s1">indent</span><span class="s2">: -</span><span class="s7">1</span><span class="s2">,</span>
                <span class="s1">inFlow</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
                <span class="s1">inCollection</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
                <span class="s1">lineStart</span><span class="s2">: </span><span class="s1">lineStart</span><span class="s2">,</span>
                <span class="s1">parent</span><span class="s2">: </span><span class="s0">this</span>
              <span class="s2">};</span>
              <span class="s0">var </span><span class="s1">node </span><span class="s2">= </span><span class="s1">parseNode</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">iEnd</span><span class="s2">);</span>
              <span class="s0">if </span><span class="s2">(!</span><span class="s1">node</span><span class="s2">) </span><span class="s0">return this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">iEnd</span><span class="s2">; </span><span class="s4">// at next document start</span>

              <span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
              <span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
              <span class="s0">var </span><span class="s1">ec </span><span class="s2">= </span><span class="s1">grabCollectionEndComments</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
              <span class="s0">if </span><span class="s2">(</span><span class="s1">ec</span><span class="s2">) </span><span class="s1">Array</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">.</span><span class="s1">push</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">, </span><span class="s1">ec</span><span class="s2">);</span>
            <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s1">offset </span><span class="s2">= </span><span class="s1">Document</span><span class="s2">.</span><span class="s1">startCommentOrEndBlankLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">documentEndMarker </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">3</span><span class="s2">);</span>
        <span class="s1">offset </span><span class="s2">+= </span><span class="s7">3</span><span class="s2">;</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">] === </span><span class="s3">'#'</span><span class="s2">) {</span>
            <span class="s0">var </span><span class="s1">_comment </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Comment</span><span class="s2">();</span>

            <span class="s1">offset </span><span class="s2">= </span><span class="s1">_comment</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
              <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
            <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">_comment</span><span class="s2">);</span>
          <span class="s2">}</span>

          <span class="s0">switch </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
            <span class="s0">case </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">:</span>
              <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s1">undefined</span><span class="s2">:</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">default</span><span class="s2">:</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Document end marker line cannot have a non-comment suffix'</span><span class="s2">);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s1">context</span><span class="s2">.</span><span class="s1">root </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">charCodeAt</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) === </span><span class="s7">0xfeff </span><span class="s2">? </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1 </span><span class="s2">: </span><span class="s1">start</span><span class="s2">; </span><span class="s4">// skip BOM</span>

      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseDirectives</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseContents</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">_get</span><span class="s2">(</span><span class="s1">_getPrototypeOf</span><span class="s2">(</span><span class="s1">Document</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">), </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">, </span><span class="s0">this</span><span class="s2">).</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">});</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">directivesEndMarker</span><span class="s2">) </span><span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">directivesEndMarker</span><span class="s2">.</span><span class="s1">setOrigRange</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">});</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">documentEndMarker</span><span class="s2">) </span><span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">documentEndMarker</span><span class="s2">.</span><span class="s1">setOrigRange</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;toString&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">toString</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">contents </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">contents</span><span class="s2">,</span>
          <span class="s1">directives </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">directives</span><span class="s2">,</span>
          <span class="s1">value </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) </span><span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s1">directives</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">''</span><span class="s2">);</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">contents</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">directives</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">|| </span><span class="s1">contents</span><span class="s2">[</span><span class="s7">0</span><span class="s2">].</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">COMMENT</span><span class="s2">) </span><span class="s1">str </span><span class="s2">+= </span><span class="s3">'---</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
        <span class="s1">str </span><span class="s2">+= </span><span class="s1">contents</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">''</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">str</span><span class="s2">[</span><span class="s1">str</span><span class="s2">.</span><span class="s1">length </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] !== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
      <span class="s0">return </span><span class="s1">str</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}], [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;startCommentOrEndBlankLine&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">startCommentOrEndBlankLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s0">return </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'#' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">? </span><span class="s1">offset </span><span class="s2">: </span><span class="s1">start</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">Document</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">Alias </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">Alias</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">Alias</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">Alias</span><span class="s2">() {</span>
    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">Alias</span><span class="s2">);</span>

    <span class="s0">return </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">Alias</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">:</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses an *alias from the source</span>
     <span class="s5">*</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this scalar</span>
     <span class="s5">*/</span>
    <span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIdentifier</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">Alias</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">Chomp </span><span class="s2">= {</span>
  <span class="s1">CLIP</span><span class="s2">: </span><span class="s3">'CLIP'</span><span class="s2">,</span>
  <span class="s1">KEEP</span><span class="s2">: </span><span class="s3">'KEEP'</span><span class="s2">,</span>
  <span class="s1">STRIP</span><span class="s2">: </span><span class="s3">'STRIP'</span>
<span class="s2">};</span>
<span class="s0">var </span><span class="s1">BlockValue </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">BlockValue</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">BlockValue</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">BlockValue</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">BlockValue</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">blockIndent </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">= </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">CLIP</span><span class="s2">;</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">header </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">BlockValue</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;includesTrailingLines&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">return this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">=== </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">KEEP</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;strValue&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">: </span><span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">|| !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">) </span><span class="s0">return null</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">_this$valueRange </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">,</span>
          <span class="s1">start </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">start</span><span class="s2">,</span>
          <span class="s1">end </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">_this$context </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">indent </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">isEmpty</span><span class="s2">()) </span><span class="s0">return </span><span class="s3">''</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">lastNewLine </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">' '</span><span class="s2">) {</span>
        <span class="s1">end </span><span class="s2">-= </span><span class="s7">1</span><span class="s2">;</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">end </span><span class="s2">&lt;= </span><span class="s1">start</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">=== </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">KEEP</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span><span class="s0">else return </span><span class="s3">''</span><span class="s2">; </span><span class="s4">// probably never happens</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">lastNewLine </span><span class="s2">= </span><span class="s1">end</span><span class="s2">;</span>
        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">var </span><span class="s1">keepStart </span><span class="s2">= </span><span class="s1">end </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">lastNewLine</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">=== </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">KEEP</span><span class="s2">) {</span>
          <span class="s1">keepStart </span><span class="s2">= </span><span class="s1">lastNewLine</span><span class="s2">;</span>
          <span class="s1">end </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">end </span><span class="s2">= </span><span class="s1">lastNewLine</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">var </span><span class="s1">bi </span><span class="s2">= </span><span class="s1">indent </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">folded </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLOCK_FOLDED</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">atStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">sep </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">prevMoreIndented </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>

      <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">start</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">end</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
        <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">j </span><span class="s2">= </span><span class="s7">0</span><span class="s2">; </span><span class="s1">j </span><span class="s2">&lt; </span><span class="s1">bi</span><span class="s2">; ++</span><span class="s1">j</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] !== </span><span class="s3">' '</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>
          <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s0">var </span><span class="s1">_ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">_ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">sep </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span><span class="s0">else </span><span class="s1">sep </span><span class="s2">= </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s0">var </span><span class="s1">lineEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">i</span><span class="s2">);</span>
          <span class="s0">var </span><span class="s1">line </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">lineEnd</span><span class="s2">);</span>
          <span class="s1">i </span><span class="s2">= </span><span class="s1">lineEnd</span><span class="s2">;</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">folded </span><span class="s2">&amp;&amp; (</span><span class="s1">_ch </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">_ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) &amp;&amp; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">keepStart</span><span class="s2">) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">sep </span><span class="s2">=== </span><span class="s3">' '</span><span class="s2">) </span><span class="s1">sep </span><span class="s2">= </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span><span class="s0">else if </span><span class="s2">(!</span><span class="s1">prevMoreIndented </span><span class="s2">&amp;&amp; !</span><span class="s1">atStart </span><span class="s2">&amp;&amp; </span><span class="s1">sep </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">sep </span><span class="s2">= </span><span class="s3">'</span><span class="s0">\n\n</span><span class="s3">'</span><span class="s2">;</span>
            <span class="s1">str </span><span class="s2">+= </span><span class="s1">sep </span><span class="s2">+ </span><span class="s1">line</span><span class="s2">; </span><span class="s4">//+ ((lineEnd &lt; end &amp;&amp; src[lineEnd]) || '')</span>

            <span class="s1">sep </span><span class="s2">= </span><span class="s1">lineEnd </span><span class="s2">&lt; </span><span class="s1">end </span><span class="s2">&amp;&amp; </span><span class="s1">src</span><span class="s2">[</span><span class="s1">lineEnd</span><span class="s2">] || </span><span class="s3">''</span><span class="s2">;</span>
            <span class="s1">prevMoreIndented </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
            <span class="s1">str </span><span class="s2">+= </span><span class="s1">sep </span><span class="s2">+ </span><span class="s1">line</span><span class="s2">;</span>
            <span class="s1">sep </span><span class="s2">= </span><span class="s1">folded </span><span class="s2">&amp;&amp; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">keepStart </span><span class="s2">? </span><span class="s3">' ' </span><span class="s2">: </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
            <span class="s1">prevMoreIndented </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
          <span class="s2">}</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">atStart </span><span class="s2">&amp;&amp; </span><span class="s1">line </span><span class="s2">!== </span><span class="s3">''</span><span class="s2">) </span><span class="s1">atStart </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">return this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">=== </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">STRIP </span><span class="s2">? </span><span class="s1">str </span><span class="s2">: </span><span class="s1">str </span><span class="s2">+ </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseBlockHeader&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseBlockHeader</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">bi </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s0">true</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

        <span class="s0">switch </span><span class="s2">(</span><span class="s1">ch</span><span class="s2">) {</span>
          <span class="s0">case </span><span class="s3">'-'</span><span class="s2">:</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">= </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">STRIP</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'+'</span><span class="s2">:</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">= </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">KEEP</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'0'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'1'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'2'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'3'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'4'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'5'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'6'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'7'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'8'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">'9'</span><span class="s2">:</span>
            <span class="s1">bi </span><span class="s2">+= </span><span class="s1">ch</span><span class="s2">;</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">default</span><span class="s2">:</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent </span><span class="s2">= </span><span class="s1">Number</span><span class="s2">(</span><span class="s1">bi</span><span class="s2">) || </span><span class="s0">null</span><span class="s2">;</span>
            <span class="s0">this</span><span class="s2">.</span><span class="s1">header </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
            <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
        <span class="s2">}</span>

        <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseBlockValue&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseBlockValue</span><span class="s2">(</span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">_this$context2 </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">indent </span><span class="s2">= </span><span class="s1">_this$context2</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">_this$context2</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">explicit </span><span class="s2">= !!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">valueEnd </span><span class="s2">= </span><span class="s1">start</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">minBlockIndent </span><span class="s2">= </span><span class="s7">1</span><span class="s2">;</span>

      <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]; </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">; </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
        <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">)) </span><span class="s0">break</span><span class="s2">;</span>
        <span class="s0">var </span><span class="s1">end </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfBlockIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">); </span><span class="s4">// should not include tab?</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">end </span><span class="s2">=== </span><span class="s0">null</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>
        <span class="s0">var </span><span class="s1">_ch2 </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">end</span><span class="s2">];</span>
        <span class="s0">var </span><span class="s1">lineIndent </span><span class="s2">= </span><span class="s1">end </span><span class="s2">- (</span><span class="s1">offset </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">);</span>

        <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent</span><span class="s2">) {</span>
          <span class="s4">// no explicit block indent, none yet detected</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">end</span><span class="s2">] !== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
            <span class="s4">// first line with non-whitespace content</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">lineIndent </span><span class="s2">&lt; </span><span class="s1">minBlockIndent</span><span class="s2">) {</span>
              <span class="s0">var </span><span class="s1">msg </span><span class="s2">= </span><span class="s3">'Block scalars with more-indented leading empty lines must use an explicit indentation indicator'</span><span class="s2">;</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">msg</span><span class="s2">);</span>
            <span class="s2">}</span>

            <span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent </span><span class="s2">= </span><span class="s1">lineIndent</span><span class="s2">;</span>
          <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">lineIndent </span><span class="s2">&gt; </span><span class="s1">minBlockIndent</span><span class="s2">) {</span>
            <span class="s4">// empty line with more whitespace</span>
            <span class="s1">minBlockIndent </span><span class="s2">= </span><span class="s1">lineIndent</span><span class="s2">;</span>
          <span class="s2">}</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">_ch2 </span><span class="s2">&amp;&amp; </span><span class="s1">_ch2 </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">lineIndent </span><span class="s2">&lt; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">blockIndent</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">end</span><span class="s2">] === </span><span class="s3">'#'</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>

          <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">error</span><span class="s2">) {</span>
            <span class="s0">var </span><span class="s1">_src </span><span class="s2">= </span><span class="s1">explicit </span><span class="s2">? </span><span class="s3">'explicit indentation indicator' </span><span class="s2">: </span><span class="s3">'first line'</span><span class="s2">;</span>

            <span class="s0">var </span><span class="s1">_msg </span><span class="s2">= </span><span class="s3">&quot;Block scalars must not be less indented than their &quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">_src</span><span class="s2">);</span>

            <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">_msg</span><span class="s2">);</span>
          <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">end</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">end</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">valueEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">end</span><span class="s2">);</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s0">this</span><span class="s2">.</span><span class="s1">chomping </span><span class="s2">!== </span><span class="s1">Chomp</span><span class="s2">.</span><span class="s1">KEEP</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">valueEnd</span><span class="s2">] ? </span><span class="s1">valueEnd </span><span class="s2">+ </span><span class="s7">1 </span><span class="s2">: </span><span class="s1">valueEnd</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses a block value from the source</span>
     <span class="s5">*</span>
     <span class="s5">* Accepted forms are:</span>
     <span class="s5">* ```</span>
     <span class="s5">* BS</span>
     <span class="s5">* block</span>
     <span class="s5">* lines</span>
     <span class="s5">*</span>
     <span class="s5">* BS #comment</span>
     <span class="s5">* block</span>
     <span class="s5">* lines</span>
     <span class="s5">* ```</span>
     <span class="s5">* where the block style BS matches the regexp `[|&gt;][-+1-9]*` and block lines</span>
     <span class="s5">* are empty or have an indent level greater than `indent`.</span>
     <span class="s5">*</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this block</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseBlockHeader</span><span class="s2">(</span><span class="s1">start</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseBlockValue</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">_get</span><span class="s2">(</span><span class="s1">_getPrototypeOf</span><span class="s2">(</span><span class="s1">BlockValue</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">), </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">, </span><span class="s0">this</span><span class="s2">).</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return this</span><span class="s2">.</span><span class="s1">header </span><span class="s2">? </span><span class="s0">this</span><span class="s2">.</span><span class="s1">header</span><span class="s2">.</span><span class="s1">setOrigRange</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) : </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">BlockValue</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">FlowCollection </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">FlowCollection</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">FlowCollection</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">FlowCollection</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">_this</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">FlowCollection</span><span class="s2">);</span>

    <span class="s1">_this </span><span class="s2">= </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>
    <span class="s1">_this</span><span class="s2">.</span><span class="s1">items </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s0">return </span><span class="s1">_this</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">FlowCollection</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;prevNodeIsJsonLike&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">prevNodeIsJsonLike</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">idx </span><span class="s2">= </span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">&amp;&amp; </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">0</span><span class="s2">] !== </span><span class="s1">undefined </span><span class="s2">? </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">0</span><span class="s2">] : </span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">length</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">node </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">[</span><span class="s1">idx </span><span class="s2">- </span><span class="s7">1</span><span class="s2">];</span>
      <span class="s0">return </span><span class="s2">!!</span><span class="s1">node </span><span class="s2">&amp;&amp; (</span><span class="s1">node</span><span class="s2">.</span><span class="s1">jsonLike </span><span class="s2">|| </span><span class="s1">node</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">COMMENT </span><span class="s2">&amp;&amp; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">prevNodeIsJsonLike</span><span class="s2">(</span><span class="s1">idx </span><span class="s2">- </span><span class="s7">1</span><span class="s2">));</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">parseNode </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parseNode</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">indent </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">char </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">start</span><span class="s2">]; </span><span class="s4">// { or [</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">items </span><span class="s2">= [{</span>
        <span class="s1">char</span><span class="s2">: </span><span class="s1">char</span><span class="s2">,</span>
        <span class="s1">offset</span><span class="s2">: </span><span class="s1">start</span>
      <span class="s2">}];</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s1">char </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">char </span><span class="s2">&amp;&amp; </span><span class="s1">char </span><span class="s2">!== </span><span class="s3">']' </span><span class="s2">&amp;&amp; </span><span class="s1">char </span><span class="s2">!== </span><span class="s3">'}'</span><span class="s2">) {</span>
        <span class="s0">switch </span><span class="s2">(</span><span class="s1">char</span><span class="s2">) {</span>
          <span class="s0">case </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
              <span class="s0">var </span><span class="s1">wsEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>

              <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">wsEnd</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
                <span class="s0">var </span><span class="s1">blankLine </span><span class="s2">= </span><span class="s0">new </span><span class="s1">BlankLine</span><span class="s2">();</span>
                <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">blankLine</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                  <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
                <span class="s2">}, </span><span class="s1">lineStart</span><span class="s2">);</span>
                <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">blankLine</span><span class="s2">);</span>
              <span class="s2">}</span>

              <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>

              <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt;= </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent</span><span class="s2">) {</span>
                <span class="s1">char </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

                <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s1">indent </span><span class="s2">|| </span><span class="s1">char </span><span class="s2">!== </span><span class="s3">']' </span><span class="s2">&amp;&amp; </span><span class="s1">char </span><span class="s2">!== </span><span class="s3">'}'</span><span class="s2">) {</span>
                  <span class="s0">var </span><span class="s1">msg </span><span class="s2">= </span><span class="s3">'Insufficient indentation in flow collection'</span><span class="s2">;</span>
                  <span class="s0">this</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">msg</span><span class="s2">);</span>
                <span class="s2">}</span>
              <span class="s2">}</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">','</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">({</span>
                <span class="s1">char</span><span class="s2">: </span><span class="s1">char</span><span class="s2">,</span>
                <span class="s1">offset</span><span class="s2">: </span><span class="s1">offset</span>
              <span class="s2">});</span>
              <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'#'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">comment </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Comment</span><span class="s2">();</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">comment</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">({</span>
                <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>
              <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">comment</span><span class="s2">);</span>
            <span class="s2">}</span>
            <span class="s0">break</span><span class="s2">;</span>

          <span class="s0">case </span><span class="s3">'?'</span><span class="s2">:</span>
          <span class="s0">case </span><span class="s3">':'</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>

              <span class="s0">if </span><span class="s2">(</span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">',' </span><span class="s2">|| </span><span class="s4">// in-flow : after JSON-like key does not need to be followed by whitespace</span>
              <span class="s1">char </span><span class="s2">=== </span><span class="s3">':' </span><span class="s2">&amp;&amp; </span><span class="s0">this</span><span class="s2">.</span><span class="s1">prevNodeIsJsonLike</span><span class="s2">()) {</span>
                <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">({</span>
                  <span class="s1">char</span><span class="s2">: </span><span class="s1">char</span><span class="s2">,</span>
                  <span class="s1">offset</span><span class="s2">: </span><span class="s1">offset</span>
                <span class="s2">});</span>
                <span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
                <span class="s0">break</span><span class="s2">;</span>
              <span class="s2">}</span>
            <span class="s2">}</span>
          <span class="s4">// fallthrough</span>

          <span class="s0">default</span><span class="s2">:</span>
            <span class="s2">{</span>
              <span class="s0">var </span><span class="s1">node </span><span class="s2">= </span><span class="s1">parseNode</span><span class="s2">({</span>
                <span class="s1">atLineStart</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
                <span class="s1">inCollection</span><span class="s2">: </span><span class="s0">false</span><span class="s2">,</span>
                <span class="s1">inFlow</span><span class="s2">: </span><span class="s0">true</span><span class="s2">,</span>
                <span class="s1">indent</span><span class="s2">: -</span><span class="s7">1</span><span class="s2">,</span>
                <span class="s1">lineStart</span><span class="s2">: </span><span class="s1">lineStart</span><span class="s2">,</span>
                <span class="s1">parent</span><span class="s2">: </span><span class="s0">this</span>
              <span class="s2">}, </span><span class="s1">offset</span><span class="s2">);</span>

              <span class="s0">if </span><span class="s2">(!</span><span class="s1">node</span><span class="s2">) {</span>
                <span class="s4">// at next document start</span>
                <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
                <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
              <span class="s2">}</span>

              <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">normalizeOffset</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">);</span>
            <span class="s2">}</span>
        <span class="s2">}</span>

        <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
        <span class="s1">char </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">char</span><span class="s2">) {</span>
        <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">push</span><span class="s2">({</span>
          <span class="s1">char</span><span class="s2">: </span><span class="s1">char</span><span class="s2">,</span>
          <span class="s1">offset</span><span class="s2">: </span><span class="s1">offset</span>
        <span class="s2">});</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">_get</span><span class="s2">(</span><span class="s1">_getPrototypeOf</span><span class="s2">(</span><span class="s1">FlowCollection</span><span class="s2">.</span><span class="s1">prototype</span><span class="s2">), </span><span class="s3">&quot;setOrigRanges&quot;</span><span class="s2">, </span><span class="s0">this</span><span class="s2">).</span><span class="s1">call</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">node </span><span class="s0">instanceof </span><span class="s1">Node</span><span class="s2">) {</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">cr</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s7">0</span><span class="s2">) {</span>
          <span class="s1">node</span><span class="s2">.</span><span class="s1">origOffset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">offset</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>

          <span class="s0">while </span><span class="s2">(</span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">cr</span><span class="s2">.</span><span class="s1">length</span><span class="s2">) {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">cr</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] &gt; </span><span class="s1">node</span><span class="s2">.</span><span class="s1">offset</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span><span class="s0">else </span><span class="s2">++</span><span class="s1">i</span><span class="s2">;</span>
          <span class="s2">}</span>

          <span class="s1">node</span><span class="s2">.</span><span class="s1">origOffset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">offset </span><span class="s2">+ </span><span class="s1">i</span><span class="s2">;</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">i</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">});</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;toString&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">toString</span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">,</span>
          <span class="s1">items </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">items</span><span class="s2">,</span>
          <span class="s1">range </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">range</span><span class="s2">,</span>
          <span class="s1">value </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">value </span><span class="s2">!= </span><span class="s0">null</span><span class="s2">) </span><span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">nodes </span><span class="s2">= </span><span class="s1">items</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">item</span><span class="s2">) {</span>
        <span class="s0">return </span><span class="s1">item </span><span class="s0">instanceof </span><span class="s1">Node</span><span class="s2">;</span>
      <span class="s2">});</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">prevEnd </span><span class="s2">= </span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">;</span>
      <span class="s1">nodes</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">prefix </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">prevEnd</span><span class="s2">, </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">start</span><span class="s2">);</span>
        <span class="s1">prevEnd </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
        <span class="s1">str </span><span class="s2">+= </span><span class="s1">prefix </span><span class="s2">+ </span><span class="s1">String</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">str</span><span class="s2">[</span><span class="s1">str</span><span class="s2">.</span><span class="s1">length </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">src</span><span class="s2">[</span><span class="s1">prevEnd </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] !== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">&amp;&amp; </span><span class="s1">src</span><span class="s2">[</span><span class="s1">prevEnd</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s4">// Comment range does not include the terminal newline, but its</span>
          <span class="s4">// stringified value does. Without this fix, newlines at comment ends</span>
          <span class="s4">// get duplicated.</span>
          <span class="s1">prevEnd </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">});</span>
      <span class="s1">str </span><span class="s2">+= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">prevEnd</span><span class="s2">, </span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">addStringTerminator</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">, </span><span class="s1">str</span><span class="s2">);</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">FlowCollection</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">QuoteDouble </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">QuoteDouble</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">QuoteDouble</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">QuoteDouble</span><span class="s2">() {</span>
    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">QuoteDouble</span><span class="s2">);</span>

    <span class="s0">return </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">QuoteDouble</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;strValue&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">:</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{string | { str: string, errors: YAMLSyntaxError[] }}</span>
     <span class="s5">*/</span>
    <span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">|| !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">) </span><span class="s0">return null</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">errors </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">_this$valueRange </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">,</span>
          <span class="s1">start </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">start</span><span class="s2">,</span>
          <span class="s1">end </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">_this$context </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">indent </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] !== </span><span class="s3">'&quot;'</span><span class="s2">) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Missing closing &quot;quote'</span><span class="s2">)); </span><span class="s4">// Using String#replace is too painful with escaped newlines preceded by</span>
      <span class="s4">// escaped backslashes; also, this should be faster.</span>

      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>

      <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">)) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Document boundary indicators are not allowed within string values'</span><span class="s2">));</span>

          <span class="s0">var </span><span class="s1">_Node$foldNewline </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">foldNewline</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">i</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">),</span>
              <span class="s1">fold </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">fold</span><span class="s2">,</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">offset</span><span class="s2">,</span>
              <span class="s1">error </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">error</span><span class="s2">;</span>

          <span class="s1">str </span><span class="s2">+= </span><span class="s1">fold</span><span class="s2">;</span>
          <span class="s1">i </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">error</span><span class="s2">) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Multi-line double-quoted string needs to be sufficiently indented'</span><span class="s2">));</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\\</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>

          <span class="s0">switch </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">]) {</span>
            <span class="s0">case </span><span class="s3">'0'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\0</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// null character</span>

            <span class="s0">case </span><span class="s3">'a'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\x07</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// bell character</span>

            <span class="s0">case </span><span class="s3">'b'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\b</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// backspace</span>

            <span class="s0">case </span><span class="s3">'e'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\x1b</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// escape character</span>

            <span class="s0">case </span><span class="s3">'f'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\f</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// form feed</span>

            <span class="s0">case </span><span class="s3">'n'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// line feed</span>

            <span class="s0">case </span><span class="s3">'r'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\r</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// carriage return</span>

            <span class="s0">case </span><span class="s3">'t'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// horizontal tab</span>

            <span class="s0">case </span><span class="s3">'v'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\v</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// vertical tab</span>

            <span class="s0">case </span><span class="s3">'N'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">&quot;</span><span class="s0">\x85</span><span class="s3">&quot;</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// Unicode next line</span>

            <span class="s0">case </span><span class="s3">'_'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">&quot;</span><span class="s0">\xA0</span><span class="s3">&quot;</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// Unicode non-breaking space</span>

            <span class="s0">case </span><span class="s3">'L'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">&quot;</span><span class="s0">\u2028</span><span class="s3">&quot;</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// Unicode line separator</span>

            <span class="s0">case </span><span class="s3">'P'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">&quot;</span><span class="s0">\u2029</span><span class="s3">&quot;</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>
            <span class="s4">// Unicode paragraph separator</span>

            <span class="s0">case </span><span class="s3">' '</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">' '</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'&quot;'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'&quot;'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'/'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'/'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'</span><span class="s0">\\</span><span class="s3">'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\\</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'x'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseCharCode</span><span class="s2">(</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s7">2</span><span class="s2">, </span><span class="s1">errors</span><span class="s2">);</span>
              <span class="s1">i </span><span class="s2">+= </span><span class="s7">2</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'u'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseCharCode</span><span class="s2">(</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s7">4</span><span class="s2">, </span><span class="s1">errors</span><span class="s2">);</span>
              <span class="s1">i </span><span class="s2">+= </span><span class="s7">4</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'U'</span><span class="s2">:</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseCharCode</span><span class="s2">(</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s7">8</span><span class="s2">, </span><span class="s1">errors</span><span class="s2">);</span>
              <span class="s1">i </span><span class="s2">+= </span><span class="s7">8</span><span class="s2">;</span>
              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">case </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">:</span>
              <span class="s4">// skip escaped newlines, but still trim the following line</span>
              <span class="s0">while </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">] === </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
                <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
              <span class="s2">}</span>

              <span class="s0">break</span><span class="s2">;</span>

            <span class="s0">default</span><span class="s2">:</span>
              <span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">&quot;Invalid escape sequence &quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">src</span><span class="s2">.</span><span class="s1">substr</span><span class="s2">(</span><span class="s1">i </span><span class="s2">- </span><span class="s7">1</span><span class="s2">, </span><span class="s7">2</span><span class="s2">))));</span>
              <span class="s1">str </span><span class="s2">+= </span><span class="s3">'</span><span class="s0">\\</span><span class="s3">' </span><span class="s2">+ </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>
          <span class="s2">}</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s4">// trim trailing whitespace</span>
          <span class="s0">var </span><span class="s1">wsStart </span><span class="s2">= </span><span class="s1">i</span><span class="s2">;</span>
          <span class="s0">var </span><span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>

          <span class="s0">while </span><span class="s2">(</span><span class="s1">next </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
            <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
            <span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>
          <span class="s2">}</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">next </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">str </span><span class="s2">+= </span><span class="s1">i </span><span class="s2">&gt; </span><span class="s1">wsStart </span><span class="s2">? </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">wsStart</span><span class="s2">, </span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">) : </span><span class="s1">ch</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">str </span><span class="s2">+= </span><span class="s1">ch</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">? {</span>
        <span class="s1">errors</span><span class="s2">: </span><span class="s1">errors</span><span class="s2">,</span>
        <span class="s1">str</span><span class="s2">: </span><span class="s1">str</span>
      <span class="s2">} : </span><span class="s1">str</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseCharCode&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseCharCode</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">length</span><span class="s2">, </span><span class="s1">errors</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">cc </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">substr</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">length</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ok </span><span class="s2">= </span><span class="s1">cc</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s1">length </span><span class="s2">&amp;&amp; </span><span class="s8">/^[0-9a-fA-F]+$/</span><span class="s2">.</span><span class="s1">test</span><span class="s2">(</span><span class="s1">cc</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">code </span><span class="s2">= </span><span class="s1">ok </span><span class="s2">? </span><span class="s1">parseInt</span><span class="s2">(</span><span class="s1">cc</span><span class="s2">, </span><span class="s7">16</span><span class="s2">) : </span><span class="s1">NaN</span><span class="s2">;</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">isNaN</span><span class="s2">(</span><span class="s1">code</span><span class="s2">)) {</span>
        <span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">&quot;Invalid escape sequence &quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">src</span><span class="s2">.</span><span class="s1">substr</span><span class="s2">(</span><span class="s1">offset </span><span class="s2">- </span><span class="s7">2</span><span class="s2">, </span><span class="s1">length </span><span class="s2">+ </span><span class="s7">2</span><span class="s2">))));</span>
        <span class="s0">return </span><span class="s1">src</span><span class="s2">.</span><span class="s1">substr</span><span class="s2">(</span><span class="s1">offset </span><span class="s2">- </span><span class="s7">2</span><span class="s2">, </span><span class="s1">length </span><span class="s2">+ </span><span class="s7">2</span><span class="s2">);</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">String</span><span class="s2">.</span><span class="s1">fromCodePoint</span><span class="s2">(</span><span class="s1">code</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses a &quot;double quoted&quot; value from the source</span>
     <span class="s5">*</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this scalar</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">QuoteDouble</span><span class="s2">.</span><span class="s1">endOfQuote</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}], [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;endOfQuote&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">endOfQuote</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">!== </span><span class="s3">'&quot;'</span><span class="s2">) {</span>
        <span class="s1">offset </span><span class="s2">+= </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\\</span><span class="s3">' </span><span class="s2">? </span><span class="s7">2 </span><span class="s2">: </span><span class="s7">1</span><span class="s2">;</span>
        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">QuoteDouble</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">var </span><span class="s1">QuoteSingle </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">(</span><span class="s1">_Node</span><span class="s2">) {</span>
  <span class="s1">_inherits</span><span class="s2">(</span><span class="s1">QuoteSingle</span><span class="s2">, </span><span class="s1">_Node</span><span class="s2">);</span>

  <span class="s0">var </span><span class="s1">_super </span><span class="s2">= </span><span class="s1">_createSuper</span><span class="s2">(</span><span class="s1">QuoteSingle</span><span class="s2">);</span>

  <span class="s0">function </span><span class="s1">QuoteSingle</span><span class="s2">() {</span>
    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">QuoteSingle</span><span class="s2">);</span>

    <span class="s0">return </span><span class="s1">_super</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">arguments</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">QuoteSingle</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;strValue&quot;</span><span class="s2">,</span>
    <span class="s1">get</span><span class="s2">:</span>
    <span class="s5">/**</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{string | { str: string, errors: YAMLSyntaxError[] }}</span>
     <span class="s5">*/</span>
    <span class="s0">function </span><span class="s1">get</span><span class="s2">() {</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">|| !</span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">) </span><span class="s0">return null</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">errors </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">_this$valueRange </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange</span><span class="s2">,</span>
          <span class="s1">start </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">start</span><span class="s2">,</span>
          <span class="s1">end </span><span class="s2">= </span><span class="s1">_this$valueRange</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">_this$context </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">context</span><span class="s2">,</span>
          <span class="s1">indent </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s1">_this$context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] !== </span><span class="s3">&quot;'&quot;</span><span class="s2">) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">&quot;Missing closing 'quote&quot;</span><span class="s2">));</span>
      <span class="s0">var </span><span class="s1">str </span><span class="s2">= </span><span class="s3">''</span><span class="s2">;</span>

      <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">end </span><span class="s2">- </span><span class="s7">1</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">];</span>

        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">)) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Document boundary indicators are not allowed within string values'</span><span class="s2">));</span>

          <span class="s0">var </span><span class="s1">_Node$foldNewline </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">foldNewline</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">i</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">),</span>
              <span class="s1">fold </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">fold</span><span class="s2">,</span>
              <span class="s1">offset </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">offset</span><span class="s2">,</span>
              <span class="s1">error </span><span class="s2">= </span><span class="s1">_Node$foldNewline</span><span class="s2">.</span><span class="s1">error</span><span class="s2">;</span>

          <span class="s1">str </span><span class="s2">+= </span><span class="s1">fold</span><span class="s2">;</span>
          <span class="s1">i </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">error</span><span class="s2">) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSemanticError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Multi-line single-quoted string needs to be sufficiently indented'</span><span class="s2">));</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">&quot;'&quot;</span><span class="s2">) {</span>
          <span class="s1">str </span><span class="s2">+= </span><span class="s1">ch</span><span class="s2">;</span>
          <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] !== </span><span class="s3">&quot;'&quot;</span><span class="s2">) </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">'Unescaped single quote? This should not happen.'</span><span class="s2">));</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s4">// trim trailing whitespace</span>
          <span class="s0">var </span><span class="s1">wsStart </span><span class="s2">= </span><span class="s1">i</span><span class="s2">;</span>
          <span class="s0">var </span><span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>

          <span class="s0">while </span><span class="s2">(</span><span class="s1">next </span><span class="s2">=== </span><span class="s3">' ' </span><span class="s2">|| </span><span class="s1">next </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\t</span><span class="s3">'</span><span class="s2">) {</span>
            <span class="s1">i </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">;</span>
            <span class="s1">next </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">];</span>
          <span class="s2">}</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">next </span><span class="s2">!== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s1">str </span><span class="s2">+= </span><span class="s1">i </span><span class="s2">&gt; </span><span class="s1">wsStart </span><span class="s2">? </span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">wsStart</span><span class="s2">, </span><span class="s1">i </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">) : </span><span class="s1">ch</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">str </span><span class="s2">+= </span><span class="s1">ch</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">errors</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">? {</span>
        <span class="s1">errors</span><span class="s2">: </span><span class="s1">errors</span><span class="s2">,</span>
        <span class="s1">str</span><span class="s2">: </span><span class="s1">str</span>
      <span class="s2">} : </span><span class="s1">str</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses a 'single quoted' value from the source</span>
     <span class="s5">*</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} context</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first character</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{number} - Index of the character after this scalar</span>
     <span class="s5">*/</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parse&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">context </span><span class="s2">= </span><span class="s1">context</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">src </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">QuoteSingle</span><span class="s2">.</span><span class="s1">endOfQuote</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
      <span class="s0">this</span><span class="s2">.</span><span class="s1">valueRange </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parseComment</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">offset</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}], [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;endOfQuote&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">endOfQuote</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">&quot;'&quot;</span><span class="s2">) {</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">] !== </span><span class="s3">&quot;'&quot;</span><span class="s2">) </span><span class="s0">break</span><span class="s2">;</span>
          <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+= </span><span class="s7">2</span><span class="s2">];</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">+= </span><span class="s7">1</span><span class="s2">];</span>
        <span class="s2">}</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">QuoteSingle</span><span class="s2">;</span>
<span class="s2">}(</span><span class="s1">Node</span><span class="s2">);</span>

<span class="s0">function </span><span class="s1">createNewNode</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">) {</span>
  <span class="s0">switch </span><span class="s2">(</span><span class="s1">type</span><span class="s2">) {</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">ALIAS</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">Alias</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLOCK_FOLDED</span><span class="s2">:</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLOCK_LITERAL</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">BlockValue</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">FLOW_MAP</span><span class="s2">:</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">FLOW_SEQ</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">FlowCollection</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">MAP_KEY</span><span class="s2">:</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">MAP_VALUE</span><span class="s2">:</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">CollectionItem</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">COMMENT</span><span class="s2">:</span>
    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">PLAIN</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">PlainValue</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">QUOTE_DOUBLE</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">QuoteDouble</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s0">case </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">QUOTE_SINGLE</span><span class="s2">:</span>
      <span class="s0">return new </span><span class="s1">QuoteSingle</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>

    <span class="s4">/* istanbul ignore next */</span>

    <span class="s0">default</span><span class="s2">:</span>
      <span class="s0">return null</span><span class="s2">;</span>
    <span class="s4">// should never happen</span>
  <span class="s2">}</span>
<span class="s2">}</span>
<span class="s5">/**</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{boolean} atLineStart - Node starts at beginning of line</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{boolean} inFlow - true if currently in a flow context</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{boolean} inCollection - true if currently in a collection context</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} indent - Current level of indentation</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} lineStart - Start of the current line</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Node} parent - The parent of the node</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{string} src - Source of the YAML document</span>
 <span class="s5">*/</span>


<span class="s0">var </span><span class="s1">ParseContext </span><span class="s2">= </span><span class="s4">/*#__PURE__*/</span><span class="s0">function </span><span class="s2">() {</span>
  <span class="s0">function </span><span class="s1">ParseContext</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">_this </span><span class="s2">= </span><span class="s0">this</span><span class="s2">;</span>

    <span class="s0">var </span><span class="s1">orig </span><span class="s2">= </span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">0 </span><span class="s2">&amp;&amp; </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">0</span><span class="s2">] !== </span><span class="s1">undefined </span><span class="s2">? </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">0</span><span class="s2">] : {};</span>

    <span class="s0">var </span><span class="s1">_ref </span><span class="s2">= </span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">1 </span><span class="s2">&amp;&amp; </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">1</span><span class="s2">] !== </span><span class="s1">undefined </span><span class="s2">? </span><span class="s1">arguments</span><span class="s2">[</span><span class="s7">1</span><span class="s2">] : {},</span>
        <span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">atLineStart</span><span class="s2">,</span>
        <span class="s1">inCollection </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">inCollection</span><span class="s2">,</span>
        <span class="s1">inFlow </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">inFlow</span><span class="s2">,</span>
        <span class="s1">indent </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">,</span>
        <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">,</span>
        <span class="s1">parent </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">;</span>

    <span class="s1">_classCallCheck</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s1">ParseContext</span><span class="s2">);</span>

    <span class="s1">_defineProperty</span><span class="s2">(</span><span class="s0">this</span><span class="s2">, </span><span class="s3">&quot;parseNode&quot;</span><span class="s2">, </span><span class="s0">function </span><span class="s2">(</span><span class="s1">overlay</span><span class="s2">, </span><span class="s1">start</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atDocumentBoundary</span><span class="s2">(</span><span class="s1">_this</span><span class="s2">.</span><span class="s1">src</span><span class="s2">, </span><span class="s1">start</span><span class="s2">)) </span><span class="s0">return null</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">context </span><span class="s2">= </span><span class="s0">new </span><span class="s1">ParseContext</span><span class="s2">(</span><span class="s1">_this</span><span class="s2">, </span><span class="s1">overlay</span><span class="s2">);</span>

      <span class="s0">var </span><span class="s1">_context$parseProps </span><span class="s2">= </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parseProps</span><span class="s2">(</span><span class="s1">start</span><span class="s2">),</span>
          <span class="s1">props </span><span class="s2">= </span><span class="s1">_context$parseProps</span><span class="s2">.</span><span class="s1">props</span><span class="s2">,</span>
          <span class="s1">type </span><span class="s2">= </span><span class="s1">_context$parseProps</span><span class="s2">.</span><span class="s1">type</span><span class="s2">,</span>
          <span class="s1">valueStart </span><span class="s2">= </span><span class="s1">_context$parseProps</span><span class="s2">.</span><span class="s1">valueStart</span><span class="s2">;</span>

      <span class="s0">var </span><span class="s1">node </span><span class="s2">= </span><span class="s1">createNewNode</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">props</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">valueStart</span><span class="s2">);</span>
      <span class="s1">node</span><span class="s2">.</span><span class="s1">range </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s4">/* istanbul ignore if */</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt;= </span><span class="s1">start</span><span class="s2">) {</span>
        <span class="s4">// This should never happen, but if it does, let's make sure to at least</span>
        <span class="s4">// step one character forward to avoid a busy loop.</span>
        <span class="s1">node</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Error</span><span class="s2">(</span><span class="s3">&quot;Node#parse consumed no characters&quot;</span><span class="s2">);</span>
        <span class="s1">node</span><span class="s2">.</span><span class="s1">error</span><span class="s2">.</span><span class="s1">parseEnd </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>
        <span class="s1">node</span><span class="s2">.</span><span class="s1">error</span><span class="s2">.</span><span class="s1">source </span><span class="s2">= </span><span class="s1">node</span><span class="s2">;</span>
        <span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end </span><span class="s2">= </span><span class="s1">start </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">if </span><span class="s2">(</span><span class="s1">context</span><span class="s2">.</span><span class="s1">nodeStartsCollection</span><span class="s2">(</span><span class="s1">node</span><span class="s2">)) {</span>
        <span class="s0">if </span><span class="s2">(!</span><span class="s1">node</span><span class="s2">.</span><span class="s1">error </span><span class="s2">&amp;&amp; !</span><span class="s1">context</span><span class="s2">.</span><span class="s1">atLineStart </span><span class="s2">&amp;&amp; </span><span class="s1">context</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">DOCUMENT</span><span class="s2">) {</span>
          <span class="s1">node</span><span class="s2">.</span><span class="s1">error </span><span class="s2">= </span><span class="s0">new </span><span class="s1">YAMLSyntaxError</span><span class="s2">(</span><span class="s1">node</span><span class="s2">, </span><span class="s3">'Block collection must not have preceding content here (e.g. directives-end indicator)'</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s0">var </span><span class="s1">collection </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Collection</span><span class="s2">(</span><span class="s1">node</span><span class="s2">);</span>
        <span class="s1">offset </span><span class="s2">= </span><span class="s1">collection</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">(</span><span class="s0">new </span><span class="s1">ParseContext</span><span class="s2">(</span><span class="s1">context</span><span class="s2">), </span><span class="s1">offset</span><span class="s2">);</span>
        <span class="s1">collection</span><span class="s2">.</span><span class="s1">range </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
        <span class="s0">return </span><span class="s1">collection</span><span class="s2">;</span>
      <span class="s2">}</span>

      <span class="s0">return </span><span class="s1">node</span><span class="s2">;</span>
    <span class="s2">});</span>

    <span class="s0">this</span><span class="s2">.</span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s1">atLineStart </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">atLineStart </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">atLineStart </span><span class="s2">|| </span><span class="s0">false</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">inCollection </span><span class="s2">= </span><span class="s1">inCollection </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">inCollection </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">inCollection </span><span class="s2">|| </span><span class="s0">false</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">inFlow </span><span class="s2">= </span><span class="s1">inFlow </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">inFlow </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">inFlow </span><span class="s2">|| </span><span class="s0">false</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">indent </span><span class="s2">= </span><span class="s1">indent </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">indent </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">lineStart </span><span class="s2">= </span><span class="s1">lineStart </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">lineStart </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">lineStart</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">parent </span><span class="s2">= </span><span class="s1">parent </span><span class="s2">!= </span><span class="s0">null </span><span class="s2">? </span><span class="s1">parent </span><span class="s2">: </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">parent </span><span class="s2">|| {};</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">root </span><span class="s2">= </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">root</span><span class="s2">;</span>
    <span class="s0">this</span><span class="s2">.</span><span class="s1">src </span><span class="s2">= </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s1">_createClass</span><span class="s2">(</span><span class="s1">ParseContext</span><span class="s2">, [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;nodeStartsCollection&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">nodeStartsCollection</span><span class="s2">(</span><span class="s1">node</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">inCollection </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">inCollection</span><span class="s2">,</span>
          <span class="s1">inFlow </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">inFlow</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">inCollection </span><span class="s2">|| </span><span class="s1">inFlow</span><span class="s2">) </span><span class="s0">return false</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">node </span><span class="s0">instanceof </span><span class="s1">CollectionItem</span><span class="s2">) </span><span class="s0">return true</span><span class="s2">; </span><span class="s4">// check for implicit key</span>

      <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s1">node</span><span class="s2">.</span><span class="s1">range</span><span class="s2">.</span><span class="s1">end</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">' </span><span class="s2">|| </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset </span><span class="s2">- </span><span class="s7">1</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) </span><span class="s0">return false</span><span class="s2">;</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">] === </span><span class="s3">':'</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s4">// Anchor and tag are before type, which determines the node implementation</span>
    <span class="s4">// class; hence this intermediate step.</span>

  <span class="s2">}, {</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseProps&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseProps</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">inFlow </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">inFlow</span><span class="s2">,</span>
          <span class="s1">parent </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">parent</span><span class="s2">,</span>
          <span class="s1">src </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">src</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">props </span><span class="s2">= [];</span>
      <span class="s0">var </span><span class="s1">lineHasProps </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
      <span class="s1">offset </span><span class="s2">= </span><span class="s0">this</span><span class="s2">.</span><span class="s1">atLineStart </span><span class="s2">? </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) : </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>

      <span class="s0">while </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">ANCHOR </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">COMMENT </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">TAG </span><span class="s2">|| </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">) {</span>
          <span class="s0">var </span><span class="s1">inEnd </span><span class="s2">= </span><span class="s1">offset</span><span class="s2">;</span>
          <span class="s0">var </span><span class="s1">lineStart </span><span class="s2">= </span><span class="s0">void </span><span class="s7">0</span><span class="s2">;</span>

          <span class="s0">do </span><span class="s2">{</span>
            <span class="s1">lineStart </span><span class="s2">= </span><span class="s1">inEnd </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">;</span>
            <span class="s1">inEnd </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIndent</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">lineStart</span><span class="s2">);</span>
          <span class="s2">} </span><span class="s0">while </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">inEnd</span><span class="s2">] === </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">);</span>

          <span class="s0">var </span><span class="s1">indentDiff </span><span class="s2">= </span><span class="s1">inEnd </span><span class="s2">- (</span><span class="s1">lineStart </span><span class="s2">+ </span><span class="s0">this</span><span class="s2">.</span><span class="s1">indent</span><span class="s2">);</span>
          <span class="s0">var </span><span class="s1">noIndicatorAsIndent </span><span class="s2">= </span><span class="s1">parent</span><span class="s2">.</span><span class="s1">type </span><span class="s2">=== </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM </span><span class="s2">&amp;&amp; </span><span class="s1">parent</span><span class="s2">.</span><span class="s1">context</span><span class="s2">.</span><span class="s1">atLineStart</span><span class="s2">;</span>
          <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">inEnd</span><span class="s2">] !== </span><span class="s3">'#' </span><span class="s2">&amp;&amp; !</span><span class="s1">Node</span><span class="s2">.</span><span class="s1">nextNodeIsIndented</span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">inEnd</span><span class="s2">], </span><span class="s1">indentDiff</span><span class="s2">, !</span><span class="s1">noIndicatorAsIndent</span><span class="s2">)) </span><span class="s0">break</span><span class="s2">;</span>
          <span class="s0">this</span><span class="s2">.</span><span class="s1">atLineStart </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s0">this</span><span class="s2">.</span><span class="s1">lineStart </span><span class="s2">= </span><span class="s1">lineStart</span><span class="s2">;</span>
          <span class="s1">lineHasProps </span><span class="s2">= </span><span class="s0">false</span><span class="s2">;</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">inEnd</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">COMMENT</span><span class="s2">) {</span>
          <span class="s0">var </span><span class="s1">end </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfLine</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>
          <span class="s1">props</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">end</span><span class="s2">));</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">end</span><span class="s2">;</span>
        <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
          <span class="s0">var </span><span class="s1">_end </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIdentifier</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">);</span>

          <span class="s0">if </span><span class="s2">(</span><span class="s1">ch </span><span class="s2">=== </span><span class="s1">Char</span><span class="s2">.</span><span class="s1">TAG </span><span class="s2">&amp;&amp; </span><span class="s1">src</span><span class="s2">[</span><span class="s1">_end</span><span class="s2">] === </span><span class="s3">',' </span><span class="s2">&amp;&amp; </span><span class="s8">/^[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+,\d\d\d\d(-\d\d){0,2}\/\S/</span><span class="s2">.</span><span class="s1">test</span><span class="s2">(</span><span class="s1">src</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s1">_end </span><span class="s2">+ </span><span class="s7">13</span><span class="s2">))) {</span>
            <span class="s4">// Let's presume we're dealing with a YAML 1.0 domain tag here, rather</span>
            <span class="s4">// than an empty but 'foo.bar' private-tagged node in a flow collection</span>
            <span class="s4">// followed without whitespace by a plain string starting with a year</span>
            <span class="s4">// or date divided by something.</span>
            <span class="s1">_end </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfIdentifier</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">_end </span><span class="s2">+ </span><span class="s7">5</span><span class="s2">);</span>
          <span class="s2">}</span>

          <span class="s1">props</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s0">new </span><span class="s1">Range</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">, </span><span class="s1">_end</span><span class="s2">));</span>
          <span class="s1">lineHasProps </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
          <span class="s1">offset </span><span class="s2">= </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">endOfWhiteSpace</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">_end</span><span class="s2">);</span>
        <span class="s2">}</span>

        <span class="s1">ch </span><span class="s2">= </span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">];</span>
      <span class="s2">} </span><span class="s4">// '- &amp;a : b' has an anchor on an empty node</span>


      <span class="s0">if </span><span class="s2">(</span><span class="s1">lineHasProps </span><span class="s2">&amp;&amp; </span><span class="s1">ch </span><span class="s2">=== </span><span class="s3">':' </span><span class="s2">&amp;&amp; </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atBlank</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s0">true</span><span class="s2">)) </span><span class="s1">offset </span><span class="s2">-= </span><span class="s7">1</span><span class="s2">;</span>
      <span class="s0">var </span><span class="s1">type </span><span class="s2">= </span><span class="s1">ParseContext</span><span class="s2">.</span><span class="s1">parseType</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">inFlow</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s2">{</span>
        <span class="s1">props</span><span class="s2">: </span><span class="s1">props</span><span class="s2">,</span>
        <span class="s1">type</span><span class="s2">: </span><span class="s1">type</span><span class="s2">,</span>
        <span class="s1">valueStart</span><span class="s2">: </span><span class="s1">offset</span>
      <span class="s2">};</span>
    <span class="s2">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Parses a node from the source</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{ParseContext} overlay</span>
     <span class="s5">* </span><span class="s6">@param </span><span class="s5">{number} start - Index of first non-whitespace character for the node</span>
     <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{?Node} - null if at a document boundary</span>
     <span class="s5">*/</span>

  <span class="s2">}], [{</span>
    <span class="s1">key</span><span class="s2">: </span><span class="s3">&quot;parseType&quot;</span><span class="s2">,</span>
    <span class="s1">value</span><span class="s2">: </span><span class="s0">function </span><span class="s1">parseType</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">inFlow</span><span class="s2">) {</span>
      <span class="s0">switch </span><span class="s2">(</span><span class="s1">src</span><span class="s2">[</span><span class="s1">offset</span><span class="s2">]) {</span>
        <span class="s0">case </span><span class="s3">'*'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">ALIAS</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'&gt;'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLOCK_FOLDED</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'|'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">BLOCK_LITERAL</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'{'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">FLOW_MAP</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'['</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">FLOW_SEQ</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'?'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s2">!</span><span class="s1">inFlow </span><span class="s2">&amp;&amp; </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atBlank</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s0">true</span><span class="s2">) ? </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">MAP_KEY </span><span class="s2">: </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">PLAIN</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">':'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s2">!</span><span class="s1">inFlow </span><span class="s2">&amp;&amp; </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atBlank</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s0">true</span><span class="s2">) ? </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">MAP_VALUE </span><span class="s2">: </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">PLAIN</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'-'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s2">!</span><span class="s1">inFlow </span><span class="s2">&amp;&amp; </span><span class="s1">Node</span><span class="s2">.</span><span class="s1">atBlank</span><span class="s2">(</span><span class="s1">src</span><span class="s2">, </span><span class="s1">offset </span><span class="s2">+ </span><span class="s7">1</span><span class="s2">, </span><span class="s0">true</span><span class="s2">) ? </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">SEQ_ITEM </span><span class="s2">: </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">PLAIN</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">'&quot;'</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">QUOTE_DOUBLE</span><span class="s2">;</span>

        <span class="s0">case </span><span class="s3">&quot;'&quot;</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">QUOTE_SINGLE</span><span class="s2">;</span>

        <span class="s0">default</span><span class="s2">:</span>
          <span class="s0">return </span><span class="s1">Type</span><span class="s2">.</span><span class="s1">PLAIN</span><span class="s2">;</span>
      <span class="s2">}</span>
    <span class="s2">}</span>
  <span class="s2">}]);</span>

  <span class="s0">return </span><span class="s1">ParseContext</span><span class="s2">;</span>
<span class="s2">}();</span>

<span class="s4">// Published as 'yaml/parse-cst'</span>
<span class="s0">function </span><span class="s1">parse</span><span class="s2">(</span><span class="s1">src</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">cr </span><span class="s2">= [];</span>

  <span class="s0">if </span><span class="s2">(</span><span class="s1">src</span><span class="s2">.</span><span class="s1">indexOf</span><span class="s2">(</span><span class="s3">'</span><span class="s0">\r</span><span class="s3">'</span><span class="s2">) !== -</span><span class="s7">1</span><span class="s2">) {</span>
    <span class="s1">src </span><span class="s2">= </span><span class="s1">src</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/\r\n?/g</span><span class="s2">, </span><span class="s0">function </span><span class="s2">(</span><span class="s1">match</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">match</span><span class="s2">.</span><span class="s1">length </span><span class="s2">&gt; </span><span class="s7">1</span><span class="s2">) </span><span class="s1">cr</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">offset</span><span class="s2">);</span>
      <span class="s0">return </span><span class="s3">'</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">;</span>
    <span class="s2">});</span>
  <span class="s2">}</span>

  <span class="s0">var </span><span class="s1">documents </span><span class="s2">= [];</span>
  <span class="s0">var </span><span class="s1">offset </span><span class="s2">= </span><span class="s7">0</span><span class="s2">;</span>

  <span class="s0">do </span><span class="s2">{</span>
    <span class="s0">var </span><span class="s1">doc </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Document</span><span class="s2">();</span>
    <span class="s0">var </span><span class="s1">context </span><span class="s2">= </span><span class="s0">new </span><span class="s1">ParseContext</span><span class="s2">({</span>
      <span class="s1">src</span><span class="s2">: </span><span class="s1">src</span>
    <span class="s2">});</span>
    <span class="s1">offset </span><span class="s2">= </span><span class="s1">doc</span><span class="s2">.</span><span class="s1">parse</span><span class="s2">(</span><span class="s1">context</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">);</span>
    <span class="s1">documents</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">doc</span><span class="s2">);</span>
  <span class="s2">} </span><span class="s0">while </span><span class="s2">(</span><span class="s1">offset </span><span class="s2">&lt; </span><span class="s1">src</span><span class="s2">.</span><span class="s1">length</span><span class="s2">);</span>

  <span class="s1">documents</span><span class="s2">.</span><span class="s1">setOrigRanges </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">cr</span><span class="s2">.</span><span class="s1">length </span><span class="s2">=== </span><span class="s7">0</span><span class="s2">) </span><span class="s0">return false</span><span class="s2">;</span>

    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s7">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">cr</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; ++</span><span class="s1">i</span><span class="s2">) {</span>
      <span class="s1">cr</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] -= </span><span class="s1">i</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s0">var </span><span class="s1">crOffset </span><span class="s2">= </span><span class="s7">0</span><span class="s2">;</span>

    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">_i </span><span class="s2">= </span><span class="s7">0</span><span class="s2">; </span><span class="s1">_i </span><span class="s2">&lt; </span><span class="s1">documents</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; ++</span><span class="s1">_i</span><span class="s2">) {</span>
      <span class="s1">crOffset </span><span class="s2">= </span><span class="s1">documents</span><span class="s2">[</span><span class="s1">_i</span><span class="s2">].</span><span class="s1">setOrigRanges</span><span class="s2">(</span><span class="s1">cr</span><span class="s2">, </span><span class="s1">crOffset</span><span class="s2">);</span>
    <span class="s2">}</span>

    <span class="s1">cr</span><span class="s2">.</span><span class="s1">splice</span><span class="s2">(</span><span class="s7">0</span><span class="s2">, </span><span class="s1">cr</span><span class="s2">.</span><span class="s1">length</span><span class="s2">);</span>
    <span class="s0">return true</span><span class="s2">;</span>
  <span class="s2">};</span>

  <span class="s1">documents</span><span class="s2">.</span><span class="s1">toString </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
    <span class="s0">return </span><span class="s1">documents</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">'...</span><span class="s0">\n</span><span class="s3">'</span><span class="s2">);</span>
  <span class="s2">};</span>

  <span class="s0">return </span><span class="s1">documents</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s0">export </span><span class="s2">{ </span><span class="s1">parse </span><span class="s2">};</span>
</pre>
</body>
</html>