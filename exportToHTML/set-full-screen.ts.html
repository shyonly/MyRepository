<html>
<head>
<title>set-full-screen.ts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #67a37c; font-style: italic;}
.s2 { color: #bcbec4;}
.s3 { color: #cf8e6d;}
.s4 { color: #6aab73;}
.s5 { color: #bcbec4;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
set-full-screen.ts</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* </span><span class="s1">@description </span><span class="s0">全屏功能</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">xiaokyo</span>
 <span class="s0">*/</span>

<span class="s3">import </span><span class="s2">Editor from </span><span class="s4">'../index'</span>
<span class="s3">import </span><span class="s2">$ from </span><span class="s4">'../../utils/dom-core'</span>

<span class="s3">import </span><span class="s4">'../../assets/style/full-screen.less'</span>

<span class="s3">const </span><span class="s2">iconFullScreenText </span><span class="s5">= </span><span class="s4">'w-e-icon-fullscreen' </span><span class="s6">// 全屏icon class</span>
<span class="s3">const </span><span class="s2">iconExitFullScreenText </span><span class="s5">= </span><span class="s4">'w-e-icon-fullscreen_exit' </span><span class="s6">// 退出全屏icon class</span>
<span class="s3">const </span><span class="s2">classfullScreenEditor </span><span class="s5">= </span><span class="s4">'w-e-full-screen-editor' </span><span class="s6">// 全屏添加至编辑器的class</span>

<span class="s0">/**</span>
 <span class="s0">* 设置全屏</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">editor 编辑器实例</span>
 <span class="s0">*/</span>
<span class="s3">export const </span><span class="s2">setFullScreen </span><span class="s5">= (</span><span class="s2">editor</span><span class="s5">: </span><span class="s2">Editor</span><span class="s5">) =&gt; {</span>
    <span class="s3">const </span><span class="s2">$editorParent </span><span class="s5">= </span><span class="s2">$</span><span class="s5">(</span><span class="s2">editor</span><span class="s5">.</span><span class="s2">toolbarSelector</span><span class="s5">)</span>
    <span class="s3">const </span><span class="s2">$textContainerElem </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">$textContainerElem</span>
    <span class="s3">const </span><span class="s2">$toolbarElem </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">$toolbarElem</span>
    <span class="s3">const </span><span class="s2">$iconElem </span><span class="s5">= </span><span class="s2">$toolbarElem</span><span class="s5">.</span><span class="s2">find</span><span class="s5">(</span><span class="s4">`i.</span><span class="s2">$</span><span class="s5">{</span><span class="s2">iconFullScreenText</span><span class="s5">}</span><span class="s4">`</span><span class="s5">)</span>
    <span class="s3">const </span><span class="s2">config </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">config</span>

    <span class="s2">$iconElem</span><span class="s5">.</span><span class="s2">removeClass</span><span class="s5">(</span><span class="s2">iconFullScreenText</span><span class="s5">)</span>
    <span class="s2">$iconElem</span><span class="s5">.</span><span class="s2">addClass</span><span class="s5">(</span><span class="s2">iconExitFullScreenText</span><span class="s5">)</span>
    <span class="s2">$editorParent</span><span class="s5">.</span><span class="s2">addClass</span><span class="s5">(</span><span class="s2">classfullScreenEditor</span><span class="s5">)</span>
    <span class="s2">$editorParent</span><span class="s5">.</span><span class="s2">css</span><span class="s5">(</span><span class="s4">'z-index'</span><span class="s5">, </span><span class="s2">config</span><span class="s5">.</span><span class="s2">zIndexFullScreen</span><span class="s5">)</span>
    <span class="s3">const </span><span class="s2">bar </span><span class="s5">= </span><span class="s2">$toolbarElem</span><span class="s5">.</span><span class="s2">getBoundingClientRect</span><span class="s5">()</span>
    <span class="s2">$textContainerElem</span><span class="s5">.</span><span class="s2">css</span><span class="s5">(</span><span class="s4">'height'</span><span class="s5">, </span><span class="s4">`calc(100% - </span><span class="s2">$</span><span class="s5">{</span><span class="s2">bar</span><span class="s5">.</span><span class="s2">height</span><span class="s5">}</span><span class="s4">px)`</span><span class="s5">)</span>
<span class="s5">}</span>

<span class="s0">/**</span>
 <span class="s0">* 取消全屏</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">editor 编辑器实例</span>
 <span class="s0">*/</span>
<span class="s3">export const </span><span class="s2">setUnFullScreen </span><span class="s5">= (</span><span class="s2">editor</span><span class="s5">: </span><span class="s2">Editor</span><span class="s5">) =&gt; {</span>
    <span class="s3">const </span><span class="s2">$editorParent </span><span class="s5">= </span><span class="s2">$</span><span class="s5">(</span><span class="s2">editor</span><span class="s5">.</span><span class="s2">toolbarSelector</span><span class="s5">)</span>
    <span class="s3">const </span><span class="s2">$textContainerElem </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">$textContainerElem</span>
    <span class="s3">const </span><span class="s2">$toolbarElem </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">$toolbarElem</span>
    <span class="s3">const </span><span class="s2">$iconElem </span><span class="s5">= </span><span class="s2">$toolbarElem</span><span class="s5">.</span><span class="s2">find</span><span class="s5">(</span><span class="s4">`i.</span><span class="s2">$</span><span class="s5">{</span><span class="s2">iconExitFullScreenText</span><span class="s5">}</span><span class="s4">`</span><span class="s5">)</span>
    <span class="s3">const </span><span class="s2">config </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">config</span>

    <span class="s2">$iconElem</span><span class="s5">.</span><span class="s2">removeClass</span><span class="s5">(</span><span class="s2">iconExitFullScreenText</span><span class="s5">)</span>
    <span class="s2">$iconElem</span><span class="s5">.</span><span class="s2">addClass</span><span class="s5">(</span><span class="s2">iconFullScreenText</span><span class="s5">)</span>
    <span class="s2">$editorParent</span><span class="s5">.</span><span class="s2">removeClass</span><span class="s5">(</span><span class="s2">classfullScreenEditor</span><span class="s5">)</span>
    <span class="s2">$editorParent</span><span class="s5">.</span><span class="s2">css</span><span class="s5">(</span><span class="s4">'z-index'</span><span class="s5">, </span><span class="s4">'auto'</span><span class="s5">)</span>
    <span class="s2">$textContainerElem</span><span class="s5">.</span><span class="s2">css</span><span class="s5">(</span><span class="s4">'height'</span><span class="s5">, </span><span class="s2">config</span><span class="s5">.</span><span class="s2">height </span><span class="s5">+ </span><span class="s4">'px'</span><span class="s5">)</span>
<span class="s5">}</span>

<span class="s0">/**</span>
 <span class="s0">* 初始化全屏功能</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">editor 编辑器实例</span>
 <span class="s0">*/</span>
<span class="s3">const </span><span class="s2">initFullScreen </span><span class="s5">= (</span><span class="s2">editor</span><span class="s5">: </span><span class="s2">Editor</span><span class="s5">) =&gt; {</span>
    <span class="s6">// 当textSelector有值的时候，也就是编辑器是工具栏和编辑区域分离的情况， 则不生成全屏功能按钮</span>
    <span class="s3">if </span><span class="s5">(</span><span class="s2">editor</span><span class="s5">.</span><span class="s2">textSelector</span><span class="s5">) </span><span class="s3">return</span>
    <span class="s3">if </span><span class="s5">(!</span><span class="s2">editor</span><span class="s5">.</span><span class="s2">config</span><span class="s5">.</span><span class="s2">showFullScreen</span><span class="s5">) </span><span class="s3">return</span>
    <span class="s3">const </span><span class="s2">$toolbarElem </span><span class="s5">= </span><span class="s2">editor</span><span class="s5">.</span><span class="s2">$toolbarElem</span>
    <span class="s3">const </span><span class="s2">$elem </span><span class="s5">= </span><span class="s2">$</span><span class="s5">(</span>
        <span class="s4">`&lt;div class=&quot;w-e-menu&quot; data-title=&quot;全屏&quot;&gt; 
            &lt;i class=&quot;</span><span class="s2">$</span><span class="s5">{</span><span class="s2">iconFullScreenText</span><span class="s5">}</span><span class="s4">&quot;&gt;&lt;/i&gt; 
        &lt;/div&gt;`</span>
    <span class="s5">)</span>
    <span class="s2">$elem</span><span class="s5">.</span><span class="s2">on</span><span class="s5">(</span><span class="s4">'click'</span><span class="s5">, </span><span class="s3">function </span><span class="s5">(</span><span class="s2">e</span><span class="s5">: </span><span class="s2">MouseEvent</span><span class="s5">) {</span>
        <span class="s3">const </span><span class="s2">$elemIcon </span><span class="s5">= </span><span class="s2">$</span><span class="s5">(</span><span class="s2">e</span><span class="s5">.</span><span class="s2">currentTarget</span><span class="s5">).</span><span class="s2">find</span><span class="s5">(</span><span class="s4">'i'</span><span class="s5">)</span>
        <span class="s3">if </span><span class="s5">(</span><span class="s2">$elemIcon</span><span class="s5">.</span><span class="s2">hasClass</span><span class="s5">(</span><span class="s2">iconFullScreenText</span><span class="s5">)) {</span>
            <span class="s2">$elem</span><span class="s5">.</span><span class="s2">attr</span><span class="s5">(</span><span class="s4">'data-title'</span><span class="s5">, </span><span class="s4">'取消全屏'</span><span class="s5">)</span>
            <span class="s2">setFullScreen</span><span class="s5">(</span><span class="s2">editor</span><span class="s5">)</span>
        <span class="s5">} </span><span class="s3">else </span><span class="s5">{</span>
            <span class="s2">$elem</span><span class="s5">.</span><span class="s2">attr</span><span class="s5">(</span><span class="s4">'data-title'</span><span class="s5">, </span><span class="s4">'全屏'</span><span class="s5">)</span>
            <span class="s2">setUnFullScreen</span><span class="s5">(</span><span class="s2">editor</span><span class="s5">)</span>
        <span class="s5">}</span>
    <span class="s5">})</span>

    <span class="s2">$toolbarElem</span><span class="s5">.</span><span class="s2">append</span><span class="s5">(</span><span class="s2">$elem</span><span class="s5">)</span>
<span class="s5">}</span>

<span class="s3">export default </span><span class="s2">initFullScreen</span>
</pre>
</body>
</html>