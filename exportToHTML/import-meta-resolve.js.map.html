<html>
<head>
<title>import-meta-resolve.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
import-meta-resolve.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_assert&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;_fs&quot;</span><span class="s0">,</span><span class="s1">&quot;_interopRequireWildcard&quot;</span><span class="s0">,</span><span class="s1">&quot;_process&quot;</span><span class="s0">,</span><span class="s1">&quot;_url&quot;</span><span class="s0">,</span><span class="s1">&quot;_path&quot;</span><span class="s0">,</span><span class="s1">&quot;_module&quot;</span><span class="s0">,</span><span class="s1">&quot;_v&quot;</span><span class="s0">,</span><span class="s1">&quot;_util&quot;</span><span class="s0">,</span><span class="s1">&quot;_getRequireWildcardCache&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeInterop&quot;</span><span class="s0">,</span><span class="s1">&quot;WeakMap&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheBabelInterop&quot;</span><span class="s0">,</span><span class="s1">&quot;cacheNodeInterop&quot;</span><span class="s0">,</span><span class="s1">&quot;obj&quot;</span><span class="s0">,</span><span class="s1">&quot;__esModule&quot;</span><span class="s0">,</span><span class="s1">&quot;default&quot;</span><span class="s0">,</span><span class="s1">&quot;cache&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;newObj&quot;</span><span class="s0">,</span><span class="s1">&quot;hasPropertyDescriptor&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;getOwnPropertyDescriptor&quot;</span><span class="s0">,</span><span class="s1">&quot;key&quot;</span><span class="s0">,</span><span class="s1">&quot;prototype&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOwnProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;call&quot;</span><span class="s0">,</span><span class="s1">&quot;desc&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;isWindows&quot;</span><span class="s0">,</span><span class="s1">&quot;process&quot;</span><span class="s0">,</span><span class="s1">&quot;platform&quot;</span><span class="s0">,</span><span class="s1">&quot;own$1&quot;</span><span class="s0">,</span><span class="s1">&quot;classRegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;kTypes&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;codes&quot;</span><span class="s0">,</span><span class="s1">&quot;formatList&quot;</span><span class="s0">,</span><span class="s1">&quot;array&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;slice&quot;</span><span class="s0">,</span><span class="s1">&quot;messages&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;nodeInternalPrefix&quot;</span><span class="s0">,</span><span class="s1">&quot;userStackTraceLimit&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_ARG_TYPE&quot;</span><span class="s0">,</span><span class="s1">&quot;createError&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;expected&quot;</span><span class="s0">,</span><span class="s1">&quot;actual&quot;</span><span class="s0">,</span><span class="s1">&quot;assert&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;endsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;includes&quot;</span><span class="s0">,</span><span class="s1">&quot;types&quot;</span><span class="s0">,</span><span class="s1">&quot;instances&quot;</span><span class="s0">,</span><span class="s1">&quot;other&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;toLowerCase&quot;</span><span class="s0">,</span><span class="s1">&quot;exec&quot;</span><span class="s0">,</span><span class="s1">&quot;pos&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;determineSpecificType&quot;</span><span class="s0">,</span><span class="s1">&quot;TypeError&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_MODULE_SPECIFIER&quot;</span><span class="s0">,</span><span class="s1">&quot;request&quot;</span><span class="s0">,</span><span class="s1">&quot;reason&quot;</span><span class="s0">,</span><span class="s1">&quot;base&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_PACKAGE_CONFIG&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_PACKAGE_TARGET&quot;</span><span class="s0">,</span><span class="s1">&quot;pkgPath&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;isImport&quot;</span><span class="s0">,</span><span class="s1">&quot;relError&quot;</span><span class="s0">,</span><span class="s1">&quot;startsWith&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_MODULE_NOT_FOUND&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_NETWORK_IMPORT_DISALLOWED&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_PACKAGE_IMPORT_NOT_DEFINED&quot;</span><span class="s0">,</span><span class="s1">&quot;specifier&quot;</span><span class="s0">,</span><span class="s1">&quot;packagePath&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_PACKAGE_PATH_NOT_EXPORTED&quot;</span><span class="s0">,</span><span class="s1">&quot;subpath&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_UNSUPPORTED_DIR_IMPORT&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_UNKNOWN_FILE_EXTENSION&quot;</span><span class="s0">,</span><span class="s1">&quot;ext&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_ARG_VALUE&quot;</span><span class="s0">,</span><span class="s1">&quot;inspected&quot;</span><span class="s0">,</span><span class="s1">&quot;inspect&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_UNSUPPORTED_ESM_URL_SCHEME&quot;</span><span class="s0">,</span><span class="s1">&quot;url&quot;</span><span class="s0">,</span><span class="s1">&quot;supported&quot;</span><span class="s0">,</span><span class="s1">&quot;protocol&quot;</span><span class="s0">,</span><span class="s1">&quot;sym&quot;</span><span class="s0">,</span><span class="s1">&quot;def&quot;</span><span class="s0">,</span><span class="s1">&quot;makeNodeErrorWithCode&quot;</span><span class="s0">,</span><span class="s1">&quot;Base&quot;</span><span class="s0">,</span><span class="s1">&quot;NodeError&quot;</span><span class="s0">,</span><span class="s1">&quot;args&quot;</span><span class="s0">,</span><span class="s1">&quot;limit&quot;</span><span class="s0">,</span><span class="s1">&quot;stackTraceLimit&quot;</span><span class="s0">,</span><span class="s1">&quot;isErrorStackTraceLimitWritable&quot;</span><span class="s0">,</span><span class="s1">&quot;error&quot;</span><span class="s0">,</span><span class="s1">&quot;getMessage&quot;</span><span class="s0">,</span><span class="s1">&quot;defineProperties&quot;</span><span class="s0">,</span><span class="s1">&quot;enumerable&quot;</span><span class="s0">,</span><span class="s1">&quot;writable&quot;</span><span class="s0">,</span><span class="s1">&quot;configurable&quot;</span><span class="s0">,</span><span class="s1">&quot;toString&quot;</span><span class="s0">,</span><span class="s1">&quot;captureLargerStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;code&quot;</span><span class="s0">,</span><span class="s1">&quot;v8&quot;</span><span class="s0">,</span><span class="s1">&quot;startupSnapshot&quot;</span><span class="s0">,</span><span class="s1">&quot;isBuildingSnapshot&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused&quot;</span><span class="s0">,</span><span class="s1">&quot;isExtensible&quot;</span><span class="s0">,</span><span class="s1">&quot;hideStackFrames&quot;</span><span class="s0">,</span><span class="s1">&quot;fn&quot;</span><span class="s0">,</span><span class="s1">&quot;hidden&quot;</span><span class="s0">,</span><span class="s1">&quot;stackTraceLimitIsWritable&quot;</span><span class="s0">,</span><span class="s1">&quot;Number&quot;</span><span class="s0">,</span><span class="s1">&quot;POSITIVE_INFINITY&quot;</span><span class="s0">,</span><span class="s1">&quot;captureStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;self&quot;</span><span class="s0">,</span><span class="s1">&quot;Reflect&quot;</span><span class="s0">,</span><span class="s1">&quot;apply&quot;</span><span class="s0">,</span><span class="s1">&quot;regex&quot;</span><span class="s0">,</span><span class="s1">&quot;expectedLength&quot;</span><span class="s0">,</span><span class="s1">&quot;unshift&quot;</span><span class="s0">,</span><span class="s1">&quot;format&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;constructor&quot;</span><span class="s0">,</span><span class="s1">&quot;depth&quot;</span><span class="s0">,</span><span class="s1">&quot;colors&quot;</span><span class="s0">,</span><span class="s1">&quot;reader&quot;</span><span class="s0">,</span><span class="s1">&quot;read&quot;</span><span class="s0">,</span><span class="s1">&quot;packageJsonReader&quot;</span><span class="s0">,</span><span class="s1">&quot;jsonPath&quot;</span><span class="s0">,</span><span class="s1">&quot;string&quot;</span><span class="s0">,</span><span class="s1">&quot;fs&quot;</span><span class="s0">,</span><span class="s1">&quot;readFileSync&quot;</span><span class="s0">,</span><span class="s1">&quot;toNamespacedPath&quot;</span><span class="s0">,</span><span class="s1">&quot;dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;exception&quot;</span><span class="s0">,</span><span class="s1">&quot;ERR_INVALID_PACKAGE_CONFIG$1&quot;</span><span class="s0">,</span><span class="s1">&quot;packageJsonCache&quot;</span><span class="s0">,</span><span class="s1">&quot;getPackageConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;packageConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;pjsonPath&quot;</span><span class="s0">,</span><span class="s1">&quot;exists&quot;</span><span class="s0">,</span><span class="s1">&quot;main&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;imports&quot;</span><span class="s0">,</span><span class="s1">&quot;packageJson&quot;</span><span class="s0">,</span><span class="s1">&quot;parse&quot;</span><span class="s0">,</span><span class="s1">&quot;fileURLToPath&quot;</span><span class="s0">,</span><span class="s1">&quot;getPackageScopeConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;resolved&quot;</span><span class="s0">,</span><span class="s1">&quot;packageJsonUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;URL&quot;</span><span class="s0">,</span><span class="s1">&quot;packageJsonPath&quot;</span><span class="s0">,</span><span class="s1">&quot;pathname&quot;</span><span class="s0">,</span><span class="s1">&quot;lastPackageJsonUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;getPackageType&quot;</span><span class="s0">,</span><span class="s1">&quot;extensionFormatMap&quot;</span><span class="s0">,</span><span class="s1">&quot;__proto__&quot;</span><span class="s0">,</span><span class="s1">&quot;mimeToFormat&quot;</span><span class="s0">,</span><span class="s1">&quot;mime&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;protocolHandlers&quot;</span><span class="s0">,</span><span class="s1">&quot;getDataProtocolModuleFormat&quot;</span><span class="s0">,</span><span class="s1">&quot;getFileProtocolModuleFormat&quot;</span><span class="s0">,</span><span class="s1">&quot;getHttpProtocolModuleFormat&quot;</span><span class="s0">,</span><span class="s1">&quot;node:&quot;</span><span class="s0">,</span><span class="s1">&quot;parsed&quot;</span><span class="s0">,</span><span class="s1">&quot;extname&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;codePointAt&quot;</span><span class="s0">,</span><span class="s1">&quot;_context&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;filepath&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultGetFormatWithoutErrors&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_CONDITIONS&quot;</span><span class="s0">,</span><span class="s1">&quot;freeze&quot;</span><span class="s0">,</span><span class="s1">&quot;DEFAULT_CONDITIONS_SET&quot;</span><span class="s0">,</span><span class="s1">&quot;getDefaultConditions&quot;</span><span class="s0">,</span><span class="s1">&quot;getDefaultConditionsSet&quot;</span><span class="s0">,</span><span class="s1">&quot;getConditionsSet&quot;</span><span class="s0">,</span><span class="s1">&quot;conditions&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExpPrototypeSymbolReplace&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;Symbol&quot;</span><span class="s0">,</span><span class="s1">&quot;replace&quot;</span><span class="s0">,</span><span class="s1">&quot;experimentalNetworkImports&quot;</span><span class="s0">,</span><span class="s1">&quot;own&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidSegmentRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;deprecatedInvalidSegmentRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidPackageNameRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;patternRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;encodedSepRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;emittedPackageWarnings&quot;</span><span class="s0">,</span><span class="s1">&quot;doubleSlashRegEx&quot;</span><span class="s0">,</span><span class="s1">&quot;emitInvalidSegmentDeprecation&quot;</span><span class="s0">,</span><span class="s1">&quot;match&quot;</span><span class="s0">,</span><span class="s1">&quot;internal&quot;</span><span class="s0">,</span><span class="s1">&quot;isTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;double&quot;</span><span class="s0">,</span><span class="s1">&quot;emitWarning&quot;</span><span class="s0">,</span><span class="s1">&quot;emitLegacyIndexDeprecation&quot;</span><span class="s0">,</span><span class="s1">&quot;parentURL&quot;</span><span class="s0">,</span><span class="s1">&quot;href&quot;</span><span class="s0">,</span><span class="s1">&quot;basePath&quot;</span><span class="s0">,</span><span class="s1">&quot;tryStatSync&quot;</span><span class="s0">,</span><span class="s1">&quot;statSync&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused2&quot;</span><span class="s0">,</span><span class="s1">&quot;Stats&quot;</span><span class="s0">,</span><span class="s1">&quot;fileExists&quot;</span><span class="s0">,</span><span class="s1">&quot;stats&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfNoEntry&quot;</span><span class="s0">,</span><span class="s1">&quot;isFile&quot;</span><span class="s0">,</span><span class="s1">&quot;legacyMainResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;guess&quot;</span><span class="s0">,</span><span class="s1">&quot;tries&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;finalizeResolution&quot;</span><span class="s0">,</span><span class="s1">&quot;preserveSymlinks&quot;</span><span class="s0">,</span><span class="s1">&quot;filePath&quot;</span><span class="s0">,</span><span class="s1">&quot;isDirectory&quot;</span><span class="s0">,</span><span class="s1">&quot;real&quot;</span><span class="s0">,</span><span class="s1">&quot;realpathSync&quot;</span><span class="s0">,</span><span class="s1">&quot;search&quot;</span><span class="s0">,</span><span class="s1">&quot;hash&quot;</span><span class="s0">,</span><span class="s1">&quot;pathToFileURL&quot;</span><span class="s0">,</span><span class="s1">&quot;sep&quot;</span><span class="s0">,</span><span class="s1">&quot;importNotDefined&quot;</span><span class="s0">,</span><span class="s1">&quot;exportsNotFound&quot;</span><span class="s0">,</span><span class="s1">&quot;throwInvalidSubpath&quot;</span><span class="s0">,</span><span class="s1">&quot;invalidPackageTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvePackageTargetString&quot;</span><span class="s0">,</span><span class="s1">&quot;pattern&quot;</span><span class="s0">,</span><span class="s1">&quot;isPathMap&quot;</span><span class="s0">,</span><span class="s1">&quot;isURL&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused3&quot;</span><span class="s0">,</span><span class="s1">&quot;exportTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;packageResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvedPath&quot;</span><span class="s0">,</span><span class="s1">&quot;isArrayIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;keyNumber&quot;</span><span class="s0">,</span><span class="s1">&quot;resolvePackageTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;packageSubpath&quot;</span><span class="s0">,</span><span class="s1">&quot;targetList&quot;</span><span class="s0">,</span><span class="s1">&quot;lastException&quot;</span><span class="s0">,</span><span class="s1">&quot;targetItem&quot;</span><span class="s0">,</span><span class="s1">&quot;resolveResult&quot;</span><span class="s0">,</span><span class="s1">&quot;keys&quot;</span><span class="s0">,</span><span class="s1">&quot;getOwnPropertyNames&quot;</span><span class="s0">,</span><span class="s1">&quot;conditionalTarget&quot;</span><span class="s0">,</span><span class="s1">&quot;isConditionalExportsMainSugar&quot;</span><span class="s0">,</span><span class="s1">&quot;isConditionalSugar&quot;</span><span class="s0">,</span><span class="s1">&quot;j&quot;</span><span class="s0">,</span><span class="s1">&quot;curIsConditionalSugar&quot;</span><span class="s0">,</span><span class="s1">&quot;emitTrailingSlashPatternDeprecation&quot;</span><span class="s0">,</span><span class="s1">&quot;pjsonUrl&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;packageExportsResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;bestMatch&quot;</span><span class="s0">,</span><span class="s1">&quot;bestMatchSubpath&quot;</span><span class="s0">,</span><span class="s1">&quot;patternIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;patternTrailer&quot;</span><span class="s0">,</span><span class="s1">&quot;patternKeyCompare&quot;</span><span class="s0">,</span><span class="s1">&quot;lastIndexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;a&quot;</span><span class="s0">,</span><span class="s1">&quot;b&quot;</span><span class="s0">,</span><span class="s1">&quot;aPatternIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;bPatternIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;baseLengthA&quot;</span><span class="s0">,</span><span class="s1">&quot;baseLengthB&quot;</span><span class="s0">,</span><span class="s1">&quot;packageImportsResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;parsePackageName&quot;</span><span class="s0">,</span><span class="s1">&quot;separatorIndex&quot;</span><span class="s0">,</span><span class="s1">&quot;validPackageName&quot;</span><span class="s0">,</span><span class="s1">&quot;isScoped&quot;</span><span class="s0">,</span><span class="s1">&quot;packageName&quot;</span><span class="s0">,</span><span class="s1">&quot;builtinModules&quot;</span><span class="s0">,</span><span class="s1">&quot;lastPath&quot;</span><span class="s0">,</span><span class="s1">&quot;stat&quot;</span><span class="s0">,</span><span class="s1">&quot;isRelativeSpecifier&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldBeTreatedAsRelativeOrAbsolutePath&quot;</span><span class="s0">,</span><span class="s1">&quot;moduleResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;isRemote&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused4&quot;</span><span class="s0">,</span><span class="s1">&quot;checkIfDisallowedImport&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedParentURL&quot;</span><span class="s0">,</span><span class="s1">&quot;parentProtocol&quot;</span><span class="s0">,</span><span class="s1">&quot;parsedProtocol&quot;</span><span class="s0">,</span><span class="s1">&quot;Boolean&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfInvalidParentURL&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfUnsupportedURLProtocol&quot;</span><span class="s0">,</span><span class="s1">&quot;throwIfUnsupportedURLScheme&quot;</span><span class="s0">,</span><span class="s1">&quot;concat&quot;</span><span class="s0">,</span><span class="s1">&quot;defaultResolve&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused5&quot;</span><span class="s0">,</span><span class="s1">&quot;_unused6&quot;</span><span class="s0">,</span><span class="s1">&quot;maybeReturn&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;parent&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/vendor/import-meta-resolve.js&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;</span><span class="s3">\n</span><span class="s1">/****************************************************************************</span><span class="s3">\\\n </span><span class="s1">*                         NOTE FROM BABEL AUTHORS                          *</span><span class="s3">\n </span><span class="s1">* This file is inlined from https://github.com/wooorm/import-meta-resolve, *</span><span class="s3">\n </span><span class="s1">* because we need to compile it to CommonJS.                               *</span><span class="s3">\n\\</span><span class="s1">****************************************************************************/</span><span class="s3">\n\n</span><span class="s1">/*</span><span class="s3">\n</span><span class="s1">(The MIT License)</span><span class="s3">\n\n</span><span class="s1">Copyright (c) 2021 Titus Wormer &lt;mailto:tituswormer@gmail.com&gt;</span><span class="s3">\n\n</span><span class="s1">Permission is hereby granted, free of charge, to any person obtaining</span><span class="s3">\n</span><span class="s1">a copy of this software and associated documentation files (the</span><span class="s3">\n</span><span class="s1">'Software'), to deal in the Software without restriction, including</span><span class="s3">\n</span><span class="s1">without limitation the rights to use, copy, modify, merge, publish,</span><span class="s3">\n</span><span class="s1">distribute, sublicense, and/or sell copies of the Software, and to</span><span class="s3">\n</span><span class="s1">permit persons to whom the Software is furnished to do so, subject to</span><span class="s3">\n</span><span class="s1">the following conditions:</span><span class="s3">\n\n</span><span class="s1">The above copyright notice and this permission notice shall be</span><span class="s3">\n</span><span class="s1">included in all copies or substantial portions of the Software.</span><span class="s3">\n\n</span><span class="s1">THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,</span><span class="s3">\n</span><span class="s1">EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span><span class="s3">\n</span><span class="s1">MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</span><span class="s3">\n</span><span class="s1">IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY</span><span class="s3">\n</span><span class="s1">CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,</span><span class="s3">\n</span><span class="s1">TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE</span><span class="s3">\n</span><span class="s1">SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span><span class="s3">\n\n</span><span class="s1">---</span><span class="s3">\n\n</span><span class="s1">This is a derivative work based on:</span><span class="s3">\n</span><span class="s1">&lt;https://github.com/nodejs/node&gt;.</span><span class="s3">\n</span><span class="s1">Which is licensed:</span><span class="s3">\n\n\&quot;\&quot;\&quot;\n</span><span class="s1">Copyright Node.js contributors. All rights reserved.</span><span class="s3">\n\n</span><span class="s1">Permission is hereby granted, free of charge, to any person obtaining a copy</span><span class="s3">\n</span><span class="s1">of this software and associated documentation files (the </span><span class="s3">\&quot;</span><span class="s1">Software</span><span class="s3">\&quot;</span><span class="s1">), to</span><span class="s3">\n</span><span class="s1">deal in the Software without restriction, including without limitation the</span><span class="s3">\n</span><span class="s1">rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span><span class="s3">\n</span><span class="s1">sell copies of the Software, and to permit persons to whom the Software is</span><span class="s3">\n</span><span class="s1">furnished to do so, subject to the following conditions:</span><span class="s3">\n\n</span><span class="s1">The above copyright notice and this permission notice shall be included in</span><span class="s3">\n</span><span class="s1">all copies or substantial portions of the Software.</span><span class="s3">\n\n</span><span class="s1">THE SOFTWARE IS PROVIDED </span><span class="s3">\&quot;</span><span class="s1">AS IS</span><span class="s3">\&quot;</span><span class="s1">, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><span class="s3">\n</span><span class="s1">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><span class="s3">\n</span><span class="s1">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><span class="s3">\n</span><span class="s1">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><span class="s3">\n</span><span class="s1">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span><span class="s3">\n</span><span class="s1">FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span><span class="s3">\n</span><span class="s1">IN THE SOFTWARE.</span><span class="s3">\n\&quot;\&quot;\&quot;\n\n</span><span class="s1">This license applies to parts of Node.js originating from the</span><span class="s3">\n</span><span class="s1">https://github.com/joyent/node repository:</span><span class="s3">\n\n\&quot;\&quot;\&quot;\n</span><span class="s1">Copyright Joyent, Inc. and other Node contributors. All rights reserved.</span><span class="s3">\n</span><span class="s1">Permission is hereby granted, free of charge, to any person obtaining a copy</span><span class="s3">\n</span><span class="s1">of this software and associated documentation files (the </span><span class="s3">\&quot;</span><span class="s1">Software</span><span class="s3">\&quot;</span><span class="s1">), to</span><span class="s3">\n</span><span class="s1">deal in the Software without restriction, including without limitation the</span><span class="s3">\n</span><span class="s1">rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span><span class="s3">\n</span><span class="s1">sell copies of the Software, and to permit persons to whom the Software is</span><span class="s3">\n</span><span class="s1">furnished to do so, subject to the following conditions:</span><span class="s3">\n\n</span><span class="s1">The above copyright notice and this permission notice shall be included in</span><span class="s3">\n</span><span class="s1">all copies or substantial portions of the Software.</span><span class="s3">\n\n</span><span class="s1">THE SOFTWARE IS PROVIDED </span><span class="s3">\&quot;</span><span class="s1">AS IS</span><span class="s3">\&quot;</span><span class="s1">, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><span class="s3">\n</span><span class="s1">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><span class="s3">\n</span><span class="s1">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><span class="s3">\n</span><span class="s1">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><span class="s3">\n</span><span class="s1">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span><span class="s3">\n</span><span class="s1">FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span><span class="s3">\n</span><span class="s1">IN THE SOFTWARE.</span><span class="s3">\n\&quot;\&quot;\&quot;\n</span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">import assert from 'assert';</span><span class="s3">\n</span><span class="s1">import fs, { realpathSync, statSync, Stats } from 'fs';</span><span class="s3">\n</span><span class="s1">import process from 'process';</span><span class="s3">\n</span><span class="s1">import { fileURLToPath, URL, pathToFileURL } from 'url';</span><span class="s3">\n</span><span class="s1">import path from 'path';</span><span class="s3">\n</span><span class="s1">import { builtinModules } from 'module';</span><span class="s3">\n</span><span class="s1">import v8 from 'v8';</span><span class="s3">\n</span><span class="s1">import { format, inspect } from 'util';</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @typedef ErrnoExceptionFields</span><span class="s3">\n </span><span class="s1">* @property {number | undefined} [errnode]</span><span class="s3">\n </span><span class="s1">* @property {string | undefined} [code]</span><span class="s3">\n </span><span class="s1">* @property {string | undefined} [path]</span><span class="s3">\n </span><span class="s1">* @property {string | undefined} [syscall]</span><span class="s3">\n </span><span class="s1">* @property {string | undefined} [url]</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @typedef {Error &amp; ErrnoExceptionFields} ErrnoException</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n\n</span><span class="s1">const isWindows = process.platform === 'win32';</span><span class="s3">\n\n</span><span class="s1">const own$1 = {}.hasOwnProperty;</span><span class="s3">\n\n</span><span class="s1">const classRegExp = /^([A-Z][a-z</span><span class="s3">\\</span><span class="s1">d]*)+$/;</span><span class="s3">\n</span><span class="s1">// Sorted by a rough estimate on most frequently used entries.</span><span class="s3">\n</span><span class="s1">const kTypes = new Set([</span><span class="s3">\n  </span><span class="s1">'string',</span><span class="s3">\n  </span><span class="s1">'function',</span><span class="s3">\n  </span><span class="s1">'number',</span><span class="s3">\n  </span><span class="s1">'object',</span><span class="s3">\n  </span><span class="s1">// Accept 'Function' and 'Object' as alternative to the lower cased version.</span><span class="s3">\n  </span><span class="s1">'Function',</span><span class="s3">\n  </span><span class="s1">'Object',</span><span class="s3">\n  </span><span class="s1">'boolean',</span><span class="s3">\n  </span><span class="s1">'bigint',</span><span class="s3">\n  </span><span class="s1">'symbol'</span><span class="s3">\n</span><span class="s1">]);</span><span class="s3">\n\n</span><span class="s1">const codes = {};</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Create a list string in the form like 'A and B' or 'A, B, ..., and Z'.</span><span class="s3">\n </span><span class="s1">* We cannot use Intl.ListFormat because it's not available in</span><span class="s3">\n </span><span class="s1">* --without-intl builds.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {Array&lt;string&gt;} array</span><span class="s3">\n </span><span class="s1">*   An array of strings.</span><span class="s3">\n </span><span class="s1">* @param {string} [type]</span><span class="s3">\n </span><span class="s1">*   The list type to be inserted before the last element.</span><span class="s3">\n </span><span class="s1">* @returns {string}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function formatList(array, type = 'and') {</span><span class="s3">\n  </span><span class="s1">return array.length &lt; 3</span><span class="s3">\n    </span><span class="s1">? array.join(` ${type} `)</span><span class="s3">\n    </span><span class="s1">: `${array.slice(0, -1).join(', ')}, ${type} ${array[array.length - 1]}`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/** @type {Map&lt;string, MessageFunction | string&gt;} */</span><span class="s3">\n</span><span class="s1">const messages = new Map();</span><span class="s3">\n</span><span class="s1">const nodeInternalPrefix = '__node_internal_';</span><span class="s3">\n</span><span class="s1">/** @type {number} */</span><span class="s3">\n</span><span class="s1">let userStackTraceLimit;</span><span class="s3">\n\n</span><span class="s1">codes.ERR_INVALID_ARG_TYPE = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_INVALID_ARG_TYPE',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} name</span><span class="s3">\n   </span><span class="s1">* @param {Array&lt;string&gt; | string} expected</span><span class="s3">\n   </span><span class="s1">* @param {unknown} actual</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(name, expected, actual) =&gt; {</span><span class="s3">\n    </span><span class="s1">assert(typeof name === 'string', </span><span class="s3">\&quot;</span><span class="s1">'name' must be a string</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (!Array.isArray(expected)) {</span><span class="s3">\n      </span><span class="s1">expected = [expected];</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">let message = 'The ';</span><span class="s3">\n    </span><span class="s1">if (name.endsWith(' argument')) {</span><span class="s3">\n      </span><span class="s1">// For cases like 'first argument'</span><span class="s3">\n      </span><span class="s1">message += `${name} `;</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">const type = name.includes('.') ? 'property' : 'argument';</span><span class="s3">\n      </span><span class="s1">message += `</span><span class="s3">\&quot;</span><span class="s1">${name}</span><span class="s3">\&quot; </span><span class="s1">${type} `;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">message += 'must be ';</span><span class="s3">\n\n    </span><span class="s1">/** @type {Array&lt;string&gt;} */</span><span class="s3">\n    </span><span class="s1">const types = [];</span><span class="s3">\n    </span><span class="s1">/** @type {Array&lt;string&gt;} */</span><span class="s3">\n    </span><span class="s1">const instances = [];</span><span class="s3">\n    </span><span class="s1">/** @type {Array&lt;string&gt;} */</span><span class="s3">\n    </span><span class="s1">const other = [];</span><span class="s3">\n\n    </span><span class="s1">for (const value of expected) {</span><span class="s3">\n      </span><span class="s1">assert(</span><span class="s3">\n        </span><span class="s1">typeof value === 'string',</span><span class="s3">\n        </span><span class="s1">'All expected entries have to be of type string'</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n\n      </span><span class="s1">if (kTypes.has(value)) {</span><span class="s3">\n        </span><span class="s1">types.push(value.toLowerCase());</span><span class="s3">\n      </span><span class="s1">} else if (classRegExp.exec(value) === null) {</span><span class="s3">\n        </span><span class="s1">assert(</span><span class="s3">\n          </span><span class="s1">value !== 'object',</span><span class="s3">\n          </span><span class="s1">'The value </span><span class="s3">\&quot;</span><span class="s1">object</span><span class="s3">\&quot; </span><span class="s1">should be written as </span><span class="s3">\&quot;</span><span class="s1">Object</span><span class="s3">\&quot;</span><span class="s1">'</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">other.push(value);</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">instances.push(value);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Special handle `object` in case other instances are allowed to outline</span><span class="s3">\n    </span><span class="s1">// the differences between each other.</span><span class="s3">\n    </span><span class="s1">if (instances.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">const pos = types.indexOf('object');</span><span class="s3">\n      </span><span class="s1">if (pos !== -1) {</span><span class="s3">\n        </span><span class="s1">types.slice(pos, 1);</span><span class="s3">\n        </span><span class="s1">instances.push('Object');</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (types.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">message += `${types.length &gt; 1 ? 'one of type' : 'of type'} ${formatList(</span><span class="s3">\n        </span><span class="s1">types,</span><span class="s3">\n        </span><span class="s1">'or'</span><span class="s3">\n      </span><span class="s1">)}`;</span><span class="s3">\n      </span><span class="s1">if (instances.length &gt; 0 || other.length &gt; 0) message += ' or ';</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (instances.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">message += `an instance of ${formatList(instances, 'or')}`;</span><span class="s3">\n      </span><span class="s1">if (other.length &gt; 0) message += ' or ';</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (other.length &gt; 0) {</span><span class="s3">\n      </span><span class="s1">if (other.length &gt; 1) {</span><span class="s3">\n        </span><span class="s1">message += `one of ${formatList(other, 'or')}`;</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">if (other[0].toLowerCase() !== other[0]) message += 'an ';</span><span class="s3">\n        </span><span class="s1">message += `${other[0]}`;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">message += `. Received ${determineSpecificType(actual)}`;</span><span class="s3">\n\n    </span><span class="s1">return message</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">TypeError</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_INVALID_MODULE_SPECIFIER = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_INVALID_MODULE_SPECIFIER',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} request</span><span class="s3">\n   </span><span class="s1">* @param {string} reason</span><span class="s3">\n   </span><span class="s1">* @param {string} [base]</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(request, reason, base = undefined) =&gt; {</span><span class="s3">\n    </span><span class="s1">return `Invalid module </span><span class="s3">\&quot;</span><span class="s1">${request}</span><span class="s3">\&quot; </span><span class="s1">${reason}${</span><span class="s3">\n      </span><span class="s1">base ? ` imported from ${base}` : ''</span><span class="s3">\n    </span><span class="s1">}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">TypeError</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_INVALID_PACKAGE_CONFIG = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_INVALID_PACKAGE_CONFIG',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} path</span><span class="s3">\n   </span><span class="s1">* @param {string} [base]</span><span class="s3">\n   </span><span class="s1">* @param {string} [message]</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(path, base, message) =&gt; {</span><span class="s3">\n    </span><span class="s1">return `Invalid package config ${path}${</span><span class="s3">\n      </span><span class="s1">base ? ` while importing ${base}` : ''</span><span class="s3">\n    </span><span class="s1">}${message ? `. ${message}` : ''}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_INVALID_PACKAGE_TARGET = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_INVALID_PACKAGE_TARGET',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} pkgPath</span><span class="s3">\n   </span><span class="s1">* @param {string} key</span><span class="s3">\n   </span><span class="s1">* @param {unknown} target</span><span class="s3">\n   </span><span class="s1">* @param {boolean} [isImport=false]</span><span class="s3">\n   </span><span class="s1">* @param {string} [base]</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(pkgPath, key, target, isImport = false, base = undefined) =&gt; {</span><span class="s3">\n    </span><span class="s1">const relError =</span><span class="s3">\n      </span><span class="s1">typeof target === 'string' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!isImport &amp;&amp;</span><span class="s3">\n      </span><span class="s1">target.length &gt; 0 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">!target.startsWith('./');</span><span class="s3">\n    </span><span class="s1">if (key === '.') {</span><span class="s3">\n      </span><span class="s1">assert(isImport === false);</span><span class="s3">\n      </span><span class="s1">return (</span><span class="s3">\n        </span><span class="s1">`Invalid </span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">main target ${JSON.stringify(target)} defined ` +</span><span class="s3">\n        </span><span class="s1">`in the package config ${pkgPath}package.json${</span><span class="s3">\n          </span><span class="s1">base ? ` imported from ${base}` : ''</span><span class="s3">\n        </span><span class="s1">}${relError ? '; targets must start with </span><span class="s3">\&quot;</span><span class="s1">./</span><span class="s3">\&quot;</span><span class="s1">' : ''}`</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return `Invalid </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n      </span><span class="s1">isImport ? 'imports' : 'exports'</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">target ${JSON.stringify(</span><span class="s3">\n      </span><span class="s1">target</span><span class="s3">\n    </span><span class="s1">)} defined for '${key}' in the package config ${pkgPath}package.json${</span><span class="s3">\n      </span><span class="s1">base ? ` imported from ${base}` : ''</span><span class="s3">\n    </span><span class="s1">}${relError ? '; targets must start with </span><span class="s3">\&quot;</span><span class="s1">./</span><span class="s3">\&quot;</span><span class="s1">' : ''}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_MODULE_NOT_FOUND = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_MODULE_NOT_FOUND',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} path</span><span class="s3">\n   </span><span class="s1">* @param {string} base</span><span class="s3">\n   </span><span class="s1">* @param {string} [type]</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(path, base, type = 'package') =&gt; {</span><span class="s3">\n    </span><span class="s1">return `Cannot find ${type} '${path}' imported from ${base}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_NETWORK_IMPORT_DISALLOWED = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_NETWORK_IMPORT_DISALLOWED',</span><span class="s3">\n  \&quot;</span><span class="s1">import of '%s' by %s is not supported: %s</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_PACKAGE_IMPORT_NOT_DEFINED = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_PACKAGE_IMPORT_NOT_DEFINED',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} specifier</span><span class="s3">\n   </span><span class="s1">* @param {string} packagePath</span><span class="s3">\n   </span><span class="s1">* @param {string} base</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(specifier, packagePath, base) =&gt; {</span><span class="s3">\n    </span><span class="s1">return `Package import specifier </span><span class="s3">\&quot;</span><span class="s1">${specifier}</span><span class="s3">\&quot; </span><span class="s1">is not defined${</span><span class="s3">\n      </span><span class="s1">packagePath ? ` in package ${packagePath}package.json` : ''</span><span class="s3">\n    </span><span class="s1">} imported from ${base}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">TypeError</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_PACKAGE_PATH_NOT_EXPORTED = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_PACKAGE_PATH_NOT_EXPORTED',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} pkgPath</span><span class="s3">\n   </span><span class="s1">* @param {string} subpath</span><span class="s3">\n   </span><span class="s1">* @param {string} [base]</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(pkgPath, subpath, base = undefined) =&gt; {</span><span class="s3">\n    </span><span class="s1">if (subpath === '.')</span><span class="s3">\n      </span><span class="s1">return `No </span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">main defined in ${pkgPath}package.json${</span><span class="s3">\n        </span><span class="s1">base ? ` imported from ${base}` : ''</span><span class="s3">\n      </span><span class="s1">}`</span><span class="s3">\n    </span><span class="s1">return `Package subpath '${subpath}' is not defined by </span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">in ${pkgPath}package.json${</span><span class="s3">\n      </span><span class="s1">base ? ` imported from ${base}` : ''</span><span class="s3">\n    </span><span class="s1">}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_UNSUPPORTED_DIR_IMPORT = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_UNSUPPORTED_DIR_IMPORT',</span><span class="s3">\n  \&quot;</span><span class="s1">Directory import '%s' is not supported </span><span class="s3">\&quot; </span><span class="s1">+</span><span class="s3">\n    </span><span class="s1">'resolving ES modules imported from %s',</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_UNKNOWN_FILE_EXTENSION = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_UNKNOWN_FILE_EXTENSION',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} ext</span><span class="s3">\n   </span><span class="s1">* @param {string} path</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(ext, path) =&gt; {</span><span class="s3">\n    </span><span class="s1">return `Unknown file extension </span><span class="s3">\&quot;</span><span class="s1">${ext}</span><span class="s3">\&quot; </span><span class="s1">for ${path}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">TypeError</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_INVALID_ARG_VALUE = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_INVALID_ARG_VALUE',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {string} name</span><span class="s3">\n   </span><span class="s1">* @param {unknown} value</span><span class="s3">\n   </span><span class="s1">* @param {string} [reason='is invalid']</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(name, value, reason = 'is invalid') =&gt; {</span><span class="s3">\n    </span><span class="s1">let inspected = inspect(value);</span><span class="s3">\n\n    </span><span class="s1">if (inspected.length &gt; 128) {</span><span class="s3">\n      </span><span class="s1">inspected = `${inspected.slice(0, 128)}...`;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const type = name.includes('.') ? 'property' : 'argument';</span><span class="s3">\n\n    </span><span class="s1">return `The ${type} '${name}' ${reason}. Received ${inspected}`</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">TypeError</span><span class="s3">\n  </span><span class="s1">// Note: extra classes have been shaken out.</span><span class="s3">\n  </span><span class="s1">// , RangeError</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">codes.ERR_UNSUPPORTED_ESM_URL_SCHEME = createError(</span><span class="s3">\n  </span><span class="s1">'ERR_UNSUPPORTED_ESM_URL_SCHEME',</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {URL} url</span><span class="s3">\n   </span><span class="s1">* @param {Array&lt;string&gt;} supported</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">(url, supported) =&gt; {</span><span class="s3">\n    </span><span class="s1">let message = `Only URLs with a scheme in: ${formatList(</span><span class="s3">\n      </span><span class="s1">supported</span><span class="s3">\n    </span><span class="s1">)} are supported by the default ESM loader`;</span><span class="s3">\n\n    </span><span class="s1">if (isWindows &amp;&amp; url.protocol.length === 2) {</span><span class="s3">\n      </span><span class="s1">message += '. On Windows, absolute paths must be valid file:// URLs';</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">message += `. Received protocol '${url.protocol}'`;</span><span class="s3">\n    </span><span class="s1">return message</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n  </span><span class="s1">Error</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Utility function for registering the error codes. Only used here. Exported</span><span class="s3">\n </span><span class="s1">* *only* to allow for testing.</span><span class="s3">\n </span><span class="s1">* @param {string} sym</span><span class="s3">\n </span><span class="s1">* @param {MessageFunction | string} value</span><span class="s3">\n </span><span class="s1">* @param {ErrorConstructor} def</span><span class="s3">\n </span><span class="s1">* @returns {new (...args: Array&lt;any&gt;) =&gt; Error}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function createError(sym, value, def) {</span><span class="s3">\n  </span><span class="s1">// Special case for SystemError that formats the error message differently</span><span class="s3">\n  </span><span class="s1">// The SystemErrors only have SystemError as their base classes.</span><span class="s3">\n  </span><span class="s1">messages.set(sym, value);</span><span class="s3">\n\n  </span><span class="s1">return makeNodeErrorWithCode(def, sym)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {ErrorConstructor} Base</span><span class="s3">\n </span><span class="s1">* @param {string} key</span><span class="s3">\n </span><span class="s1">* @returns {ErrorConstructor}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function makeNodeErrorWithCode(Base, key) {</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error It’s a Node error.</span><span class="s3">\n  </span><span class="s1">return NodeError</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {Array&lt;unknown&gt;} args</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">function NodeError(...args) {</span><span class="s3">\n    </span><span class="s1">const limit = Error.stackTraceLimit;</span><span class="s3">\n    </span><span class="s1">if (isErrorStackTraceLimitWritable()) Error.stackTraceLimit = 0;</span><span class="s3">\n    </span><span class="s1">const error = new Base();</span><span class="s3">\n    </span><span class="s1">// Reset the limit and setting the name property.</span><span class="s3">\n    </span><span class="s1">if (isErrorStackTraceLimitWritable()) Error.stackTraceLimit = limit;</span><span class="s3">\n    </span><span class="s1">const message = getMessage(key, args, error);</span><span class="s3">\n    </span><span class="s1">Object.defineProperties(error, {</span><span class="s3">\n      </span><span class="s1">// Note: no need to implement `kIsNodeError` symbol, would be hard,</span><span class="s3">\n      </span><span class="s1">// probably.</span><span class="s3">\n      </span><span class="s1">message: {</span><span class="s3">\n        </span><span class="s1">value: message,</span><span class="s3">\n        </span><span class="s1">enumerable: false,</span><span class="s3">\n        </span><span class="s1">writable: true,</span><span class="s3">\n        </span><span class="s1">configurable: true</span><span class="s3">\n      </span><span class="s1">},</span><span class="s3">\n      </span><span class="s1">toString: {</span><span class="s3">\n        </span><span class="s1">/** @this {Error} */</span><span class="s3">\n        </span><span class="s1">value() {</span><span class="s3">\n          </span><span class="s1">return `${this.name} [${key}]: ${this.message}`</span><span class="s3">\n        </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">enumerable: false,</span><span class="s3">\n        </span><span class="s1">writable: true,</span><span class="s3">\n        </span><span class="s1">configurable: true</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n\n    </span><span class="s1">captureLargerStackTrace(error);</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error It’s a Node error.</span><span class="s3">\n    </span><span class="s1">error.code = key;</span><span class="s3">\n    </span><span class="s1">return error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isErrorStackTraceLimitWritable() {</span><span class="s3">\n  </span><span class="s1">// Do no touch Error.stackTraceLimit as V8 would attempt to install</span><span class="s3">\n  </span><span class="s1">// it again during deserialization.</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error: not in types?</span><span class="s3">\n    </span><span class="s1">if (v8.startupSnapshot.isBuildingSnapshot()) {</span><span class="s3">\n      </span><span class="s1">return false</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch {}</span><span class="s3">\n\n  </span><span class="s1">const desc = Object.getOwnPropertyDescriptor(Error, 'stackTraceLimit');</span><span class="s3">\n  </span><span class="s1">if (desc === undefined) {</span><span class="s3">\n    </span><span class="s1">return Object.isExtensible(Error)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return own$1.call(desc, 'writable') &amp;&amp; desc.writable !== undefined</span><span class="s3">\n    </span><span class="s1">? desc.writable</span><span class="s3">\n    </span><span class="s1">: desc.set !== undefined</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* This function removes unnecessary frames from Node.js core errors.</span><span class="s3">\n </span><span class="s1">* @template {(...args: unknown[]) =&gt; unknown} T</span><span class="s3">\n </span><span class="s1">* @param {T} fn</span><span class="s3">\n </span><span class="s1">* @returns {T}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function hideStackFrames(fn) {</span><span class="s3">\n  </span><span class="s1">// We rename the functions that will be hidden to cut off the stacktrace</span><span class="s3">\n  </span><span class="s1">// at the outermost one</span><span class="s3">\n  </span><span class="s1">const hidden = nodeInternalPrefix + fn.name;</span><span class="s3">\n  </span><span class="s1">Object.defineProperty(fn, 'name', {value: hidden});</span><span class="s3">\n  </span><span class="s1">return fn</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const captureLargerStackTrace = hideStackFrames(</span><span class="s3">\n  </span><span class="s1">/**</span><span class="s3">\n   </span><span class="s1">* @param {Error} error</span><span class="s3">\n   </span><span class="s1">* @returns {Error}</span><span class="s3">\n   </span><span class="s1">*/</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error: fine</span><span class="s3">\n  </span><span class="s1">function (error) {</span><span class="s3">\n    </span><span class="s1">const stackTraceLimitIsWritable = isErrorStackTraceLimitWritable();</span><span class="s3">\n    </span><span class="s1">if (stackTraceLimitIsWritable) {</span><span class="s3">\n      </span><span class="s1">userStackTraceLimit = Error.stackTraceLimit;</span><span class="s3">\n      </span><span class="s1">Error.stackTraceLimit = Number.POSITIVE_INFINITY;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">Error.captureStackTrace(error);</span><span class="s3">\n\n    </span><span class="s1">// Reset the limit</span><span class="s3">\n    </span><span class="s1">if (stackTraceLimitIsWritable) Error.stackTraceLimit = userStackTraceLimit;</span><span class="s3">\n\n    </span><span class="s1">return error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} key</span><span class="s3">\n </span><span class="s1">* @param {Array&lt;unknown&gt;} args</span><span class="s3">\n </span><span class="s1">* @param {Error} self</span><span class="s3">\n </span><span class="s1">* @returns {string}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getMessage(key, args, self) {</span><span class="s3">\n  </span><span class="s1">const message = messages.get(key);</span><span class="s3">\n  </span><span class="s1">assert(message !== undefined, 'expected `message` to be found');</span><span class="s3">\n\n  </span><span class="s1">if (typeof message === 'function') {</span><span class="s3">\n    </span><span class="s1">assert(</span><span class="s3">\n      </span><span class="s1">message.length &lt;= args.length, // Default options do not count.</span><span class="s3">\n      </span><span class="s1">`Code: ${key}; The provided arguments length (${args.length}) does not ` +</span><span class="s3">\n        </span><span class="s1">`match the required ones (${message.length}).`</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return Reflect.apply(message, self, args)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const regex = /%[dfijoOs]/g;</span><span class="s3">\n  </span><span class="s1">let expectedLength = 0;</span><span class="s3">\n  </span><span class="s1">while (regex.exec(message) !== null) expectedLength++;</span><span class="s3">\n  </span><span class="s1">assert(</span><span class="s3">\n    </span><span class="s1">expectedLength === args.length,</span><span class="s3">\n    </span><span class="s1">`Code: ${key}; The provided arguments length (${args.length}) does not ` +</span><span class="s3">\n      </span><span class="s1">`match the required ones (${expectedLength}).`</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">if (args.length === 0) return message</span><span class="s3">\n\n  </span><span class="s1">args.unshift(message);</span><span class="s3">\n  </span><span class="s1">return Reflect.apply(format, null, args)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Determine the specific type of a value for type-mismatch errors.</span><span class="s3">\n </span><span class="s1">* @param {unknown} value</span><span class="s3">\n </span><span class="s1">* @returns {string}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function determineSpecificType(value) {</span><span class="s3">\n  </span><span class="s1">if (value === null || value === undefined) {</span><span class="s3">\n    </span><span class="s1">return String(value)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof value === 'function' &amp;&amp; value.name) {</span><span class="s3">\n    </span><span class="s1">return `function ${value.name}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof value === 'object') {</span><span class="s3">\n    </span><span class="s1">if (value.constructor &amp;&amp; value.constructor.name) {</span><span class="s3">\n      </span><span class="s1">return `an instance of ${value.constructor.name}`</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return `${inspect(value, {depth: -1})}`</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let inspected = inspect(value, {colors: false});</span><span class="s3">\n\n  </span><span class="s1">if (inspected.length &gt; 28) {</span><span class="s3">\n    </span><span class="s1">inspected = `${inspected.slice(0, 25)}...`;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return `type ${typeof value} (${inspected})`</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/package_json_reader.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n</span><span class="s1">// Removed the native dependency.</span><span class="s3">\n</span><span class="s1">// Also: no need to cache, we do that in resolve already.</span><span class="s3">\n\n\n</span><span class="s1">const reader = {read};</span><span class="s3">\n</span><span class="s1">var packageJsonReader = reader;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} jsonPath</span><span class="s3">\n </span><span class="s1">* @returns {{string: string | undefined}}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function read(jsonPath) {</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">const string = fs.readFileSync(</span><span class="s3">\n      </span><span class="s1">path.toNamespacedPath(path.join(path.dirname(jsonPath), 'package.json')),</span><span class="s3">\n      </span><span class="s1">'utf8'</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">return {string}</span><span class="s3">\n  </span><span class="s1">} catch (error) {</span><span class="s3">\n    </span><span class="s1">const exception = /** @type {ErrnoException} */ (error);</span><span class="s3">\n\n    </span><span class="s1">if (exception.code === 'ENOENT') {</span><span class="s3">\n      </span><span class="s1">return {string: undefined}</span><span class="s3">\n      </span><span class="s1">// Throw all other errors.</span><span class="s3">\n      </span><span class="s1">/* c8 ignore next 4 */</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">throw exception</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/esm/package_config.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n\n\n</span><span class="s1">const {ERR_INVALID_PACKAGE_CONFIG: ERR_INVALID_PACKAGE_CONFIG$1} = codes;</span><span class="s3">\n\n</span><span class="s1">/** @type {Map&lt;string, PackageConfig&gt;} */</span><span class="s3">\n</span><span class="s1">const packageJsonCache = new Map();</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} path</span><span class="s3">\n </span><span class="s1">* @param {URL | string} specifier Note: `specifier` is actually optional, not base.</span><span class="s3">\n </span><span class="s1">* @param {URL} [base]</span><span class="s3">\n </span><span class="s1">* @returns {PackageConfig}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getPackageConfig(path, specifier, base) {</span><span class="s3">\n  </span><span class="s1">const existing = packageJsonCache.get(path);</span><span class="s3">\n  </span><span class="s1">if (existing !== undefined) {</span><span class="s3">\n    </span><span class="s1">return existing</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const source = packageJsonReader.read(path).string;</span><span class="s3">\n\n  </span><span class="s1">if (source === undefined) {</span><span class="s3">\n    </span><span class="s1">/** @type {PackageConfig} */</span><span class="s3">\n    </span><span class="s1">const packageConfig = {</span><span class="s3">\n      </span><span class="s1">pjsonPath: path,</span><span class="s3">\n      </span><span class="s1">exists: false,</span><span class="s3">\n      </span><span class="s1">main: undefined,</span><span class="s3">\n      </span><span class="s1">name: undefined,</span><span class="s3">\n      </span><span class="s1">type: 'none',</span><span class="s3">\n      </span><span class="s1">exports: undefined,</span><span class="s3">\n      </span><span class="s1">imports: undefined</span><span class="s3">\n    </span><span class="s1">};</span><span class="s3">\n    </span><span class="s1">packageJsonCache.set(path, packageConfig);</span><span class="s3">\n    </span><span class="s1">return packageConfig</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/** @type {Record&lt;string, unknown&gt;} */</span><span class="s3">\n  </span><span class="s1">let packageJson;</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">packageJson = JSON.parse(source);</span><span class="s3">\n  </span><span class="s1">} catch (error) {</span><span class="s3">\n    </span><span class="s1">const exception = /** @type {ErrnoException} */ (error);</span><span class="s3">\n\n    </span><span class="s1">throw new ERR_INVALID_PACKAGE_CONFIG$1(</span><span class="s3">\n      </span><span class="s1">path,</span><span class="s3">\n      </span><span class="s1">(base ? `</span><span class="s3">\&quot;</span><span class="s1">${specifier}</span><span class="s3">\&quot; </span><span class="s1">from ` : '') + fileURLToPath(base || specifier),</span><span class="s3">\n      </span><span class="s1">exception.message</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const {exports, imports, main, name, type} = packageJson;</span><span class="s3">\n\n  </span><span class="s1">/** @type {PackageConfig} */</span><span class="s3">\n  </span><span class="s1">const packageConfig = {</span><span class="s3">\n    </span><span class="s1">pjsonPath: path,</span><span class="s3">\n    </span><span class="s1">exists: true,</span><span class="s3">\n    </span><span class="s1">main: typeof main === 'string' ? main : undefined,</span><span class="s3">\n    </span><span class="s1">name: typeof name === 'string' ? name : undefined,</span><span class="s3">\n    </span><span class="s1">type: type === 'module' || type === 'commonjs' ? type : 'none',</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error Assume `Record&lt;string, unknown&gt;`.</span><span class="s3">\n    </span><span class="s1">exports,</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error Assume `Record&lt;string, unknown&gt;`.</span><span class="s3">\n    </span><span class="s1">imports: imports &amp;&amp; typeof imports === 'object' ? imports : undefined</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">packageJsonCache.set(path, packageConfig);</span><span class="s3">\n  </span><span class="s1">return packageConfig</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} resolved</span><span class="s3">\n </span><span class="s1">* @returns {PackageConfig}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getPackageScopeConfig(resolved) {</span><span class="s3">\n  </span><span class="s1">let packageJsonUrl = new URL('package.json', resolved);</span><span class="s3">\n\n  </span><span class="s1">while (true) {</span><span class="s3">\n    </span><span class="s1">const packageJsonPath = packageJsonUrl.pathname;</span><span class="s3">\n\n    </span><span class="s1">if (packageJsonPath.endsWith('node_modules/package.json')) break</span><span class="s3">\n\n    </span><span class="s1">const packageConfig = getPackageConfig(</span><span class="s3">\n      </span><span class="s1">fileURLToPath(packageJsonUrl),</span><span class="s3">\n      </span><span class="s1">resolved</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (packageConfig.exists) return packageConfig</span><span class="s3">\n\n    </span><span class="s1">const lastPackageJsonUrl = packageJsonUrl;</span><span class="s3">\n    </span><span class="s1">packageJsonUrl = new URL('../package.json', packageJsonUrl);</span><span class="s3">\n\n    </span><span class="s1">// Terminates at root where ../package.json equals ../../package.json</span><span class="s3">\n    </span><span class="s1">// (can't just check </span><span class="s3">\&quot;</span><span class="s1">/package.json</span><span class="s3">\&quot; </span><span class="s1">for Windows support).</span><span class="s3">\n    </span><span class="s1">if (packageJsonUrl.pathname === lastPackageJsonUrl.pathname) break</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const packageJsonPath = fileURLToPath(packageJsonUrl);</span><span class="s3">\n  </span><span class="s1">/** @type {PackageConfig} */</span><span class="s3">\n  </span><span class="s1">const packageConfig = {</span><span class="s3">\n    </span><span class="s1">pjsonPath: packageJsonPath,</span><span class="s3">\n    </span><span class="s1">exists: false,</span><span class="s3">\n    </span><span class="s1">main: undefined,</span><span class="s3">\n    </span><span class="s1">name: undefined,</span><span class="s3">\n    </span><span class="s1">type: 'none',</span><span class="s3">\n    </span><span class="s1">exports: undefined,</span><span class="s3">\n    </span><span class="s1">imports: undefined</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">packageJsonCache.set(packageJsonPath, packageConfig);</span><span class="s3">\n  </span><span class="s1">return packageConfig</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/esm/resolve.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n</span><span class="s1">//</span><span class="s3">\n</span><span class="s1">// This file solves a circular dependency.</span><span class="s3">\n</span><span class="s1">// In Node.js, `getPackageType` is in `resolve.js`.</span><span class="s3">\n</span><span class="s1">// `resolve.js` imports `get-format.js`, which needs `getPackageType`.</span><span class="s3">\n</span><span class="s1">// We split that up so that bundlers don’t fail.</span><span class="s3">\n\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">* @returns {PackageType}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getPackageType(url) {</span><span class="s3">\n  </span><span class="s1">const packageConfig = getPackageScopeConfig(url);</span><span class="s3">\n  </span><span class="s1">return packageConfig.type</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/esm/get_format.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n\n\n</span><span class="s1">const {ERR_UNKNOWN_FILE_EXTENSION} = codes;</span><span class="s3">\n\n</span><span class="s1">const hasOwnProperty = {}.hasOwnProperty;</span><span class="s3">\n\n</span><span class="s1">/** @type {Record&lt;string, string&gt;} */</span><span class="s3">\n</span><span class="s1">const extensionFormatMap = {</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error: hush.</span><span class="s3">\n  </span><span class="s1">__proto__: null,</span><span class="s3">\n  </span><span class="s1">'.cjs': 'commonjs',</span><span class="s3">\n  </span><span class="s1">'.js': 'module',</span><span class="s3">\n  </span><span class="s1">'.json': 'json',</span><span class="s3">\n  </span><span class="s1">'.mjs': 'module'</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string | null} mime</span><span class="s3">\n </span><span class="s1">* @returns {string | null}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function mimeToFormat(mime) {</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">mime &amp;&amp;</span><span class="s3">\n    </span><span class="s1">/</span><span class="s3">\\</span><span class="s1">s*(text|application)</span><span class="s3">\\</span><span class="s1">/javascript</span><span class="s3">\\</span><span class="s1">s*(;</span><span class="s3">\\</span><span class="s1">s*charset=utf-?8</span><span class="s3">\\</span><span class="s1">s*)?/i.test(mime)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">return 'module'</span><span class="s3">\n  </span><span class="s1">if (mime === 'application/json') return 'json'</span><span class="s3">\n  </span><span class="s1">return null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @callback ProtocolHandler</span><span class="s3">\n </span><span class="s1">* @param {URL} parsed</span><span class="s3">\n </span><span class="s1">* @param {{parentURL: string}} context</span><span class="s3">\n </span><span class="s1">* @param {boolean} ignoreErrors</span><span class="s3">\n </span><span class="s1">* @returns {string | null | void}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @type {Record&lt;string, ProtocolHandler&gt;}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const protocolHandlers = {</span><span class="s3">\n  </span><span class="s1">// @ts-expect-error: hush.</span><span class="s3">\n  </span><span class="s1">__proto__: null,</span><span class="s3">\n  </span><span class="s1">'data:': getDataProtocolModuleFormat,</span><span class="s3">\n  </span><span class="s1">'file:': getFileProtocolModuleFormat,</span><span class="s3">\n  </span><span class="s1">'http:': getHttpProtocolModuleFormat,</span><span class="s3">\n  </span><span class="s1">'https:': getHttpProtocolModuleFormat,</span><span class="s3">\n  </span><span class="s1">'node:'() {</span><span class="s3">\n    </span><span class="s1">return 'builtin'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} parsed</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getDataProtocolModuleFormat(parsed) {</span><span class="s3">\n  </span><span class="s1">const {1: mime} = /^([^/]+</span><span class="s3">\\</span><span class="s1">/[^;,]+)[^,]*?(;base64)?,/.exec(</span><span class="s3">\n    </span><span class="s1">parsed.pathname</span><span class="s3">\n  </span><span class="s1">) || [null, null, null];</span><span class="s3">\n  </span><span class="s1">return mimeToFormat(mime)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns the file extension from a URL.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Should give similar result to</span><span class="s3">\n </span><span class="s1">* `require('node:path').extname(require('node:url').fileURLToPath(url))`</span><span class="s3">\n </span><span class="s1">* when used with a `file:` URL.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">* @returns {string}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function extname(url) {</span><span class="s3">\n  </span><span class="s1">const pathname = url.pathname;</span><span class="s3">\n  </span><span class="s1">let index = pathname.length;</span><span class="s3">\n\n  </span><span class="s1">while (index--) {</span><span class="s3">\n    </span><span class="s1">const code = pathname.codePointAt(index);</span><span class="s3">\n\n    </span><span class="s1">if (code === 47 /* `/` */) {</span><span class="s3">\n      </span><span class="s1">return ''</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (code === 46 /* `.` */) {</span><span class="s3">\n      </span><span class="s1">return pathname.codePointAt(index - 1) === 47 /* `/` */</span><span class="s3">\n        </span><span class="s1">? ''</span><span class="s3">\n        </span><span class="s1">: pathname.slice(index)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return ''</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @type {ProtocolHandler}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getFileProtocolModuleFormat(url, _context, ignoreErrors) {</span><span class="s3">\n  </span><span class="s1">const ext = extname(url);</span><span class="s3">\n\n  </span><span class="s1">if (ext === '.js') {</span><span class="s3">\n    </span><span class="s1">return getPackageType(url) === 'module' ? 'module' : 'commonjs'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const format = extensionFormatMap[ext];</span><span class="s3">\n  </span><span class="s1">if (format) return format</span><span class="s3">\n\n  </span><span class="s1">// Explicit undefined return indicates load hook should rerun format check</span><span class="s3">\n  </span><span class="s1">if (ignoreErrors) {</span><span class="s3">\n    </span><span class="s1">return undefined</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const filepath = fileURLToPath(url);</span><span class="s3">\n  </span><span class="s1">throw new ERR_UNKNOWN_FILE_EXTENSION(ext, filepath)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getHttpProtocolModuleFormat() {</span><span class="s3">\n  </span><span class="s1">// To do: HTTPS imports.</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">* @param {{parentURL: string}} context</span><span class="s3">\n </span><span class="s1">* @returns {string | null}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function defaultGetFormatWithoutErrors(url, context) {</span><span class="s3">\n  </span><span class="s1">if (!hasOwnProperty.call(protocolHandlers, url.protocol)) {</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return protocolHandlers[url.protocol](url, context, true) || null</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/esm/utils.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n\n\n</span><span class="s1">const {ERR_INVALID_ARG_VALUE} = codes;</span><span class="s3">\n\n</span><span class="s1">// In Node itself these values are populated from CLI arguments, before any</span><span class="s3">\n</span><span class="s1">// user code runs.</span><span class="s3">\n</span><span class="s1">// Here we just define the defaults.</span><span class="s3">\n</span><span class="s1">const DEFAULT_CONDITIONS = Object.freeze(['node', 'import']);</span><span class="s3">\n</span><span class="s1">const DEFAULT_CONDITIONS_SET = new Set(DEFAULT_CONDITIONS);</span><span class="s3">\n\n</span><span class="s1">function getDefaultConditions() {</span><span class="s3">\n  </span><span class="s1">return DEFAULT_CONDITIONS</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function getDefaultConditionsSet() {</span><span class="s3">\n  </span><span class="s1">return DEFAULT_CONDITIONS_SET</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {Array&lt;string&gt;} [conditions]</span><span class="s3">\n </span><span class="s1">* @returns {Set&lt;string&gt;}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function getConditionsSet(conditions) {</span><span class="s3">\n  </span><span class="s1">if (conditions !== undefined &amp;&amp; conditions !== getDefaultConditions()) {</span><span class="s3">\n    </span><span class="s1">if (!Array.isArray(conditions)) {</span><span class="s3">\n      </span><span class="s1">throw new ERR_INVALID_ARG_VALUE(</span><span class="s3">\n        </span><span class="s1">'conditions',</span><span class="s3">\n        </span><span class="s1">conditions,</span><span class="s3">\n        </span><span class="s1">'expected an array'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return new Set(conditions)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return getDefaultConditionsSet()</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Manually “tree shaken” from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/modules/esm/resolve.js&gt;</span><span class="s3">\n</span><span class="s1">// Last checked on: Apr 24, 2023.</span><span class="s3">\n\n\n</span><span class="s1">const RegExpPrototypeSymbolReplace = RegExp.prototype[Symbol.replace];</span><span class="s3">\n\n</span><span class="s1">// To do: potentially enable?</span><span class="s3">\n</span><span class="s1">const experimentalNetworkImports = false;</span><span class="s3">\n\n</span><span class="s1">const {</span><span class="s3">\n  </span><span class="s1">ERR_NETWORK_IMPORT_DISALLOWED,</span><span class="s3">\n  </span><span class="s1">ERR_INVALID_MODULE_SPECIFIER,</span><span class="s3">\n  </span><span class="s1">ERR_INVALID_PACKAGE_CONFIG,</span><span class="s3">\n  </span><span class="s1">ERR_INVALID_PACKAGE_TARGET,</span><span class="s3">\n  </span><span class="s1">ERR_MODULE_NOT_FOUND,</span><span class="s3">\n  </span><span class="s1">ERR_PACKAGE_IMPORT_NOT_DEFINED,</span><span class="s3">\n  </span><span class="s1">ERR_PACKAGE_PATH_NOT_EXPORTED,</span><span class="s3">\n  </span><span class="s1">ERR_UNSUPPORTED_DIR_IMPORT,</span><span class="s3">\n  </span><span class="s1">ERR_UNSUPPORTED_ESM_URL_SCHEME</span><span class="s3">\n</span><span class="s1">} = codes;</span><span class="s3">\n\n</span><span class="s1">const own = {}.hasOwnProperty;</span><span class="s3">\n\n</span><span class="s1">const invalidSegmentRegEx =</span><span class="s3">\n  </span><span class="s1">/(^|</span><span class="s3">\\\\</span><span class="s1">|</span><span class="s3">\\</span><span class="s1">/)((</span><span class="s3">\\</span><span class="s1">.|%2e)(</span><span class="s3">\\</span><span class="s1">.|%2e)?|(n|%6e|%4e)(o|%6f|%4f)(d|%64|%44)(e|%65|%45)(_|%5f)(m|%6d|%4d)(o|%6f|%4f)(d|%64|%44)(u|%75|%55)(l|%6c|%4c)(e|%65|%45)(s|%73|%53))?(</span><span class="s3">\\\\</span><span class="s1">|</span><span class="s3">\\</span><span class="s1">/|$)/i;</span><span class="s3">\n</span><span class="s1">const deprecatedInvalidSegmentRegEx =</span><span class="s3">\n  </span><span class="s1">/(^|</span><span class="s3">\\\\</span><span class="s1">|</span><span class="s3">\\</span><span class="s1">/)((</span><span class="s3">\\</span><span class="s1">.|%2e)(</span><span class="s3">\\</span><span class="s1">.|%2e)?|(n|%6e|%4e)(o|%6f|%4f)(d|%64|%44)(e|%65|%45)(_|%5f)(m|%6d|%4d)(o|%6f|%4f)(d|%64|%44)(u|%75|%55)(l|%6c|%4c)(e|%65|%45)(s|%73|%53))(</span><span class="s3">\\\\</span><span class="s1">|</span><span class="s3">\\</span><span class="s1">/|$)/i;</span><span class="s3">\n</span><span class="s1">const invalidPackageNameRegEx = /^</span><span class="s3">\\</span><span class="s1">.|%|</span><span class="s3">\\\\</span><span class="s1">/;</span><span class="s3">\n</span><span class="s1">const patternRegEx = /</span><span class="s3">\\</span><span class="s1">*/g;</span><span class="s3">\n</span><span class="s1">const encodedSepRegEx = /%2f|%5c/i;</span><span class="s3">\n</span><span class="s1">/** @type {Set&lt;string&gt;} */</span><span class="s3">\n</span><span class="s1">const emittedPackageWarnings = new Set();</span><span class="s3">\n\n</span><span class="s1">const doubleSlashRegEx = /[/</span><span class="s3">\\\\</span><span class="s1">]{2}/;</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {string} target</span><span class="s3">\n </span><span class="s1">* @param {string} request</span><span class="s3">\n </span><span class="s1">* @param {string} match</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {boolean} internal</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {boolean} isTarget</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function emitInvalidSegmentDeprecation(</span><span class="s3">\n  </span><span class="s1">target,</span><span class="s3">\n  </span><span class="s1">request,</span><span class="s3">\n  </span><span class="s1">match,</span><span class="s3">\n  </span><span class="s1">packageJsonUrl,</span><span class="s3">\n  </span><span class="s1">internal,</span><span class="s3">\n  </span><span class="s1">base,</span><span class="s3">\n  </span><span class="s1">isTarget</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const pjsonPath = fileURLToPath(packageJsonUrl);</span><span class="s3">\n  </span><span class="s1">const double = doubleSlashRegEx.exec(isTarget ? target : request) !== null;</span><span class="s3">\n  </span><span class="s1">process.emitWarning(</span><span class="s3">\n    </span><span class="s1">`Use of deprecated ${</span><span class="s3">\n      </span><span class="s1">double ? 'double slash' : 'leading or trailing slash matching'</span><span class="s3">\n    </span><span class="s1">} resolving </span><span class="s3">\&quot;</span><span class="s1">${target}</span><span class="s3">\&quot; </span><span class="s1">for module ` +</span><span class="s3">\n      </span><span class="s1">`request </span><span class="s3">\&quot;</span><span class="s1">${request}</span><span class="s3">\&quot; </span><span class="s1">${</span><span class="s3">\n        </span><span class="s1">request === match ? '' : `matched to </span><span class="s3">\&quot;</span><span class="s1">${match}</span><span class="s3">\&quot; </span><span class="s1">`</span><span class="s3">\n      </span><span class="s1">}in the </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n        </span><span class="s1">internal ? 'imports' : 'exports'</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">field module resolution of the package at ${pjsonPath}${</span><span class="s3">\n        </span><span class="s1">base ? ` imported from ${fileURLToPath(base)}` : ''</span><span class="s3">\n      </span><span class="s1">}.`,</span><span class="s3">\n    </span><span class="s1">'DeprecationWarning',</span><span class="s3">\n    </span><span class="s1">'DEP0166'</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {unknown} [main]</span><span class="s3">\n </span><span class="s1">* @returns {void}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function emitLegacyIndexDeprecation(url, packageJsonUrl, base, main) {</span><span class="s3">\n  </span><span class="s1">const format = defaultGetFormatWithoutErrors(url, {parentURL: base.href});</span><span class="s3">\n  </span><span class="s1">if (format !== 'module') return</span><span class="s3">\n  </span><span class="s1">const path = fileURLToPath(url.href);</span><span class="s3">\n  </span><span class="s1">const pkgPath = fileURLToPath(new URL('.', packageJsonUrl));</span><span class="s3">\n  </span><span class="s1">const basePath = fileURLToPath(base);</span><span class="s3">\n  </span><span class="s1">if (main)</span><span class="s3">\n    </span><span class="s1">process.emitWarning(</span><span class="s3">\n      </span><span class="s1">`Package ${pkgPath} has a </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot; </span><span class="s1">field set to ${JSON.stringify(main)}, ` +</span><span class="s3">\n        </span><span class="s1">`excluding the full filename and extension to the resolved file at </span><span class="s3">\&quot;</span><span class="s1">${path.slice(</span><span class="s3">\n          </span><span class="s1">pkgPath.length</span><span class="s3">\n        </span><span class="s1">)}</span><span class="s3">\&quot;</span><span class="s1">, imported from ${basePath}.</span><span class="s3">\\</span><span class="s1">n Automatic extension resolution of the </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot; </span><span class="s1">field is` +</span><span class="s3">\n        </span><span class="s1">'deprecated for ES modules.',</span><span class="s3">\n      </span><span class="s1">'DeprecationWarning',</span><span class="s3">\n      </span><span class="s1">'DEP0151'</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">else</span><span class="s3">\n    </span><span class="s1">process.emitWarning(</span><span class="s3">\n      </span><span class="s1">`No </span><span class="s3">\&quot;</span><span class="s1">main</span><span class="s3">\&quot; </span><span class="s1">or </span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">field defined in the package.json for ${pkgPath} resolving the main entry point </span><span class="s3">\&quot;</span><span class="s1">${path.slice(</span><span class="s3">\n        </span><span class="s1">pkgPath.length</span><span class="s3">\n      </span><span class="s1">)}</span><span class="s3">\&quot;</span><span class="s1">, imported from ${basePath}.</span><span class="s3">\\</span><span class="s1">nDefault </span><span class="s3">\&quot;</span><span class="s1">index</span><span class="s3">\&quot; </span><span class="s1">lookups for the main are deprecated for ES modules.`,</span><span class="s3">\n      </span><span class="s1">'DeprecationWarning',</span><span class="s3">\n      </span><span class="s1">'DEP0151'</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} path</span><span class="s3">\n </span><span class="s1">* @returns {Stats}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function tryStatSync(path) {</span><span class="s3">\n  </span><span class="s1">// Note: from Node 15 onwards we can use `throwIfNoEntry: false` instead.</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return statSync(path)</span><span class="s3">\n  </span><span class="s1">} catch {</span><span class="s3">\n    </span><span class="s1">return new Stats()</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Legacy CommonJS main resolution:</span><span class="s3">\n </span><span class="s1">* 1. let M = pkg_url + (json main field)</span><span class="s3">\n </span><span class="s1">* 2. TRY(M, M.js, M.json, M.node)</span><span class="s3">\n </span><span class="s1">* 3. TRY(M/index.js, M/index.json, M/index.node)</span><span class="s3">\n </span><span class="s1">* 4. TRY(pkg_url/index.js, pkg_url/index.json, pkg_url/index.node)</span><span class="s3">\n </span><span class="s1">* 5. NOT_FOUND</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function fileExists(url) {</span><span class="s3">\n  </span><span class="s1">const stats = statSync(url, {throwIfNoEntry: false});</span><span class="s3">\n  </span><span class="s1">const isFile = stats ? stats.isFile() : undefined;</span><span class="s3">\n  </span><span class="s1">return isFile === null || isFile === undefined ? false : isFile</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {PackageConfig} packageConfig</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function legacyMainResolve(packageJsonUrl, packageConfig, base) {</span><span class="s3">\n  </span><span class="s1">/** @type {URL | undefined} */</span><span class="s3">\n  </span><span class="s1">let guess;</span><span class="s3">\n  </span><span class="s1">if (packageConfig.main !== undefined) {</span><span class="s3">\n    </span><span class="s1">guess = new URL(packageConfig.main, packageJsonUrl);</span><span class="s3">\n    </span><span class="s1">// Note: fs check redundances will be handled by Descriptor cache here.</span><span class="s3">\n    </span><span class="s1">if (fileExists(guess)) return guess</span><span class="s3">\n\n    </span><span class="s1">const tries = [</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}.js`,</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}.json`,</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}.node`,</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}/index.js`,</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}/index.json`,</span><span class="s3">\n      </span><span class="s1">`./${packageConfig.main}/index.node`</span><span class="s3">\n    </span><span class="s1">];</span><span class="s3">\n    </span><span class="s1">let i = -1;</span><span class="s3">\n\n    </span><span class="s1">while (++i &lt; tries.length) {</span><span class="s3">\n      </span><span class="s1">guess = new URL(tries[i], packageJsonUrl);</span><span class="s3">\n      </span><span class="s1">if (fileExists(guess)) break</span><span class="s3">\n      </span><span class="s1">guess = undefined;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (guess) {</span><span class="s3">\n      </span><span class="s1">emitLegacyIndexDeprecation(</span><span class="s3">\n        </span><span class="s1">guess,</span><span class="s3">\n        </span><span class="s1">packageJsonUrl,</span><span class="s3">\n        </span><span class="s1">base,</span><span class="s3">\n        </span><span class="s1">packageConfig.main</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">return guess</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">// Fallthrough.</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const tries = ['./index.js', './index.json', './index.node'];</span><span class="s3">\n  </span><span class="s1">let i = -1;</span><span class="s3">\n\n  </span><span class="s1">while (++i &lt; tries.length) {</span><span class="s3">\n    </span><span class="s1">guess = new URL(tries[i], packageJsonUrl);</span><span class="s3">\n    </span><span class="s1">if (fileExists(guess)) break</span><span class="s3">\n    </span><span class="s1">guess = undefined;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (guess) {</span><span class="s3">\n    </span><span class="s1">emitLegacyIndexDeprecation(guess, packageJsonUrl, base, packageConfig.main);</span><span class="s3">\n    </span><span class="s1">return guess</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// Not found.</span><span class="s3">\n  </span><span class="s1">throw new ERR_MODULE_NOT_FOUND(</span><span class="s3">\n    </span><span class="s1">fileURLToPath(new URL('.', packageJsonUrl)),</span><span class="s3">\n    </span><span class="s1">fileURLToPath(base)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} resolved</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {boolean} [preserveSymlinks]</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function finalizeResolution(resolved, base, preserveSymlinks) {</span><span class="s3">\n  </span><span class="s1">if (encodedSepRegEx.exec(resolved.pathname) !== null)</span><span class="s3">\n    </span><span class="s1">throw new ERR_INVALID_MODULE_SPECIFIER(</span><span class="s3">\n      </span><span class="s1">resolved.pathname,</span><span class="s3">\n      </span><span class="s1">'must not include encoded </span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot; </span><span class="s1">or </span><span class="s3">\&quot;\\\\\&quot; </span><span class="s1">characters',</span><span class="s3">\n      </span><span class="s1">fileURLToPath(base)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n\n  </span><span class="s1">const filePath = fileURLToPath(resolved);</span><span class="s3">\n\n  </span><span class="s1">const stats = tryStatSync(</span><span class="s3">\n    </span><span class="s1">filePath.endsWith('/') ? filePath.slice(-1) : filePath</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">if (stats.isDirectory()) {</span><span class="s3">\n    </span><span class="s1">const error = new ERR_UNSUPPORTED_DIR_IMPORT(filePath, fileURLToPath(base));</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error Add this for `import.meta.resolve`.</span><span class="s3">\n    </span><span class="s1">error.url = String(resolved);</span><span class="s3">\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!stats.isFile()) {</span><span class="s3">\n    </span><span class="s1">throw new ERR_MODULE_NOT_FOUND(</span><span class="s3">\n      </span><span class="s1">filePath || resolved.pathname,</span><span class="s3">\n      </span><span class="s1">base &amp;&amp; fileURLToPath(base),</span><span class="s3">\n      </span><span class="s1">'module'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!preserveSymlinks) {</span><span class="s3">\n    </span><span class="s1">const real = realpathSync(filePath);</span><span class="s3">\n    </span><span class="s1">const {search, hash} = resolved;</span><span class="s3">\n    </span><span class="s1">resolved = pathToFileURL(real + (filePath.endsWith(path.sep) ? '/' : ''));</span><span class="s3">\n    </span><span class="s1">resolved.search = search;</span><span class="s3">\n    </span><span class="s1">resolved.hash = hash;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return resolved</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @param {URL | undefined} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @returns {Error}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function importNotDefined(specifier, packageJsonUrl, base) {</span><span class="s3">\n  </span><span class="s1">return new ERR_PACKAGE_IMPORT_NOT_DEFINED(</span><span class="s3">\n    </span><span class="s1">specifier,</span><span class="s3">\n    </span><span class="s1">packageJsonUrl &amp;&amp; fileURLToPath(new URL('.', packageJsonUrl)),</span><span class="s3">\n    </span><span class="s1">fileURLToPath(base)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} subpath</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @returns {Error}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function exportsNotFound(subpath, packageJsonUrl, base) {</span><span class="s3">\n  </span><span class="s1">return new ERR_PACKAGE_PATH_NOT_EXPORTED(</span><span class="s3">\n    </span><span class="s1">fileURLToPath(new URL('.', packageJsonUrl)),</span><span class="s3">\n    </span><span class="s1">subpath,</span><span class="s3">\n    </span><span class="s1">base &amp;&amp; fileURLToPath(base)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} request</span><span class="s3">\n </span><span class="s1">* @param {string} match</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {boolean} internal</span><span class="s3">\n </span><span class="s1">* @param {URL} [base]</span><span class="s3">\n </span><span class="s1">* @returns {never}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function throwInvalidSubpath(request, match, packageJsonUrl, internal, base) {</span><span class="s3">\n  </span><span class="s1">const reason = `request is not a valid match in pattern </span><span class="s3">\&quot;</span><span class="s1">${match}</span><span class="s3">\&quot; </span><span class="s1">for the </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n    </span><span class="s1">internal ? 'imports' : 'exports'</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">resolution of ${fileURLToPath(packageJsonUrl)}`;</span><span class="s3">\n  </span><span class="s1">throw new ERR_INVALID_MODULE_SPECIFIER(</span><span class="s3">\n    </span><span class="s1">request,</span><span class="s3">\n    </span><span class="s1">reason,</span><span class="s3">\n    </span><span class="s1">base &amp;&amp; fileURLToPath(base)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} subpath</span><span class="s3">\n </span><span class="s1">* @param {unknown} target</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {boolean} internal</span><span class="s3">\n </span><span class="s1">* @param {URL} [base]</span><span class="s3">\n </span><span class="s1">* @returns {Error}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function invalidPackageTarget(subpath, target, packageJsonUrl, internal, base) {</span><span class="s3">\n  </span><span class="s1">target =</span><span class="s3">\n    </span><span class="s1">typeof target === 'object' &amp;&amp; target !== null</span><span class="s3">\n      </span><span class="s1">? JSON.stringify(target, null, '')</span><span class="s3">\n      </span><span class="s1">: `${target}`;</span><span class="s3">\n\n  </span><span class="s1">return new ERR_INVALID_PACKAGE_TARGET(</span><span class="s3">\n    </span><span class="s1">fileURLToPath(new URL('.', packageJsonUrl)),</span><span class="s3">\n    </span><span class="s1">subpath,</span><span class="s3">\n    </span><span class="s1">target,</span><span class="s3">\n    </span><span class="s1">internal,</span><span class="s3">\n    </span><span class="s1">base &amp;&amp; fileURLToPath(base)</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} target</span><span class="s3">\n </span><span class="s1">* @param {string} subpath</span><span class="s3">\n </span><span class="s1">* @param {string} match</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {boolean} pattern</span><span class="s3">\n </span><span class="s1">* @param {boolean} internal</span><span class="s3">\n </span><span class="s1">* @param {boolean} isPathMap</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt; | undefined} conditions</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function resolvePackageTargetString(</span><span class="s3">\n  </span><span class="s1">target,</span><span class="s3">\n  </span><span class="s1">subpath,</span><span class="s3">\n  </span><span class="s1">match,</span><span class="s3">\n  </span><span class="s1">packageJsonUrl,</span><span class="s3">\n  </span><span class="s1">base,</span><span class="s3">\n  </span><span class="s1">pattern,</span><span class="s3">\n  </span><span class="s1">internal,</span><span class="s3">\n  </span><span class="s1">isPathMap,</span><span class="s3">\n  </span><span class="s1">conditions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (subpath !== '' &amp;&amp; !pattern &amp;&amp; target[target.length - 1] !== '/')</span><span class="s3">\n    </span><span class="s1">throw invalidPackageTarget(match, target, packageJsonUrl, internal, base)</span><span class="s3">\n\n  </span><span class="s1">if (!target.startsWith('./')) {</span><span class="s3">\n    </span><span class="s1">if (internal &amp;&amp; !target.startsWith('../') &amp;&amp; !target.startsWith('/')) {</span><span class="s3">\n      </span><span class="s1">let isURL = false;</span><span class="s3">\n\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">new URL(target);</span><span class="s3">\n        </span><span class="s1">isURL = true;</span><span class="s3">\n      </span><span class="s1">} catch {</span><span class="s3">\n        </span><span class="s1">// Continue regardless of error.</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (!isURL) {</span><span class="s3">\n        </span><span class="s1">const exportTarget = pattern</span><span class="s3">\n          </span><span class="s1">? RegExpPrototypeSymbolReplace.call(</span><span class="s3">\n              </span><span class="s1">patternRegEx,</span><span class="s3">\n              </span><span class="s1">target,</span><span class="s3">\n              </span><span class="s1">() =&gt; subpath</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">: target + subpath;</span><span class="s3">\n\n        </span><span class="s1">return packageResolve(exportTarget, packageJsonUrl, conditions)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">throw invalidPackageTarget(match, target, packageJsonUrl, internal, base)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (invalidSegmentRegEx.exec(target.slice(2)) !== null) {</span><span class="s3">\n    </span><span class="s1">if (deprecatedInvalidSegmentRegEx.exec(target.slice(2)) === null) {</span><span class="s3">\n      </span><span class="s1">if (!isPathMap) {</span><span class="s3">\n        </span><span class="s1">const request = pattern</span><span class="s3">\n          </span><span class="s1">? match.replace('*', () =&gt; subpath)</span><span class="s3">\n          </span><span class="s1">: match + subpath;</span><span class="s3">\n        </span><span class="s1">const resolvedTarget = pattern</span><span class="s3">\n          </span><span class="s1">? RegExpPrototypeSymbolReplace.call(</span><span class="s3">\n              </span><span class="s1">patternRegEx,</span><span class="s3">\n              </span><span class="s1">target,</span><span class="s3">\n              </span><span class="s1">() =&gt; subpath</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">: target;</span><span class="s3">\n        </span><span class="s1">emitInvalidSegmentDeprecation(</span><span class="s3">\n          </span><span class="s1">resolvedTarget,</span><span class="s3">\n          </span><span class="s1">request,</span><span class="s3">\n          </span><span class="s1">match,</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">internal,</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">true</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">throw invalidPackageTarget(match, target, packageJsonUrl, internal, base)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const resolved = new URL(target, packageJsonUrl);</span><span class="s3">\n  </span><span class="s1">const resolvedPath = resolved.pathname;</span><span class="s3">\n  </span><span class="s1">const packagePath = new URL('.', packageJsonUrl).pathname;</span><span class="s3">\n\n  </span><span class="s1">if (!resolvedPath.startsWith(packagePath))</span><span class="s3">\n    </span><span class="s1">throw invalidPackageTarget(match, target, packageJsonUrl, internal, base)</span><span class="s3">\n\n  </span><span class="s1">if (subpath === '') return resolved</span><span class="s3">\n\n  </span><span class="s1">if (invalidSegmentRegEx.exec(subpath) !== null) {</span><span class="s3">\n    </span><span class="s1">const request = pattern</span><span class="s3">\n      </span><span class="s1">? match.replace('*', () =&gt; subpath)</span><span class="s3">\n      </span><span class="s1">: match + subpath;</span><span class="s3">\n    </span><span class="s1">if (deprecatedInvalidSegmentRegEx.exec(subpath) === null) {</span><span class="s3">\n      </span><span class="s1">if (!isPathMap) {</span><span class="s3">\n        </span><span class="s1">const resolvedTarget = pattern</span><span class="s3">\n          </span><span class="s1">? RegExpPrototypeSymbolReplace.call(</span><span class="s3">\n              </span><span class="s1">patternRegEx,</span><span class="s3">\n              </span><span class="s1">target,</span><span class="s3">\n              </span><span class="s1">() =&gt; subpath</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">: target;</span><span class="s3">\n        </span><span class="s1">emitInvalidSegmentDeprecation(</span><span class="s3">\n          </span><span class="s1">resolvedTarget,</span><span class="s3">\n          </span><span class="s1">request,</span><span class="s3">\n          </span><span class="s1">match,</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">internal,</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">false</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">throwInvalidSubpath(request, match, packageJsonUrl, internal, base);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (pattern) {</span><span class="s3">\n    </span><span class="s1">return new URL(</span><span class="s3">\n      </span><span class="s1">RegExpPrototypeSymbolReplace.call(</span><span class="s3">\n        </span><span class="s1">patternRegEx,</span><span class="s3">\n        </span><span class="s1">resolved.href,</span><span class="s3">\n        </span><span class="s1">() =&gt; subpath</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return new URL(subpath, resolved)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} key</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isArrayIndex(key) {</span><span class="s3">\n  </span><span class="s1">const keyNumber = Number(key);</span><span class="s3">\n  </span><span class="s1">if (`${keyNumber}` !== key) return false</span><span class="s3">\n  </span><span class="s1">return keyNumber &gt;= 0 &amp;&amp; keyNumber &lt; 0xff_ff_ff_ff</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {unknown} target</span><span class="s3">\n </span><span class="s1">* @param {string} subpath</span><span class="s3">\n </span><span class="s1">* @param {string} packageSubpath</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {boolean} pattern</span><span class="s3">\n </span><span class="s1">* @param {boolean} internal</span><span class="s3">\n </span><span class="s1">* @param {boolean} isPathMap</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt; | undefined} conditions</span><span class="s3">\n </span><span class="s1">* @returns {URL | null}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function resolvePackageTarget(</span><span class="s3">\n  </span><span class="s1">packageJsonUrl,</span><span class="s3">\n  </span><span class="s1">target,</span><span class="s3">\n  </span><span class="s1">subpath,</span><span class="s3">\n  </span><span class="s1">packageSubpath,</span><span class="s3">\n  </span><span class="s1">base,</span><span class="s3">\n  </span><span class="s1">pattern,</span><span class="s3">\n  </span><span class="s1">internal,</span><span class="s3">\n  </span><span class="s1">isPathMap,</span><span class="s3">\n  </span><span class="s1">conditions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (typeof target === 'string') {</span><span class="s3">\n    </span><span class="s1">return resolvePackageTargetString(</span><span class="s3">\n      </span><span class="s1">target,</span><span class="s3">\n      </span><span class="s1">subpath,</span><span class="s3">\n      </span><span class="s1">packageSubpath,</span><span class="s3">\n      </span><span class="s1">packageJsonUrl,</span><span class="s3">\n      </span><span class="s1">base,</span><span class="s3">\n      </span><span class="s1">pattern,</span><span class="s3">\n      </span><span class="s1">internal,</span><span class="s3">\n      </span><span class="s1">isPathMap,</span><span class="s3">\n      </span><span class="s1">conditions</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (Array.isArray(target)) {</span><span class="s3">\n    </span><span class="s1">/** @type {Array&lt;unknown&gt;} */</span><span class="s3">\n    </span><span class="s1">const targetList = target;</span><span class="s3">\n    </span><span class="s1">if (targetList.length === 0) return null</span><span class="s3">\n\n    </span><span class="s1">/** @type {ErrnoException | null | undefined} */</span><span class="s3">\n    </span><span class="s1">let lastException;</span><span class="s3">\n    </span><span class="s1">let i = -1;</span><span class="s3">\n\n    </span><span class="s1">while (++i &lt; targetList.length) {</span><span class="s3">\n      </span><span class="s1">const targetItem = targetList[i];</span><span class="s3">\n      </span><span class="s1">/** @type {URL | null} */</span><span class="s3">\n      </span><span class="s1">let resolveResult;</span><span class="s3">\n      </span><span class="s1">try {</span><span class="s3">\n        </span><span class="s1">resolveResult = resolvePackageTarget(</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">targetItem,</span><span class="s3">\n          </span><span class="s1">subpath,</span><span class="s3">\n          </span><span class="s1">packageSubpath,</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">pattern,</span><span class="s3">\n          </span><span class="s1">internal,</span><span class="s3">\n          </span><span class="s1">isPathMap,</span><span class="s3">\n          </span><span class="s1">conditions</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">} catch (error) {</span><span class="s3">\n        </span><span class="s1">const exception = /** @type {ErrnoException} */ (error);</span><span class="s3">\n        </span><span class="s1">lastException = exception;</span><span class="s3">\n        </span><span class="s1">if (exception.code === 'ERR_INVALID_PACKAGE_TARGET') continue</span><span class="s3">\n        </span><span class="s1">throw error</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (resolveResult === undefined) continue</span><span class="s3">\n\n      </span><span class="s1">if (resolveResult === null) {</span><span class="s3">\n        </span><span class="s1">lastException = null;</span><span class="s3">\n        </span><span class="s1">continue</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">return resolveResult</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (lastException === undefined || lastException === null) {</span><span class="s3">\n      </span><span class="s1">return null</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">throw lastException</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof target === 'object' &amp;&amp; target !== null) {</span><span class="s3">\n    </span><span class="s1">const keys = Object.getOwnPropertyNames(target);</span><span class="s3">\n    </span><span class="s1">let i = -1;</span><span class="s3">\n\n    </span><span class="s1">while (++i &lt; keys.length) {</span><span class="s3">\n      </span><span class="s1">const key = keys[i];</span><span class="s3">\n      </span><span class="s1">if (isArrayIndex(key)) {</span><span class="s3">\n        </span><span class="s1">throw new ERR_INVALID_PACKAGE_CONFIG(</span><span class="s3">\n          </span><span class="s1">fileURLToPath(packageJsonUrl),</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">'</span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">cannot contain numeric property keys.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">i = -1;</span><span class="s3">\n\n    </span><span class="s1">while (++i &lt; keys.length) {</span><span class="s3">\n      </span><span class="s1">const key = keys[i];</span><span class="s3">\n      </span><span class="s1">if (key === 'default' || (conditions &amp;&amp; conditions.has(key))) {</span><span class="s3">\n        </span><span class="s1">// @ts-expect-error: indexable.</span><span class="s3">\n        </span><span class="s1">const conditionalTarget = /** @type {unknown} */ (target[key]);</span><span class="s3">\n        </span><span class="s1">const resolveResult = resolvePackageTarget(</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">conditionalTarget,</span><span class="s3">\n          </span><span class="s1">subpath,</span><span class="s3">\n          </span><span class="s1">packageSubpath,</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">pattern,</span><span class="s3">\n          </span><span class="s1">internal,</span><span class="s3">\n          </span><span class="s1">isPathMap,</span><span class="s3">\n          </span><span class="s1">conditions</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">if (resolveResult === undefined) continue</span><span class="s3">\n        </span><span class="s1">return resolveResult</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (target === null) {</span><span class="s3">\n    </span><span class="s1">return null</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">throw invalidPackageTarget(</span><span class="s3">\n    </span><span class="s1">packageSubpath,</span><span class="s3">\n    </span><span class="s1">target,</span><span class="s3">\n    </span><span class="s1">packageJsonUrl,</span><span class="s3">\n    </span><span class="s1">internal,</span><span class="s3">\n    </span><span class="s1">base</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {unknown} exports</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isConditionalExportsMainSugar(exports, packageJsonUrl, base) {</span><span class="s3">\n  </span><span class="s1">if (typeof exports === 'string' || Array.isArray(exports)) return true</span><span class="s3">\n  </span><span class="s1">if (typeof exports !== 'object' || exports === null) return false</span><span class="s3">\n\n  </span><span class="s1">const keys = Object.getOwnPropertyNames(exports);</span><span class="s3">\n  </span><span class="s1">let isConditionalSugar = false;</span><span class="s3">\n  </span><span class="s1">let i = 0;</span><span class="s3">\n  </span><span class="s1">let j = -1;</span><span class="s3">\n  </span><span class="s1">while (++j &lt; keys.length) {</span><span class="s3">\n    </span><span class="s1">const key = keys[j];</span><span class="s3">\n    </span><span class="s1">const curIsConditionalSugar = key === '' || key[0] !== '.';</span><span class="s3">\n    </span><span class="s1">if (i++ === 0) {</span><span class="s3">\n      </span><span class="s1">isConditionalSugar = curIsConditionalSugar;</span><span class="s3">\n    </span><span class="s1">} else if (isConditionalSugar !== curIsConditionalSugar) {</span><span class="s3">\n      </span><span class="s1">throw new ERR_INVALID_PACKAGE_CONFIG(</span><span class="s3">\n        </span><span class="s1">fileURLToPath(packageJsonUrl),</span><span class="s3">\n        </span><span class="s1">base,</span><span class="s3">\n        </span><span class="s1">'</span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">cannot contain some keys starting with </span><span class="s3">\\</span><span class="s1">'.</span><span class="s3">\\</span><span class="s1">' and some not.' +</span><span class="s3">\n          </span><span class="s1">' The exports object must either be an object of package subpath keys' +</span><span class="s3">\n          </span><span class="s1">' or an object of main entry condition name keys only.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return isConditionalSugar</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} match</span><span class="s3">\n </span><span class="s1">* @param {URL} pjsonUrl</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function emitTrailingSlashPatternDeprecation(match, pjsonUrl, base) {</span><span class="s3">\n  </span><span class="s1">const pjsonPath = fileURLToPath(pjsonUrl);</span><span class="s3">\n  </span><span class="s1">if (emittedPackageWarnings.has(pjsonPath + '|' + match)) return</span><span class="s3">\n  </span><span class="s1">emittedPackageWarnings.add(pjsonPath + '|' + match);</span><span class="s3">\n  </span><span class="s1">process.emitWarning(</span><span class="s3">\n    </span><span class="s1">`Use of deprecated trailing slash pattern mapping </span><span class="s3">\&quot;</span><span class="s1">${match}</span><span class="s3">\&quot; </span><span class="s1">in the ` +</span><span class="s3">\n      </span><span class="s1">`</span><span class="s3">\&quot;</span><span class="s1">exports</span><span class="s3">\&quot; </span><span class="s1">field module resolution of the package at ${pjsonPath}${</span><span class="s3">\n        </span><span class="s1">base ? ` imported from ${fileURLToPath(base)}` : ''</span><span class="s3">\n      </span><span class="s1">}. Mapping specifiers ending in </span><span class="s3">\&quot;</span><span class="s1">/</span><span class="s3">\&quot; </span><span class="s1">is no longer supported.`,</span><span class="s3">\n    </span><span class="s1">'DeprecationWarning',</span><span class="s3">\n    </span><span class="s1">'DEP0155'</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} packageJsonUrl</span><span class="s3">\n </span><span class="s1">* @param {string} packageSubpath</span><span class="s3">\n </span><span class="s1">* @param {Record&lt;string, unknown&gt;} packageConfig</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt; | undefined} conditions</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function packageExportsResolve(</span><span class="s3">\n  </span><span class="s1">packageJsonUrl,</span><span class="s3">\n  </span><span class="s1">packageSubpath,</span><span class="s3">\n  </span><span class="s1">packageConfig,</span><span class="s3">\n  </span><span class="s1">base,</span><span class="s3">\n  </span><span class="s1">conditions</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">let exports = packageConfig.exports;</span><span class="s3">\n\n  </span><span class="s1">if (isConditionalExportsMainSugar(exports, packageJsonUrl, base)) {</span><span class="s3">\n    </span><span class="s1">exports = {'.': exports};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">own.call(exports, packageSubpath) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!packageSubpath.includes('*') &amp;&amp;</span><span class="s3">\n    </span><span class="s1">!packageSubpath.endsWith('/')</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error: indexable.</span><span class="s3">\n    </span><span class="s1">const target = exports[packageSubpath];</span><span class="s3">\n    </span><span class="s1">const resolveResult = resolvePackageTarget(</span><span class="s3">\n      </span><span class="s1">packageJsonUrl,</span><span class="s3">\n      </span><span class="s1">target,</span><span class="s3">\n      </span><span class="s1">'',</span><span class="s3">\n      </span><span class="s1">packageSubpath,</span><span class="s3">\n      </span><span class="s1">base,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">conditions</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (resolveResult === null || resolveResult === undefined) {</span><span class="s3">\n      </span><span class="s1">throw exportsNotFound(packageSubpath, packageJsonUrl, base)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return resolveResult</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let bestMatch = '';</span><span class="s3">\n  </span><span class="s1">let bestMatchSubpath = '';</span><span class="s3">\n  </span><span class="s1">const keys = Object.getOwnPropertyNames(exports);</span><span class="s3">\n  </span><span class="s1">let i = -1;</span><span class="s3">\n\n  </span><span class="s1">while (++i &lt; keys.length) {</span><span class="s3">\n    </span><span class="s1">const key = keys[i];</span><span class="s3">\n    </span><span class="s1">const patternIndex = key.indexOf('*');</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">patternIndex !== -1 &amp;&amp;</span><span class="s3">\n      </span><span class="s1">packageSubpath.startsWith(key.slice(0, patternIndex))</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">// When this reaches EOL, this can throw at the top of the whole function:</span><span class="s3">\n      </span><span class="s1">//</span><span class="s3">\n      </span><span class="s1">// if (StringPrototypeEndsWith(packageSubpath, '/'))</span><span class="s3">\n      </span><span class="s1">//   throwInvalidSubpath(packageSubpath)</span><span class="s3">\n      </span><span class="s1">//</span><span class="s3">\n      </span><span class="s1">// To match </span><span class="s3">\&quot;</span><span class="s1">imports</span><span class="s3">\&quot; </span><span class="s1">and the spec.</span><span class="s3">\n      </span><span class="s1">if (packageSubpath.endsWith('/')) {</span><span class="s3">\n        </span><span class="s1">emitTrailingSlashPatternDeprecation(</span><span class="s3">\n          </span><span class="s1">packageSubpath,</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">base</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">const patternTrailer = key.slice(patternIndex + 1);</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">packageSubpath.length &gt;= key.length &amp;&amp;</span><span class="s3">\n        </span><span class="s1">packageSubpath.endsWith(patternTrailer) &amp;&amp;</span><span class="s3">\n        </span><span class="s1">patternKeyCompare(bestMatch, key) === 1 &amp;&amp;</span><span class="s3">\n        </span><span class="s1">key.lastIndexOf('*') === patternIndex</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">bestMatch = key;</span><span class="s3">\n        </span><span class="s1">bestMatchSubpath = packageSubpath.slice(</span><span class="s3">\n          </span><span class="s1">patternIndex,</span><span class="s3">\n          </span><span class="s1">packageSubpath.length - patternTrailer.length</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (bestMatch) {</span><span class="s3">\n    </span><span class="s1">// @ts-expect-error: indexable.</span><span class="s3">\n    </span><span class="s1">const target = /** @type {unknown} */ (exports[bestMatch]);</span><span class="s3">\n    </span><span class="s1">const resolveResult = resolvePackageTarget(</span><span class="s3">\n      </span><span class="s1">packageJsonUrl,</span><span class="s3">\n      </span><span class="s1">target,</span><span class="s3">\n      </span><span class="s1">bestMatchSubpath,</span><span class="s3">\n      </span><span class="s1">bestMatch,</span><span class="s3">\n      </span><span class="s1">base,</span><span class="s3">\n      </span><span class="s1">true,</span><span class="s3">\n      </span><span class="s1">false,</span><span class="s3">\n      </span><span class="s1">packageSubpath.endsWith('/'),</span><span class="s3">\n      </span><span class="s1">conditions</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n\n    </span><span class="s1">if (resolveResult === null || resolveResult === undefined) {</span><span class="s3">\n      </span><span class="s1">throw exportsNotFound(packageSubpath, packageJsonUrl, base)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return resolveResult</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">throw exportsNotFound(packageSubpath, packageJsonUrl, base)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} a</span><span class="s3">\n </span><span class="s1">* @param {string} b</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function patternKeyCompare(a, b) {</span><span class="s3">\n  </span><span class="s1">const aPatternIndex = a.indexOf('*');</span><span class="s3">\n  </span><span class="s1">const bPatternIndex = b.indexOf('*');</span><span class="s3">\n  </span><span class="s1">const baseLengthA = aPatternIndex === -1 ? a.length : aPatternIndex + 1;</span><span class="s3">\n  </span><span class="s1">const baseLengthB = bPatternIndex === -1 ? b.length : bPatternIndex + 1;</span><span class="s3">\n  </span><span class="s1">if (baseLengthA &gt; baseLengthB) return -1</span><span class="s3">\n  </span><span class="s1">if (baseLengthB &gt; baseLengthA) return 1</span><span class="s3">\n  </span><span class="s1">if (aPatternIndex === -1) return 1</span><span class="s3">\n  </span><span class="s1">if (bPatternIndex === -1) return -1</span><span class="s3">\n  </span><span class="s1">if (a.length &gt; b.length) return -1</span><span class="s3">\n  </span><span class="s1">if (b.length &gt; a.length) return 1</span><span class="s3">\n  </span><span class="s1">return 0</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} name</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt;} [conditions]</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function packageImportsResolve(name, base, conditions) {</span><span class="s3">\n  </span><span class="s1">if (name === '#' || name.startsWith('#/') || name.endsWith('/')) {</span><span class="s3">\n    </span><span class="s1">const reason = 'is not a valid internal imports specifier name';</span><span class="s3">\n    </span><span class="s1">throw new ERR_INVALID_MODULE_SPECIFIER(name, reason, fileURLToPath(base))</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/** @type {URL | undefined} */</span><span class="s3">\n  </span><span class="s1">let packageJsonUrl;</span><span class="s3">\n\n  </span><span class="s1">const packageConfig = getPackageScopeConfig(base);</span><span class="s3">\n\n  </span><span class="s1">if (packageConfig.exists) {</span><span class="s3">\n    </span><span class="s1">packageJsonUrl = pathToFileURL(packageConfig.pjsonPath);</span><span class="s3">\n    </span><span class="s1">const imports = packageConfig.imports;</span><span class="s3">\n    </span><span class="s1">if (imports) {</span><span class="s3">\n      </span><span class="s1">if (own.call(imports, name) &amp;&amp; !name.includes('*')) {</span><span class="s3">\n        </span><span class="s1">const resolveResult = resolvePackageTarget(</span><span class="s3">\n          </span><span class="s1">packageJsonUrl,</span><span class="s3">\n          </span><span class="s1">imports[name],</span><span class="s3">\n          </span><span class="s1">'',</span><span class="s3">\n          </span><span class="s1">name,</span><span class="s3">\n          </span><span class="s1">base,</span><span class="s3">\n          </span><span class="s1">false,</span><span class="s3">\n          </span><span class="s1">true,</span><span class="s3">\n          </span><span class="s1">false,</span><span class="s3">\n          </span><span class="s1">conditions</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">if (resolveResult !== null &amp;&amp; resolveResult !== undefined) {</span><span class="s3">\n          </span><span class="s1">return resolveResult</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">let bestMatch = '';</span><span class="s3">\n        </span><span class="s1">let bestMatchSubpath = '';</span><span class="s3">\n        </span><span class="s1">const keys = Object.getOwnPropertyNames(imports);</span><span class="s3">\n        </span><span class="s1">let i = -1;</span><span class="s3">\n\n        </span><span class="s1">while (++i &lt; keys.length) {</span><span class="s3">\n          </span><span class="s1">const key = keys[i];</span><span class="s3">\n          </span><span class="s1">const patternIndex = key.indexOf('*');</span><span class="s3">\n\n          </span><span class="s1">if (patternIndex !== -1 &amp;&amp; name.startsWith(key.slice(0, -1))) {</span><span class="s3">\n            </span><span class="s1">const patternTrailer = key.slice(patternIndex + 1);</span><span class="s3">\n            </span><span class="s1">if (</span><span class="s3">\n              </span><span class="s1">name.length &gt;= key.length &amp;&amp;</span><span class="s3">\n              </span><span class="s1">name.endsWith(patternTrailer) &amp;&amp;</span><span class="s3">\n              </span><span class="s1">patternKeyCompare(bestMatch, key) === 1 &amp;&amp;</span><span class="s3">\n              </span><span class="s1">key.lastIndexOf('*') === patternIndex</span><span class="s3">\n            </span><span class="s1">) {</span><span class="s3">\n              </span><span class="s1">bestMatch = key;</span><span class="s3">\n              </span><span class="s1">bestMatchSubpath = name.slice(</span><span class="s3">\n                </span><span class="s1">patternIndex,</span><span class="s3">\n                </span><span class="s1">name.length - patternTrailer.length</span><span class="s3">\n              </span><span class="s1">);</span><span class="s3">\n            </span><span class="s1">}</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">if (bestMatch) {</span><span class="s3">\n          </span><span class="s1">const target = imports[bestMatch];</span><span class="s3">\n          </span><span class="s1">const resolveResult = resolvePackageTarget(</span><span class="s3">\n            </span><span class="s1">packageJsonUrl,</span><span class="s3">\n            </span><span class="s1">target,</span><span class="s3">\n            </span><span class="s1">bestMatchSubpath,</span><span class="s3">\n            </span><span class="s1">bestMatch,</span><span class="s3">\n            </span><span class="s1">base,</span><span class="s3">\n            </span><span class="s1">true,</span><span class="s3">\n            </span><span class="s1">true,</span><span class="s3">\n            </span><span class="s1">false,</span><span class="s3">\n            </span><span class="s1">conditions</span><span class="s3">\n          </span><span class="s1">);</span><span class="s3">\n\n          </span><span class="s1">if (resolveResult !== null &amp;&amp; resolveResult !== undefined) {</span><span class="s3">\n            </span><span class="s1">return resolveResult</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">throw importNotDefined(name, packageJsonUrl, base)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Note: In Node.js, `getPackageType` is here.</span><span class="s3">\n</span><span class="s1">// To prevent a circular dependency, we move it to</span><span class="s3">\n</span><span class="s1">// `resolve-get-package-type.js`.</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function parsePackageName(specifier, base) {</span><span class="s3">\n  </span><span class="s1">let separatorIndex = specifier.indexOf('/');</span><span class="s3">\n  </span><span class="s1">let validPackageName = true;</span><span class="s3">\n  </span><span class="s1">let isScoped = false;</span><span class="s3">\n  </span><span class="s1">if (specifier[0] === '@') {</span><span class="s3">\n    </span><span class="s1">isScoped = true;</span><span class="s3">\n    </span><span class="s1">if (separatorIndex === -1 || specifier.length === 0) {</span><span class="s3">\n      </span><span class="s1">validPackageName = false;</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">separatorIndex = specifier.indexOf('/', separatorIndex + 1);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const packageName =</span><span class="s3">\n    </span><span class="s1">separatorIndex === -1 ? specifier : specifier.slice(0, separatorIndex);</span><span class="s3">\n\n  </span><span class="s1">// Package name cannot have leading . and cannot have percent-encoding or</span><span class="s3">\n  </span><span class="s1">// </span><span class="s3">\\\\ </span><span class="s1">separators.</span><span class="s3">\n  </span><span class="s1">if (invalidPackageNameRegEx.exec(packageName) !== null) {</span><span class="s3">\n    </span><span class="s1">validPackageName = false;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (!validPackageName) {</span><span class="s3">\n    </span><span class="s1">throw new ERR_INVALID_MODULE_SPECIFIER(</span><span class="s3">\n      </span><span class="s1">specifier,</span><span class="s3">\n      </span><span class="s1">'is not a valid package name',</span><span class="s3">\n      </span><span class="s1">fileURLToPath(base)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const packageSubpath =</span><span class="s3">\n    </span><span class="s1">'.' + (separatorIndex === -1 ? '' : specifier.slice(separatorIndex));</span><span class="s3">\n\n  </span><span class="s1">return {packageName, packageSubpath, isScoped}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt; | undefined} conditions</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function packageResolve(specifier, base, conditions) {</span><span class="s3">\n  </span><span class="s1">if (builtinModules.includes(specifier)) {</span><span class="s3">\n    </span><span class="s1">return new URL('node:' + specifier)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">const {packageName, packageSubpath, isScoped} = parsePackageName(</span><span class="s3">\n    </span><span class="s1">specifier,</span><span class="s3">\n    </span><span class="s1">base</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">// ResolveSelf</span><span class="s3">\n  </span><span class="s1">const packageConfig = getPackageScopeConfig(base);</span><span class="s3">\n\n  </span><span class="s1">// Can’t test.</span><span class="s3">\n  </span><span class="s1">/* c8 ignore next 16 */</span><span class="s3">\n  </span><span class="s1">if (packageConfig.exists) {</span><span class="s3">\n    </span><span class="s1">const packageJsonUrl = pathToFileURL(packageConfig.pjsonPath);</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">packageConfig.name === packageName &amp;&amp;</span><span class="s3">\n      </span><span class="s1">packageConfig.exports !== undefined &amp;&amp;</span><span class="s3">\n      </span><span class="s1">packageConfig.exports !== null</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return packageExportsResolve(</span><span class="s3">\n        </span><span class="s1">packageJsonUrl,</span><span class="s3">\n        </span><span class="s1">packageSubpath,</span><span class="s3">\n        </span><span class="s1">packageConfig,</span><span class="s3">\n        </span><span class="s1">base,</span><span class="s3">\n        </span><span class="s1">conditions</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let packageJsonUrl = new URL(</span><span class="s3">\n    </span><span class="s1">'./node_modules/' + packageName + '/package.json',</span><span class="s3">\n    </span><span class="s1">base</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">let packageJsonPath = fileURLToPath(packageJsonUrl);</span><span class="s3">\n  </span><span class="s1">/** @type {string} */</span><span class="s3">\n  </span><span class="s1">let lastPath;</span><span class="s3">\n  </span><span class="s1">do {</span><span class="s3">\n    </span><span class="s1">const stat = tryStatSync(packageJsonPath.slice(0, -13));</span><span class="s3">\n    </span><span class="s1">if (!stat.isDirectory()) {</span><span class="s3">\n      </span><span class="s1">lastPath = packageJsonPath;</span><span class="s3">\n      </span><span class="s1">packageJsonUrl = new URL(</span><span class="s3">\n        </span><span class="s1">(isScoped ? '../../../../node_modules/' : '../../../node_modules/') +</span><span class="s3">\n          </span><span class="s1">packageName +</span><span class="s3">\n          </span><span class="s1">'/package.json',</span><span class="s3">\n        </span><span class="s1">packageJsonUrl</span><span class="s3">\n      </span><span class="s1">);</span><span class="s3">\n      </span><span class="s1">packageJsonPath = fileURLToPath(packageJsonUrl);</span><span class="s3">\n      </span><span class="s1">continue</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Package match.</span><span class="s3">\n    </span><span class="s1">const packageConfig = getPackageConfig(packageJsonPath, specifier, base);</span><span class="s3">\n    </span><span class="s1">if (packageConfig.exports !== undefined &amp;&amp; packageConfig.exports !== null) {</span><span class="s3">\n      </span><span class="s1">return packageExportsResolve(</span><span class="s3">\n        </span><span class="s1">packageJsonUrl,</span><span class="s3">\n        </span><span class="s1">packageSubpath,</span><span class="s3">\n        </span><span class="s1">packageConfig,</span><span class="s3">\n        </span><span class="s1">base,</span><span class="s3">\n        </span><span class="s1">conditions</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (packageSubpath === '.') {</span><span class="s3">\n      </span><span class="s1">return legacyMainResolve(packageJsonUrl, packageConfig, base)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return new URL(packageSubpath, packageJsonUrl)</span><span class="s3">\n    </span><span class="s1">// Cross-platform root check.</span><span class="s3">\n  </span><span class="s1">} while (packageJsonPath.length !== lastPath.length)</span><span class="s3">\n\n  </span><span class="s1">throw new ERR_MODULE_NOT_FOUND(packageName, fileURLToPath(base))</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isRelativeSpecifier(specifier) {</span><span class="s3">\n  </span><span class="s1">if (specifier[0] === '.') {</span><span class="s3">\n    </span><span class="s1">if (specifier.length === 1 || specifier[1] === '/') return true</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">specifier[1] === '.' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">(specifier.length === 2 || specifier[2] === '/')</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return true</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @returns {boolean}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function shouldBeTreatedAsRelativeOrAbsolutePath(specifier) {</span><span class="s3">\n  </span><span class="s1">if (specifier === '') return false</span><span class="s3">\n  </span><span class="s1">if (specifier[0] === '/') return true</span><span class="s3">\n  </span><span class="s1">return isRelativeSpecifier(specifier)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* The “Resolver Algorithm Specification” as detailed in the Node docs (which is</span><span class="s3">\n </span><span class="s1">* sync and slightly lower-level than `resolve`).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">*   `/example.js`, `./example.js`, `../example.js`, `some-package`, `fs`, etc.</span><span class="s3">\n </span><span class="s1">* @param {URL} base</span><span class="s3">\n </span><span class="s1">*   Full URL (to a file) that `specifier` is resolved relative from.</span><span class="s3">\n </span><span class="s1">* @param {Set&lt;string&gt;} [conditions]</span><span class="s3">\n </span><span class="s1">*   Conditions.</span><span class="s3">\n </span><span class="s1">* @param {boolean} [preserveSymlinks]</span><span class="s3">\n </span><span class="s1">*   Keep symlinks instead of resolving them.</span><span class="s3">\n </span><span class="s1">* @returns {URL}</span><span class="s3">\n </span><span class="s1">*   A URL object to the found thing.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function moduleResolve(specifier, base, conditions, preserveSymlinks) {</span><span class="s3">\n  </span><span class="s1">const protocol = base.protocol;</span><span class="s3">\n  </span><span class="s1">const isRemote = protocol === 'http:' || protocol === 'https:';</span><span class="s3">\n  </span><span class="s1">// Order swapped from spec for minor perf gain.</span><span class="s3">\n  </span><span class="s1">// Ok since relative URLs cannot parse as URLs.</span><span class="s3">\n  </span><span class="s1">/** @type {URL | undefined} */</span><span class="s3">\n  </span><span class="s1">let resolved;</span><span class="s3">\n\n  </span><span class="s1">if (shouldBeTreatedAsRelativeOrAbsolutePath(specifier)) {</span><span class="s3">\n    </span><span class="s1">resolved = new URL(specifier, base);</span><span class="s3">\n  </span><span class="s1">} else if (!isRemote &amp;&amp; specifier[0] === '#') {</span><span class="s3">\n    </span><span class="s1">resolved = packageImportsResolve(specifier, base, conditions);</span><span class="s3">\n  </span><span class="s1">} else {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">resolved = new URL(specifier);</span><span class="s3">\n    </span><span class="s1">} catch {</span><span class="s3">\n      </span><span class="s1">if (!isRemote) {</span><span class="s3">\n        </span><span class="s1">resolved = packageResolve(specifier, base, conditions);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">assert(resolved !== undefined, 'expected to be defined');</span><span class="s3">\n\n  </span><span class="s1">if (resolved.protocol !== 'file:') {</span><span class="s3">\n    </span><span class="s1">return resolved</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return finalizeResolution(resolved, base, preserveSymlinks)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @param {URL | undefined} parsed</span><span class="s3">\n </span><span class="s1">* @param {URL | undefined} parsedParentURL</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function checkIfDisallowedImport(specifier, parsed, parsedParentURL) {</span><span class="s3">\n  </span><span class="s1">if (parsedParentURL) {</span><span class="s3">\n    </span><span class="s1">// Avoid accessing the `protocol` property due to the lazy getters.</span><span class="s3">\n    </span><span class="s1">const parentProtocol = parsedParentURL.protocol;</span><span class="s3">\n\n    </span><span class="s1">if (parentProtocol === 'http:' || parentProtocol === 'https:') {</span><span class="s3">\n      </span><span class="s1">if (shouldBeTreatedAsRelativeOrAbsolutePath(specifier)) {</span><span class="s3">\n        </span><span class="s1">// Avoid accessing the `protocol` property due to the lazy getters.</span><span class="s3">\n        </span><span class="s1">const parsedProtocol = parsed?.protocol;</span><span class="s3">\n\n        </span><span class="s1">// `data:` and `blob:` disallowed due to allowing file: access via</span><span class="s3">\n        </span><span class="s1">// indirection</span><span class="s3">\n        </span><span class="s1">if (</span><span class="s3">\n          </span><span class="s1">parsedProtocol &amp;&amp;</span><span class="s3">\n          </span><span class="s1">parsedProtocol !== 'https:' &amp;&amp;</span><span class="s3">\n          </span><span class="s1">parsedProtocol !== 'http:'</span><span class="s3">\n        </span><span class="s1">) {</span><span class="s3">\n          </span><span class="s1">throw new ERR_NETWORK_IMPORT_DISALLOWED(</span><span class="s3">\n            </span><span class="s1">specifier,</span><span class="s3">\n            </span><span class="s1">parsedParentURL,</span><span class="s3">\n            </span><span class="s1">'remote imports cannot import from a local location.'</span><span class="s3">\n          </span><span class="s1">)</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n\n        </span><span class="s1">return {url: parsed?.href || ''}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (builtinModules.includes(specifier)) {</span><span class="s3">\n        </span><span class="s1">throw new ERR_NETWORK_IMPORT_DISALLOWED(</span><span class="s3">\n          </span><span class="s1">specifier,</span><span class="s3">\n          </span><span class="s1">parsedParentURL,</span><span class="s3">\n          </span><span class="s1">'remote imports cannot import from a local location.'</span><span class="s3">\n        </span><span class="s1">)</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">throw new ERR_NETWORK_IMPORT_DISALLOWED(</span><span class="s3">\n        </span><span class="s1">specifier,</span><span class="s3">\n        </span><span class="s1">parsedParentURL,</span><span class="s3">\n        </span><span class="s1">'only relative and absolute specifiers are supported.'</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">// Note: this is from:</span><span class="s3">\n</span><span class="s1">// &lt;https://github.com/nodejs/node/blob/3e74590/lib/internal/url.js#L687&gt;</span><span class="s3">\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Checks if a value has the shape of a WHATWG URL object.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* Using a symbol or instanceof would not be able to recognize URL objects</span><span class="s3">\n </span><span class="s1">* coming from other implementations (e.g. in Electron), so instead we are</span><span class="s3">\n </span><span class="s1">* checking some well known properties for a lack of a better test.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* We use `href` and `protocol` as they are the only properties that are</span><span class="s3">\n </span><span class="s1">* easy to retrieve and calculate due to the lazy nature of the getters.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @template {unknown} Value</span><span class="s3">\n </span><span class="s1">* @param {Value} self</span><span class="s3">\n </span><span class="s1">* @returns {Value is URL}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function isURL(self) {</span><span class="s3">\n  </span><span class="s1">return Boolean(</span><span class="s3">\n    </span><span class="s1">self &amp;&amp;</span><span class="s3">\n      </span><span class="s1">typeof self === 'object' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">'href' in self &amp;&amp;</span><span class="s3">\n      </span><span class="s1">typeof self.href === 'string' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">'protocol' in self &amp;&amp;</span><span class="s3">\n      </span><span class="s1">typeof self.protocol === 'string' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">self.href &amp;&amp;</span><span class="s3">\n      </span><span class="s1">self.protocol</span><span class="s3">\n  </span><span class="s1">)</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Validate user-input in `context` supplied by a custom loader.</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {unknown} parentURL</span><span class="s3">\n </span><span class="s1">* @returns {asserts parentURL is URL | string | undefined}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function throwIfInvalidParentURL(parentURL) {</span><span class="s3">\n  </span><span class="s1">if (parentURL === undefined) {</span><span class="s3">\n    </span><span class="s1">return // Main entry point, so no parent</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof parentURL !== 'string' &amp;&amp; !isURL(parentURL)) {</span><span class="s3">\n    </span><span class="s1">throw new codes.ERR_INVALID_ARG_TYPE(</span><span class="s3">\n      </span><span class="s1">'parentURL',</span><span class="s3">\n      </span><span class="s1">['string', 'URL'],</span><span class="s3">\n      </span><span class="s1">parentURL</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL} url</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function throwIfUnsupportedURLProtocol(url) {</span><span class="s3">\n  </span><span class="s1">// Avoid accessing the `protocol` property due to the lazy getters.</span><span class="s3">\n  </span><span class="s1">const protocol = url.protocol;</span><span class="s3">\n\n  </span><span class="s1">if (protocol !== 'file:' &amp;&amp; protocol !== 'data:' &amp;&amp; protocol !== 'node:') {</span><span class="s3">\n    </span><span class="s1">throw new ERR_UNSUPPORTED_ESM_URL_SCHEME(url)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {URL | undefined} parsed</span><span class="s3">\n </span><span class="s1">* @param {boolean} experimentalNetworkImports</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function throwIfUnsupportedURLScheme(parsed, experimentalNetworkImports) {</span><span class="s3">\n  </span><span class="s1">// Avoid accessing the `protocol` property due to the lazy getters.</span><span class="s3">\n  </span><span class="s1">const protocol = parsed?.protocol;</span><span class="s3">\n\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">protocol &amp;&amp;</span><span class="s3">\n    </span><span class="s1">protocol !== 'file:' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">protocol !== 'data:' &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(!experimentalNetworkImports ||</span><span class="s3">\n      </span><span class="s1">(protocol !== 'https:' &amp;&amp; protocol !== 'http:'))</span><span class="s3">\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">throw new ERR_UNSUPPORTED_ESM_URL_SCHEME(</span><span class="s3">\n      </span><span class="s1">parsed,</span><span class="s3">\n      </span><span class="s1">['file', 'data'].concat(</span><span class="s3">\n        </span><span class="s1">experimentalNetworkImports ? ['https', 'http'] : []</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">* @param {{parentURL?: string, conditions?: Array&lt;string&gt;}} context</span><span class="s3">\n </span><span class="s1">* @returns {{url: string, format?: string | null}}</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function defaultResolve(specifier, context = {}) {</span><span class="s3">\n  </span><span class="s1">const {parentURL} = context;</span><span class="s3">\n  </span><span class="s1">assert(parentURL !== undefined, 'expected `parentURL` to be defined');</span><span class="s3">\n  </span><span class="s1">throwIfInvalidParentURL(parentURL);</span><span class="s3">\n\n  </span><span class="s1">/** @type {URL | undefined} */</span><span class="s3">\n  </span><span class="s1">let parsedParentURL;</span><span class="s3">\n  </span><span class="s1">if (parentURL) {</span><span class="s3">\n    </span><span class="s1">try {</span><span class="s3">\n      </span><span class="s1">parsedParentURL = new URL(parentURL);</span><span class="s3">\n    </span><span class="s1">} catch {</span><span class="s3">\n      </span><span class="s1">// Ignore exception</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">/** @type {URL | undefined} */</span><span class="s3">\n  </span><span class="s1">let parsed;</span><span class="s3">\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">parsed = shouldBeTreatedAsRelativeOrAbsolutePath(specifier)</span><span class="s3">\n      </span><span class="s1">? new URL(specifier, parsedParentURL)</span><span class="s3">\n      </span><span class="s1">: new URL(specifier);</span><span class="s3">\n\n    </span><span class="s1">// Avoid accessing the `protocol` property due to the lazy getters.</span><span class="s3">\n    </span><span class="s1">const protocol = parsed.protocol;</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">protocol === 'data:' ||</span><span class="s3">\n      </span><span class="s1">(experimentalNetworkImports &amp;&amp;</span><span class="s3">\n        </span><span class="s1">(protocol === 'https:' || protocol === 'http:'))</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return {url: parsed.href, format: null}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">} catch {</span><span class="s3">\n    </span><span class="s1">// Ignore exception</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// There are multiple deep branches that can either throw or return; instead</span><span class="s3">\n  </span><span class="s1">// of duplicating that deeply nested logic for the possible returns, DRY and</span><span class="s3">\n  </span><span class="s1">// check for a return. This seems the least gnarly.</span><span class="s3">\n  </span><span class="s1">const maybeReturn = checkIfDisallowedImport(</span><span class="s3">\n    </span><span class="s1">specifier,</span><span class="s3">\n    </span><span class="s1">parsed,</span><span class="s3">\n    </span><span class="s1">parsedParentURL</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">if (maybeReturn) return maybeReturn</span><span class="s3">\n\n  </span><span class="s1">// This must come after checkIfDisallowedImport</span><span class="s3">\n  </span><span class="s1">if (parsed &amp;&amp; parsed.protocol === 'node:') return {url: specifier}</span><span class="s3">\n\n  </span><span class="s1">throwIfUnsupportedURLScheme(parsed, experimentalNetworkImports);</span><span class="s3">\n\n  </span><span class="s1">const conditions = getConditionsSet(context.conditions);</span><span class="s3">\n\n  </span><span class="s1">const url = moduleResolve(specifier, new URL(parentURL), conditions, false);</span><span class="s3">\n\n  </span><span class="s1">throwIfUnsupportedURLProtocol(url);</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">// Do NOT cast `url` to a string: that will work even when there are real</span><span class="s3">\n    </span><span class="s1">// problems, silencing them</span><span class="s3">\n    </span><span class="s1">url: url.href,</span><span class="s3">\n    </span><span class="s1">format: defaultGetFormatWithoutErrors(url, {parentURL})</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* @typedef {import('./lib/errors.js').ErrnoException} ErrnoException</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Match `import.meta.resolve` except that `parent` is required (you can pass</span><span class="s3">\n </span><span class="s1">* `import.meta.url`).</span><span class="s3">\n </span><span class="s1">*</span><span class="s3">\n </span><span class="s1">* @param {string} specifier</span><span class="s3">\n </span><span class="s1">*   The module specifier to resolve relative to parent</span><span class="s3">\n </span><span class="s1">*   (`/example.js`, `./example.js`, `../example.js`, `some-package`, `fs`,</span><span class="s3">\n </span><span class="s1">*   etc).</span><span class="s3">\n </span><span class="s1">* @param {string} parent</span><span class="s3">\n </span><span class="s1">*   The absolute parent module URL to resolve from.</span><span class="s3">\n </span><span class="s1">*   You must pass `import.meta.url` or something else.</span><span class="s3">\n </span><span class="s1">* @returns {string}</span><span class="s3">\n </span><span class="s1">*   Returns a string to a full `file:`, `data:`, or `node:` URL</span><span class="s3">\n </span><span class="s1">*   to the found thing.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function resolve(specifier, parent) {</span><span class="s3">\n  </span><span class="s1">if (!parent) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">'Please pass `parent`: `import-meta-resolve` cannot ponyfill that'</span><span class="s3">\n    </span><span class="s1">)</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">try {</span><span class="s3">\n    </span><span class="s1">return defaultResolve(specifier, {parentURL: parent}).url</span><span class="s3">\n  </span><span class="s1">} catch (error) {</span><span class="s3">\n    </span><span class="s1">const exception = /** @type {ErrnoException} */ (error);</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">exception.code === 'ERR_UNSUPPORTED_DIR_IMPORT' &amp;&amp;</span><span class="s3">\n      </span><span class="s1">typeof exception.url === 'string'</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return exception.url</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">throw error</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export { moduleResolve, resolve };</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;;;;;;;;AAoFA,SAAAA,QAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,OAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAE,IAAA;EAAA,MAAAF,IAAA,GAAAG,uBAAA,CAAAF,OAAA;EAAAC,GAAA,YAAAA,CAAA;IAAA,OAAAF,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAI,SAAA;EAAA,MAAAJ,IAAA,GAAAC,OAAA;EAAAG,QAAA,YAAAA,CAAA;IAAA,OAAAJ,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAK,KAAA;EAAA,MAAAL,IAAA,GAAAC,OAAA;EAAAI,IAAA,YAAAA,CAAA;IAAA,OAAAL,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAM,MAAA;EAAA,MAAAN,IAAA,GAAAC,OAAA;EAAAK,KAAA,YAAAA,CAAA;IAAA,OAAAN,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAO,QAAA;EAAA,MAAAP,IAAA,GAAAC,OAAA;EAAAM,OAAA,YAAAA,CAAA;IAAA,OAAAP,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAQ,GAAA;EAAA,MAAAR,IAAA,GAAAC,OAAA;EAAAO,EAAA,YAAAA,CAAA;IAAA,OAAAR,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAS,MAAA;EAAA,MAAAT,IAAA,GAAAC,OAAA;EAAAQ,KAAA,YAAAA,CAAA;IAAA,OAAAT,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAAuC,SAAAU,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAR,wBAAAY,GAAA,EAAAJ,WAAA,SAAAA,WAAA,IAAAI,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAG,KAAA,GAAAR,wBAAA,CAAAC,WAAA,OAAAO,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAJ,GAAA,YAAAG,KAAA,CAAAE,GAAA,CAAAL,GAAA,SAAAM,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAX,GAAA,QAAAW,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAd,GAAA,EAAAW,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAV,GAAA,EAAAW,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAX,GAAA,CAAAW,GAAA,SAAAL,MAAA,CAAAJ,OAAA,GAAAF,GAAA,MAAAG,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAAhB,GAAA,EAAAM,MAAA,YAAAA,MAAA;AAcvC,MAAMW,SAAS,GAAGC,SAAMA,CAAC,CAACC,QAAQ,KAAK,OAAO;AAE9C,MAAMC,KAAK,GAAG,CAAC,CAAC,CAACP,cAAc;AAE/B,MAAMQ,WAAW,GAAG,oBAAoB;AAExC,MAAMC,MAAM,GAAG,IAAIC,GAAG,CAAC,CACrB,QAAQ,EACR,UAAU,EACV,QAAQ,EACR,QAAQ,EAER,UAAU,EACV,QAAQ,EACR,SAAS,EACT,QAAQ,EACR,QAAQ,CACT,CAAC;AAEF,MAAMC,KAAK,GAAG,CAAC,CAAC;AAahB,SAASC,UAAUA,CAACC,KAAK,EAAEC,IAAI,GAAG,KAAK,EAAE;EACvC,OAAOD,KAAK,CAACE,MAAM,GAAG,CAAC,GACnBF,KAAK,CAACG,IAAI,CAAE,IAAGF,IAAK,GAAE,CAAC,GACtB,GAAED,KAAK,CAACI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACD,IAAI,CAAC,IAAI,CAAE,KAAIF,IAAK,IAAGD,KAAK,CAACA,KAAK,CAACE,MAAM,GAAG,CAAC,CAAE,EAAC;AAC5E;AAGA,MAAMG,QAAQ,GAAG,IAAIC,GAAG,CAAC,CAAC;AAC1B,MAAMC,kBAAkB,GAAG,kBAAkB;AAE7C,IAAIC,mBAAmB;AAEvBV,KAAK,CAACW,oBAAoB,GAAGC,WAAW,CACtC,sBAAsB,EAMtB,CAACC,IAAI,EAAEC,QAAQ,EAAEC,MAAM,KAAK;EAC1BC,QAAKA,CAAC,CAAC,OAAOH,IAAI,KAAK,QAAQ,EAAE,yBAAyB,CAAC;EAC3D,IAAI,CAACI,KAAK,CAACC,OAAO,CAACJ,QAAQ,CAAC,EAAE;IAC5BA,QAAQ,GAAG,CAACA,QAAQ,CAAC;EACvB;EAEA,IAAIK,OAAO,GAAG,MAAM;EACpB,IAAIN,IAAI,CAACO,QAAQ,CAAC,WAAW,CAAC,EAAE;IAE9BD,OAAO,IAAK,GAAEN,IAAK,GAAE;EACvB,CAAC,MAAM;IACL,MAAMV,IAAI,GAAGU,IAAI,CAACQ,QAAQ,CAAC,GAAG,CAAC,GAAG,UAAU,GAAG,UAAU;IACzDF,OAAO,IAAK,IAAGN,IAAK,KAAIV,IAAK,GAAE;EACjC;EAEAgB,OAAO,IAAI,UAAU;EAGrB,MAAMG,KAAK,GAAG,EAAE;EAEhB,MAAMC,SAAS,GAAG,EAAE;EAEpB,MAAMC,KAAK,GAAG,EAAE;EAEhB,KAAK,MAAMC,KAAK,IAAIX,QAAQ,EAAE;IAC5BE,QAAKA,CAAC,CACJ,OAAOS,KAAK,KAAK,QAAQ,EACzB,gDACF,CAAC;IAED,IAAI3B,MAAM,CAAClB,GAAG,CAAC6C,KAAK,CAAC,EAAE;MACrBH,KAAK,CAACI,IAAI,CAACD,KAAK,CAACE,WAAW,CAAC,CAAC,CAAC;IACjC,CAAC,MAAM,IAAI9B,WAAW,CAAC+B,IAAI,CAACH,KAAK,CAAC,KAAK,IAAI,EAAE;MAC3CT,QAAKA,CAAC,CACJS,KAAK,KAAK,QAAQ,EAClB,kDACF,CAAC;MACDD,KAAK,CAACE,IAAI,CAACD,KAAK,CAAC;IACnB,CAAC,MAAM;MACLF,SAAS,CAACG,IAAI,CAACD,KAAK,CAAC;IACvB;EACF;EAIA,IAAIF,SAAS,CAACnB,MAAM,GAAG,CAAC,EAAE;IACxB,MAAMyB,GAAG,GAAGP,KAAK,CAACQ,OAAO,CAAC,QAAQ,CAAC;IACnC,IAAID,GAAG,KAAK,CAAC,CAAC,EAAE;MACdP,KAAK,CAAChB,KAAK,CAACuB,GAAG,EAAE,CAAC,CAAC;MACnBN,SAAS,CAACG,IAAI,CAAC,QAAQ,CAAC;IAC1B;EACF;EAEA,IAAIJ,KAAK,CAAClB,MAAM,GAAG,CAAC,EAAE;IACpBe,OAAO,IAAK,GAAEG,KAAK,CAAClB,MAAM,GAAG,CAAC,GAAG,aAAa,GAAG,SAAU,IAAGH,UAAU,CACtEqB,KAAK,EACL,IACF,CAAE,EAAC;IACH,IAAIC,SAAS,CAACnB,MAAM,GAAG,CAAC,IAAIoB,KAAK,CAACpB,MAAM,GAAG,CAAC,EAAEe,OAAO,IAAI,MAAM;EACjE;EAEA,IAAII,SAAS,CAACnB,MAAM,GAAG,CAAC,EAAE;IACxBe,OAAO,IAAK,kBAAiBlB,UAAU,CAACsB,SAAS,EAAE,IAAI,CAAE,EAAC;IAC1D,IAAIC,KAAK,CAACpB,MAAM,GAAG,CAAC,EAAEe,OAAO,IAAI,MAAM;EACzC;EAEA,IAAIK,KAAK,CAACpB,MAAM,GAAG,CAAC,EAAE;IACpB,IAAIoB,KAAK,CAACpB,MAAM,GAAG,CAAC,EAAE;MACpBe,OAAO,IAAK,UAASlB,UAAU,CAACuB,KAAK,EAAE,IAAI,CAAE,EAAC;IAChD,CAAC,MAAM;MACL,IAAIA,KAAK,CAAC,CAAC,CAAC,CAACG,WAAW,CAAC,CAAC,KAAKH,KAAK,CAAC,CAAC,CAAC,EAAEL,OAAO,IAAI,KAAK;MACzDA,OAAO,IAAK,GAAEK,KAAK,CAAC,CAAC,CAAE,EAAC;IAC1B;EACF;EAEAL,OAAO,IAAK,cAAaY,qBAAqB,CAAChB,MAAM,CAAE,EAAC;EAExD,OAAOI,OAAO;AAChB,CAAC,EACDa,SACF,CAAC;AAEDhC,KAAK,CAACiC,4BAA4B,GAAGrB,WAAW,CAC9C,8BAA8B,EAM9B,CAACsB,OAAO,EAAEC,MAAM,EAAEC,IAAI,GAAGC,SAAS,KAAK;EACrC,OAAQ,mBAAkBH,OAAQ,KAAIC,MAAO,GAC3CC,IAAI,GAAI,kBAAiBA,IAAK,EAAC,GAAG,EACnC,EAAC;AACJ,CAAC,EACDJ,SACF,CAAC;AAEDhC,KAAK,CAACsC,0BAA0B,GAAG1B,WAAW,CAC5C,4BAA4B,EAM5B,CAAC2B,IAAI,EAAEH,IAAI,EAAEjB,OAAO,KAAK;EACvB,OAAQ,0BAAyBoB,IAAK,GACpCH,IAAI,GAAI,oBAAmBA,IAAK,EAAC,GAAG,EACrC,GAAEjB,OAAO,GAAI,KAAIA,OAAQ,EAAC,GAAG,EAAG,EAAC;AACpC,CAAC,EACDqB,KACF,CAAC;AAEDxC,KAAK,CAACyC,0BAA0B,GAAG7B,WAAW,CAC5C,4BAA4B,EAQ5B,CAAC8B,OAAO,EAAEvD,GAAG,EAAEwD,MAAM,EAAEC,QAAQ,GAAG,KAAK,EAAER,IAAI,GAAGC,SAAS,KAAK;EAC5D,MAAMQ,QAAQ,GACZ,OAAOF,MAAM,KAAK,QAAQ,IAC1B,CAACC,QAAQ,IACTD,MAAM,CAACvC,MAAM,GAAG,CAAC,IACjB,CAACuC,MAAM,CAACG,UAAU,CAAC,IAAI,CAAC;EAC1B,IAAI3D,GAAG,KAAK,GAAG,EAAE;IACf6B,QAAKA,CAAC,CAAC4B,QAAQ,KAAK,KAAK,CAAC;IAC1B,OACG,iCAAgCG,IAAI,CAACC,SAAS,CAACL,MAAM,CAAE,WAAU,GACjE,yBAAwBD,OAAQ,eAC/BN,IAAI,GAAI,kBAAiBA,IAAK,EAAC,GAAG,EACnC,GAAES,QAAQ,GAAG,gCAAgC,GAAG,EAAG,EAAC;EAEzD;EAEA,OAAQ,YACND,QAAQ,GAAG,SAAS,GAAG,SACxB,YAAWG,IAAI,CAACC,SAAS,CACxBL,MACF,CAAE,iBAAgBxD,GAAI,2BAA0BuD,OAAQ,eACtDN,IAAI,GAAI,kBAAiBA,IAAK,EAAC,GAAG,EACnC,GAAES,QAAQ,GAAG,gCAAgC,GAAG,EAAG,EAAC;AACvD,CAAC,EACDL,KACF,CAAC;AAEDxC,KAAK,CAACiD,oBAAoB,GAAGrC,WAAW,CACtC,sBAAsB,EAMtB,CAAC2B,IAAI,EAAEH,IAAI,EAAEjC,IAAI,GAAG,SAAS,KAAK;EAChC,OAAQ,eAAcA,IAAK,KAAIoC,IAAK,mBAAkBH,IAAK,EAAC;AAC9D,CAAC,EACDI,KACF,CAAC;AAEDxC,KAAK,CAACkD,6BAA6B,GAAGtC,WAAW,CAC/C,+BAA+B,EAC/B,2CAA2C,EAC3C4B,KACF,CAAC;AAEDxC,KAAK,CAACmD,8BAA8B,GAAGvC,WAAW,CAChD,gCAAgC,EAMhC,CAACwC,SAAS,EAAEC,WAAW,EAAEjB,IAAI,KAAK;EAChC,OAAQ,6BAA4BgB,SAAU,mBAC5CC,WAAW,GAAI,eAAcA,WAAY,cAAa,GAAG,EAC1D,kBAAiBjB,IAAK,EAAC;AAC1B,CAAC,EACDJ,SACF,CAAC;AAEDhC,KAAK,CAACsD,6BAA6B,GAAG1C,WAAW,CAC/C,+BAA+B,EAM/B,CAAC8B,OAAO,EAAEa,OAAO,EAAEnB,IAAI,GAAGC,SAAS,KAAK;EACtC,IAAIkB,OAAO,KAAK,GAAG,EACjB,OAAQ,gCAA+Bb,OAAQ,eAC7CN,IAAI,GAAI,kBAAiBA,IAAK,EAAC,GAAG,EACnC,EAAC;EACJ,OAAQ,oBAAmBmB,OAAQ,oCAAmCb,OAAQ,eAC5EN,IAAI,GAAI,kBAAiBA,IAAK,EAAC,GAAG,EACnC,EAAC;AACJ,CAAC,EACDI,KACF,CAAC;AAEDxC,KAAK,CAACwD,0BAA0B,GAAG5C,WAAW,CAC5C,4BAA4B,EAC5B,yCAAyC,GACvC,uCAAuC,EACzC4B,KACF,CAAC;AAEDxC,KAAK,CAACyD,0BAA0B,GAAG7C,WAAW,CAC5C,4BAA4B,EAK5B,CAAC8C,GAAG,EAAEnB,IAAI,KAAK;EACb,OAAQ,2BAA0BmB,GAAI,SAAQnB,IAAK,EAAC;AACtD,CAAC,EACDP,SACF,CAAC;AAEDhC,KAAK,CAAC2D,qBAAqB,GAAG/C,WAAW,CACvC,uBAAuB,EAMvB,CAACC,IAAI,EAAEY,KAAK,EAAEU,MAAM,GAAG,YAAY,KAAK;EACtC,IAAIyB,SAAS,GAAG,IAAAC,eAAO,EAACpC,KAAK,CAAC;EAE9B,IAAImC,SAAS,CAACxD,MAAM,GAAG,GAAG,EAAE;IAC1BwD,SAAS,GAAI,GAAEA,SAAS,CAACtD,KAAK,CAAC,CAAC,EAAE,GAAG,CAAE,KAAI;EAC7C;EAEA,MAAMH,IAAI,GAAGU,IAAI,CAACQ,QAAQ,CAAC,GAAG,CAAC,GAAG,UAAU,GAAG,UAAU;EAEzD,OAAQ,OAAMlB,IAAK,KAAIU,IAAK,KAAIsB,MAAO,cAAayB,SAAU,EAAC;AACjE,CAAC,EACD5B,SAGF,CAAC;AAEDhC,KAAK,CAAC8D,8BAA8B,GAAGlD,WAAW,CAChD,gCAAgC,EAKhC,CAACmD,GAAG,EAAEC,SAAS,KAAK;EAClB,IAAI7C,OAAO,GAAI,+BAA8BlB,UAAU,CACrD+D,SACF,CAAE,0CAAyC;EAE3C,IAAIvE,SAAS,IAAIsE,GAAG,CAACE,QAAQ,CAAC7D,MAAM,KAAK,CAAC,EAAE;IAC1Ce,OAAO,IAAI,yDAAyD;EACtE;EAEAA,OAAO,IAAK,wBAAuB4C,GAAG,CAACE,QAAS,GAAE;EAClD,OAAO9C,OAAO;AAChB,CAAC,EACDqB,KACF,CAAC;AAUD,SAAS5B,WAAWA,CAACsD,GAAG,EAAEzC,KAAK,EAAE0C,GAAG,EAAE;EAGpC5D,QAAQ,CAACf,GAAG,CAAC0E,GAAG,EAAEzC,KAAK,CAAC;EAExB,OAAO2C,qBAAqB,CAACD,GAAG,EAAED,GAAG,CAAC;AACxC;AAOA,SAASE,qBAAqBA,CAACC,IAAI,EAAElF,GAAG,EAAE;EAExC,OAAOmF,SAAS;EAIhB,SAASA,SAASA,CAAC,GAAGC,IAAI,EAAE;IAC1B,MAAMC,KAAK,GAAGhC,KAAK,CAACiC,eAAe;IACnC,IAAIC,8BAA8B,CAAC,CAAC,EAAElC,KAAK,CAACiC,eAAe,GAAG,CAAC;IAC/D,MAAME,KAAK,GAAG,IAAIN,IAAI,CAAC,CAAC;IAExB,IAAIK,8BAA8B,CAAC,CAAC,EAAElC,KAAK,CAACiC,eAAe,GAAGD,KAAK;IACnE,MAAMrD,OAAO,GAAGyD,UAAU,CAACzF,GAAG,EAAEoF,IAAI,EAAEI,KAAK,CAAC;IAC5C3F,MAAM,CAAC6F,gBAAgB,CAACF,KAAK,EAAE;MAG7BxD,OAAO,EAAE;QACPM,KAAK,EAAEN,OAAO;QACd2D,UAAU,EAAE,KAAK;QACjBC,QAAQ,EAAE,IAAI;QACdC,YAAY,EAAE;MAChB,CAAC;MACDC,QAAQ,EAAE;QAERxD,KAAKA,CAAA,EAAG;UACN,OAAQ,GAAE,IAAI,CAACZ,IAAK,KAAI1B,GAAI,MAAK,IAAI,CAACgC,OAAQ,EAAC;QACjD,CAAC;QACD2D,UAAU,EAAE,KAAK;QACjBC,QAAQ,EAAE,IAAI;QACdC,YAAY,EAAE;MAChB;IACF,CAAC,CAAC;IAEFE,uBAAuB,CAACP,KAAK,CAAC;IAE9BA,KAAK,CAACQ,IAAI,GAAGhG,GAAG;IAChB,OAAOwF,KAAK;EACd;AACF;AAKA,SAASD,8BAA8BA,CAAA,EAAG;EAGxC,IAAI;IAEF,IAAIU,GAACA,CAAC,CAACC,eAAe,CAACC,kBAAkB,CAAC,CAAC,EAAE;MAC3C,OAAO,KAAK;IACd;EACF,CAAC,CAAC,OAAAC,OAAA,EAAM,CAAC;EAET,MAAMhG,IAAI,GAAGP,MAAM,CAACE,wBAAwB,CAACsD,KAAK,EAAE,iBAAiB,CAAC;EACtE,IAAIjD,IAAI,KAAK8C,SAAS,EAAE;IACtB,OAAOrD,MAAM,CAACwG,YAAY,CAAChD,KAAK,CAAC;EACnC;EAEA,OAAO5C,KAAK,CAACN,IAAI,CAACC,IAAI,EAAE,UAAU,CAAC,IAAIA,IAAI,CAACwF,QAAQ,KAAK1C,SAAS,GAC9D9C,IAAI,CAACwF,QAAQ,GACbxF,IAAI,CAACC,GAAG,KAAK6C,SAAS;AAC5B;AAQA,SAASoD,eAAeA,CAACC,EAAE,EAAE;EAG3B,MAAMC,MAAM,GAAGlF,kBAAkB,GAAGiF,EAAE,CAAC7E,IAAI;EAC3C7B,MAAM,CAACC,cAAc,CAACyG,EAAE,EAAE,MAAM,EAAE;IAACjE,KAAK,EAAEkE;EAAM,CAAC,CAAC;EAClD,OAAOD,EAAE;AACX;AAEA,MAAMR,uBAAuB,GAAGO,eAAe,CAM7C,UAAUd,KAAK,EAAE;EACf,MAAMiB,yBAAyB,GAAGlB,8BAA8B,CAAC,CAAC;EAClE,IAAIkB,yBAAyB,EAAE;IAC7BlF,mBAAmB,GAAG8B,KAAK,CAACiC,eAAe;IAC3CjC,KAAK,CAACiC,eAAe,GAAGoB,MAAM,CAACC,iBAAiB;EAClD;EAEAtD,KAAK,CAACuD,iBAAiB,CAACpB,KAAK,CAAC;EAG9B,IAAIiB,yBAAyB,EAAEpD,KAAK,CAACiC,eAAe,GAAG/D,mBAAmB;EAE1E,OAAOiE,KAAK;AACd,CACF,CAAC;AAQD,SAASC,UAAUA,CAACzF,GAAG,EAAEoF,IAAI,EAAEyB,IAAI,EAAE;EACnC,MAAM7E,OAAO,GAAGZ,QAAQ,CAAC1B,GAAG,CAACM,GAAG,CAAC;EACjC6B,QAAKA,CAAC,CAACG,OAAO,KAAKkB,SAAS,EAAE,gCAAgC,CAAC;EAE/D,IAAI,OAAOlB,OAAO,KAAK,UAAU,EAAE;IACjCH,QAAKA,CAAC,CACJG,OAAO,CAACf,MAAM,IAAImE,IAAI,CAACnE,MAAM,EAC5B,SAAQjB,GAAI,oCAAmCoF,IAAI,CAACnE,MAAO,aAAY,GACrE,4BAA2Be,OAAO,CAACf,MAAO,IAC/C,CAAC;IACD,OAAO6F,OAAO,CAACC,KAAK,CAAC/E,OAAO,EAAE6E,IAAI,EAAEzB,IAAI,CAAC;EAC3C;EAEA,MAAM4B,KAAK,GAAG,aAAa;EAC3B,IAAIC,cAAc,GAAG,CAAC;EACtB,OAAOD,KAAK,CAACvE,IAAI,CAACT,OAAO,CAAC,KAAK,IAAI,EAAEiF,cAAc,EAAE;EACrDpF,QAAKA,CAAC,CACJoF,cAAc,KAAK7B,IAAI,CAACnE,MAAM,EAC7B,SAAQjB,GAAI,oCAAmCoF,IAAI,CAACnE,MAAO,aAAY,GACrE,4BAA2BgG,cAAe,IAC/C,CAAC;EACD,IAAI7B,IAAI,CAACnE,MAAM,KAAK,CAAC,EAAE,OAAOe,OAAO;EAErCoD,IAAI,CAAC8B,OAAO,CAAClF,OAAO,CAAC;EACrB,OAAO8E,OAAO,CAACC,KAAK,CAACI,cAAM,EAAE,IAAI,EAAE/B,IAAI,CAAC;AAC1C;AAOA,SAASxC,qBAAqBA,CAACN,KAAK,EAAE;EACpC,IAAIA,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKY,SAAS,EAAE;IACzC,OAAOkE,MAAM,CAAC9E,KAAK,CAAC;EACtB;EAEA,IAAI,OAAOA,KAAK,KAAK,UAAU,IAAIA,KAAK,CAACZ,IAAI,EAAE;IAC7C,OAAQ,YAAWY,KAAK,CAACZ,IAAK,EAAC;EACjC;EAEA,IAAI,OAAOY,KAAK,KAAK,QAAQ,EAAE;IAC7B,IAAIA,KAAK,CAAC+E,WAAW,IAAI/E,KAAK,CAAC+E,WAAW,CAAC3F,IAAI,EAAE;MAC/C,OAAQ,kBAAiBY,KAAK,CAAC+E,WAAW,CAAC3F,IAAK,EAAC;IACnD;IAEA,OAAQ,GAAE,IAAAgD,eAAO,EAACpC,KAAK,EAAE;MAACgF,KAAK,EAAE,CAAC;IAAC,CAAC,CAAE,EAAC;EACzC;EAEA,IAAI7C,SAAS,GAAG,IAAAC,eAAO,EAACpC,KAAK,EAAE;IAACiF,MAAM,EAAE;EAAK,CAAC,CAAC;EAE/C,IAAI9C,SAAS,CAACxD,MAAM,GAAG,EAAE,EAAE;IACzBwD,SAAS,GAAI,GAAEA,SAAS,CAACtD,KAAK,CAAC,CAAC,EAAE,EAAE,CAAE,KAAI;EAC5C;EAEA,OAAQ,QAAO,OAAOmB,KAAM,KAAImC,SAAU,GAAE;AAC9C;AASA,MAAM+C,MAAM,GAAG;EAACC;AAAI,CAAC;AACrB,IAAIC,iBAAiB,GAAGF,MAAM;AAM9B,SAASC,IAAIA,CAACE,QAAQ,EAAE;EACtB,IAAI;IACF,MAAMC,MAAM,GAAGC,aAAE,CAACC,YAAY,CAC5B1E,MAAGA,CAAC,CAAC2E,gBAAgB,CAAC3E,MAAGA,CAAC,CAAClC,IAAI,CAACkC,MAAGA,CAAC,CAAC4E,OAAO,CAACL,QAAQ,CAAC,EAAE,cAAc,CAAC,CAAC,EACxE,MACF,CAAC;IACD,OAAO;MAACC;IAAM,CAAC;EACjB,CAAC,CAAC,OAAOpC,KAAK,EAAE;IACd,MAAMyC,SAAS,GAAkCzC,KAAM;IAEvD,IAAIyC,SAAS,CAACjC,IAAI,KAAK,QAAQ,EAAE;MAC/B,OAAO;QAAC4B,MAAM,EAAE1E;MAAS,CAAC;IAG5B;IAEA,MAAM+E,SAAS;EACjB;AACF;AAOA,MAAM;EAAC9E,0BAA0B,EAAE+E;AAA4B,CAAC,GAAGrH,KAAK;AAGxE,MAAMsH,gBAAgB,GAAG,IAAI9G,GAAG,CAAC,CAAC;AAQlC,SAAS+G,gBAAgBA,CAAChF,IAAI,EAAEa,SAAS,EAAEhB,IAAI,EAAE;EAC/C,MAAMoF,QAAQ,GAAGF,gBAAgB,CAACzI,GAAG,CAAC0D,IAAI,CAAC;EAC3C,IAAIiF,QAAQ,KAAKnF,SAAS,EAAE;IAC1B,OAAOmF,QAAQ;EACjB;EAEA,MAAMC,MAAM,GAAGZ,iBAAiB,CAACD,IAAI,CAACrE,IAAI,CAAC,CAACwE,MAAM;EAElD,IAAIU,MAAM,KAAKpF,SAAS,EAAE;IAExB,MAAMqF,aAAa,GAAG;MACpBC,SAAS,EAAEpF,IAAI;MACfqF,MAAM,EAAE,KAAK;MACbC,IAAI,EAAExF,SAAS;MACfxB,IAAI,EAAEwB,SAAS;MACflC,IAAI,EAAE,MAAM;MACZ2H,OAAO,EAAEzF,SAAS;MAClB0F,OAAO,EAAE1F;IACX,CAAC;IACDiF,gBAAgB,CAAC9H,GAAG,CAAC+C,IAAI,EAAEmF,aAAa,CAAC;IACzC,OAAOA,aAAa;EACtB;EAGA,IAAIM,WAAW;EACf,IAAI;IACFA,WAAW,GAAGjF,IAAI,CAACkF,KAAK,CAACR,MAAM,CAAC;EAClC,CAAC,CAAC,OAAO9C,KAAK,EAAE;IACd,MAAMyC,SAAS,GAAkCzC,KAAM;IAEvD,MAAM,IAAI0C,4BAA4B,CACpC9E,IAAI,EACJ,CAACH,IAAI,GAAI,IAAGgB,SAAU,SAAQ,GAAG,EAAE,IAAI,IAAA8E,oBAAa,EAAC9F,IAAI,IAAIgB,SAAS,CAAC,EACvEgE,SAAS,CAACjG,OACZ,CAAC;EACH;EAEA,MAAM;IAAC2G,OAAO;IAAEC,OAAO;IAAEF,IAAI;IAAEhH,IAAI;IAAEV;EAAI,CAAC,GAAG6H,WAAW;EAGxD,MAAMN,aAAa,GAAG;IACpBC,SAAS,EAAEpF,IAAI;IACfqF,MAAM,EAAE,IAAI;IACZC,IAAI,EAAE,OAAOA,IAAI,KAAK,QAAQ,GAAGA,IAAI,GAAGxF,SAAS;IACjDxB,IAAI,EAAE,OAAOA,IAAI,KAAK,QAAQ,GAAGA,IAAI,GAAGwB,SAAS;IACjDlC,IAAI,EAAEA,IAAI,KAAK,QAAQ,IAAIA,IAAI,KAAK,UAAU,GAAGA,IAAI,GAAG,MAAM;IAE9D2H,OAAO;IAEPC,OAAO,EAAEA,OAAO,IAAI,OAAOA,OAAO,KAAK,QAAQ,GAAGA,OAAO,GAAG1F;EAC9D,CAAC;EACDiF,gBAAgB,CAAC9H,GAAG,CAAC+C,IAAI,EAAEmF,aAAa,CAAC;EACzC,OAAOA,aAAa;AACtB;AAMA,SAASS,qBAAqBA,CAACC,QAAQ,EAAE;EACvC,IAAIC,cAAc,GAAG,KAAIC,UAAG,EAAC,cAAc,EAAEF,QAAQ,CAAC;EAEtD,OAAO,IAAI,EAAE;IACX,MAAMG,eAAe,GAAGF,cAAc,CAACG,QAAQ;IAE/C,IAAID,eAAe,CAACnH,QAAQ,CAAC,2BAA2B,CAAC,EAAE;IAE3D,MAAMsG,aAAa,GAAGH,gBAAgB,CACpC,IAAAW,oBAAa,EAACG,cAAc,CAAC,EAC7BD,QACF,CAAC;IACD,IAAIV,aAAa,CAACE,MAAM,EAAE,OAAOF,aAAa;IAE9C,MAAMe,kBAAkB,GAAGJ,cAAc;IACzCA,cAAc,GAAG,KAAIC,UAAG,EAAC,iBAAiB,EAAED,cAAc,CAAC;IAI3D,IAAIA,cAAc,CAACG,QAAQ,KAAKC,kBAAkB,CAACD,QAAQ,EAAE;EAC/D;EAEA,MAAMD,eAAe,GAAG,IAAAL,oBAAa,EAACG,cAAc,CAAC;EAErD,MAAMX,aAAa,GAAG;IACpBC,SAAS,EAAEY,eAAe;IAC1BX,MAAM,EAAE,KAAK;IACbC,IAAI,EAAExF,SAAS;IACfxB,IAAI,EAAEwB,SAAS;IACflC,IAAI,EAAE,MAAM;IACZ2H,OAAO,EAAEzF,SAAS;IAClB0F,OAAO,EAAE1F;EACX,CAAC;EACDiF,gBAAgB,CAAC9H,GAAG,CAAC+I,eAAe,EAAEb,aAAa,CAAC;EACpD,OAAOA,aAAa;AACtB;AAgBA,SAASgB,cAAcA,CAAC3E,GAAG,EAAE;EAC3B,MAAM2D,aAAa,GAAGS,qBAAqB,CAACpE,GAAG,CAAC;EAChD,OAAO2D,aAAa,CAACvH,IAAI;AAC3B;AAOA,MAAM;EAACsD;AAA0B,CAAC,GAAGzD,KAAK;AAE1C,MAAMX,cAAc,GAAG,CAAC,CAAC,CAACA,cAAc;AAGxC,MAAMsJ,kBAAkB,GAAG;EAEzBC,SAAS,EAAE,IAAI;EACf,MAAM,EAAE,UAAU;EAClB,KAAK,EAAE,QAAQ;EACf,OAAO,EAAE,MAAM;EACf,MAAM,EAAE;AACV,CAAC;AAMD,SAASC,YAAYA,CAACC,IAAI,EAAE;EAC1B,IACEA,IAAI,IACJ,+DAA+D,CAACC,IAAI,CAACD,IAAI,CAAC,EAE1E,OAAO,QAAQ;EACjB,IAAIA,IAAI,KAAK,kBAAkB,EAAE,OAAO,MAAM;EAC9C,OAAO,IAAI;AACb;AAaA,MAAME,gBAAgB,GAAG;EAEvBJ,SAAS,EAAE,IAAI;EACf,OAAO,EAAEK,2BAA2B;EACpC,OAAO,EAAEC,2BAA2B;EACpC,OAAO,EAAEC,2BAA2B;EACpC,QAAQ,EAAEA,2BAA2B;EACrC,OAAOC,CAAA,EAAG;IACR,OAAO,SAAS;EAClB;AACF,CAAC;AAKD,SAASH,2BAA2BA,CAACI,MAAM,EAAE;EAC3C,MAAM;IAAC,CAAC,EAAEP;EAAI,CAAC,GAAG,mCAAmC,CAAClH,IAAI,CACxDyH,MAAM,CAACb,QACT,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;EACvB,OAAOK,YAAY,CAACC,IAAI,CAAC;AAC3B;AAYA,SAASQ,OAAOA,CAACvF,GAAG,EAAE;EACpB,MAAMyE,QAAQ,GAAGzE,GAAG,CAACyE,QAAQ;EAC7B,IAAIe,KAAK,GAAGf,QAAQ,CAACpI,MAAM;EAE3B,OAAOmJ,KAAK,EAAE,EAAE;IACd,MAAMpE,IAAI,GAAGqD,QAAQ,CAACgB,WAAW,CAACD,KAAK,CAAC;IAExC,IAAIpE,IAAI,KAAK,EAAE,EAAY;MACzB,OAAO,EAAE;IACX;IAEA,IAAIA,IAAI,KAAK,EAAE,EAAY;MACzB,OAAOqD,QAAQ,CAACgB,WAAW,CAACD,KAAK,GAAG,CAAC,CAAC,KAAK,EAAE,GACzC,EAAE,GACFf,QAAQ,CAAClI,KAAK,CAACiJ,KAAK,CAAC;IAC3B;EACF;EAEA,OAAO,EAAE;AACX;AAKA,SAASL,2BAA2BA,CAACnF,GAAG,EAAE0F,QAAQ,EAAEC,YAAY,EAAE;EAChE,MAAMhG,GAAG,GAAG4F,OAAO,CAACvF,GAAG,CAAC;EAExB,IAAIL,GAAG,KAAK,KAAK,EAAE;IACjB,OAAOgF,cAAc,CAAC3E,GAAG,CAAC,KAAK,QAAQ,GAAG,QAAQ,GAAG,UAAU;EACjE;EAEA,MAAMuC,MAAM,GAAGqC,kBAAkB,CAACjF,GAAG,CAAC;EACtC,IAAI4C,MAAM,EAAE,OAAOA,MAAM;EAGzB,IAAIoD,YAAY,EAAE;IAChB,OAAOrH,SAAS;EAClB;EAEA,MAAMsH,QAAQ,GAAG,IAAAzB,oBAAa,EAACnE,GAAG,CAAC;EACnC,MAAM,IAAIN,0BAA0B,CAACC,GAAG,EAAEiG,QAAQ,CAAC;AACrD;AAEA,SAASR,2BAA2BA,CAAA,EAAG,CAEvC;AAOA,SAASS,6BAA6BA,CAAC7F,GAAG,EAAE8F,OAAO,EAAE;EACnD,IAAI,CAACxK,cAAc,CAACC,IAAI,CAAC0J,gBAAgB,EAAEjF,GAAG,CAACE,QAAQ,CAAC,EAAE;IACxD,OAAO,IAAI;EACb;EAEA,OAAO+E,gBAAgB,CAACjF,GAAG,CAACE,QAAQ,CAAC,CAACF,GAAG,EAAE8F,OAAO,EAAE,IAAI,CAAC,IAAI,IAAI;AACnE;AAOA,MAAM;EAAClG;AAAqB,CAAC,GAAG3D,KAAK;AAKrC,MAAM8J,kBAAkB,GAAG9K,MAAM,CAAC+K,MAAM,CAAC,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;AAC5D,MAAMC,sBAAsB,GAAG,IAAIjK,GAAG,CAAC+J,kBAAkB,CAAC;AAE1D,SAASG,oBAAoBA,CAAA,EAAG;EAC9B,OAAOH,kBAAkB;AAC3B;AAEA,SAASI,uBAAuBA,CAAA,EAAG;EACjC,OAAOF,sBAAsB;AAC/B;AAMA,SAASG,gBAAgBA,CAACC,UAAU,EAAE;EACpC,IAAIA,UAAU,KAAK/H,SAAS,IAAI+H,UAAU,KAAKH,oBAAoB,CAAC,CAAC,EAAE;IACrE,IAAI,CAAChJ,KAAK,CAACC,OAAO,CAACkJ,UAAU,CAAC,EAAE;MAC9B,MAAM,IAAIzG,qBAAqB,CAC7B,YAAY,EACZyG,UAAU,EACV,mBACF,CAAC;IACH;IAEA,OAAO,IAAIrK,GAAG,CAACqK,UAAU,CAAC;EAC5B;EAEA,OAAOF,uBAAuB,CAAC,CAAC;AAClC;AAOA,MAAMG,4BAA4B,GAAGC,MAAM,CAAClL,SAAS,CAACmL,MAAM,CAACC,OAAO,CAAC;AAGrE,MAAMC,0BAA0B,GAAG,KAAK;AAExC,MAAM;EACJvH,6BAA6B;EAC7BjB,4BAA4B;EAC5BK,0BAA0B;EAC1BG,0BAA0B;EAC1BQ,oBAAoB;EACpBE,8BAA8B;EAC9BG,6BAA6B;EAC7BE,0BAA0B;EAC1BM;AACF,CAAC,GAAG9D,KAAK;AAET,MAAM0K,GAAG,GAAG,CAAC,CAAC,CAACrL,cAAc;AAE7B,MAAMsL,mBAAmB,GACvB,0KAA0K;AAC5K,MAAMC,6BAA6B,GACjC,yKAAyK;AAC3K,MAAMC,uBAAuB,GAAG,UAAU;AAC1C,MAAMC,YAAY,GAAG,KAAK;AAC1B,MAAMC,eAAe,GAAG,UAAU;AAElC,MAAMC,sBAAsB,GAAG,IAAIjL,GAAG,CAAC,CAAC;AAExC,MAAMkL,gBAAgB,GAAG,UAAU;AAYnC,SAASC,6BAA6BA,CACpCvI,MAAM,EACNT,OAAO,EACPiJ,KAAK,EACL9C,cAAc,EACd+C,QAAQ,EACRhJ,IAAI,EACJiJ,QAAQ,EACR;EACA,MAAM1D,SAAS,GAAG,IAAAO,oBAAa,EAACG,cAAc,CAAC;EAC/C,MAAMiD,MAAM,GAAGL,gBAAgB,CAACrJ,IAAI,CAACyJ,QAAQ,GAAG1I,MAAM,GAAGT,OAAO,CAAC,KAAK,IAAI;EAC1ExC,SAAMA,CAAC,CAAC6L,WAAW,CAChB,qBACCD,MAAM,GAAG,cAAc,GAAG,oCAC3B,eAAc3I,MAAO,eAAc,GACjC,YAAWT,OAAQ,KAClBA,OAAO,KAAKiJ,KAAK,GAAG,EAAE,GAAI,eAAcA,KAAM,IAC/C,WACCC,QAAQ,GAAG,SAAS,GAAG,SACxB,+CAA8CzD,SAAU,GACvDvF,IAAI,GAAI,kBAAiB,IAAA8F,oBAAa,EAAC9F,IAAI,CAAE,EAAC,GAAG,EAClD,GAAE,EACL,oBAAoB,EACpB,SACF,CAAC;AACH;AASA,SAASoJ,0BAA0BA,CAACzH,GAAG,EAAEsE,cAAc,EAAEjG,IAAI,EAAEyF,IAAI,EAAE;EACnE,MAAMvB,MAAM,GAAGsD,6BAA6B,CAAC7F,GAAG,EAAE;IAAC0H,SAAS,EAAErJ,IAAI,CAACsJ;EAAI,CAAC,CAAC;EACzE,IAAIpF,MAAM,KAAK,QAAQ,EAAE;EACzB,MAAM/D,IAAI,GAAG,IAAA2F,oBAAa,EAACnE,GAAG,CAAC2H,IAAI,CAAC;EACpC,MAAMhJ,OAAO,GAAG,IAAAwF,oBAAa,EAAC,KAAII,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAAC;EAC3D,MAAMsD,QAAQ,GAAG,IAAAzD,oBAAa,EAAC9F,IAAI,CAAC;EACpC,IAAIyF,IAAI,EACNnI,SAAMA,CAAC,CAAC6L,WAAW,CAChB,WAAU7I,OAAQ,8BAA6BK,IAAI,CAACC,SAAS,CAAC6E,IAAI,CAAE,IAAG,GACrE,sEAAqEtF,IAAI,CAACjC,KAAK,CAC9EoC,OAAO,CAACtC,MACV,CAAE,oBAAmBuL,QAAS,2DAA0D,GACxF,4BAA4B,EAC9B,oBAAoB,EACpB,SACF,CAAC,CAAC,KAEFjM,SAAMA,CAAC,CAAC6L,WAAW,CAChB,gEAA+D7I,OAAQ,oCAAmCH,IAAI,CAACjC,KAAK,CACnHoC,OAAO,CAACtC,MACV,CAAE,oBAAmBuL,QAAS,wEAAuE,EACrG,oBAAoB,EACpB,SACF,CAAC;AACL;AAMA,SAASC,WAAWA,CAACrJ,IAAI,EAAE;EAEzB,IAAI;IACF,OAAO,IAAAsJ,cAAQ,EAACtJ,IAAI,CAAC;EACvB,CAAC,CAAC,OAAAuJ,QAAA,EAAM;IACN,OAAO,KAAIC,WAAK,EAAC,CAAC;EACpB;AACF;AAaA,SAASC,UAAUA,CAACjI,GAAG,EAAE;EACvB,MAAMkI,KAAK,GAAG,IAAAJ,cAAQ,EAAC9H,GAAG,EAAE;IAACmI,cAAc,EAAE;EAAK,CAAC,CAAC;EACpD,MAAMC,MAAM,GAAGF,KAAK,GAAGA,KAAK,CAACE,MAAM,CAAC,CAAC,GAAG9J,SAAS;EACjD,OAAO8J,MAAM,KAAK,IAAI,IAAIA,MAAM,KAAK9J,SAAS,GAAG,KAAK,GAAG8J,MAAM;AACjE;AAQA,SAASC,iBAAiBA,CAAC/D,cAAc,EAAEX,aAAa,EAAEtF,IAAI,EAAE;EAE9D,IAAIiK,KAAK;EACT,IAAI3E,aAAa,CAACG,IAAI,KAAKxF,SAAS,EAAE;IACpCgK,KAAK,GAAG,KAAI/D,UAAG,EAACZ,aAAa,CAACG,IAAI,EAAEQ,cAAc,CAAC;IAEnD,IAAI2D,UAAU,CAACK,KAAK,CAAC,EAAE,OAAOA,KAAK;IAEnC,MAAMC,KAAK,GAAG,CACX,KAAI5E,aAAa,CAACG,IAAK,KAAI,EAC3B,KAAIH,aAAa,CAACG,IAAK,OAAM,EAC7B,KAAIH,aAAa,CAACG,IAAK,OAAM,EAC7B,KAAIH,aAAa,CAACG,IAAK,WAAU,EACjC,KAAIH,aAAa,CAACG,IAAK,aAAY,EACnC,KAAIH,aAAa,CAACG,IAAK,aAAY,CACrC;IACD,IAAI0E,CAAC,GAAG,CAAC,CAAC;IAEV,OAAO,EAAEA,CAAC,GAAGD,KAAK,CAAClM,MAAM,EAAE;MACzBiM,KAAK,GAAG,KAAI/D,UAAG,EAACgE,KAAK,CAACC,CAAC,CAAC,EAAElE,cAAc,CAAC;MACzC,IAAI2D,UAAU,CAACK,KAAK,CAAC,EAAE;MACvBA,KAAK,GAAGhK,SAAS;IACnB;IAEA,IAAIgK,KAAK,EAAE;MACTb,0BAA0B,CACxBa,KAAK,EACLhE,cAAc,EACdjG,IAAI,EACJsF,aAAa,CAACG,IAChB,CAAC;MACD,OAAOwE,KAAK;IACd;EAEF;EAEA,MAAMC,KAAK,GAAG,CAAC,YAAY,EAAE,cAAc,EAAE,cAAc,CAAC;EAC5D,IAAIC,CAAC,GAAG,CAAC,CAAC;EAEV,OAAO,EAAEA,CAAC,GAAGD,KAAK,CAAClM,MAAM,EAAE;IACzBiM,KAAK,GAAG,KAAI/D,UAAG,EAACgE,KAAK,CAACC,CAAC,CAAC,EAAElE,cAAc,CAAC;IACzC,IAAI2D,UAAU,CAACK,KAAK,CAAC,EAAE;IACvBA,KAAK,GAAGhK,SAAS;EACnB;EAEA,IAAIgK,KAAK,EAAE;IACTb,0BAA0B,CAACa,KAAK,EAAEhE,cAAc,EAAEjG,IAAI,EAAEsF,aAAa,CAACG,IAAI,CAAC;IAC3E,OAAOwE,KAAK;EACd;EAGA,MAAM,IAAIpJ,oBAAoB,CAC5B,IAAAiF,oBAAa,EAAC,KAAII,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAAC,EAC3C,IAAAH,oBAAa,EAAC9F,IAAI,CACpB,CAAC;AACH;AAQA,SAASoK,kBAAkBA,CAACpE,QAAQ,EAAEhG,IAAI,EAAEqK,gBAAgB,EAAE;EAC5D,IAAI1B,eAAe,CAACnJ,IAAI,CAACwG,QAAQ,CAACI,QAAQ,CAAC,KAAK,IAAI,EAClD,MAAM,IAAIvG,4BAA4B,CACpCmG,QAAQ,CAACI,QAAQ,EACjB,iDAAiD,EACjD,IAAAN,oBAAa,EAAC9F,IAAI,CACpB,CAAC;EAEH,MAAMsK,QAAQ,GAAG,IAAAxE,oBAAa,EAACE,QAAQ,CAAC;EAExC,MAAM6D,KAAK,GAAGL,WAAW,CACvBc,QAAQ,CAACtL,QAAQ,CAAC,GAAG,CAAC,GAAGsL,QAAQ,CAACpM,KAAK,CAAC,CAAC,CAAC,CAAC,GAAGoM,QAChD,CAAC;EAED,IAAIT,KAAK,CAACU,WAAW,CAAC,CAAC,EAAE;IACvB,MAAMhI,KAAK,GAAG,IAAInB,0BAA0B,CAACkJ,QAAQ,EAAE,IAAAxE,oBAAa,EAAC9F,IAAI,CAAC,CAAC;IAE3EuC,KAAK,CAACZ,GAAG,GAAGwC,MAAM,CAAC6B,QAAQ,CAAC;IAC5B,MAAMzD,KAAK;EACb;EAEA,IAAI,CAACsH,KAAK,CAACE,MAAM,CAAC,CAAC,EAAE;IACnB,MAAM,IAAIlJ,oBAAoB,CAC5ByJ,QAAQ,IAAItE,QAAQ,CAACI,QAAQ,EAC7BpG,IAAI,IAAI,IAAA8F,oBAAa,EAAC9F,IAAI,CAAC,EAC3B,QACF,CAAC;EACH;EAEA,IAAI,CAACqK,gBAAgB,EAAE;IACrB,MAAMG,IAAI,GAAG,IAAAC,kBAAY,EAACH,QAAQ,CAAC;IACnC,MAAM;MAACI,MAAM;MAAEC;IAAI,CAAC,GAAG3E,QAAQ;IAC/BA,QAAQ,GAAG,IAAA4E,oBAAa,EAACJ,IAAI,IAAIF,QAAQ,CAACtL,QAAQ,CAACmB,MAAGA,CAAC,CAAC0K,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC;IACzE7E,QAAQ,CAAC0E,MAAM,GAAGA,MAAM;IACxB1E,QAAQ,CAAC2E,IAAI,GAAGA,IAAI;EACtB;EAEA,OAAO3E,QAAQ;AACjB;AAQA,SAAS8E,gBAAgBA,CAAC9J,SAAS,EAAEiF,cAAc,EAAEjG,IAAI,EAAE;EACzD,OAAO,IAAIe,8BAA8B,CACvCC,SAAS,EACTiF,cAAc,IAAI,IAAAH,oBAAa,EAAC,KAAII,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAAC,EAC7D,IAAAH,oBAAa,EAAC9F,IAAI,CACpB,CAAC;AACH;AAQA,SAAS+K,eAAeA,CAAC5J,OAAO,EAAE8E,cAAc,EAAEjG,IAAI,EAAE;EACtD,OAAO,IAAIkB,6BAA6B,CACtC,IAAA4E,oBAAa,EAAC,KAAII,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAAC,EAC3C9E,OAAO,EACPnB,IAAI,IAAI,IAAA8F,oBAAa,EAAC9F,IAAI,CAC5B,CAAC;AACH;AAUA,SAASgL,mBAAmBA,CAAClL,OAAO,EAAEiJ,KAAK,EAAE9C,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,EAAE;EAC3E,MAAMD,MAAM,GAAI,4CAA2CgJ,KAAM,cAC/DC,QAAQ,GAAG,SAAS,GAAG,SACxB,mBAAkB,IAAAlD,oBAAa,EAACG,cAAc,CAAE,EAAC;EAClD,MAAM,IAAIpG,4BAA4B,CACpCC,OAAO,EACPC,MAAM,EACNC,IAAI,IAAI,IAAA8F,oBAAa,EAAC9F,IAAI,CAC5B,CAAC;AACH;AAUA,SAASiL,oBAAoBA,CAAC9J,OAAO,EAAEZ,MAAM,EAAE0F,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,EAAE;EAC7EO,MAAM,GACJ,OAAOA,MAAM,KAAK,QAAQ,IAAIA,MAAM,KAAK,IAAI,GACzCI,IAAI,CAACC,SAAS,CAACL,MAAM,EAAE,IAAI,EAAE,EAAE,CAAC,GAC/B,GAAEA,MAAO,EAAC;EAEjB,OAAO,IAAIF,0BAA0B,CACnC,IAAAyF,oBAAa,EAAC,KAAII,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAAC,EAC3C9E,OAAO,EACPZ,MAAM,EACNyI,QAAQ,EACRhJ,IAAI,IAAI,IAAA8F,oBAAa,EAAC9F,IAAI,CAC5B,CAAC;AACH;AAcA,SAASkL,0BAA0BA,CACjC3K,MAAM,EACNY,OAAO,EACP4H,KAAK,EACL9C,cAAc,EACdjG,IAAI,EACJmL,OAAO,EACPnC,QAAQ,EACRoC,SAAS,EACTpD,UAAU,EACV;EACA,IAAI7G,OAAO,KAAK,EAAE,IAAI,CAACgK,OAAO,IAAI5K,MAAM,CAACA,MAAM,CAACvC,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,EACjE,MAAMiN,oBAAoB,CAAClC,KAAK,EAAExI,MAAM,EAAE0F,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,CAAC;EAE3E,IAAI,CAACO,MAAM,CAACG,UAAU,CAAC,IAAI,CAAC,EAAE;IAC5B,IAAIsI,QAAQ,IAAI,CAACzI,MAAM,CAACG,UAAU,CAAC,KAAK,CAAC,IAAI,CAACH,MAAM,CAACG,UAAU,CAAC,GAAG,CAAC,EAAE;MACpE,IAAI2K,KAAK,GAAG,KAAK;MAEjB,IAAI;QACF,KAAInF,UAAG,EAAC3F,MAAM,CAAC;QACf8K,KAAK,GAAG,IAAI;MACd,CAAC,CAAC,OAAAC,QAAA,EAAM,CAER;MAEA,IAAI,CAACD,KAAK,EAAE;QACV,MAAME,YAAY,GAAGJ,OAAO,GACxBlD,4BAA4B,CAAC/K,IAAI,CAC/BwL,YAAY,EACZnI,MAAM,EACN,MAAMY,OACR,CAAC,GACDZ,MAAM,GAAGY,OAAO;QAEpB,OAAOqK,cAAc,CAACD,YAAY,EAAEtF,cAAc,EAAE+B,UAAU,CAAC;MACjE;IACF;IAEA,MAAMiD,oBAAoB,CAAClC,KAAK,EAAExI,MAAM,EAAE0F,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,CAAC;EAC3E;EAEA,IAAIuI,mBAAmB,CAAC/I,IAAI,CAACe,MAAM,CAACrC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;IACtD,IAAIsK,6BAA6B,CAAChJ,IAAI,CAACe,MAAM,CAACrC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;MAChE,IAAI,CAACkN,SAAS,EAAE;QACd,MAAMtL,OAAO,GAAGqL,OAAO,GACnBpC,KAAK,CAACX,OAAO,CAAC,GAAG,EAAE,MAAMjH,OAAO,CAAC,GACjC4H,KAAK,GAAG5H,OAAO;QACnB,MAAMsK,cAAc,GAAGN,OAAO,GAC1BlD,4BAA4B,CAAC/K,IAAI,CAC/BwL,YAAY,EACZnI,MAAM,EACN,MAAMY,OACR,CAAC,GACDZ,MAAM;QACVuI,6BAA6B,CAC3B2C,cAAc,EACd3L,OAAO,EACPiJ,KAAK,EACL9C,cAAc,EACd+C,QAAQ,EACRhJ,IAAI,EACJ,IACF,CAAC;MACH;IACF,CAAC,MAAM;MACL,MAAMiL,oBAAoB,CAAClC,KAAK,EAAExI,MAAM,EAAE0F,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,CAAC;IAC3E;EACF;EAEA,MAAMgG,QAAQ,GAAG,KAAIE,UAAG,EAAC3F,MAAM,EAAE0F,cAAc,CAAC;EAChD,MAAMyF,YAAY,GAAG1F,QAAQ,CAACI,QAAQ;EACtC,MAAMnF,WAAW,GAAG,KAAIiF,UAAG,EAAC,GAAG,EAAED,cAAc,CAAC,CAACG,QAAQ;EAEzD,IAAI,CAACsF,YAAY,CAAChL,UAAU,CAACO,WAAW,CAAC,EACvC,MAAMgK,oBAAoB,CAAClC,KAAK,EAAExI,MAAM,EAAE0F,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,CAAC;EAE3E,IAAImB,OAAO,KAAK,EAAE,EAAE,OAAO6E,QAAQ;EAEnC,IAAIuC,mBAAmB,CAAC/I,IAAI,CAAC2B,OAAO,CAAC,KAAK,IAAI,EAAE;IAC9C,MAAMrB,OAAO,GAAGqL,OAAO,GACnBpC,KAAK,CAACX,OAAO,CAAC,GAAG,EAAE,MAAMjH,OAAO,CAAC,GACjC4H,KAAK,GAAG5H,OAAO;IACnB,IAAIqH,6BAA6B,CAAChJ,IAAI,CAAC2B,OAAO,CAAC,KAAK,IAAI,EAAE;MACxD,IAAI,CAACiK,SAAS,EAAE;QACd,MAAMK,cAAc,GAAGN,OAAO,GAC1BlD,4BAA4B,CAAC/K,IAAI,CAC/BwL,YAAY,EACZnI,MAAM,EACN,MAAMY,OACR,CAAC,GACDZ,MAAM;QACVuI,6BAA6B,CAC3B2C,cAAc,EACd3L,OAAO,EACPiJ,KAAK,EACL9C,cAAc,EACd+C,QAAQ,EACRhJ,IAAI,EACJ,KACF,CAAC;MACH;IACF,CAAC,MAAM;MACLgL,mBAAmB,CAAClL,OAAO,EAAEiJ,KAAK,EAAE9C,cAAc,EAAE+C,QAAQ,EAAEhJ,IAAI,CAAC;IACrE;EACF;EAEA,IAAImL,OAAO,EAAE;IACX,OAAO,KAAIjF,UAAG,EACZ+B,4BAA4B,CAAC/K,IAAI,CAC/BwL,YAAY,EACZ1C,QAAQ,CAACsD,IAAI,EACb,MAAMnI,OACR,CACF,CAAC;EACH;EAEA,OAAO,KAAI+E,UAAG,EAAC/E,OAAO,EAAE6E,QAAQ,CAAC;AACnC;AAMA,SAAS2F,YAAYA,CAAC5O,GAAG,EAAE;EACzB,MAAM6O,SAAS,GAAGnI,MAAM,CAAC1G,GAAG,CAAC;EAC7B,IAAK,GAAE6O,SAAU,EAAC,KAAK7O,GAAG,EAAE,OAAO,KAAK;EACxC,OAAO6O,SAAS,IAAI,CAAC,IAAIA,SAAS,GAAG,UAAa;AACpD;AAcA,SAASC,oBAAoBA,CAC3B5F,cAAc,EACd1F,MAAM,EACNY,OAAO,EACP2K,cAAc,EACd9L,IAAI,EACJmL,OAAO,EACPnC,QAAQ,EACRoC,SAAS,EACTpD,UAAU,EACV;EACA,IAAI,OAAOzH,MAAM,KAAK,QAAQ,EAAE;IAC9B,OAAO2K,0BAA0B,CAC/B3K,MAAM,EACNY,OAAO,EACP2K,cAAc,EACd7F,cAAc,EACdjG,IAAI,EACJmL,OAAO,EACPnC,QAAQ,EACRoC,SAAS,EACTpD,UACF,CAAC;EACH;EAEA,IAAInJ,KAAK,CAACC,OAAO,CAACyB,MAAM,CAAC,EAAE;IAEzB,MAAMwL,UAAU,GAAGxL,MAAM;IACzB,IAAIwL,UAAU,CAAC/N,MAAM,KAAK,CAAC,EAAE,OAAO,IAAI;IAGxC,IAAIgO,aAAa;IACjB,IAAI7B,CAAC,GAAG,CAAC,CAAC;IAEV,OAAO,EAAEA,CAAC,GAAG4B,UAAU,CAAC/N,MAAM,EAAE;MAC9B,MAAMiO,UAAU,GAAGF,UAAU,CAAC5B,CAAC,CAAC;MAEhC,IAAI+B,aAAa;MACjB,IAAI;QACFA,aAAa,GAAGL,oBAAoB,CAClC5F,cAAc,EACdgG,UAAU,EACV9K,OAAO,EACP2K,cAAc,EACd9L,IAAI,EACJmL,OAAO,EACPnC,QAAQ,EACRoC,SAAS,EACTpD,UACF,CAAC;MACH,CAAC,CAAC,OAAOzF,KAAK,EAAE;QACd,MAAMyC,SAAS,GAAkCzC,KAAM;QACvDyJ,aAAa,GAAGhH,SAAS;QACzB,IAAIA,SAAS,CAACjC,IAAI,KAAK,4BAA4B,EAAE;QACrD,MAAMR,KAAK;MACb;MAEA,IAAI2J,aAAa,KAAKjM,SAAS,EAAE;MAEjC,IAAIiM,aAAa,KAAK,IAAI,EAAE;QAC1BF,aAAa,GAAG,IAAI;QACpB;MACF;MAEA,OAAOE,aAAa;IACtB;IAEA,IAAIF,aAAa,KAAK/L,SAAS,IAAI+L,aAAa,KAAK,IAAI,EAAE;MACzD,OAAO,IAAI;IACb;IAEA,MAAMA,aAAa;EACrB;EAEA,IAAI,OAAOzL,MAAM,KAAK,QAAQ,IAAIA,MAAM,KAAK,IAAI,EAAE;IACjD,MAAM4L,IAAI,GAAGvP,MAAM,CAACwP,mBAAmB,CAAC7L,MAAM,CAAC;IAC/C,IAAI4J,CAAC,GAAG,CAAC,CAAC;IAEV,OAAO,EAAEA,CAAC,GAAGgC,IAAI,CAACnO,MAAM,EAAE;MACxB,MAAMjB,GAAG,GAAGoP,IAAI,CAAChC,CAAC,CAAC;MACnB,IAAIwB,YAAY,CAAC5O,GAAG,CAAC,EAAE;QACrB,MAAM,IAAImD,0BAA0B,CAClC,IAAA4F,oBAAa,EAACG,cAAc,CAAC,EAC7BjG,IAAI,EACJ,iDACF,CAAC;MACH;IACF;IAEAmK,CAAC,GAAG,CAAC,CAAC;IAEN,OAAO,EAAEA,CAAC,GAAGgC,IAAI,CAACnO,MAAM,EAAE;MACxB,MAAMjB,GAAG,GAAGoP,IAAI,CAAChC,CAAC,CAAC;MACnB,IAAIpN,GAAG,KAAK,SAAS,IAAKiL,UAAU,IAAIA,UAAU,CAACxL,GAAG,CAACO,GAAG,CAAE,EAAE;QAE5D,MAAMsP,iBAAiB,GAA2B9L,MAAM,CAACxD,GAAG,CAAE;QAC9D,MAAMmP,aAAa,GAAGL,oBAAoB,CACxC5F,cAAc,EACdoG,iBAAiB,EACjBlL,OAAO,EACP2K,cAAc,EACd9L,IAAI,EACJmL,OAAO,EACPnC,QAAQ,EACRoC,SAAS,EACTpD,UACF,CAAC;QACD,IAAIkE,aAAa,KAAKjM,SAAS,EAAE;QACjC,OAAOiM,aAAa;MACtB;IACF;IAEA,OAAO,IAAI;EACb;EAEA,IAAI3L,MAAM,KAAK,IAAI,EAAE;IACnB,OAAO,IAAI;EACb;EAEA,MAAM0K,oBAAoB,CACxBa,cAAc,EACdvL,MAAM,EACN0F,cAAc,EACd+C,QAAQ,EACRhJ,IACF,CAAC;AACH;AAQA,SAASsM,6BAA6BA,CAAC5G,OAAO,EAAEO,cAAc,EAAEjG,IAAI,EAAE;EACpE,IAAI,OAAO0F,OAAO,KAAK,QAAQ,IAAI7G,KAAK,CAACC,OAAO,CAAC4G,OAAO,CAAC,EAAE,OAAO,IAAI;EACtE,IAAI,OAAOA,OAAO,KAAK,QAAQ,IAAIA,OAAO,KAAK,IAAI,EAAE,OAAO,KAAK;EAEjE,MAAMyG,IAAI,GAAGvP,MAAM,CAACwP,mBAAmB,CAAC1G,OAAO,CAAC;EAChD,IAAI6G,kBAAkB,GAAG,KAAK;EAC9B,IAAIpC,CAAC,GAAG,CAAC;EACT,IAAIqC,CAAC,GAAG,CAAC,CAAC;EACV,OAAO,EAAEA,CAAC,GAAGL,IAAI,CAACnO,MAAM,EAAE;IACxB,MAAMjB,GAAG,GAAGoP,IAAI,CAACK,CAAC,CAAC;IACnB,MAAMC,qBAAqB,GAAG1P,GAAG,KAAK,EAAE,IAAIA,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG;IAC1D,IAAIoN,CAAC,EAAE,KAAK,CAAC,EAAE;MACboC,kBAAkB,GAAGE,qBAAqB;IAC5C,CAAC,MAAM,IAAIF,kBAAkB,KAAKE,qBAAqB,EAAE;MACvD,MAAM,IAAIvM,0BAA0B,CAClC,IAAA4F,oBAAa,EAACG,cAAc,CAAC,EAC7BjG,IAAI,EACJ,sEAAsE,GACpE,sEAAsE,GACtE,uDACJ,CAAC;IACH;EACF;EAEA,OAAOuM,kBAAkB;AAC3B;AAOA,SAASG,mCAAmCA,CAAC3D,KAAK,EAAE4D,QAAQ,EAAE3M,IAAI,EAAE;EAClE,MAAMuF,SAAS,GAAG,IAAAO,oBAAa,EAAC6G,QAAQ,CAAC;EACzC,IAAI/D,sBAAsB,CAACpM,GAAG,CAAC+I,SAAS,GAAG,GAAG,GAAGwD,KAAK,CAAC,EAAE;EACzDH,sBAAsB,CAACgE,GAAG,CAACrH,SAAS,GAAG,GAAG,GAAGwD,KAAK,CAAC;EACnDzL,SAAMA,CAAC,CAAC6L,WAAW,CAChB,qDAAoDJ,KAAM,WAAU,GAClE,uDAAsDxD,SAAU,GAC/DvF,IAAI,GAAI,kBAAiB,IAAA8F,oBAAa,EAAC9F,IAAI,CAAE,EAAC,GAAG,EAClD,4DAA2D,EAC9D,oBAAoB,EACpB,SACF,CAAC;AACH;AAUA,SAAS6M,qBAAqBA,CAC5B5G,cAAc,EACd6F,cAAc,EACdxG,aAAa,EACbtF,IAAI,EACJgI,UAAU,EACV;EACA,IAAItC,OAAO,GAAGJ,aAAa,CAACI,OAAO;EAEnC,IAAI4G,6BAA6B,CAAC5G,OAAO,EAAEO,cAAc,EAAEjG,IAAI,CAAC,EAAE;IAChE0F,OAAO,GAAG;MAAC,GAAG,EAAEA;IAAO,CAAC;EAC1B;EAEA,IACE4C,GAAG,CAACpL,IAAI,CAACwI,OAAO,EAAEoG,cAAc,CAAC,IACjC,CAACA,cAAc,CAAC7M,QAAQ,CAAC,GAAG,CAAC,IAC7B,CAAC6M,cAAc,CAAC9M,QAAQ,CAAC,GAAG,CAAC,EAC7B;IAEA,MAAMuB,MAAM,GAAGmF,OAAO,CAACoG,cAAc,CAAC;IACtC,MAAMI,aAAa,GAAGL,oBAAoB,CACxC5F,cAAc,EACd1F,MAAM,EACN,EAAE,EACFuL,cAAc,EACd9L,IAAI,EACJ,KAAK,EACL,KAAK,EACL,KAAK,EACLgI,UACF,CAAC;IACD,IAAIkE,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAKjM,SAAS,EAAE;MACzD,MAAM8K,eAAe,CAACe,cAAc,EAAE7F,cAAc,EAAEjG,IAAI,CAAC;IAC7D;IAEA,OAAOkM,aAAa;EACtB;EAEA,IAAIY,SAAS,GAAG,EAAE;EAClB,IAAIC,gBAAgB,GAAG,EAAE;EACzB,MAAMZ,IAAI,GAAGvP,MAAM,CAACwP,mBAAmB,CAAC1G,OAAO,CAAC;EAChD,IAAIyE,CAAC,GAAG,CAAC,CAAC;EAEV,OAAO,EAAEA,CAAC,GAAGgC,IAAI,CAACnO,MAAM,EAAE;IACxB,MAAMjB,GAAG,GAAGoP,IAAI,CAAChC,CAAC,CAAC;IACnB,MAAM6C,YAAY,GAAGjQ,GAAG,CAAC2C,OAAO,CAAC,GAAG,CAAC;IAErC,IACEsN,YAAY,KAAK,CAAC,CAAC,IACnBlB,cAAc,CAACpL,UAAU,CAAC3D,GAAG,CAACmB,KAAK,CAAC,CAAC,EAAE8O,YAAY,CAAC,CAAC,EACrD;MAOA,IAAIlB,cAAc,CAAC9M,QAAQ,CAAC,GAAG,CAAC,EAAE;QAChC0N,mCAAmC,CACjCZ,cAAc,EACd7F,cAAc,EACdjG,IACF,CAAC;MACH;MAEA,MAAMiN,cAAc,GAAGlQ,GAAG,CAACmB,KAAK,CAAC8O,YAAY,GAAG,CAAC,CAAC;MAElD,IACElB,cAAc,CAAC9N,MAAM,IAAIjB,GAAG,CAACiB,MAAM,IACnC8N,cAAc,CAAC9M,QAAQ,CAACiO,cAAc,CAAC,IACvCC,iBAAiB,CAACJ,SAAS,EAAE/P,GAAG,CAAC,KAAK,CAAC,IACvCA,GAAG,CAACoQ,WAAW,CAAC,GAAG,CAAC,KAAKH,YAAY,EACrC;QACAF,SAAS,GAAG/P,GAAG;QACfgQ,gBAAgB,GAAGjB,cAAc,CAAC5N,KAAK,CACrC8O,YAAY,EACZlB,cAAc,CAAC9N,MAAM,GAAGiP,cAAc,CAACjP,MACzC,CAAC;MACH;IACF;EACF;EAEA,IAAI8O,SAAS,EAAE;IAEb,MAAMvM,MAAM,GAA2BmF,OAAO,CAACoH,SAAS,CAAE;IAC1D,MAAMZ,aAAa,GAAGL,oBAAoB,CACxC5F,cAAc,EACd1F,MAAM,EACNwM,gBAAgB,EAChBD,SAAS,EACT9M,IAAI,EACJ,IAAI,EACJ,KAAK,EACL8L,cAAc,CAAC9M,QAAQ,CAAC,GAAG,CAAC,EAC5BgJ,UACF,CAAC;IAED,IAAIkE,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAKjM,SAAS,EAAE;MACzD,MAAM8K,eAAe,CAACe,cAAc,EAAE7F,cAAc,EAAEjG,IAAI,CAAC;IAC7D;IAEA,OAAOkM,aAAa;EACtB;EAEA,MAAMnB,eAAe,CAACe,cAAc,EAAE7F,cAAc,EAAEjG,IAAI,CAAC;AAC7D;AAMA,SAASkN,iBAAiBA,CAACE,CAAC,EAAEC,CAAC,EAAE;EAC/B,MAAMC,aAAa,GAAGF,CAAC,CAAC1N,OAAO,CAAC,GAAG,CAAC;EACpC,MAAM6N,aAAa,GAAGF,CAAC,CAAC3N,OAAO,CAAC,GAAG,CAAC;EACpC,MAAM8N,WAAW,GAAGF,aAAa,KAAK,CAAC,CAAC,GAAGF,CAAC,CAACpP,MAAM,GAAGsP,aAAa,GAAG,CAAC;EACvE,MAAMG,WAAW,GAAGF,aAAa,KAAK,CAAC,CAAC,GAAGF,CAAC,CAACrP,MAAM,GAAGuP,aAAa,GAAG,CAAC;EACvE,IAAIC,WAAW,GAAGC,WAAW,EAAE,OAAO,CAAC,CAAC;EACxC,IAAIA,WAAW,GAAGD,WAAW,EAAE,OAAO,CAAC;EACvC,IAAIF,aAAa,KAAK,CAAC,CAAC,EAAE,OAAO,CAAC;EAClC,IAAIC,aAAa,KAAK,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;EACnC,IAAIH,CAAC,CAACpP,MAAM,GAAGqP,CAAC,CAACrP,MAAM,EAAE,OAAO,CAAC,CAAC;EAClC,IAAIqP,CAAC,CAACrP,MAAM,GAAGoP,CAAC,CAACpP,MAAM,EAAE,OAAO,CAAC;EACjC,OAAO,CAAC;AACV;AAQA,SAAS0P,qBAAqBA,CAACjP,IAAI,EAAEuB,IAAI,EAAEgI,UAAU,EAAE;EACrD,IAAIvJ,IAAI,KAAK,GAAG,IAAIA,IAAI,CAACiC,UAAU,CAAC,IAAI,CAAC,IAAIjC,IAAI,CAACO,QAAQ,CAAC,GAAG,CAAC,EAAE;IAC/D,MAAMe,MAAM,GAAG,gDAAgD;IAC/D,MAAM,IAAIF,4BAA4B,CAACpB,IAAI,EAAEsB,MAAM,EAAE,IAAA+F,oBAAa,EAAC9F,IAAI,CAAC,CAAC;EAC3E;EAGA,IAAIiG,cAAc;EAElB,MAAMX,aAAa,GAAGS,qBAAqB,CAAC/F,IAAI,CAAC;EAEjD,IAAIsF,aAAa,CAACE,MAAM,EAAE;IACxBS,cAAc,GAAG,IAAA2E,oBAAa,EAACtF,aAAa,CAACC,SAAS,CAAC;IACvD,MAAMI,OAAO,GAAGL,aAAa,CAACK,OAAO;IACrC,IAAIA,OAAO,EAAE;MACX,IAAI2C,GAAG,CAACpL,IAAI,CAACyI,OAAO,EAAElH,IAAI,CAAC,IAAI,CAACA,IAAI,CAACQ,QAAQ,CAAC,GAAG,CAAC,EAAE;QAClD,MAAMiN,aAAa,GAAGL,oBAAoB,CACxC5F,cAAc,EACdN,OAAO,CAAClH,IAAI,CAAC,EACb,EAAE,EACFA,IAAI,EACJuB,IAAI,EACJ,KAAK,EACL,IAAI,EACJ,KAAK,EACLgI,UACF,CAAC;QACD,IAAIkE,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAKjM,SAAS,EAAE;UACzD,OAAOiM,aAAa;QACtB;MACF,CAAC,MAAM;QACL,IAAIY,SAAS,GAAG,EAAE;QAClB,IAAIC,gBAAgB,GAAG,EAAE;QACzB,MAAMZ,IAAI,GAAGvP,MAAM,CAACwP,mBAAmB,CAACzG,OAAO,CAAC;QAChD,IAAIwE,CAAC,GAAG,CAAC,CAAC;QAEV,OAAO,EAAEA,CAAC,GAAGgC,IAAI,CAACnO,MAAM,EAAE;UACxB,MAAMjB,GAAG,GAAGoP,IAAI,CAAChC,CAAC,CAAC;UACnB,MAAM6C,YAAY,GAAGjQ,GAAG,CAAC2C,OAAO,CAAC,GAAG,CAAC;UAErC,IAAIsN,YAAY,KAAK,CAAC,CAAC,IAAIvO,IAAI,CAACiC,UAAU,CAAC3D,GAAG,CAACmB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;YAC5D,MAAM+O,cAAc,GAAGlQ,GAAG,CAACmB,KAAK,CAAC8O,YAAY,GAAG,CAAC,CAAC;YAClD,IACEvO,IAAI,CAACT,MAAM,IAAIjB,GAAG,CAACiB,MAAM,IACzBS,IAAI,CAACO,QAAQ,CAACiO,cAAc,CAAC,IAC7BC,iBAAiB,CAACJ,SAAS,EAAE/P,GAAG,CAAC,KAAK,CAAC,IACvCA,GAAG,CAACoQ,WAAW,CAAC,GAAG,CAAC,KAAKH,YAAY,EACrC;cACAF,SAAS,GAAG/P,GAAG;cACfgQ,gBAAgB,GAAGtO,IAAI,CAACP,KAAK,CAC3B8O,YAAY,EACZvO,IAAI,CAACT,MAAM,GAAGiP,cAAc,CAACjP,MAC/B,CAAC;YACH;UACF;QACF;QAEA,IAAI8O,SAAS,EAAE;UACb,MAAMvM,MAAM,GAAGoF,OAAO,CAACmH,SAAS,CAAC;UACjC,MAAMZ,aAAa,GAAGL,oBAAoB,CACxC5F,cAAc,EACd1F,MAAM,EACNwM,gBAAgB,EAChBD,SAAS,EACT9M,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,KAAK,EACLgI,UACF,CAAC;UAED,IAAIkE,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAKjM,SAAS,EAAE;YACzD,OAAOiM,aAAa;UACtB;QACF;MACF;IACF;EACF;EAEA,MAAMpB,gBAAgB,CAACrM,IAAI,EAAEwH,cAAc,EAAEjG,IAAI,CAAC;AACpD;AAUA,SAAS2N,gBAAgBA,CAAC3M,SAAS,EAAEhB,IAAI,EAAE;EACzC,IAAI4N,cAAc,GAAG5M,SAAS,CAACtB,OAAO,CAAC,GAAG,CAAC;EAC3C,IAAImO,gBAAgB,GAAG,IAAI;EAC3B,IAAIC,QAAQ,GAAG,KAAK;EACpB,IAAI9M,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IACxB8M,QAAQ,GAAG,IAAI;IACf,IAAIF,cAAc,KAAK,CAAC,CAAC,IAAI5M,SAAS,CAAChD,MAAM,KAAK,CAAC,EAAE;MACnD6P,gBAAgB,GAAG,KAAK;IAC1B,CAAC,MAAM;MACLD,cAAc,GAAG5M,SAAS,CAACtB,OAAO,CAAC,GAAG,EAAEkO,cAAc,GAAG,CAAC,CAAC;IAC7D;EACF;EAEA,MAAMG,WAAW,GACfH,cAAc,KAAK,CAAC,CAAC,GAAG5M,SAAS,GAAGA,SAAS,CAAC9C,KAAK,CAAC,CAAC,EAAE0P,cAAc,CAAC;EAIxE,IAAInF,uBAAuB,CAACjJ,IAAI,CAACuO,WAAW,CAAC,KAAK,IAAI,EAAE;IACtDF,gBAAgB,GAAG,KAAK;EAC1B;EAEA,IAAI,CAACA,gBAAgB,EAAE;IACrB,MAAM,IAAIhO,4BAA4B,CACpCmB,SAAS,EACT,6BAA6B,EAC7B,IAAA8E,oBAAa,EAAC9F,IAAI,CACpB,CAAC;EACH;EAEA,MAAM8L,cAAc,GAClB,GAAG,IAAI8B,cAAc,KAAK,CAAC,CAAC,GAAG,EAAE,GAAG5M,SAAS,CAAC9C,KAAK,CAAC0P,cAAc,CAAC,CAAC;EAEtE,OAAO;IAACG,WAAW;IAAEjC,cAAc;IAAEgC;EAAQ,CAAC;AAChD;AAQA,SAAStC,cAAcA,CAACxK,SAAS,EAAEhB,IAAI,EAAEgI,UAAU,EAAE;EACnD,IAAIgG,wBAAc,CAAC/O,QAAQ,CAAC+B,SAAS,CAAC,EAAE;IACtC,OAAO,KAAIkF,UAAG,EAAC,OAAO,GAAGlF,SAAS,CAAC;EACrC;EAEA,MAAM;IAAC+M,WAAW;IAAEjC,cAAc;IAAEgC;EAAQ,CAAC,GAAGH,gBAAgB,CAC9D3M,SAAS,EACThB,IACF,CAAC;EAGD,MAAMsF,aAAa,GAAGS,qBAAqB,CAAC/F,IAAI,CAAC;EAIjD,IAAIsF,aAAa,CAACE,MAAM,EAAE;IACxB,MAAMS,cAAc,GAAG,IAAA2E,oBAAa,EAACtF,aAAa,CAACC,SAAS,CAAC;IAC7D,IACED,aAAa,CAAC7G,IAAI,KAAKsP,WAAW,IAClCzI,aAAa,CAACI,OAAO,KAAKzF,SAAS,IACnCqF,aAAa,CAACI,OAAO,KAAK,IAAI,EAC9B;MACA,OAAOmH,qBAAqB,CAC1B5G,cAAc,EACd6F,cAAc,EACdxG,aAAa,EACbtF,IAAI,EACJgI,UACF,CAAC;IACH;EACF;EAEA,IAAI/B,cAAc,GAAG,KAAIC,UAAG,EAC1B,iBAAiB,GAAG6H,WAAW,GAAG,eAAe,EACjD/N,IACF,CAAC;EACD,IAAImG,eAAe,GAAG,IAAAL,oBAAa,EAACG,cAAc,CAAC;EAEnD,IAAIgI,QAAQ;EACZ,GAAG;IACD,MAAMC,IAAI,GAAG1E,WAAW,CAACrD,eAAe,CAACjI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACvD,IAAI,CAACgQ,IAAI,CAAC3D,WAAW,CAAC,CAAC,EAAE;MACvB0D,QAAQ,GAAG9H,eAAe;MAC1BF,cAAc,GAAG,KAAIC,UAAG,EACtB,CAAC4H,QAAQ,GAAG,2BAA2B,GAAG,wBAAwB,IAChEC,WAAW,GACX,eAAe,EACjB9H,cACF,CAAC;MACDE,eAAe,GAAG,IAAAL,oBAAa,EAACG,cAAc,CAAC;MAC/C;IACF;IAGA,MAAMX,aAAa,GAAGH,gBAAgB,CAACgB,eAAe,EAAEnF,SAAS,EAAEhB,IAAI,CAAC;IACxE,IAAIsF,aAAa,CAACI,OAAO,KAAKzF,SAAS,IAAIqF,aAAa,CAACI,OAAO,KAAK,IAAI,EAAE;MACzE,OAAOmH,qBAAqB,CAC1B5G,cAAc,EACd6F,cAAc,EACdxG,aAAa,EACbtF,IAAI,EACJgI,UACF,CAAC;IACH;IAEA,IAAI8D,cAAc,KAAK,GAAG,EAAE;MAC1B,OAAO9B,iBAAiB,CAAC/D,cAAc,EAAEX,aAAa,EAAEtF,IAAI,CAAC;IAC/D;IAEA,OAAO,KAAIkG,UAAG,EAAC4F,cAAc,EAAE7F,cAAc,CAAC;EAEhD,CAAC,QAAQE,eAAe,CAACnI,MAAM,KAAKiQ,QAAQ,CAACjQ,MAAM;EAEnD,MAAM,IAAI6C,oBAAoB,CAACkN,WAAW,EAAE,IAAAjI,oBAAa,EAAC9F,IAAI,CAAC,CAAC;AAClE;AAMA,SAASmO,mBAAmBA,CAACnN,SAAS,EAAE;EACtC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IACxB,IAAIA,SAAS,CAAChD,MAAM,KAAK,CAAC,IAAIgD,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE,OAAO,IAAI;IAC/D,IACEA,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,KACnBA,SAAS,CAAChD,MAAM,KAAK,CAAC,IAAIgD,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,EAChD;MACA,OAAO,IAAI;IACb;EACF;EAEA,OAAO,KAAK;AACd;AAMA,SAASoN,uCAAuCA,CAACpN,SAAS,EAAE;EAC1D,IAAIA,SAAS,KAAK,EAAE,EAAE,OAAO,KAAK;EAClC,IAAIA,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE,OAAO,IAAI;EACrC,OAAOmN,mBAAmB,CAACnN,SAAS,CAAC;AACvC;AAiBA,SAASqN,aAAaA,CAACrN,SAAS,EAAEhB,IAAI,EAAEgI,UAAU,EAAEqC,gBAAgB,EAAE;EACpE,MAAMxI,QAAQ,GAAG7B,IAAI,CAAC6B,QAAQ;EAC9B,MAAMyM,QAAQ,GAAGzM,QAAQ,KAAK,OAAO,IAAIA,QAAQ,KAAK,QAAQ;EAI9D,IAAImE,QAAQ;EAEZ,IAAIoI,uCAAuC,CAACpN,SAAS,CAAC,EAAE;IACtDgF,QAAQ,GAAG,KAAIE,UAAG,EAAClF,SAAS,EAAEhB,IAAI,CAAC;EACrC,CAAC,MAAM,IAAI,CAACsO,QAAQ,IAAItN,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IAC5CgF,QAAQ,GAAG0H,qBAAqB,CAAC1M,SAAS,EAAEhB,IAAI,EAAEgI,UAAU,CAAC;EAC/D,CAAC,MAAM;IACL,IAAI;MACFhC,QAAQ,GAAG,KAAIE,UAAG,EAAClF,SAAS,CAAC;IAC/B,CAAC,CAAC,OAAAuN,QAAA,EAAM;MACN,IAAI,CAACD,QAAQ,EAAE;QACbtI,QAAQ,GAAGwF,cAAc,CAACxK,SAAS,EAAEhB,IAAI,EAAEgI,UAAU,CAAC;MACxD;IACF;EACF;EAEApJ,QAAKA,CAAC,CAACoH,QAAQ,KAAK/F,SAAS,EAAE,wBAAwB,CAAC;EAExD,IAAI+F,QAAQ,CAACnE,QAAQ,KAAK,OAAO,EAAE;IACjC,OAAOmE,QAAQ;EACjB;EAEA,OAAOoE,kBAAkB,CAACpE,QAAQ,EAAEhG,IAAI,EAAEqK,gBAAgB,CAAC;AAC7D;AAOA,SAASmE,uBAAuBA,CAACxN,SAAS,EAAEiG,MAAM,EAAEwH,eAAe,EAAE;EACnE,IAAIA,eAAe,EAAE;IAEnB,MAAMC,cAAc,GAAGD,eAAe,CAAC5M,QAAQ;IAE/C,IAAI6M,cAAc,KAAK,OAAO,IAAIA,cAAc,KAAK,QAAQ,EAAE;MAC7D,IAAIN,uCAAuC,CAACpN,SAAS,CAAC,EAAE;QAEtD,MAAM2N,cAAc,GAAG1H,MAAM,oBAANA,MAAM,CAAEpF,QAAQ;QAIvC,IACE8M,cAAc,IACdA,cAAc,KAAK,QAAQ,IAC3BA,cAAc,KAAK,OAAO,EAC1B;UACA,MAAM,IAAI7N,6BAA6B,CACrCE,SAAS,EACTyN,eAAe,EACf,qDACF,CAAC;QACH;QAEA,OAAO;UAAC9M,GAAG,EAAE,CAAAsF,MAAM,oBAANA,MAAM,CAAEqC,IAAI,KAAI;QAAE,CAAC;MAClC;MAEA,IAAI0E,wBAAc,CAAC/O,QAAQ,CAAC+B,SAAS,CAAC,EAAE;QACtC,MAAM,IAAIF,6BAA6B,CACrCE,SAAS,EACTyN,eAAe,EACf,qDACF,CAAC;MACH;MAEA,MAAM,IAAI3N,6BAA6B,CACrCE,SAAS,EACTyN,eAAe,EACf,sDACF,CAAC;IACH;EACF;AACF;AAkBA,SAASpD,KAAKA,CAACzH,IAAI,EAAE;EACnB,OAAOgL,OAAO,CACZhL,IAAI,IACF,OAAOA,IAAI,KAAK,QAAQ,IACxB,MAAM,IAAIA,IAAI,IACd,OAAOA,IAAI,CAAC0F,IAAI,KAAK,QAAQ,IAC7B,UAAU,IAAI1F,IAAI,IAClB,OAAOA,IAAI,CAAC/B,QAAQ,KAAK,QAAQ,IACjC+B,IAAI,CAAC0F,IAAI,IACT1F,IAAI,CAAC/B,QACT,CAAC;AACH;AAQA,SAASgN,uBAAuBA,CAACxF,SAAS,EAAE;EAC1C,IAAIA,SAAS,KAAKpJ,SAAS,EAAE;IAC3B;EACF;EAEA,IAAI,OAAOoJ,SAAS,KAAK,QAAQ,IAAI,CAACgC,KAAK,CAAChC,SAAS,CAAC,EAAE;IACtD,MAAM,IAAIzL,KAAK,CAACW,oBAAoB,CAClC,WAAW,EACX,CAAC,QAAQ,EAAE,KAAK,CAAC,EACjB8K,SACF,CAAC;EACH;AACF;AAKA,SAASyF,6BAA6BA,CAACnN,GAAG,EAAE;EAE1C,MAAME,QAAQ,GAAGF,GAAG,CAACE,QAAQ;EAE7B,IAAIA,QAAQ,KAAK,OAAO,IAAIA,QAAQ,KAAK,OAAO,IAAIA,QAAQ,KAAK,OAAO,EAAE;IACxE,MAAM,IAAIH,8BAA8B,CAACC,GAAG,CAAC;EAC/C;AACF;AAMA,SAASoN,2BAA2BA,CAAC9H,MAAM,EAAEoB,0BAA0B,EAAE;EAEvE,MAAMxG,QAAQ,GAAGoF,MAAM,oBAANA,MAAM,CAAEpF,QAAQ;EAEjC,IACEA,QAAQ,IACRA,QAAQ,KAAK,OAAO,IACpBA,QAAQ,KAAK,OAAO,KACnB,CAACwG,0BAA0B,IACzBxG,QAAQ,KAAK,QAAQ,IAAIA,QAAQ,KAAK,OAAQ,CAAC,EAClD;IACA,MAAM,IAAIH,8BAA8B,CACtCuF,MAAM,EACN,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC+H,MAAM,CACrB3G,0BAA0B,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,EACnD,CACF,CAAC;EACH;AACF;AAOA,SAAS4G,cAAcA,CAACjO,SAAS,EAAEyG,OAAO,GAAG,CAAC,CAAC,EAAE;EAC/C,MAAM;IAAC4B;EAAS,CAAC,GAAG5B,OAAO;EAC3B7I,QAAKA,CAAC,CAACyK,SAAS,KAAKpJ,SAAS,EAAE,oCAAoC,CAAC;EACrE4O,uBAAuB,CAACxF,SAAS,CAAC;EAGlC,IAAIoF,eAAe;EACnB,IAAIpF,SAAS,EAAE;IACb,IAAI;MACFoF,eAAe,GAAG,KAAIvI,UAAG,EAACmD,SAAS,CAAC;IACtC,CAAC,CAAC,OAAA6F,QAAA,EAAM,CAER;EACF;EAGA,IAAIjI,MAAM;EACV,IAAI;IACFA,MAAM,GAAGmH,uCAAuC,CAACpN,SAAS,CAAC,GACvD,KAAIkF,UAAG,EAAClF,SAAS,EAAEyN,eAAe,CAAC,GACnC,KAAIvI,UAAG,EAAClF,SAAS,CAAC;IAGtB,MAAMa,QAAQ,GAAGoF,MAAM,CAACpF,QAAQ;IAEhC,IACEA,QAAQ,KAAK,OAAO,IACnBwG,0BAA0B,KACxBxG,QAAQ,KAAK,QAAQ,IAAIA,QAAQ,KAAK,OAAO,CAAE,EAClD;MACA,OAAO;QAACF,GAAG,EAAEsF,MAAM,CAACqC,IAAI;QAAEpF,MAAM,EAAE;MAAI,CAAC;IACzC;EACF,CAAC,CAAC,OAAAiL,QAAA,EAAM,CAER;EAKA,MAAMC,WAAW,GAAGZ,uBAAuB,CACzCxN,SAAS,EACTiG,MAAM,EACNwH,eACF,CAAC;EAED,IAAIW,WAAW,EAAE,OAAOA,WAAW;EAGnC,IAAInI,MAAM,IAAIA,MAAM,CAACpF,QAAQ,KAAK,OAAO,EAAE,OAAO;IAACF,GAAG,EAAEX;EAAS,CAAC;EAElE+N,2BAA2B,CAAC9H,MAAM,EAAEoB,0BAA0B,CAAC;EAE/D,MAAML,UAAU,GAAGD,gBAAgB,CAACN,OAAO,CAACO,UAAU,CAAC;EAEvD,MAAMrG,GAAG,GAAG0M,aAAa,CAACrN,SAAS,EAAE,KAAIkF,UAAG,EAACmD,SAAS,CAAC,EAAErB,UAAU,EAAE,KAAK,CAAC;EAE3E8G,6BAA6B,CAACnN,GAAG,CAAC;EAElC,OAAO;IAGLA,GAAG,EAAEA,GAAG,CAAC2H,IAAI;IACbpF,MAAM,EAAEsD,6BAA6B,CAAC7F,GAAG,EAAE;MAAC0H;IAAS,CAAC;EACxD,CAAC;AACH;AAsBA,SAASgG,OAAOA,CAACrO,SAAS,EAAEsO,MAAM,EAAE;EAClC,IAAI,CAACA,MAAM,EAAE;IACX,MAAM,IAAIlP,KAAK,CACb,kEACF,CAAC;EACH;EAEA,IAAI;IACF,OAAO6O,cAAc,CAACjO,SAAS,EAAE;MAACqI,SAAS,EAAEiG;IAAM,CAAC,CAAC,CAAC3N,GAAG;EAC3D,CAAC,CAAC,OAAOY,KAAK,EAAE;IACd,MAAMyC,SAAS,GAAkCzC,KAAM;IAEvD,IACEyC,SAAS,CAACjC,IAAI,KAAK,4BAA4B,IAC/C,OAAOiC,SAAS,CAACrD,GAAG,KAAK,QAAQ,EACjC;MACA,OAAOqD,SAAS,CAACrD,GAAG;IACtB;IAEA,MAAMY,KAAK;EACb;AACF;AAAC&quot;</span><span class="s0">}</span></pre>
</body>
</html>