<html>
<head>
<title>des.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #67a37c; font-style: italic;}
.s2 { color: #bcbec4;}
.s3 { color: #cf8e6d;}
.s4 { color: #bcbec4;}
.s5 { color: #6aab73;}
.s6 { color: #7a7e85;}
.s7 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
des.js</font>
</center></td></tr></table>
<pre><span class="s0">/**</span>
 <span class="s0">* DES (Data Encryption Standard) implementation.</span>
 <span class="s0">*</span>
 <span class="s0">* This implementation supports DES as well as 3DES-EDE in ECB and CBC mode.</span>
 <span class="s0">* It is based on the BSD-licensed implementation by Paul Tero:</span>
 <span class="s0">*</span>
 <span class="s0">* Paul Tero, July 2001</span>
 <span class="s0">* http://www.tero.co.uk/des/</span>
 <span class="s0">*</span>
 <span class="s0">* Optimised for performance with large blocks by</span>
 <span class="s0">* Michael Hayworth, November 2001</span>
 <span class="s0">* http://www.netdealing.com</span>
 <span class="s0">*</span>
 <span class="s0">* THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND</span>
 <span class="s0">* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
 <span class="s0">* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
 <span class="s0">* ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</span>
 <span class="s0">* FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
 <span class="s0">* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
 <span class="s0">* OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
 <span class="s0">* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
 <span class="s0">* LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
 <span class="s0">* OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
 <span class="s0">* SUCH DAMAGE.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">Stefan Siegl</span>
 <span class="s0">* </span><span class="s1">@author </span><span class="s0">Dave Longley</span>
 <span class="s0">*</span>
 <span class="s0">* Copyright (c) 2012 Stefan Siegl &lt;stesie@brokenpipe.de&gt;</span>
 <span class="s0">* Copyright (c) 2012-2014 Digital Bazaar, Inc.</span>
 <span class="s0">*/</span>
<span class="s3">var </span><span class="s2">forge </span><span class="s4">= </span><span class="s2">require</span><span class="s4">(</span><span class="s5">'./forge'</span><span class="s4">);</span>
<span class="s2">require</span><span class="s4">(</span><span class="s5">'./cipher'</span><span class="s4">);</span>
<span class="s2">require</span><span class="s4">(</span><span class="s5">'./cipherModes'</span><span class="s4">);</span>
<span class="s2">require</span><span class="s4">(</span><span class="s5">'./util'</span><span class="s4">);</span>

<span class="s6">/* DES API */</span>
<span class="s2">module</span><span class="s4">.</span><span class="s2">exports </span><span class="s4">= </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">des </span><span class="s4">= </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">des </span><span class="s4">|| {};</span>

<span class="s0">/**</span>
 <span class="s0">* Deprecated. Instead, use:</span>
 <span class="s0">*</span>
 <span class="s0">* var cipher = forge.cipher.createCipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">* cipher.start({iv: iv});</span>
 <span class="s0">*</span>
 <span class="s0">* Creates an DES cipher object to encrypt data using the given symmetric key.</span>
 <span class="s0">* The output will be stored in the 'output' member of the returned cipher.</span>
 <span class="s0">*</span>
 <span class="s0">* The key and iv may be given as binary-encoded strings of bytes or</span>
 <span class="s0">* byte buffers.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">key the symmetric key to use (64 or 192 bits).</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">iv the initialization vector to use.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">output the buffer to write to, null to create one.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">mode the cipher mode to use (default: 'CBC' if IV is</span>
 <span class="s0">*          given, 'ECB' if null).</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the cipher.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">startEncrypting </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">key</span><span class="s4">, </span><span class="s2">iv</span><span class="s4">, </span><span class="s2">output</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">var </span><span class="s2">cipher </span><span class="s4">= </span><span class="s2">_createCipher</span><span class="s4">({</span>
    <span class="s2">key</span><span class="s4">: </span><span class="s2">key</span><span class="s4">,</span>
    <span class="s2">output</span><span class="s4">: </span><span class="s2">output</span><span class="s4">,</span>
    <span class="s2">decrypt</span><span class="s4">: </span><span class="s3">false</span><span class="s4">,</span>
    <span class="s2">mode</span><span class="s4">: </span><span class="s2">mode </span><span class="s4">|| (</span><span class="s2">iv </span><span class="s4">=== </span><span class="s3">null </span><span class="s4">? </span><span class="s5">'ECB' </span><span class="s4">: </span><span class="s5">'CBC'</span><span class="s4">)</span>
  <span class="s4">});</span>
  <span class="s2">cipher</span><span class="s4">.</span><span class="s2">start</span><span class="s4">(</span><span class="s2">iv</span><span class="s4">);</span>
  <span class="s3">return </span><span class="s2">cipher</span><span class="s4">;</span>
<span class="s4">};</span>

<span class="s0">/**</span>
 <span class="s0">* Deprecated. Instead, use:</span>
 <span class="s0">*</span>
 <span class="s0">* var cipher = forge.cipher.createCipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">*</span>
 <span class="s0">* Creates an DES cipher object to encrypt data using the given symmetric key.</span>
 <span class="s0">*</span>
 <span class="s0">* The key may be given as a binary-encoded string of bytes or a byte buffer.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">key the symmetric key to use (64 or 192 bits).</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">mode the cipher mode to use (default: 'CBC').</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the cipher.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">createEncryptionCipher </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">key</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">return </span><span class="s2">_createCipher</span><span class="s4">({</span>
    <span class="s2">key</span><span class="s4">: </span><span class="s2">key</span><span class="s4">,</span>
    <span class="s2">output</span><span class="s4">: </span><span class="s3">null</span><span class="s4">,</span>
    <span class="s2">decrypt</span><span class="s4">: </span><span class="s3">false</span><span class="s4">,</span>
    <span class="s2">mode</span><span class="s4">: </span><span class="s2">mode</span>
  <span class="s4">});</span>
<span class="s4">};</span>

<span class="s0">/**</span>
 <span class="s0">* Deprecated. Instead, use:</span>
 <span class="s0">*</span>
 <span class="s0">* var decipher = forge.cipher.createDecipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">* decipher.start({iv: iv});</span>
 <span class="s0">*</span>
 <span class="s0">* Creates an DES cipher object to decrypt data using the given symmetric key.</span>
 <span class="s0">* The output will be stored in the 'output' member of the returned cipher.</span>
 <span class="s0">*</span>
 <span class="s0">* The key and iv may be given as binary-encoded strings of bytes or</span>
 <span class="s0">* byte buffers.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">key the symmetric key to use (64 or 192 bits).</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">iv the initialization vector to use.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">output the buffer to write to, null to create one.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">mode the cipher mode to use (default: 'CBC' if IV is</span>
 <span class="s0">*          given, 'ECB' if null).</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the cipher.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">startDecrypting </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">key</span><span class="s4">, </span><span class="s2">iv</span><span class="s4">, </span><span class="s2">output</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">var </span><span class="s2">cipher </span><span class="s4">= </span><span class="s2">_createCipher</span><span class="s4">({</span>
    <span class="s2">key</span><span class="s4">: </span><span class="s2">key</span><span class="s4">,</span>
    <span class="s2">output</span><span class="s4">: </span><span class="s2">output</span><span class="s4">,</span>
    <span class="s2">decrypt</span><span class="s4">: </span><span class="s3">true</span><span class="s4">,</span>
    <span class="s2">mode</span><span class="s4">: </span><span class="s2">mode </span><span class="s4">|| (</span><span class="s2">iv </span><span class="s4">=== </span><span class="s3">null </span><span class="s4">? </span><span class="s5">'ECB' </span><span class="s4">: </span><span class="s5">'CBC'</span><span class="s4">)</span>
  <span class="s4">});</span>
  <span class="s2">cipher</span><span class="s4">.</span><span class="s2">start</span><span class="s4">(</span><span class="s2">iv</span><span class="s4">);</span>
  <span class="s3">return </span><span class="s2">cipher</span><span class="s4">;</span>
<span class="s4">};</span>

<span class="s0">/**</span>
 <span class="s0">* Deprecated. Instead, use:</span>
 <span class="s0">*</span>
 <span class="s0">* var decipher = forge.cipher.createDecipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">*</span>
 <span class="s0">* Creates an DES cipher object to decrypt data using the given symmetric key.</span>
 <span class="s0">*</span>
 <span class="s0">* The key may be given as a binary-encoded string of bytes or a byte buffer.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">key the symmetric key to use (64 or 192 bits).</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">mode the cipher mode to use (default: 'CBC').</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the cipher.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">createDecryptionCipher </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">key</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">return </span><span class="s2">_createCipher</span><span class="s4">({</span>
    <span class="s2">key</span><span class="s4">: </span><span class="s2">key</span><span class="s4">,</span>
    <span class="s2">output</span><span class="s4">: </span><span class="s3">null</span><span class="s4">,</span>
    <span class="s2">decrypt</span><span class="s4">: </span><span class="s3">true</span><span class="s4">,</span>
    <span class="s2">mode</span><span class="s4">: </span><span class="s2">mode</span>
  <span class="s4">});</span>
<span class="s4">};</span>

<span class="s0">/**</span>
 <span class="s0">* Creates a new DES cipher algorithm object.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">name the name of the algorithm.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">mode the mode factory function.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the DES algorithm object.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">Algorithm </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">name</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">var </span><span class="s2">self </span><span class="s4">= </span><span class="s3">this</span><span class="s4">;</span>
  <span class="s2">self</span><span class="s4">.</span><span class="s2">name </span><span class="s4">= </span><span class="s2">name</span><span class="s4">;</span>
  <span class="s2">self</span><span class="s4">.</span><span class="s2">mode </span><span class="s4">= </span><span class="s3">new </span><span class="s2">mode</span><span class="s4">({</span>
    <span class="s2">blockSize</span><span class="s4">: </span><span class="s7">8</span><span class="s4">,</span>
    <span class="s2">cipher</span><span class="s4">: {</span>
      <span class="s2">encrypt</span><span class="s4">: </span><span class="s3">function</span><span class="s4">(</span><span class="s2">inBlock</span><span class="s4">, </span><span class="s2">outBlock</span><span class="s4">) {</span>
        <span class="s3">return </span><span class="s2">_updateBlock</span><span class="s4">(</span><span class="s2">self</span><span class="s4">.</span><span class="s2">_keys</span><span class="s4">, </span><span class="s2">inBlock</span><span class="s4">, </span><span class="s2">outBlock</span><span class="s4">, </span><span class="s3">false</span><span class="s4">);</span>
      <span class="s4">},</span>
      <span class="s2">decrypt</span><span class="s4">: </span><span class="s3">function</span><span class="s4">(</span><span class="s2">inBlock</span><span class="s4">, </span><span class="s2">outBlock</span><span class="s4">) {</span>
        <span class="s3">return </span><span class="s2">_updateBlock</span><span class="s4">(</span><span class="s2">self</span><span class="s4">.</span><span class="s2">_keys</span><span class="s4">, </span><span class="s2">inBlock</span><span class="s4">, </span><span class="s2">outBlock</span><span class="s4">, </span><span class="s3">true</span><span class="s4">);</span>
      <span class="s4">}</span>
    <span class="s4">}</span>
  <span class="s4">});</span>
  <span class="s2">self</span><span class="s4">.</span><span class="s2">_init </span><span class="s4">= </span><span class="s3">false</span><span class="s4">;</span>
<span class="s4">};</span>

<span class="s0">/**</span>
 <span class="s0">* Initializes this DES algorithm by expanding its key.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">options the options to use.</span>
 <span class="s0">*          key the key to use with this algorithm.</span>
 <span class="s0">*          decrypt true if the algorithm should be initialized for decryption,</span>
 <span class="s0">*            false for encryption.</span>
 <span class="s0">*/</span>
<span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">Algorithm</span><span class="s4">.</span><span class="s2">prototype</span><span class="s4">.</span><span class="s2">initialize </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">options</span><span class="s4">) {</span>
  <span class="s3">if</span><span class="s4">(</span><span class="s3">this</span><span class="s4">.</span><span class="s2">_init</span><span class="s4">) {</span>
    <span class="s3">return</span><span class="s4">;</span>
  <span class="s4">}</span>

  <span class="s3">var </span><span class="s2">key </span><span class="s4">= </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">util</span><span class="s4">.</span><span class="s2">createBuffer</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">key</span><span class="s4">);</span>
  <span class="s3">if</span><span class="s4">(</span><span class="s3">this</span><span class="s4">.</span><span class="s2">name</span><span class="s4">.</span><span class="s2">indexOf</span><span class="s4">(</span><span class="s5">'3DES'</span><span class="s4">) === </span><span class="s7">0</span><span class="s4">) {</span>
    <span class="s3">if</span><span class="s4">(</span><span class="s2">key</span><span class="s4">.</span><span class="s2">length</span><span class="s4">() !== </span><span class="s7">24</span><span class="s4">) {</span>
      <span class="s3">throw new </span><span class="s2">Error</span><span class="s4">(</span><span class="s5">'Invalid Triple-DES key size: ' </span><span class="s4">+ </span><span class="s2">key</span><span class="s4">.</span><span class="s2">length</span><span class="s4">() * </span><span class="s7">8</span><span class="s4">);</span>
    <span class="s4">}</span>
  <span class="s4">}</span>

  <span class="s6">// do key expansion to 16 or 48 subkeys (single or triple DES)</span>
  <span class="s3">this</span><span class="s4">.</span><span class="s2">_keys </span><span class="s4">= </span><span class="s2">_createKeys</span><span class="s4">(</span><span class="s2">key</span><span class="s4">);</span>
  <span class="s3">this</span><span class="s4">.</span><span class="s2">_init </span><span class="s4">= </span><span class="s3">true</span><span class="s4">;</span>
<span class="s4">};</span>

<span class="s0">/** Register DES algorithms **/</span>

<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'DES-ECB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ecb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'DES-CBC'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">cbc</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'DES-CFB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">cfb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'DES-OFB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ofb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'DES-CTR'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ctr</span><span class="s4">);</span>

<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'3DES-ECB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ecb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'3DES-CBC'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">cbc</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'3DES-CFB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">cfb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'3DES-OFB'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ofb</span><span class="s4">);</span>
<span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s5">'3DES-CTR'</span><span class="s4">, </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">modes</span><span class="s4">.</span><span class="s2">ctr</span><span class="s4">);</span>

<span class="s3">function </span><span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s2">name</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">) {</span>
  <span class="s3">var </span><span class="s2">factory </span><span class="s4">= </span><span class="s3">function</span><span class="s4">() {</span>
    <span class="s3">return new </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">des</span><span class="s4">.</span><span class="s2">Algorithm</span><span class="s4">(</span><span class="s2">name</span><span class="s4">, </span><span class="s2">mode</span><span class="s4">);</span>
  <span class="s4">};</span>
  <span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">registerAlgorithm</span><span class="s4">(</span><span class="s2">name</span><span class="s4">, </span><span class="s2">factory</span><span class="s4">);</span>
<span class="s4">}</span>

<span class="s0">/** DES implementation **/</span>

<span class="s3">var </span><span class="s2">spfunction1 </span><span class="s4">= [</span><span class="s7">0x1010400</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x1010404</span><span class="s4">,</span><span class="s7">0x1010004</span><span class="s4">,</span><span class="s7">0x10404</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x1010400</span><span class="s4">,</span><span class="s7">0x1010404</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x1000404</span><span class="s4">,</span><span class="s7">0x1010004</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x404</span><span class="s4">,</span><span class="s7">0x1000400</span><span class="s4">,</span><span class="s7">0x1000400</span><span class="s4">,</span><span class="s7">0x10400</span><span class="s4">,</span><span class="s7">0x10400</span><span class="s4">,</span><span class="s7">0x1010000</span><span class="s4">,</span><span class="s7">0x1010000</span><span class="s4">,</span><span class="s7">0x1000404</span><span class="s4">,</span><span class="s7">0x10004</span><span class="s4">,</span><span class="s7">0x1000004</span><span class="s4">,</span><span class="s7">0x1000004</span><span class="s4">,</span><span class="s7">0x10004</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x404</span><span class="s4">,</span><span class="s7">0x10404</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x1010404</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x1010000</span><span class="s4">,</span><span class="s7">0x1010400</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x1010004</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x10400</span><span class="s4">,</span><span class="s7">0x1000004</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x1000404</span><span class="s4">,</span><span class="s7">0x10404</span><span class="s4">,</span><span class="s7">0x1010404</span><span class="s4">,</span><span class="s7">0x10004</span><span class="s4">,</span><span class="s7">0x1010000</span><span class="s4">,</span><span class="s7">0x1000404</span><span class="s4">,</span><span class="s7">0x1000004</span><span class="s4">,</span><span class="s7">0x404</span><span class="s4">,</span><span class="s7">0x10404</span><span class="s4">,</span><span class="s7">0x1010400</span><span class="s4">,</span><span class="s7">0x404</span><span class="s4">,</span><span class="s7">0x1000400</span><span class="s4">,</span><span class="s7">0x1000400</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10004</span><span class="s4">,</span><span class="s7">0x10400</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x1010004</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction2 </span><span class="s4">= [-</span><span class="s7">0x7fef7fe0</span><span class="s4">,-</span><span class="s7">0x7fff8000</span><span class="s4">,</span><span class="s7">0x8000</span><span class="s4">,</span><span class="s7">0x108020</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,-</span><span class="s7">0x7fefffe0</span><span class="s4">,-</span><span class="s7">0x7fff7fe0</span><span class="s4">,-</span><span class="s7">0x7fffffe0</span><span class="s4">,-</span><span class="s7">0x7fef7fe0</span><span class="s4">,-</span><span class="s7">0x7fef8000</span><span class="s4">,-</span><span class="s7">0x80000000</span><span class="s4">,-</span><span class="s7">0x7fff8000</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,-</span><span class="s7">0x7fefffe0</span><span class="s4">,</span><span class="s7">0x108000</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,-</span><span class="s7">0x7fff7fe0</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,-</span><span class="s7">0x80000000</span><span class="s4">,</span><span class="s7">0x8000</span><span class="s4">,</span><span class="s7">0x108020</span><span class="s4">,-</span><span class="s7">0x7ff00000</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,-</span><span class="s7">0x7fffffe0</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x108000</span><span class="s4">,</span><span class="s7">0x8020</span><span class="s4">,-</span><span class="s7">0x7fef8000</span><span class="s4">,-</span><span class="s7">0x7ff00000</span><span class="s4">,</span><span class="s7">0x8020</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x108020</span><span class="s4">,-</span><span class="s7">0x7fefffe0</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,-</span><span class="s7">0x7fff7fe0</span><span class="s4">,-</span><span class="s7">0x7ff00000</span><span class="s4">,-</span><span class="s7">0x7fef8000</span><span class="s4">,</span><span class="s7">0x8000</span><span class="s4">,-</span><span class="s7">0x7ff00000</span><span class="s4">,-</span><span class="s7">0x7fff8000</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,-</span><span class="s7">0x7fef7fe0</span><span class="s4">,</span><span class="s7">0x108020</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,</span><span class="s7">0x8000</span><span class="s4">,-</span><span class="s7">0x80000000</span><span class="s4">,</span><span class="s7">0x8020</span><span class="s4">,-</span><span class="s7">0x7fef8000</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,-</span><span class="s7">0x7fffffe0</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,-</span><span class="s7">0x7fff7fe0</span><span class="s4">,-</span><span class="s7">0x7fffffe0</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,</span><span class="s7">0x108000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,-</span><span class="s7">0x7fff8000</span><span class="s4">,</span><span class="s7">0x8020</span><span class="s4">,-</span><span class="s7">0x80000000</span><span class="s4">,-</span><span class="s7">0x7fefffe0</span><span class="s4">,-</span><span class="s7">0x7fef7fe0</span><span class="s4">,</span><span class="s7">0x108000</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction3 </span><span class="s4">= [</span><span class="s7">0x208</span><span class="s4">,</span><span class="s7">0x8020200</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x8020008</span><span class="s4">,</span><span class="s7">0x8000200</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x20208</span><span class="s4">,</span><span class="s7">0x8000200</span><span class="s4">,</span><span class="s7">0x20008</span><span class="s4">,</span><span class="s7">0x8000008</span><span class="s4">,</span><span class="s7">0x8000008</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x8020208</span><span class="s4">,</span><span class="s7">0x20008</span><span class="s4">,</span><span class="s7">0x8020000</span><span class="s4">,</span><span class="s7">0x208</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x8020200</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0x20200</span><span class="s4">,</span><span class="s7">0x8020000</span><span class="s4">,</span><span class="s7">0x8020008</span><span class="s4">,</span><span class="s7">0x20208</span><span class="s4">,</span><span class="s7">0x8000208</span><span class="s4">,</span><span class="s7">0x20200</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x8000208</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x8020208</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x8020200</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x20008</span><span class="s4">,</span><span class="s7">0x208</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x8020200</span><span class="s4">,</span><span class="s7">0x8000200</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0x20008</span><span class="s4">,</span><span class="s7">0x8020208</span><span class="s4">,</span><span class="s7">0x8000200</span><span class="s4">,</span><span class="s7">0x8000008</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x8020008</span><span class="s4">,</span><span class="s7">0x8000208</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x8020208</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x20208</span><span class="s4">,</span><span class="s7">0x20200</span><span class="s4">,</span><span class="s7">0x8000008</span><span class="s4">,</span><span class="s7">0x8020000</span><span class="s4">,</span><span class="s7">0x8000208</span><span class="s4">,</span><span class="s7">0x208</span><span class="s4">,</span><span class="s7">0x8020000</span><span class="s4">,</span><span class="s7">0x20208</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x8020008</span><span class="s4">,</span><span class="s7">0x20200</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction4 </span><span class="s4">= [</span><span class="s7">0x802001</span><span class="s4">,</span><span class="s7">0x2081</span><span class="s4">,</span><span class="s7">0x2081</span><span class="s4">,</span><span class="s7">0x80</span><span class="s4">,</span><span class="s7">0x802080</span><span class="s4">,</span><span class="s7">0x800081</span><span class="s4">,</span><span class="s7">0x800001</span><span class="s4">,</span><span class="s7">0x2001</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x802000</span><span class="s4">,</span><span class="s7">0x802000</span><span class="s4">,</span><span class="s7">0x802081</span><span class="s4">,</span><span class="s7">0x81</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x800080</span><span class="s4">,</span><span class="s7">0x800001</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x800000</span><span class="s4">,</span><span class="s7">0x802001</span><span class="s4">,</span><span class="s7">0x80</span><span class="s4">,</span><span class="s7">0x800000</span><span class="s4">,</span><span class="s7">0x2001</span><span class="s4">,</span><span class="s7">0x2080</span><span class="s4">,</span><span class="s7">0x800081</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x2080</span><span class="s4">,</span><span class="s7">0x800080</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x802080</span><span class="s4">,</span><span class="s7">0x802081</span><span class="s4">,</span><span class="s7">0x81</span><span class="s4">,</span><span class="s7">0x800080</span><span class="s4">,</span><span class="s7">0x800001</span><span class="s4">,</span><span class="s7">0x802000</span><span class="s4">,</span><span class="s7">0x802081</span><span class="s4">,</span><span class="s7">0x81</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x802000</span><span class="s4">,</span><span class="s7">0x2080</span><span class="s4">,</span><span class="s7">0x800080</span><span class="s4">,</span><span class="s7">0x800081</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x802001</span><span class="s4">,</span><span class="s7">0x2081</span><span class="s4">,</span><span class="s7">0x2081</span><span class="s4">,</span><span class="s7">0x80</span><span class="s4">,</span><span class="s7">0x802081</span><span class="s4">,</span><span class="s7">0x81</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x800001</span><span class="s4">,</span><span class="s7">0x2001</span><span class="s4">,</span><span class="s7">0x802080</span><span class="s4">,</span><span class="s7">0x800081</span><span class="s4">,</span><span class="s7">0x2001</span><span class="s4">,</span><span class="s7">0x2080</span><span class="s4">,</span><span class="s7">0x800000</span><span class="s4">,</span><span class="s7">0x802001</span><span class="s4">,</span><span class="s7">0x80</span><span class="s4">,</span><span class="s7">0x800000</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x802080</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction5 </span><span class="s4">= [</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x2080100</span><span class="s4">,</span><span class="s7">0x2080000</span><span class="s4">,</span><span class="s7">0x42000100</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x40000000</span><span class="s4">,</span><span class="s7">0x2080000</span><span class="s4">,</span><span class="s7">0x40080100</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x2000100</span><span class="s4">,</span><span class="s7">0x40080100</span><span class="s4">,</span><span class="s7">0x42000100</span><span class="s4">,</span><span class="s7">0x42080000</span><span class="s4">,</span><span class="s7">0x80100</span><span class="s4">,</span><span class="s7">0x40000000</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x40080000</span><span class="s4">,</span><span class="s7">0x40080000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40000100</span><span class="s4">,</span><span class="s7">0x42080100</span><span class="s4">,</span><span class="s7">0x42080100</span><span class="s4">,</span><span class="s7">0x2000100</span><span class="s4">,</span><span class="s7">0x42080000</span><span class="s4">,</span><span class="s7">0x40000100</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x42000000</span><span class="s4">,</span><span class="s7">0x2080100</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x42000000</span><span class="s4">,</span><span class="s7">0x80100</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x42000100</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x40000000</span><span class="s4">,</span><span class="s7">0x2080000</span><span class="s4">,</span><span class="s7">0x42000100</span><span class="s4">,</span><span class="s7">0x40080100</span><span class="s4">,</span><span class="s7">0x2000100</span><span class="s4">,</span><span class="s7">0x40000000</span><span class="s4">,</span><span class="s7">0x42080000</span><span class="s4">,</span><span class="s7">0x2080100</span><span class="s4">,</span><span class="s7">0x40080100</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x42080000</span><span class="s4">,</span><span class="s7">0x42080100</span><span class="s4">,</span><span class="s7">0x80100</span><span class="s4">,</span><span class="s7">0x42000000</span><span class="s4">,</span><span class="s7">0x42080100</span><span class="s4">,</span><span class="s7">0x2080000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40080000</span><span class="s4">,</span><span class="s7">0x42000000</span><span class="s4">,</span><span class="s7">0x80100</span><span class="s4">,</span><span class="s7">0x2000100</span><span class="s4">,</span><span class="s7">0x40000100</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40080000</span><span class="s4">,</span><span class="s7">0x2080100</span><span class="s4">,</span><span class="s7">0x40000100</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction6 </span><span class="s4">= [</span><span class="s7">0x20000010</span><span class="s4">,</span><span class="s7">0x20400000</span><span class="s4">,</span><span class="s7">0x4000</span><span class="s4">,</span><span class="s7">0x20404010</span><span class="s4">,</span><span class="s7">0x20400000</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x20404010</span><span class="s4">,</span><span class="s7">0x400000</span><span class="s4">,</span><span class="s7">0x20004000</span><span class="s4">,</span><span class="s7">0x404010</span><span class="s4">,</span><span class="s7">0x400000</span><span class="s4">,</span><span class="s7">0x20000010</span><span class="s4">,</span><span class="s7">0x400010</span><span class="s4">,</span><span class="s7">0x20004000</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x4010</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x400010</span><span class="s4">,</span><span class="s7">0x20004010</span><span class="s4">,</span><span class="s7">0x4000</span><span class="s4">,</span><span class="s7">0x404000</span><span class="s4">,</span><span class="s7">0x20004010</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x20400010</span><span class="s4">,</span><span class="s7">0x20400010</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x404010</span><span class="s4">,</span><span class="s7">0x20404000</span><span class="s4">,</span><span class="s7">0x4010</span><span class="s4">,</span><span class="s7">0x404000</span><span class="s4">,</span><span class="s7">0x20404000</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x20004000</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x20400010</span><span class="s4">,</span><span class="s7">0x404000</span><span class="s4">,</span><span class="s7">0x20404010</span><span class="s4">,</span><span class="s7">0x400000</span><span class="s4">,</span><span class="s7">0x4010</span><span class="s4">,</span><span class="s7">0x20000010</span><span class="s4">,</span><span class="s7">0x400000</span><span class="s4">,</span><span class="s7">0x20004000</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x4010</span><span class="s4">,</span><span class="s7">0x20000010</span><span class="s4">,</span><span class="s7">0x20404010</span><span class="s4">,</span><span class="s7">0x404000</span><span class="s4">,</span><span class="s7">0x20400000</span><span class="s4">,</span><span class="s7">0x404010</span><span class="s4">,</span><span class="s7">0x20404000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x20400010</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x4000</span><span class="s4">,</span><span class="s7">0x20400000</span><span class="s4">,</span><span class="s7">0x404010</span><span class="s4">,</span><span class="s7">0x4000</span><span class="s4">,</span><span class="s7">0x400010</span><span class="s4">,</span><span class="s7">0x20004010</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x20404000</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x400010</span><span class="s4">,</span><span class="s7">0x20004010</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction7 </span><span class="s4">= [</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0x4200002</span><span class="s4">,</span><span class="s7">0x4000802</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x4000802</span><span class="s4">,</span><span class="s7">0x200802</span><span class="s4">,</span><span class="s7">0x4200800</span><span class="s4">,</span><span class="s7">0x4200802</span><span class="s4">,</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x4000002</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x4200002</span><span class="s4">,</span><span class="s7">0x802</span><span class="s4">,</span><span class="s7">0x4000800</span><span class="s4">,</span><span class="s7">0x200802</span><span class="s4">,</span><span class="s7">0x200002</span><span class="s4">,</span><span class="s7">0x4000800</span><span class="s4">,</span><span class="s7">0x4000002</span><span class="s4">,</span><span class="s7">0x4200000</span><span class="s4">,</span><span class="s7">0x4200800</span><span class="s4">,</span><span class="s7">0x200002</span><span class="s4">,</span><span class="s7">0x4200000</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x802</span><span class="s4">,</span><span class="s7">0x4200802</span><span class="s4">,</span><span class="s7">0x200800</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x200800</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x200800</span><span class="s4">,</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0x4000802</span><span class="s4">,</span><span class="s7">0x4000802</span><span class="s4">,</span><span class="s7">0x4200002</span><span class="s4">,</span><span class="s7">0x4200002</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x200002</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x4000800</span><span class="s4">,</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0x4200800</span><span class="s4">,</span><span class="s7">0x802</span><span class="s4">,</span><span class="s7">0x200802</span><span class="s4">,</span><span class="s7">0x4200800</span><span class="s4">,</span><span class="s7">0x802</span><span class="s4">,</span><span class="s7">0x4000002</span><span class="s4">,</span><span class="s7">0x4200802</span><span class="s4">,</span><span class="s7">0x4200000</span><span class="s4">,</span><span class="s7">0x200800</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x4200802</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x200802</span><span class="s4">,</span><span class="s7">0x4200000</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x4000002</span><span class="s4">,</span><span class="s7">0x4000800</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x200002</span><span class="s4">];</span>
<span class="s3">var </span><span class="s2">spfunction8 </span><span class="s4">= [</span><span class="s7">0x10001040</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x10041040</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x10001040</span><span class="s4">,</span><span class="s7">0x40</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x40040</span><span class="s4">,</span><span class="s7">0x10040000</span><span class="s4">,</span><span class="s7">0x10041040</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x10041000</span><span class="s4">,</span><span class="s7">0x41040</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x40</span><span class="s4">,</span><span class="s7">0x10040000</span><span class="s4">,</span><span class="s7">0x10000040</span><span class="s4">,</span><span class="s7">0x10001000</span><span class="s4">,</span><span class="s7">0x1040</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x40040</span><span class="s4">,</span><span class="s7">0x10040040</span><span class="s4">,</span><span class="s7">0x10041000</span><span class="s4">,</span><span class="s7">0x1040</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10040040</span><span class="s4">,</span><span class="s7">0x10000040</span><span class="s4">,</span><span class="s7">0x10001000</span><span class="s4">,</span><span class="s7">0x41040</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x41040</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x10041000</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x40</span><span class="s4">,</span><span class="s7">0x10040040</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x41040</span><span class="s4">,</span><span class="s7">0x10001000</span><span class="s4">,</span><span class="s7">0x40</span><span class="s4">,</span><span class="s7">0x10000040</span><span class="s4">,</span><span class="s7">0x10040000</span><span class="s4">,</span><span class="s7">0x10040040</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x10001040</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10041040</span><span class="s4">,</span><span class="s7">0x40040</span><span class="s4">,</span><span class="s7">0x10000040</span><span class="s4">,</span><span class="s7">0x10040000</span><span class="s4">,</span><span class="s7">0x10001000</span><span class="s4">,</span><span class="s7">0x10001040</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10041040</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x1040</span><span class="s4">,</span><span class="s7">0x1040</span><span class="s4">,</span><span class="s7">0x40040</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x10041000</span><span class="s4">];</span>

<span class="s0">/**</span>
 <span class="s0">* Create necessary sub keys.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">key the 64-bit or 192-bit key.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the expanded keys.</span>
 <span class="s0">*/</span>
<span class="s3">function </span><span class="s2">_createKeys</span><span class="s4">(</span><span class="s2">key</span><span class="s4">) {</span>
  <span class="s3">var </span><span class="s2">pc2bytes0  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x20000004</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x10004</span><span class="s4">,</span><span class="s7">0x20010000</span><span class="s4">,</span><span class="s7">0x20010004</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0x204</span><span class="s4">,</span><span class="s7">0x20000200</span><span class="s4">,</span><span class="s7">0x20000204</span><span class="s4">,</span><span class="s7">0x10200</span><span class="s4">,</span><span class="s7">0x10204</span><span class="s4">,</span><span class="s7">0x20010200</span><span class="s4">,</span><span class="s7">0x20010204</span><span class="s4">],</span>
      <span class="s2">pc2bytes1  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,</span><span class="s7">0x100001</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x4000001</span><span class="s4">,</span><span class="s7">0x4100000</span><span class="s4">,</span><span class="s7">0x4100001</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x101</span><span class="s4">,</span><span class="s7">0x100100</span><span class="s4">,</span><span class="s7">0x100101</span><span class="s4">,</span><span class="s7">0x4000100</span><span class="s4">,</span><span class="s7">0x4000101</span><span class="s4">,</span><span class="s7">0x4100100</span><span class="s4">,</span><span class="s7">0x4100101</span><span class="s4">],</span>
      <span class="s2">pc2bytes2  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x808</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x1000008</span><span class="s4">,</span><span class="s7">0x1000800</span><span class="s4">,</span><span class="s7">0x1000808</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x808</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x1000008</span><span class="s4">,</span><span class="s7">0x1000800</span><span class="s4">,</span><span class="s7">0x1000808</span><span class="s4">],</span>
      <span class="s2">pc2bytes3  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x8200000</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x202000</span><span class="s4">,</span><span class="s7">0x8002000</span><span class="s4">,</span><span class="s7">0x8202000</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x220000</span><span class="s4">,</span><span class="s7">0x8020000</span><span class="s4">,</span><span class="s7">0x8220000</span><span class="s4">,</span><span class="s7">0x22000</span><span class="s4">,</span><span class="s7">0x222000</span><span class="s4">,</span><span class="s7">0x8022000</span><span class="s4">,</span><span class="s7">0x8222000</span><span class="s4">],</span>
      <span class="s2">pc2bytes4  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x40010</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x40010</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x1010</span><span class="s4">,</span><span class="s7">0x41010</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x41000</span><span class="s4">,</span><span class="s7">0x1010</span><span class="s4">,</span><span class="s7">0x41010</span><span class="s4">],</span>
      <span class="s2">pc2bytes5  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,</span><span class="s7">0x420</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,</span><span class="s7">0x420</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x2000400</span><span class="s4">,</span><span class="s7">0x2000020</span><span class="s4">,</span><span class="s7">0x2000420</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x2000400</span><span class="s4">,</span><span class="s7">0x2000020</span><span class="s4">,</span><span class="s7">0x2000420</span><span class="s4">],</span>
      <span class="s2">pc2bytes6  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x10080000</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x10000002</span><span class="s4">,</span><span class="s7">0x80002</span><span class="s4">,</span><span class="s7">0x10080002</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x10080000</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x10000002</span><span class="s4">,</span><span class="s7">0x80002</span><span class="s4">,</span><span class="s7">0x10080002</span><span class="s4">],</span>
      <span class="s2">pc2bytes7  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000</span><span class="s4">,</span><span class="s7">0x800</span><span class="s4">,</span><span class="s7">0x10800</span><span class="s4">,</span><span class="s7">0x20000000</span><span class="s4">,</span><span class="s7">0x20010000</span><span class="s4">,</span><span class="s7">0x20000800</span><span class="s4">,</span><span class="s7">0x20010800</span><span class="s4">,</span><span class="s7">0x20000</span><span class="s4">,</span><span class="s7">0x30000</span><span class="s4">,</span><span class="s7">0x20800</span><span class="s4">,</span><span class="s7">0x30800</span><span class="s4">,</span><span class="s7">0x20020000</span><span class="s4">,</span><span class="s7">0x20030000</span><span class="s4">,</span><span class="s7">0x20020800</span><span class="s4">,</span><span class="s7">0x20030800</span><span class="s4">],</span>
      <span class="s2">pc2bytes8  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x40000</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x40002</span><span class="s4">,</span><span class="s7">0x2</span><span class="s4">,</span><span class="s7">0x40002</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x2040000</span><span class="s4">,</span><span class="s7">0x2000000</span><span class="s4">,</span><span class="s7">0x2040000</span><span class="s4">,</span><span class="s7">0x2000002</span><span class="s4">,</span><span class="s7">0x2040002</span><span class="s4">,</span><span class="s7">0x2000002</span><span class="s4">,</span><span class="s7">0x2040002</span><span class="s4">],</span>
      <span class="s2">pc2bytes9  </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x10000008</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x10000000</span><span class="s4">,</span><span class="s7">0x8</span><span class="s4">,</span><span class="s7">0x10000008</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x10000400</span><span class="s4">,</span><span class="s7">0x408</span><span class="s4">,</span><span class="s7">0x10000408</span><span class="s4">,</span><span class="s7">0x400</span><span class="s4">,</span><span class="s7">0x10000400</span><span class="s4">,</span><span class="s7">0x408</span><span class="s4">,</span><span class="s7">0x10000408</span><span class="s4">],</span>
      <span class="s2">pc2bytes10 </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x20</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,</span><span class="s7">0x100000</span><span class="s4">,</span><span class="s7">0x100020</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x2020</span><span class="s4">,</span><span class="s7">0x2000</span><span class="s4">,</span><span class="s7">0x2020</span><span class="s4">,</span><span class="s7">0x102000</span><span class="s4">,</span><span class="s7">0x102020</span><span class="s4">,</span><span class="s7">0x102000</span><span class="s4">,</span><span class="s7">0x102020</span><span class="s4">],</span>
      <span class="s2">pc2bytes11 </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x1000000</span><span class="s4">,</span><span class="s7">0x200</span><span class="s4">,</span><span class="s7">0x1000200</span><span class="s4">,</span><span class="s7">0x200000</span><span class="s4">,</span><span class="s7">0x1200000</span><span class="s4">,</span><span class="s7">0x200200</span><span class="s4">,</span><span class="s7">0x1200200</span><span class="s4">,</span><span class="s7">0x4000000</span><span class="s4">,</span><span class="s7">0x5000000</span><span class="s4">,</span><span class="s7">0x4000200</span><span class="s4">,</span><span class="s7">0x5000200</span><span class="s4">,</span><span class="s7">0x4200000</span><span class="s4">,</span><span class="s7">0x5200000</span><span class="s4">,</span><span class="s7">0x4200200</span><span class="s4">,</span><span class="s7">0x5200200</span><span class="s4">],</span>
      <span class="s2">pc2bytes12 </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x1000</span><span class="s4">,</span><span class="s7">0x8000000</span><span class="s4">,</span><span class="s7">0x8001000</span><span class="s4">,</span><span class="s7">0x80000</span><span class="s4">,</span><span class="s7">0x81000</span><span class="s4">,</span><span class="s7">0x8080000</span><span class="s4">,</span><span class="s7">0x8081000</span><span class="s4">,</span><span class="s7">0x10</span><span class="s4">,</span><span class="s7">0x1010</span><span class="s4">,</span><span class="s7">0x8000010</span><span class="s4">,</span><span class="s7">0x8001010</span><span class="s4">,</span><span class="s7">0x80010</span><span class="s4">,</span><span class="s7">0x81010</span><span class="s4">,</span><span class="s7">0x8080010</span><span class="s4">,</span><span class="s7">0x8081010</span><span class="s4">],</span>
      <span class="s2">pc2bytes13 </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x104</span><span class="s4">,</span><span class="s7">0</span><span class="s4">,</span><span class="s7">0x4</span><span class="s4">,</span><span class="s7">0x100</span><span class="s4">,</span><span class="s7">0x104</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x5</span><span class="s4">,</span><span class="s7">0x101</span><span class="s4">,</span><span class="s7">0x105</span><span class="s4">,</span><span class="s7">0x1</span><span class="s4">,</span><span class="s7">0x5</span><span class="s4">,</span><span class="s7">0x101</span><span class="s4">,</span><span class="s7">0x105</span><span class="s4">];</span>

  <span class="s6">// how many iterations (1 for des, 3 for triple des)</span>
  <span class="s6">// changed by Paul 16/6/2007 to use Triple DES for 9+ byte keys</span>
  <span class="s3">var </span><span class="s2">iterations </span><span class="s4">= </span><span class="s2">key</span><span class="s4">.</span><span class="s2">length</span><span class="s4">() &gt; </span><span class="s7">8 </span><span class="s4">? </span><span class="s7">3 </span><span class="s4">: </span><span class="s7">1</span><span class="s4">;</span>

  <span class="s6">// stores the return keys</span>
  <span class="s3">var </span><span class="s2">keys </span><span class="s4">= [];</span>

  <span class="s6">// now define the left shifts which need to be done</span>
  <span class="s3">var </span><span class="s2">shifts </span><span class="s4">= [</span><span class="s7">0</span><span class="s4">, </span><span class="s7">0</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">0</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">1</span><span class="s4">, </span><span class="s7">0</span><span class="s4">];</span>

  <span class="s3">var </span><span class="s2">n </span><span class="s4">= </span><span class="s7">0</span><span class="s4">, </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s3">for</span><span class="s4">(</span><span class="s3">var </span><span class="s2">j </span><span class="s4">= </span><span class="s7">0</span><span class="s4">; </span><span class="s2">j </span><span class="s4">&lt; </span><span class="s2">iterations</span><span class="s4">; </span><span class="s2">j</span><span class="s4">++) {</span>
    <span class="s3">var </span><span class="s2">left </span><span class="s4">= </span><span class="s2">key</span><span class="s4">.</span><span class="s2">getInt32</span><span class="s4">();</span>
    <span class="s3">var </span><span class="s2">right </span><span class="s4">= </span><span class="s2">key</span><span class="s4">.</span><span class="s2">getInt32</span><span class="s4">();</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x0f0f0f0f</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">4</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; -</span><span class="s7">16</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x0000ffff</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; -</span><span class="s7">16</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">2</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x33333333</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">2</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; -</span><span class="s7">16</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x0000ffff</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; -</span><span class="s7">16</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x55555555</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x00ff00ff</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">8</span><span class="s4">);</span>

    <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x55555555</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">);</span>

    <span class="s6">// right needs to be shifted and OR'd with last four bits of left</span>
    <span class="s2">tmp </span><span class="s4">= (</span><span class="s2">left </span><span class="s4">&lt;&lt; </span><span class="s7">8</span><span class="s4">) | ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">20</span><span class="s4">) &amp; </span><span class="s7">0x000000f0</span><span class="s4">);</span>

    <span class="s6">// left needs to be put upside down</span>
    <span class="s2">left </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">24</span><span class="s4">) | ((</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0xff0000</span><span class="s4">) |</span>
      <span class="s4">((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0xff00</span><span class="s4">) | ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">24</span><span class="s4">) &amp; </span><span class="s7">0xf0</span><span class="s4">));</span>
    <span class="s2">right </span><span class="s4">= </span><span class="s2">tmp</span><span class="s4">;</span>

    <span class="s6">// now go through and perform these shifts on the left and right keys</span>
    <span class="s3">for</span><span class="s4">(</span><span class="s3">var </span><span class="s2">i </span><span class="s4">= </span><span class="s7">0</span><span class="s4">; </span><span class="s2">i </span><span class="s4">&lt; </span><span class="s2">shifts</span><span class="s4">.</span><span class="s2">length</span><span class="s4">; ++</span><span class="s2">i</span><span class="s4">) {</span>
      <span class="s6">//shift the keys either one or two bits to the left</span>
      <span class="s3">if</span><span class="s4">(</span><span class="s2">shifts</span><span class="s4">[</span><span class="s2">i</span><span class="s4">]) {</span>
        <span class="s2">left </span><span class="s4">= (</span><span class="s2">left </span><span class="s4">&lt;&lt; </span><span class="s7">2</span><span class="s4">) | (</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">26</span><span class="s4">);</span>
        <span class="s2">right </span><span class="s4">= (</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">2</span><span class="s4">) | (</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">26</span><span class="s4">);</span>
      <span class="s4">} </span><span class="s3">else </span><span class="s4">{</span>
        <span class="s2">left </span><span class="s4">= (</span><span class="s2">left </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">27</span><span class="s4">);</span>
        <span class="s2">right </span><span class="s4">= (</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">27</span><span class="s4">);</span>
      <span class="s4">}</span>
      <span class="s2">left </span><span class="s4">&amp;= -</span><span class="s7">0xf</span><span class="s4">;</span>
      <span class="s2">right </span><span class="s4">&amp;= -</span><span class="s7">0xf</span><span class="s4">;</span>

      <span class="s6">// now apply PC-2, in such a way that E is easier when encrypting or</span>
      <span class="s6">// decrypting this conversion will look like PC-2 except only the last 6</span>
      <span class="s6">// bits of each byte are used rather than 48 consecutive bits and the</span>
      <span class="s6">// order of lines will be according to how the S selection functions will</span>
      <span class="s6">// be applied: S2, S4, S6, S8, S1, S3, S5, S7</span>
      <span class="s3">var </span><span class="s2">lefttmp </span><span class="s4">= (</span>
        <span class="s2">pc2bytes0</span><span class="s4">[</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">28</span><span class="s4">] | </span><span class="s2">pc2bytes1</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">24</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes2</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">20</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] | </span><span class="s2">pc2bytes3</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes4</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">12</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] | </span><span class="s2">pc2bytes5</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes6</span><span class="s4">[(</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">]);</span>
      <span class="s3">var </span><span class="s2">righttmp </span><span class="s4">= (</span>
        <span class="s2">pc2bytes7</span><span class="s4">[</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">28</span><span class="s4">] | </span><span class="s2">pc2bytes8</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">24</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes9</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">20</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] | </span><span class="s2">pc2bytes10</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes11</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">12</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] | </span><span class="s2">pc2bytes12</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">] |</span>
        <span class="s2">pc2bytes13</span><span class="s4">[(</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) &amp; </span><span class="s7">0xf</span><span class="s4">]);</span>
      <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">righttmp </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) ^ </span><span class="s2">lefttmp</span><span class="s4">) &amp; </span><span class="s7">0x0000ffff</span><span class="s4">;</span>
      <span class="s2">keys</span><span class="s4">[</span><span class="s2">n</span><span class="s4">++] = </span><span class="s2">lefttmp </span><span class="s4">^ </span><span class="s2">tmp</span><span class="s4">;</span>
      <span class="s2">keys</span><span class="s4">[</span><span class="s2">n</span><span class="s4">++] = </span><span class="s2">righttmp </span><span class="s4">^ (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">16</span><span class="s4">);</span>
    <span class="s4">}</span>
  <span class="s4">}</span>

  <span class="s3">return </span><span class="s2">keys</span><span class="s4">;</span>
<span class="s4">}</span>

<span class="s0">/**</span>
 <span class="s0">* Updates a single block (1 byte) using DES. The update will either</span>
 <span class="s0">* encrypt or decrypt the block.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">keys the expanded keys.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">input the input block (an array of 32-bit words).</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">output the updated output block.</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">decrypt true to decrypt the block, false to encrypt it.</span>
 <span class="s0">*/</span>
<span class="s3">function </span><span class="s2">_updateBlock</span><span class="s4">(</span><span class="s2">keys</span><span class="s4">, </span><span class="s2">input</span><span class="s4">, </span><span class="s2">output</span><span class="s4">, </span><span class="s2">decrypt</span><span class="s4">) {</span>
  <span class="s6">// set up loops for single or triple DES</span>
  <span class="s3">var </span><span class="s2">iterations </span><span class="s4">= </span><span class="s2">keys</span><span class="s4">.</span><span class="s2">length </span><span class="s4">=== </span><span class="s7">32 </span><span class="s4">? </span><span class="s7">3 </span><span class="s4">: </span><span class="s7">9</span><span class="s4">;</span>
  <span class="s3">var </span><span class="s2">looping</span><span class="s4">;</span>
  <span class="s3">if</span><span class="s4">(</span><span class="s2">iterations </span><span class="s4">=== </span><span class="s7">3</span><span class="s4">) {</span>
    <span class="s2">looping </span><span class="s4">= </span><span class="s2">decrypt </span><span class="s4">? [</span><span class="s7">30</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">] : [</span><span class="s7">0</span><span class="s4">, </span><span class="s7">32</span><span class="s4">, </span><span class="s7">2</span><span class="s4">];</span>
  <span class="s4">} </span><span class="s3">else </span><span class="s4">{</span>
    <span class="s2">looping </span><span class="s4">= (</span><span class="s2">decrypt </span><span class="s4">?</span>
      <span class="s4">[</span><span class="s7">94</span><span class="s4">, </span><span class="s7">62</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">, </span><span class="s7">32</span><span class="s4">, </span><span class="s7">64</span><span class="s4">, </span><span class="s7">2</span><span class="s4">, </span><span class="s7">30</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">] :</span>
      <span class="s4">[</span><span class="s7">0</span><span class="s4">, </span><span class="s7">32</span><span class="s4">, </span><span class="s7">2</span><span class="s4">, </span><span class="s7">62</span><span class="s4">, </span><span class="s7">30</span><span class="s4">, -</span><span class="s7">2</span><span class="s4">, </span><span class="s7">64</span><span class="s4">, </span><span class="s7">96</span><span class="s4">, </span><span class="s7">2</span><span class="s4">]);</span>
  <span class="s4">}</span>

  <span class="s3">var </span><span class="s2">tmp</span><span class="s4">;</span>

  <span class="s3">var </span><span class="s2">left </span><span class="s4">= </span><span class="s2">input</span><span class="s4">[</span><span class="s7">0</span><span class="s4">];</span>
  <span class="s3">var </span><span class="s2">right </span><span class="s4">= </span><span class="s2">input</span><span class="s4">[</span><span class="s7">1</span><span class="s4">];</span>

  <span class="s6">// first each 64 bit chunk of the message must be permuted according to IP</span>
  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x0f0f0f0f</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">4</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x0000ffff</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">16</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">2</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x33333333</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">2</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x00ff00ff</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">8</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x55555555</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">);</span>

  <span class="s6">// rotate left 1 bit</span>
  <span class="s2">left </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">31</span><span class="s4">));</span>
  <span class="s2">right </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">31</span><span class="s4">));</span>

  <span class="s3">for</span><span class="s4">(</span><span class="s3">var </span><span class="s2">j </span><span class="s4">= </span><span class="s7">0</span><span class="s4">; </span><span class="s2">j </span><span class="s4">&lt; </span><span class="s2">iterations</span><span class="s4">; </span><span class="s2">j </span><span class="s4">+= </span><span class="s7">3</span><span class="s4">) {</span>
    <span class="s3">var </span><span class="s2">endloop </span><span class="s4">= </span><span class="s2">looping</span><span class="s4">[</span><span class="s2">j </span><span class="s4">+ </span><span class="s7">1</span><span class="s4">];</span>
    <span class="s3">var </span><span class="s2">loopinc </span><span class="s4">= </span><span class="s2">looping</span><span class="s4">[</span><span class="s2">j </span><span class="s4">+ </span><span class="s7">2</span><span class="s4">];</span>

    <span class="s6">// now go through and perform the encryption or decryption</span>
    <span class="s3">for</span><span class="s4">(</span><span class="s3">var </span><span class="s2">i </span><span class="s4">= </span><span class="s2">looping</span><span class="s4">[</span><span class="s2">j</span><span class="s4">]; </span><span class="s2">i </span><span class="s4">!= </span><span class="s2">endloop</span><span class="s4">; </span><span class="s2">i </span><span class="s4">+= </span><span class="s2">loopinc</span><span class="s4">) {</span>
      <span class="s3">var </span><span class="s2">right1 </span><span class="s4">= </span><span class="s2">right </span><span class="s4">^ </span><span class="s2">keys</span><span class="s4">[</span><span class="s2">i</span><span class="s4">];</span>
      <span class="s3">var </span><span class="s2">right2 </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) | (</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">28</span><span class="s4">)) ^ </span><span class="s2">keys</span><span class="s4">[</span><span class="s2">i </span><span class="s4">+ </span><span class="s7">1</span><span class="s4">];</span>

      <span class="s6">// passing these bytes through the S selection functions</span>
      <span class="s2">tmp </span><span class="s4">= </span><span class="s2">left</span><span class="s4">;</span>
      <span class="s2">left </span><span class="s4">= </span><span class="s2">right</span><span class="s4">;</span>
      <span class="s2">right </span><span class="s4">= </span><span class="s2">tmp </span><span class="s4">^ (</span>
        <span class="s2">spfunction2</span><span class="s4">[(</span><span class="s2">right1 </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">24</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction4</span><span class="s4">[(</span><span class="s2">right1 </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction6</span><span class="s4">[(</span><span class="s2">right1 </span><span class="s4">&gt;&gt;&gt;  </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction8</span><span class="s4">[</span><span class="s2">right1 </span><span class="s4">&amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction1</span><span class="s4">[(</span><span class="s2">right2 </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">24</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction3</span><span class="s4">[(</span><span class="s2">right2 </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction5</span><span class="s4">[(</span><span class="s2">right2 </span><span class="s4">&gt;&gt;&gt;  </span><span class="s7">8</span><span class="s4">) &amp; </span><span class="s7">0x3f</span><span class="s4">] |</span>
        <span class="s2">spfunction7</span><span class="s4">[</span><span class="s2">right2 </span><span class="s4">&amp; </span><span class="s7">0x3f</span><span class="s4">]);</span>
    <span class="s4">}</span>
    <span class="s6">// unreverse left and right</span>
    <span class="s2">tmp </span><span class="s4">= </span><span class="s2">left</span><span class="s4">;</span>
    <span class="s2">left </span><span class="s4">= </span><span class="s2">right</span><span class="s4">;</span>
    <span class="s2">right </span><span class="s4">= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s4">}</span>

  <span class="s6">// rotate right 1 bit</span>
  <span class="s2">left </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">left </span><span class="s4">&lt;&lt; </span><span class="s7">31</span><span class="s4">));</span>
  <span class="s2">right </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) | (</span><span class="s2">right </span><span class="s4">&lt;&lt; </span><span class="s7">31</span><span class="s4">));</span>

  <span class="s6">// now perform IP-1, which is IP in the opposite direction</span>
  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">1</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x55555555</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">1</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">8</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x00ff00ff</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">8</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">right </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">2</span><span class="s4">) ^ </span><span class="s2">left</span><span class="s4">) &amp; </span><span class="s7">0x33333333</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">2</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">16</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x0000ffff</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">16</span><span class="s4">);</span>

  <span class="s2">tmp </span><span class="s4">= ((</span><span class="s2">left </span><span class="s4">&gt;&gt;&gt; </span><span class="s7">4</span><span class="s4">) ^ </span><span class="s2">right</span><span class="s4">) &amp; </span><span class="s7">0x0f0f0f0f</span><span class="s4">;</span>
  <span class="s2">right </span><span class="s4">^= </span><span class="s2">tmp</span><span class="s4">;</span>
  <span class="s2">left </span><span class="s4">^= (</span><span class="s2">tmp </span><span class="s4">&lt;&lt; </span><span class="s7">4</span><span class="s4">);</span>

  <span class="s2">output</span><span class="s4">[</span><span class="s7">0</span><span class="s4">] = </span><span class="s2">left</span><span class="s4">;</span>
  <span class="s2">output</span><span class="s4">[</span><span class="s7">1</span><span class="s4">] = </span><span class="s2">right</span><span class="s4">;</span>
<span class="s4">}</span>

<span class="s0">/**</span>
 <span class="s0">* Deprecated. Instead, use:</span>
 <span class="s0">*</span>
 <span class="s0">* forge.cipher.createCipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">* forge.cipher.createDecipher('DES-&lt;mode&gt;', key);</span>
 <span class="s0">*</span>
 <span class="s0">* Creates a deprecated DES cipher object. This object's mode will default to</span>
 <span class="s0">* CBC (cipher-block-chaining).</span>
 <span class="s0">*</span>
 <span class="s0">* The key may be given as a binary-encoded string of bytes or a byte buffer.</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@param </span><span class="s0">options the options to use.</span>
 <span class="s0">*          key the symmetric key to use (64 or 192 bits).</span>
 <span class="s0">*          output the buffer to write to.</span>
 <span class="s0">*          decrypt true for decryption, false for encryption.</span>
 <span class="s0">*          mode the cipher mode to use (default: 'CBC').</span>
 <span class="s0">*</span>
 <span class="s0">* </span><span class="s1">@return </span><span class="s0">the cipher.</span>
 <span class="s0">*/</span>
<span class="s3">function </span><span class="s2">_createCipher</span><span class="s4">(</span><span class="s2">options</span><span class="s4">) {</span>
  <span class="s2">options </span><span class="s4">= </span><span class="s2">options </span><span class="s4">|| {};</span>
  <span class="s3">var </span><span class="s2">mode </span><span class="s4">= (</span><span class="s2">options</span><span class="s4">.</span><span class="s2">mode </span><span class="s4">|| </span><span class="s5">'CBC'</span><span class="s4">).</span><span class="s2">toUpperCase</span><span class="s4">();</span>
  <span class="s3">var </span><span class="s2">algorithm </span><span class="s4">= </span><span class="s5">'DES-' </span><span class="s4">+ </span><span class="s2">mode</span><span class="s4">;</span>

  <span class="s3">var </span><span class="s2">cipher</span><span class="s4">;</span>
  <span class="s3">if</span><span class="s4">(</span><span class="s2">options</span><span class="s4">.</span><span class="s2">decrypt</span><span class="s4">) {</span>
    <span class="s2">cipher </span><span class="s4">= </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">createDecipher</span><span class="s4">(</span><span class="s2">algorithm</span><span class="s4">, </span><span class="s2">options</span><span class="s4">.</span><span class="s2">key</span><span class="s4">);</span>
  <span class="s4">} </span><span class="s3">else </span><span class="s4">{</span>
    <span class="s2">cipher </span><span class="s4">= </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">createCipher</span><span class="s4">(</span><span class="s2">algorithm</span><span class="s4">, </span><span class="s2">options</span><span class="s4">.</span><span class="s2">key</span><span class="s4">);</span>
  <span class="s4">}</span>

  <span class="s6">// backwards compatible start API</span>
  <span class="s3">var </span><span class="s2">start </span><span class="s4">= </span><span class="s2">cipher</span><span class="s4">.</span><span class="s2">start</span><span class="s4">;</span>
  <span class="s2">cipher</span><span class="s4">.</span><span class="s2">start </span><span class="s4">= </span><span class="s3">function</span><span class="s4">(</span><span class="s2">iv</span><span class="s4">, </span><span class="s2">options</span><span class="s4">) {</span>
    <span class="s6">// backwards compatibility: support second arg as output buffer</span>
    <span class="s3">var </span><span class="s2">output </span><span class="s4">= </span><span class="s3">null</span><span class="s4">;</span>
    <span class="s3">if</span><span class="s4">(</span><span class="s2">options </span><span class="s3">instanceof </span><span class="s2">forge</span><span class="s4">.</span><span class="s2">util</span><span class="s4">.</span><span class="s2">ByteBuffer</span><span class="s4">) {</span>
      <span class="s2">output </span><span class="s4">= </span><span class="s2">options</span><span class="s4">;</span>
      <span class="s2">options </span><span class="s4">= {};</span>
    <span class="s4">}</span>
    <span class="s2">options </span><span class="s4">= </span><span class="s2">options </span><span class="s4">|| {};</span>
    <span class="s2">options</span><span class="s4">.</span><span class="s2">output </span><span class="s4">= </span><span class="s2">output</span><span class="s4">;</span>
    <span class="s2">options</span><span class="s4">.</span><span class="s2">iv </span><span class="s4">= </span><span class="s2">iv</span><span class="s4">;</span>
    <span class="s2">start</span><span class="s4">.</span><span class="s2">call</span><span class="s4">(</span><span class="s2">cipher</span><span class="s4">, </span><span class="s2">options</span><span class="s4">);</span>
  <span class="s4">};</span>

  <span class="s3">return </span><span class="s2">cipher</span><span class="s4">;</span>
<span class="s4">}</span>
</pre>
</body>
</html>