<html>
<head>
<title>http-parser.d.ts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #bcbec4;}
.s2 { color: #6aab73;}
.s3 { color: #cf8e6d;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
.s7 { color: #67a37c; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
http-parser.d.ts</font>
</center></td></tr></table>
<pre><span class="s0">type ParserType </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s2">'REQUEST'</span>
  <span class="s1">| </span><span class="s2">'RESPONSE'</span>

<span class="s0">type RequestMethod </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s2">'DELETE'</span>
  <span class="s1">| </span><span class="s2">'GET'</span>
  <span class="s1">| </span><span class="s2">'HEAD'</span>
  <span class="s1">| </span><span class="s2">'POST'</span>
  <span class="s1">| </span><span class="s2">'PUT'</span>
  <span class="s1">| </span><span class="s2">'CONNECT'</span>
  <span class="s1">| </span><span class="s2">'OPTIONS'</span>
  <span class="s1">| </span><span class="s2">'TRACE'</span>
  <span class="s1">| </span><span class="s2">'COPY'</span>
  <span class="s1">| </span><span class="s2">'LOCK'</span>
  <span class="s1">| </span><span class="s2">'MKCOL'</span>
  <span class="s1">| </span><span class="s2">'MOVE'</span>
  <span class="s1">| </span><span class="s2">'PROPFIND'</span>
  <span class="s1">| </span><span class="s2">'PROPPATCH'</span>
  <span class="s1">| </span><span class="s2">'SEARCH'</span>
  <span class="s1">| </span><span class="s2">'UNLOCK'</span>
  <span class="s1">| </span><span class="s2">'BIND'</span>
  <span class="s1">| </span><span class="s2">'REBIND'</span>
  <span class="s1">| </span><span class="s2">'UNBIND'</span>
  <span class="s1">| </span><span class="s2">'ACL'</span>
  <span class="s1">| </span><span class="s2">'REPORT'</span>
  <span class="s1">| </span><span class="s2">'MKACTIVITY'</span>
  <span class="s1">| </span><span class="s2">'CHECKOUT'</span>
  <span class="s1">| </span><span class="s2">'MERGE'</span>
  <span class="s1">| </span><span class="s2">'M-SEARCH'</span>
  <span class="s1">| </span><span class="s2">'NOTIFY'</span>
  <span class="s1">| </span><span class="s2">'SUBSCRIBE'</span>
  <span class="s1">| </span><span class="s2">'UNSUBSCRIBE'</span>
  <span class="s1">| </span><span class="s2">'PATCH'</span>
  <span class="s1">| </span><span class="s2">'PURGE'</span>
  <span class="s1">| </span><span class="s2">'MKCALENDAR'</span>
  <span class="s1">| </span><span class="s2">'LINK'</span>
  <span class="s1">| </span><span class="s2">'UNLINK'</span>
  <span class="s1">| </span><span class="s0">string</span>

<span class="s0">type StateHeaderKey </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s2">'REQUEST_LINE'</span>
  <span class="s1">| </span><span class="s2">'RESPONSE_LINE'</span>
  <span class="s1">| </span><span class="s2">'HEADER'</span>

<span class="s0">type StateFinishAllowedKey </span><span class="s1">=</span>
  <span class="s1">| </span><span class="s2">'REQUEST_LINE'</span>
  <span class="s1">| </span><span class="s2">'RESPONSE_LINE'</span>
  <span class="s1">| </span><span class="s2">'BODY_RAW'</span>

<span class="s0">type HeaderObject </span><span class="s1">= </span><span class="s0">Array</span><span class="s1">&lt;</span><span class="s0">string</span><span class="s1">&gt;</span>
<span class="s0">type noop</span><span class="s1">&lt;</span><span class="s0">T </span><span class="s1">= </span><span class="s3">void</span><span class="s1">&gt; = ()=&gt; </span><span class="s0">T</span>

<span class="s0">type HeaderInfo</span><span class="s1">&lt;</span><span class="s0">HEADER </span><span class="s1">= </span><span class="s0">HeaderObject</span><span class="s1">&gt; = {</span>
  <span class="s0">versionMajor</span><span class="s1">: </span><span class="s0">number</span>
  <span class="s0">versionMinor</span><span class="s1">: </span><span class="s0">number</span>
  <span class="s0">headers</span><span class="s1">: </span><span class="s0">HEADER</span>
  <span class="s0">method</span><span class="s1">: </span><span class="s0">number</span>
  <span class="s0">url</span><span class="s1">: </span><span class="s0">string</span>
  <span class="s0">statusCode</span><span class="s1">: </span><span class="s0">number</span>
  <span class="s0">statusMessage</span><span class="s1">: </span><span class="s0">string</span>
  <span class="s0">upgrade</span><span class="s1">: </span><span class="s0">boolean</span>
  <span class="s0">shouldKeepAlive</span><span class="s1">: </span><span class="s0">boolean</span>
<span class="s1">}</span>
<span class="s3">export </span><span class="s0">type OnHeadersCompleteParser</span><span class="s1">&lt;</span><span class="s0">HEADER </span><span class="s1">= </span><span class="s0">HeaderObject</span><span class="s1">, </span><span class="s0">Mode_0_12 </span><span class="s3">extends </span><span class="s0">boolean </span><span class="s1">= </span><span class="s3">true</span><span class="s1">&gt; = </span><span class="s0">Mode_0_12 </span><span class="s3">extends true</span>
  <span class="s1">? (</span><span class="s0">info</span><span class="s1">: </span><span class="s0">HeaderInfo</span><span class="s1">&lt;</span><span class="s0">HEADER</span><span class="s1">&gt;)=&gt; </span><span class="s0">number </span><span class="s1">| </span><span class="s3">void</span>
  <span class="s1">: (</span>
    <span class="s0">versionMajor</span><span class="s1">: </span><span class="s0">number</span><span class="s1">,</span>
    <span class="s0">versionMinor</span><span class="s1">: </span><span class="s0">number</span><span class="s1">,</span>
    <span class="s0">headers</span><span class="s1">: </span><span class="s0">HEADER</span><span class="s1">,</span>
    <span class="s0">method</span><span class="s1">: </span><span class="s0">number</span><span class="s1">,</span>
    <span class="s0">url</span><span class="s1">: </span><span class="s0">string</span><span class="s1">,</span>
    <span class="s0">statusCode</span><span class="s1">: </span><span class="s0">number</span><span class="s1">,</span>
    <span class="s0">statusMessage</span><span class="s1">: </span><span class="s0">string</span><span class="s1">,</span>
    <span class="s0">upgrade</span><span class="s1">: </span><span class="s0">boolean</span><span class="s1">,</span>
    <span class="s0">shouldKeepAlive</span><span class="s1">: </span><span class="s0">boolean</span><span class="s1">,</span>
  <span class="s1">)=&gt; </span><span class="s0">number </span><span class="s1">| </span><span class="s3">void</span>
<span class="s3">export </span><span class="s0">type OnBodyParser </span><span class="s1">= (</span><span class="s0">chunk</span><span class="s1">: </span><span class="s0">Buffer</span><span class="s1">, </span><span class="s0">offset</span><span class="s1">: </span><span class="s0">number</span><span class="s1">, </span><span class="s0">length</span><span class="s1">: </span><span class="s0">number</span><span class="s1">)=&gt; </span><span class="s3">void</span>
<span class="s4">// Only called in the slow case where slow means</span>
<span class="s4">// that the request headers were either fragmented</span>
<span class="s4">// across multiple TCP packets or too large to be</span>
<span class="s4">// processed in a single run. This method is also</span>
<span class="s4">// called to process trailing HTTP headers.</span>
<span class="s3">export </span><span class="s0">type OnHeadersParser </span><span class="s1">= (</span><span class="s0">headers</span><span class="s1">: </span><span class="s0">string</span><span class="s1">[], </span><span class="s0">url</span><span class="s1">: </span><span class="s0">string</span><span class="s1">)=&gt; </span><span class="s3">void</span>

<span class="s0">declare </span><span class="s3">class </span><span class="s0">HTTPParserJS </span><span class="s1">{</span>
  <span class="s0">initialize</span><span class="s1">(</span><span class="s0">type</span><span class="s1">: </span><span class="s0">ParserType</span><span class="s1">, </span><span class="s0">async_resource</span><span class="s1">?: </span><span class="s0">unknown</span><span class="s1">): </span><span class="s3">void</span>

  <span class="s4">// Some handler stubs, needed for compatibility</span>
  <span class="s1">[</span><span class="s0">HTTPParser</span><span class="s1">.</span><span class="s0">kOnHeaders</span><span class="s1">]: </span><span class="s0">OnHeadersParser</span>
  <span class="s1">[</span><span class="s0">HTTPParser</span><span class="s1">.</span><span class="s0">kOnHeadersComplete</span><span class="s1">]: </span><span class="s0">OnHeadersCompleteParser</span>
  <span class="s1">[</span><span class="s0">HTTPParser</span><span class="s1">.</span><span class="s0">kOnBody</span><span class="s1">]: </span><span class="s0">OnBodyParser</span>
  <span class="s1">[</span><span class="s0">HTTPParser</span><span class="s1">.</span><span class="s0">kOnMessageComplete</span><span class="s1">]: </span><span class="s0">noop</span>

  <span class="s0">reinitialize</span><span class="s1">: </span><span class="s0">HTTPParserConstructor</span>
  <span class="s0">close</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">pause</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">resume</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">free</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s3">private </span><span class="s0">_compatMode0_11</span><span class="s1">: </span><span class="s3">false </span><span class="s1">| </span><span class="s0">boolean</span>
  <span class="s0">getAsyncId</span><span class="s1">: </span><span class="s0">noop</span><span class="s1">&lt;</span><span class="s5">0</span><span class="s1">&gt;</span>

  <span class="s0">execute</span><span class="s1">(</span><span class="s0">chunk</span><span class="s1">: </span><span class="s0">Buffer</span><span class="s1">, </span><span class="s0">start</span><span class="s1">?: </span><span class="s0">number</span><span class="s1">, </span><span class="s0">length</span><span class="s1">?: </span><span class="s0">number</span><span class="s1">): </span><span class="s0">number </span><span class="s1">| </span><span class="s0">Error</span>
  <span class="s0">finish</span><span class="s1">(): </span><span class="s3">void </span><span class="s1">| </span><span class="s0">Error</span>

  <span class="s4">// These three methods are used for an internal speed optimization, and it also</span>
  <span class="s4">// works if theses are noops. Basically consume() asks us to read the bytes</span>
  <span class="s4">// ourselves, but if we don't do it we get them through execute().</span>
  <span class="s0">consume</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">unconsume</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">getCurrentBuffer</span><span class="s1">: </span><span class="s0">noop</span>

  <span class="s6">/**</span>
   <span class="s6">* For correct error handling - see HTTPParser#execute</span>
   <span class="s6">* </span><span class="s7">@example </span><span class="s6">this.userCall()(userFunction('arg'));</span>
   <span class="s6">*/</span>
  <span class="s0">userCall</span><span class="s1">&lt;</span><span class="s0">T </span><span class="s1">= </span><span class="s0">unknown</span><span class="s1">&gt;(): (</span><span class="s0">ret</span><span class="s1">?: </span><span class="s0">T</span><span class="s1">)=&gt; </span><span class="s0">T</span>
  <span class="s3">private </span><span class="s0">nextRequest</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s3">private </span><span class="s0">consumeLine</span><span class="s1">: </span><span class="s0">noop</span><span class="s1">&lt;</span><span class="s0">string</span><span class="s1">|</span><span class="s3">void</span><span class="s1">&gt;</span>
  <span class="s0">parseHeader</span><span class="s1">(</span><span class="s0">line</span><span class="s1">: </span><span class="s0">string</span><span class="s1">, </span><span class="s0">headers</span><span class="s1">: </span><span class="s0">string</span><span class="s1">[]): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">REQUEST_LINE</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s3">private </span><span class="s0">RESPONSE_LINE</span><span class="s1">: </span><span class="s0">noop</span>
  <span class="s0">shouldKeepAlive</span><span class="s1">(): </span><span class="s0">boolean</span>
  <span class="s6">/**</span>
   <span class="s6">* For older versions of node (v6.x and older?), that return `skipBody=1` or `skipBody=true`, need this `return true;` if it's an upgrade request.</span>
   <span class="s6">*/</span>
  <span class="s3">private </span><span class="s0">HEADER</span><span class="s1">(): </span><span class="s3">void </span><span class="s1">| </span><span class="s0">boolean</span>
  <span class="s3">private </span><span class="s0">BODY_CHUNKHEAD</span><span class="s1">(): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">BODY_CHUNK</span><span class="s1">(): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">BODY_CHUNKEMPTYLINE</span><span class="s1">(): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">BODY_CHUNKTRAILERS</span><span class="s1">(): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">BODY_RAW</span><span class="s1">(): </span><span class="s3">void</span>
  <span class="s3">private </span><span class="s0">BODY_SIZED</span><span class="s1">(): </span><span class="s3">void</span>

  <span class="s0">get onHeaders</span><span class="s1">(): </span><span class="s0">OnHeadersParser</span>
  <span class="s0">set onHeaders</span><span class="s1">(</span><span class="s0">to</span><span class="s1">: </span><span class="s0">OnHeadersParser</span><span class="s1">)</span>

  <span class="s0">get onHeadersComplete</span><span class="s1">(): </span><span class="s0">OnHeadersCompleteParser</span>
  <span class="s0">set onHeadersComplete</span><span class="s1">(</span><span class="s0">to</span><span class="s1">: </span><span class="s0">OnHeadersCompleteParser</span><span class="s1">)</span>

  <span class="s0">get onBody</span><span class="s1">(): </span><span class="s0">OnBodyParser</span>
  <span class="s0">set onBody</span><span class="s1">(</span><span class="s0">to</span><span class="s1">: </span><span class="s0">OnBodyParser</span><span class="s1">)</span>

  <span class="s0">get onMessageComplete</span><span class="s1">(): </span><span class="s0">noop</span>
  <span class="s0">set onMessageComplete</span><span class="s1">(</span><span class="s0">to</span><span class="s1">: </span><span class="s0">noop</span><span class="s1">)</span>
<span class="s1">}</span>

<span class="s3">interface </span><span class="s0">HTTPParserConstructor </span><span class="s3">extends </span><span class="s0">Function </span><span class="s1">{</span>
  <span class="s3">new</span><span class="s1">(</span><span class="s0">type</span><span class="s1">?: </span><span class="s0">ParserType</span><span class="s1">): </span><span class="s0">HTTPParserJS</span>
  <span class="s1">(</span><span class="s0">type</span><span class="s1">?: </span><span class="s0">ParserType</span><span class="s1">): </span><span class="s3">void</span>

  <span class="s0">readonly prototype</span><span class="s1">: </span><span class="s0">HTTPParserJS</span>

  <span class="s0">readonly REQUEST</span><span class="s1">: </span><span class="s2">'REQUEST'</span>
  <span class="s0">readonly RESPONSE</span><span class="s1">: </span><span class="s2">'RESPONSE'</span>
  <span class="s0">readonly methods</span><span class="s1">: </span><span class="s0">RequestMethod</span><span class="s1">[]</span>

  <span class="s0">encoding</span><span class="s1">: </span><span class="s2">'ascii'</span><span class="s1">|</span><span class="s0">string</span>
  <span class="s6">/**</span>
   <span class="s6">* maxHeaderSize (in bytes) is configurable, but 80kb by default;</span>
   <span class="s6">* </span><span class="s7">@default </span><span class="s6">80 * 1024 = 80kb</span>
   <span class="s6">*/</span>
  <span class="s0">maxHeaderSize</span><span class="s1">: </span><span class="s5">81920</span><span class="s1">|</span><span class="s0">number</span>

  <span class="s4">// Note: *not* starting with kOnHeaders=0 line the Node parser, because any</span>
  <span class="s4">// newly added constants (kOnTimeout in Node v12.19.0) will overwrite 0!</span>
  <span class="s0">readonly kOnHeaders</span><span class="s1">: </span><span class="s5">1</span>
  <span class="s0">readonly kOnHeadersComplete</span><span class="s1">: </span><span class="s5">2</span>
  <span class="s0">readonly kOnBody</span><span class="s1">: </span><span class="s5">3</span>
  <span class="s0">readonly kOnMessageComplete</span><span class="s1">: </span><span class="s5">4</span>

  <span class="s0">kOnExecute</span><span class="s1">(): </span><span class="s3">void</span>
<span class="s1">}</span>
<span class="s3">export const </span><span class="s0">HTTPParser</span><span class="s1">: </span><span class="s0">HTTPParserConstructor</span>
<span class="s3">export const </span><span class="s0">methods</span><span class="s1">: </span><span class="s0">RequestMethod</span><span class="s1">[]</span>
</pre>
</body>
</html>