<html>
<head>
<title>overlay.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #6aab73;}
.s5 { color: #7a7e85;}
.s6 { color: #5f826b; font-style: italic;}
.s7 { color: #67a37c; font-style: italic;}
.s8 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
overlay.js</font>
</center></td></tr></table>
<pre><span class="s0">function </span><span class="s1">ownKeys</span><span class="s2">(</span><span class="s1">object</span><span class="s2">, </span><span class="s1">enumerableOnly</span><span class="s2">) { </span><span class="s0">var </span><span class="s1">keys </span><span class="s2">= </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">keys</span><span class="s2">(</span><span class="s1">object</span><span class="s2">); </span><span class="s0">if </span><span class="s2">(</span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertySymbols</span><span class="s2">) { </span><span class="s0">var </span><span class="s1">symbols </span><span class="s2">= </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertySymbols</span><span class="s2">(</span><span class="s1">object</span><span class="s2">); </span><span class="s1">enumerableOnly </span><span class="s2">&amp;&amp; (</span><span class="s1">symbols </span><span class="s2">= </span><span class="s1">symbols</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">sym</span><span class="s2">) { </span><span class="s0">return </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s2">(</span><span class="s1">object</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">).</span><span class="s1">enumerable</span><span class="s2">; })), </span><span class="s1">keys</span><span class="s2">.</span><span class="s1">push</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">keys</span><span class="s2">, </span><span class="s1">symbols</span><span class="s2">); } </span><span class="s0">return </span><span class="s1">keys</span><span class="s2">; }</span>
<span class="s0">function </span><span class="s1">_objectSpread</span><span class="s2">(</span><span class="s1">target</span><span class="s2">) { </span><span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s3">1</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">arguments</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) { </span><span class="s0">var </span><span class="s1">source </span><span class="s2">= </span><span class="s0">null </span><span class="s2">!= </span><span class="s1">arguments</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] ? </span><span class="s1">arguments</span><span class="s2">[</span><span class="s1">i</span><span class="s2">] : {}; </span><span class="s1">i </span><span class="s2">% </span><span class="s3">2 </span><span class="s2">? </span><span class="s1">ownKeys</span><span class="s2">(</span><span class="s1">Object</span><span class="s2">(</span><span class="s1">source</span><span class="s2">), !</span><span class="s3">0</span><span class="s2">).</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">key</span><span class="s2">) { </span><span class="s1">_defineProperty</span><span class="s2">(</span><span class="s1">target</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">source</span><span class="s2">[</span><span class="s1">key</span><span class="s2">]); }) : </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertyDescriptors </span><span class="s2">? </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">defineProperties</span><span class="s2">(</span><span class="s1">target</span><span class="s2">, </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertyDescriptors</span><span class="s2">(</span><span class="s1">source</span><span class="s2">)) : </span><span class="s1">ownKeys</span><span class="s2">(</span><span class="s1">Object</span><span class="s2">(</span><span class="s1">source</span><span class="s2">)).</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">key</span><span class="s2">) { </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">defineProperty</span><span class="s2">(</span><span class="s1">target</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">getOwnPropertyDescriptor</span><span class="s2">(</span><span class="s1">source</span><span class="s2">, </span><span class="s1">key</span><span class="s2">)); }); } </span><span class="s0">return </span><span class="s1">target</span><span class="s2">; }</span>
<span class="s0">function </span><span class="s1">_defineProperty</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, </span><span class="s1">value</span><span class="s2">) { </span><span class="s1">key </span><span class="s2">= </span><span class="s1">_toPropertyKey</span><span class="s2">(</span><span class="s1">key</span><span class="s2">); </span><span class="s0">if </span><span class="s2">(</span><span class="s1">key </span><span class="s0">in </span><span class="s1">obj</span><span class="s2">) { </span><span class="s1">Object</span><span class="s2">.</span><span class="s1">defineProperty</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">key</span><span class="s2">, { </span><span class="s1">value</span><span class="s2">: </span><span class="s1">value</span><span class="s2">, </span><span class="s1">enumerable</span><span class="s2">: </span><span class="s0">true</span><span class="s2">, </span><span class="s1">configurable</span><span class="s2">: </span><span class="s0">true</span><span class="s2">, </span><span class="s1">writable</span><span class="s2">: </span><span class="s0">true </span><span class="s2">}); } </span><span class="s0">else </span><span class="s2">{ </span><span class="s1">obj</span><span class="s2">[</span><span class="s1">key</span><span class="s2">] = </span><span class="s1">value</span><span class="s2">; } </span><span class="s0">return </span><span class="s1">obj</span><span class="s2">; }</span>
<span class="s0">function </span><span class="s1">_toPropertyKey</span><span class="s2">(</span><span class="s1">arg</span><span class="s2">) { </span><span class="s0">var </span><span class="s1">key </span><span class="s2">= </span><span class="s1">_toPrimitive</span><span class="s2">(</span><span class="s1">arg</span><span class="s2">, </span><span class="s4">&quot;string&quot;</span><span class="s2">); </span><span class="s0">return typeof </span><span class="s1">key </span><span class="s2">=== </span><span class="s4">&quot;symbol&quot; </span><span class="s2">? </span><span class="s1">key </span><span class="s2">: </span><span class="s1">String</span><span class="s2">(</span><span class="s1">key</span><span class="s2">); }</span>
<span class="s0">function </span><span class="s1">_toPrimitive</span><span class="s2">(</span><span class="s1">input</span><span class="s2">, </span><span class="s1">hint</span><span class="s2">) { </span><span class="s0">if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">input </span><span class="s2">!== </span><span class="s4">&quot;object&quot; </span><span class="s2">|| </span><span class="s1">input </span><span class="s2">=== </span><span class="s0">null</span><span class="s2">) </span><span class="s0">return </span><span class="s1">input</span><span class="s2">; </span><span class="s0">var </span><span class="s1">prim </span><span class="s2">= </span><span class="s1">input</span><span class="s2">[</span><span class="s1">Symbol</span><span class="s2">.</span><span class="s1">toPrimitive</span><span class="s2">]; </span><span class="s0">if </span><span class="s2">(</span><span class="s1">prim </span><span class="s2">!== </span><span class="s1">undefined</span><span class="s2">) { </span><span class="s0">var </span><span class="s1">res </span><span class="s2">= </span><span class="s1">prim</span><span class="s2">.</span><span class="s1">call</span><span class="s2">(</span><span class="s1">input</span><span class="s2">, </span><span class="s1">hint </span><span class="s2">|| </span><span class="s4">&quot;default&quot;</span><span class="s2">); </span><span class="s0">if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">res </span><span class="s2">!== </span><span class="s4">&quot;object&quot;</span><span class="s2">) </span><span class="s0">return </span><span class="s1">res</span><span class="s2">; </span><span class="s0">throw new </span><span class="s1">TypeError</span><span class="s2">(</span><span class="s4">&quot;@@toPrimitive must return a primitive value.&quot;</span><span class="s2">); } </span><span class="s0">return </span><span class="s2">(</span><span class="s1">hint </span><span class="s2">=== </span><span class="s4">&quot;string&quot; </span><span class="s2">? </span><span class="s1">String </span><span class="s2">: </span><span class="s1">Number</span><span class="s2">)(</span><span class="s1">input</span><span class="s2">); }</span>
<span class="s5">// The error overlay is inspired (and mostly copied) from Create React App (https://github.com/facebookincubator/create-react-app)</span>
<span class="s5">// They, in turn, got inspired by webpack-hot-middleware (https://github.com/glenjamin/webpack-hot-middleware).</span>

<span class="s0">import </span><span class="s1">ansiHTML from </span><span class="s4">&quot;ansi-html-community&quot;</span><span class="s2">;</span>
<span class="s0">import </span><span class="s2">{ </span><span class="s1">encode </span><span class="s2">} </span><span class="s1">from </span><span class="s4">&quot;html-entities&quot;</span><span class="s2">;</span>
<span class="s0">import </span><span class="s2">{ </span><span class="s1">listenToRuntimeError</span><span class="s2">, </span><span class="s1">listenToUnhandledRejection</span><span class="s2">, </span><span class="s1">parseErrorToStacks </span><span class="s2">} </span><span class="s1">from </span><span class="s4">&quot;./overlay/runtime-error.js&quot;</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">createOverlayMachine from </span><span class="s4">&quot;./overlay/state-machine.js&quot;</span><span class="s2">;</span>
<span class="s0">import </span><span class="s2">{ </span><span class="s1">containerStyle</span><span class="s2">, </span><span class="s1">dismissButtonStyle</span><span class="s2">, </span><span class="s1">headerStyle</span><span class="s2">, </span><span class="s1">iframeStyle</span><span class="s2">, </span><span class="s1">msgStyles</span><span class="s2">, </span><span class="s1">msgTextStyle</span><span class="s2">, </span><span class="s1">msgTypeStyle </span><span class="s2">} </span><span class="s1">from </span><span class="s4">&quot;./overlay/styles.js&quot;</span><span class="s2">;</span>
<span class="s0">var </span><span class="s1">colors </span><span class="s2">= {</span>
  <span class="s1">reset</span><span class="s2">: [</span><span class="s4">&quot;transparent&quot;</span><span class="s2">, </span><span class="s4">&quot;transparent&quot;</span><span class="s2">],</span>
  <span class="s1">black</span><span class="s2">: </span><span class="s4">&quot;181818&quot;</span><span class="s2">,</span>
  <span class="s1">red</span><span class="s2">: </span><span class="s4">&quot;E36049&quot;</span><span class="s2">,</span>
  <span class="s1">green</span><span class="s2">: </span><span class="s4">&quot;B3CB74&quot;</span><span class="s2">,</span>
  <span class="s1">yellow</span><span class="s2">: </span><span class="s4">&quot;FFD080&quot;</span><span class="s2">,</span>
  <span class="s1">blue</span><span class="s2">: </span><span class="s4">&quot;7CAFC2&quot;</span><span class="s2">,</span>
  <span class="s1">magenta</span><span class="s2">: </span><span class="s4">&quot;7FACCA&quot;</span><span class="s2">,</span>
  <span class="s1">cyan</span><span class="s2">: </span><span class="s4">&quot;C3C2EF&quot;</span><span class="s2">,</span>
  <span class="s1">lightgrey</span><span class="s2">: </span><span class="s4">&quot;EBE7E3&quot;</span><span class="s2">,</span>
  <span class="s1">darkgrey</span><span class="s2">: </span><span class="s4">&quot;6D7891&quot;</span>
<span class="s2">};</span>
<span class="s1">ansiHTML</span><span class="s2">.</span><span class="s1">setColors</span><span class="s2">(</span><span class="s1">colors</span><span class="s2">);</span>

<span class="s6">/**</span>
 <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string} type</span>
 <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string  | { file?: string, moduleName?: string, loc?: string, message?: string; stack?: string[] }} item</span>
 <span class="s6">* </span><span class="s7">@returns </span><span class="s6">{{ header: string, body: string }}</span>
 <span class="s6">*/</span>
<span class="s0">function </span><span class="s1">formatProblem</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">item</span><span class="s2">) {</span>
  <span class="s0">var </span><span class="s1">header </span><span class="s2">= </span><span class="s1">type </span><span class="s2">=== </span><span class="s4">&quot;warning&quot; </span><span class="s2">? </span><span class="s4">&quot;WARNING&quot; </span><span class="s2">: </span><span class="s4">&quot;ERROR&quot;</span><span class="s2">;</span>
  <span class="s0">var </span><span class="s1">body </span><span class="s2">= </span><span class="s4">&quot;&quot;</span><span class="s2">;</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">item </span><span class="s2">=== </span><span class="s4">&quot;string&quot;</span><span class="s2">) {</span>
    <span class="s1">body </span><span class="s2">+= </span><span class="s1">item</span><span class="s2">;</span>
  <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
    <span class="s0">var </span><span class="s1">file </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">file </span><span class="s2">|| </span><span class="s4">&quot;&quot;</span><span class="s2">;</span>
    <span class="s5">// eslint-disable-next-line no-nested-ternary</span>
    <span class="s0">var </span><span class="s1">moduleName </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">moduleName </span><span class="s2">? </span><span class="s1">item</span><span class="s2">.</span><span class="s1">moduleName</span><span class="s2">.</span><span class="s1">indexOf</span><span class="s2">(</span><span class="s4">&quot;!&quot;</span><span class="s2">) !== -</span><span class="s3">1 </span><span class="s2">? </span><span class="s4">&quot;&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">moduleName</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s8">/^(\s|\S)*!/</span><span class="s2">, </span><span class="s4">&quot;&quot;</span><span class="s2">), </span><span class="s4">&quot; (&quot;</span><span class="s2">).</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">moduleName</span><span class="s2">, </span><span class="s4">&quot;)&quot;</span><span class="s2">) : </span><span class="s4">&quot;&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">moduleName</span><span class="s2">) : </span><span class="s4">&quot;&quot;</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">loc </span><span class="s2">= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">;</span>
    <span class="s1">header </span><span class="s2">+= </span><span class="s4">&quot;&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">moduleName </span><span class="s2">|| </span><span class="s1">file </span><span class="s2">? </span><span class="s4">&quot; in &quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">moduleName </span><span class="s2">? </span><span class="s4">&quot;&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">moduleName</span><span class="s2">).</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">file </span><span class="s2">? </span><span class="s4">&quot; (&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">file</span><span class="s2">, </span><span class="s4">&quot;)&quot;</span><span class="s2">) : </span><span class="s4">&quot;&quot;</span><span class="s2">) : </span><span class="s1">file</span><span class="s2">).</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">? </span><span class="s4">&quot; &quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">) : </span><span class="s4">&quot;&quot;</span><span class="s2">) : </span><span class="s4">&quot;&quot;</span><span class="s2">);</span>
    <span class="s1">body </span><span class="s2">+= </span><span class="s1">item</span><span class="s2">.</span><span class="s1">message </span><span class="s2">|| </span><span class="s4">&quot;&quot;</span><span class="s2">;</span>
  <span class="s2">}</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">Array</span><span class="s2">.</span><span class="s1">isArray</span><span class="s2">(</span><span class="s1">item</span><span class="s2">.</span><span class="s1">stack</span><span class="s2">)) {</span>
    <span class="s1">item</span><span class="s2">.</span><span class="s1">stack</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">stack</span><span class="s2">) {</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s0">typeof </span><span class="s1">stack </span><span class="s2">=== </span><span class="s4">&quot;string&quot;</span><span class="s2">) {</span>
        <span class="s1">body </span><span class="s2">+= </span><span class="s4">&quot;</span><span class="s0">\r\n</span><span class="s4">&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">stack</span><span class="s2">);</span>
      <span class="s2">}</span>
    <span class="s2">});</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s2">{</span>
    <span class="s1">header</span><span class="s2">: </span><span class="s1">header</span><span class="s2">,</span>
    <span class="s1">body</span><span class="s2">: </span><span class="s1">body</span>
  <span class="s2">};</span>
<span class="s2">}</span>

<span class="s6">/**</span>
 <span class="s6">* </span><span class="s7">@typedef </span><span class="s6">{Object} CreateOverlayOptions</span>
 <span class="s6">* </span><span class="s7">@property </span><span class="s6">{string | null} trustedTypesPolicyName</span>
 <span class="s6">* </span><span class="s7">@property </span><span class="s6">{boolean | (error: Error) =&gt; void} [catchRuntimeError]</span>
 <span class="s6">*/</span>

<span class="s6">/**</span>
 <span class="s6">*</span>
 <span class="s6">* </span><span class="s7">@param </span><span class="s6">{CreateOverlayOptions} options</span>
 <span class="s6">*/</span>
<span class="s0">var </span><span class="s1">createOverlay </span><span class="s2">= </span><span class="s0">function </span><span class="s1">createOverlay</span><span class="s2">(</span><span class="s1">options</span><span class="s2">) {</span>
  <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLIFrameElement | null | undefined} */</span>
  <span class="s0">var </span><span class="s1">iframeContainerElement</span><span class="s2">;</span>
  <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLDivElement | null | undefined} */</span>
  <span class="s0">var </span><span class="s1">containerElement</span><span class="s2">;</span>
  <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLDivElement | null | undefined} */</span>
  <span class="s0">var </span><span class="s1">headerElement</span><span class="s2">;</span>
  <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{Array&lt;(element: HTMLDivElement) =&gt; void&gt;} */</span>
  <span class="s0">var </span><span class="s1">onLoadQueue </span><span class="s2">= [];</span>
  <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{TrustedTypePolicy | undefined} */</span>
  <span class="s0">var </span><span class="s1">overlayTrustedTypesPolicy</span><span class="s2">;</span>

  <span class="s6">/**</span>
   <span class="s6">*</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{HTMLElement} element</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{CSSStyleDeclaration} style</span>
   <span class="s6">*/</span>
  <span class="s0">function </span><span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">element</span><span class="s2">, </span><span class="s1">style</span><span class="s2">) {</span>
    <span class="s1">Object</span><span class="s2">.</span><span class="s1">keys</span><span class="s2">(</span><span class="s1">style</span><span class="s2">).</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">prop</span><span class="s2">) {</span>
      <span class="s1">element</span><span class="s2">.</span><span class="s1">style</span><span class="s2">[</span><span class="s1">prop</span><span class="s2">] = </span><span class="s1">style</span><span class="s2">[</span><span class="s1">prop</span><span class="s2">];</span>
    <span class="s2">});</span>
  <span class="s2">}</span>

  <span class="s6">/**</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string | null} trustedTypesPolicyName</span>
   <span class="s6">*/</span>
  <span class="s0">function </span><span class="s1">createContainer</span><span class="s2">(</span><span class="s1">trustedTypesPolicyName</span><span class="s2">) {</span>
    <span class="s5">// Enable Trusted Types if they are available in the current browser.</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">window</span><span class="s2">.</span><span class="s1">trustedTypes</span><span class="s2">) {</span>
      <span class="s1">overlayTrustedTypesPolicy </span><span class="s2">= </span><span class="s1">window</span><span class="s2">.</span><span class="s1">trustedTypes</span><span class="s2">.</span><span class="s1">createPolicy</span><span class="s2">(</span><span class="s1">trustedTypesPolicyName </span><span class="s2">|| </span><span class="s4">&quot;webpack-dev-server#overlay&quot;</span><span class="s2">, {</span>
        <span class="s1">createHTML</span><span class="s2">: </span><span class="s0">function </span><span class="s1">createHTML</span><span class="s2">(</span><span class="s1">value</span><span class="s2">) {</span>
          <span class="s0">return </span><span class="s1">value</span><span class="s2">;</span>
        <span class="s2">}</span>
      <span class="s2">});</span>
    <span class="s2">}</span>
    <span class="s1">iframeContainerElement </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;iframe&quot;</span><span class="s2">);</span>
    <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">id </span><span class="s2">= </span><span class="s4">&quot;webpack-dev-server-client-overlay&quot;</span><span class="s2">;</span>
    <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">src </span><span class="s2">= </span><span class="s4">&quot;about:blank&quot;</span><span class="s2">;</span>
    <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">iframeContainerElement</span><span class="s2">, </span><span class="s1">iframeStyle</span><span class="s2">);</span>
    <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">onload </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>
      <span class="s0">var </span><span class="s1">contentElement </span><span class="s2">= </span><span class="s6">/** </span><span class="s7">@type </span><span class="s6">{Document} */</span>
      <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLIFrameElement} */</span>
      <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">contentDocument</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
      <span class="s1">containerElement </span><span class="s2">= </span><span class="s6">/** </span><span class="s7">@type </span><span class="s6">{Document} */</span>
      <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLIFrameElement} */</span>
      <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">contentDocument</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
      <span class="s1">contentElement</span><span class="s2">.</span><span class="s1">id </span><span class="s2">= </span><span class="s4">&quot;webpack-dev-server-client-overlay-div&quot;</span><span class="s2">;</span>
      <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">contentElement</span><span class="s2">, </span><span class="s1">containerStyle</span><span class="s2">);</span>
      <span class="s1">headerElement </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
      <span class="s1">headerElement</span><span class="s2">.</span><span class="s1">innerText </span><span class="s2">= </span><span class="s4">&quot;Compiled with problems:&quot;</span><span class="s2">;</span>
      <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">headerElement</span><span class="s2">, </span><span class="s1">headerStyle</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">closeButtonElement </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;button&quot;</span><span class="s2">);</span>
      <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">closeButtonElement</span><span class="s2">, </span><span class="s1">dismissButtonStyle</span><span class="s2">);</span>
      <span class="s1">closeButtonElement</span><span class="s2">.</span><span class="s1">innerText </span><span class="s2">= </span><span class="s4">&quot;×&quot;</span><span class="s2">;</span>
      <span class="s1">closeButtonElement</span><span class="s2">.</span><span class="s1">ariaLabel </span><span class="s2">= </span><span class="s4">&quot;Dismiss&quot;</span><span class="s2">;</span>
      <span class="s1">closeButtonElement</span><span class="s2">.</span><span class="s1">addEventListener</span><span class="s2">(</span><span class="s4">&quot;click&quot;</span><span class="s2">, </span><span class="s0">function </span><span class="s2">() {</span>
        <span class="s5">// eslint-disable-next-line no-use-before-define</span>
        <span class="s1">overlayService</span><span class="s2">.</span><span class="s1">send</span><span class="s2">({</span>
          <span class="s1">type</span><span class="s2">: </span><span class="s4">&quot;DISMISS&quot;</span>
        <span class="s2">});</span>
      <span class="s2">});</span>
      <span class="s1">contentElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">headerElement</span><span class="s2">);</span>
      <span class="s1">contentElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">closeButtonElement</span><span class="s2">);</span>
      <span class="s1">contentElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">containerElement</span><span class="s2">);</span>

      <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{Document} */</span>
      <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLIFrameElement} */</span>
      <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">contentDocument</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">contentElement</span><span class="s2">);</span>
      <span class="s1">onLoadQueue</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">onLoad</span><span class="s2">) {</span>
        <span class="s1">onLoad</span><span class="s2">( </span><span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLDivElement} */</span><span class="s1">contentElement</span><span class="s2">);</span>
      <span class="s2">});</span>
      <span class="s1">onLoadQueue </span><span class="s2">= [];</span>

      <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLIFrameElement} */</span>
      <span class="s1">iframeContainerElement</span><span class="s2">.</span><span class="s1">onload </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s2">};</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">iframeContainerElement</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s6">/**</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{(element: HTMLDivElement) =&gt; void} callback</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string | null} trustedTypesPolicyName</span>
   <span class="s6">*/</span>
  <span class="s0">function </span><span class="s1">ensureOverlayExists</span><span class="s2">(</span><span class="s1">callback</span><span class="s2">, </span><span class="s1">trustedTypesPolicyName</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">containerElement</span><span class="s2">) {</span>
      <span class="s1">containerElement</span><span class="s2">.</span><span class="s1">innerHTML </span><span class="s2">= </span><span class="s4">&quot;&quot;</span><span class="s2">;</span>
      <span class="s5">// Everything is ready, call the callback right away.</span>
      <span class="s1">callback</span><span class="s2">(</span><span class="s1">containerElement</span><span class="s2">);</span>
      <span class="s0">return</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">onLoadQueue</span><span class="s2">.</span><span class="s1">push</span><span class="s2">(</span><span class="s1">callback</span><span class="s2">);</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">iframeContainerElement</span><span class="s2">) {</span>
      <span class="s0">return</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s1">createContainer</span><span class="s2">(</span><span class="s1">trustedTypesPolicyName</span><span class="s2">);</span>
  <span class="s2">}</span>

  <span class="s5">// Successful compilation.</span>
  <span class="s0">function </span><span class="s1">hide</span><span class="s2">() {</span>
    <span class="s0">if </span><span class="s2">(!</span><span class="s1">iframeContainerElement</span><span class="s2">) {</span>
      <span class="s0">return</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s5">// Clean up and reset internal state.</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">removeChild</span><span class="s2">(</span><span class="s1">iframeContainerElement</span><span class="s2">);</span>
    <span class="s1">iframeContainerElement </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
    <span class="s1">containerElement </span><span class="s2">= </span><span class="s0">null</span><span class="s2">;</span>
  <span class="s2">}</span>

  <span class="s5">// Compilation with errors (e.g. syntax error or missing modules).</span>
  <span class="s6">/**</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string} type</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{Array&lt;string  | { moduleIdentifier?: string, moduleName?: string, loc?: string, message?: string }&gt;} messages</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string | null} trustedTypesPolicyName</span>
   <span class="s6">* </span><span class="s7">@param </span><span class="s6">{'build' | 'runtime'} messageSource</span>
   <span class="s6">*/</span>
  <span class="s0">function </span><span class="s1">show</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">messages</span><span class="s2">, </span><span class="s1">trustedTypesPolicyName</span><span class="s2">, </span><span class="s1">messageSource</span><span class="s2">) {</span>
    <span class="s1">ensureOverlayExists</span><span class="s2">(</span><span class="s0">function </span><span class="s2">() {</span>
      <span class="s1">headerElement</span><span class="s2">.</span><span class="s1">innerText </span><span class="s2">= </span><span class="s1">messageSource </span><span class="s2">=== </span><span class="s4">&quot;runtime&quot; </span><span class="s2">? </span><span class="s4">&quot;Uncaught runtime errors:&quot; </span><span class="s2">: </span><span class="s4">&quot;Compiled with problems:&quot;</span><span class="s2">;</span>
      <span class="s1">messages</span><span class="s2">.</span><span class="s1">forEach</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">message</span><span class="s2">) {</span>
        <span class="s0">var </span><span class="s1">entryElement </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
        <span class="s0">var </span><span class="s1">msgStyle </span><span class="s2">= </span><span class="s1">type </span><span class="s2">=== </span><span class="s4">&quot;warning&quot; </span><span class="s2">? </span><span class="s1">msgStyles</span><span class="s2">.</span><span class="s1">warning </span><span class="s2">: </span><span class="s1">msgStyles</span><span class="s2">.</span><span class="s1">error</span><span class="s2">;</span>
        <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">entryElement</span><span class="s2">, </span><span class="s1">_objectSpread</span><span class="s2">(</span><span class="s1">_objectSpread</span><span class="s2">({}, </span><span class="s1">msgStyle</span><span class="s2">), {}, {</span>
          <span class="s1">padding</span><span class="s2">: </span><span class="s4">&quot;1rem 1rem 1.5rem 1rem&quot;</span>
        <span class="s2">}));</span>
        <span class="s0">var </span><span class="s1">typeElement </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
        <span class="s0">var </span><span class="s1">_formatProblem </span><span class="s2">= </span><span class="s1">formatProblem</span><span class="s2">(</span><span class="s1">type</span><span class="s2">, </span><span class="s1">message</span><span class="s2">),</span>
          <span class="s1">header </span><span class="s2">= </span><span class="s1">_formatProblem</span><span class="s2">.</span><span class="s1">header</span><span class="s2">,</span>
          <span class="s1">body </span><span class="s2">= </span><span class="s1">_formatProblem</span><span class="s2">.</span><span class="s1">body</span><span class="s2">;</span>
        <span class="s1">typeElement</span><span class="s2">.</span><span class="s1">innerText </span><span class="s2">= </span><span class="s1">header</span><span class="s2">;</span>
        <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">typeElement</span><span class="s2">, </span><span class="s1">msgTypeStyle</span><span class="s2">);</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">message</span><span class="s2">.</span><span class="s1">moduleIdentifier</span><span class="s2">) {</span>
          <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">typeElement</span><span class="s2">, {</span>
            <span class="s1">cursor</span><span class="s2">: </span><span class="s4">&quot;pointer&quot;</span>
          <span class="s2">});</span>
          <span class="s5">// element.dataset not supported in IE</span>
          <span class="s1">typeElement</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s4">&quot;data-can-open&quot;</span><span class="s2">, </span><span class="s0">true</span><span class="s2">);</span>
          <span class="s1">typeElement</span><span class="s2">.</span><span class="s1">addEventListener</span><span class="s2">(</span><span class="s4">&quot;click&quot;</span><span class="s2">, </span><span class="s0">function </span><span class="s2">() {</span>
            <span class="s1">fetch</span><span class="s2">(</span><span class="s4">&quot;/webpack-dev-server/open-editor?fileName=&quot;</span><span class="s2">.</span><span class="s1">concat</span><span class="s2">(</span><span class="s1">message</span><span class="s2">.</span><span class="s1">moduleIdentifier</span><span class="s2">));</span>
          <span class="s2">});</span>
        <span class="s2">}</span>

        <span class="s5">// Make it look similar to our terminal.</span>
        <span class="s0">var </span><span class="s1">text </span><span class="s2">= </span><span class="s1">ansiHTML</span><span class="s2">(</span><span class="s1">encode</span><span class="s2">(</span><span class="s1">body</span><span class="s2">));</span>
        <span class="s0">var </span><span class="s1">messageTextNode </span><span class="s2">= </span><span class="s1">document</span><span class="s2">.</span><span class="s1">createElement</span><span class="s2">(</span><span class="s4">&quot;div&quot;</span><span class="s2">);</span>
        <span class="s1">applyStyle</span><span class="s2">(</span><span class="s1">messageTextNode</span><span class="s2">, </span><span class="s1">msgTextStyle</span><span class="s2">);</span>
        <span class="s1">messageTextNode</span><span class="s2">.</span><span class="s1">innerHTML </span><span class="s2">= </span><span class="s1">overlayTrustedTypesPolicy </span><span class="s2">? </span><span class="s1">overlayTrustedTypesPolicy</span><span class="s2">.</span><span class="s1">createHTML</span><span class="s2">(</span><span class="s1">text</span><span class="s2">) : </span><span class="s1">text</span><span class="s2">;</span>
        <span class="s1">entryElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">typeElement</span><span class="s2">);</span>
        <span class="s1">entryElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">messageTextNode</span><span class="s2">);</span>

        <span class="s6">/** </span><span class="s7">@type </span><span class="s6">{HTMLDivElement} */</span>
        <span class="s1">containerElement</span><span class="s2">.</span><span class="s1">appendChild</span><span class="s2">(</span><span class="s1">entryElement</span><span class="s2">);</span>
      <span class="s2">});</span>
    <span class="s2">}, </span><span class="s1">trustedTypesPolicyName</span><span class="s2">);</span>
  <span class="s2">}</span>
  <span class="s0">var </span><span class="s1">overlayService </span><span class="s2">= </span><span class="s1">createOverlayMachine</span><span class="s2">({</span>
    <span class="s1">showOverlay</span><span class="s2">: </span><span class="s0">function </span><span class="s1">showOverlay</span><span class="s2">(</span><span class="s1">_ref</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">_ref$level </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">level</span><span class="s2">,</span>
        <span class="s1">level </span><span class="s2">= </span><span class="s1">_ref$level </span><span class="s2">=== </span><span class="s0">void </span><span class="s3">0 </span><span class="s2">? </span><span class="s4">&quot;error&quot; </span><span class="s2">: </span><span class="s1">_ref$level</span><span class="s2">,</span>
        <span class="s1">messages </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">messages</span><span class="s2">,</span>
        <span class="s1">messageSource </span><span class="s2">= </span><span class="s1">_ref</span><span class="s2">.</span><span class="s1">messageSource</span><span class="s2">;</span>
      <span class="s0">return </span><span class="s1">show</span><span class="s2">(</span><span class="s1">level</span><span class="s2">, </span><span class="s1">messages</span><span class="s2">, </span><span class="s1">options</span><span class="s2">.</span><span class="s1">trustedTypesPolicyName</span><span class="s2">, </span><span class="s1">messageSource</span><span class="s2">);</span>
    <span class="s2">},</span>
    <span class="s1">hideOverlay</span><span class="s2">: </span><span class="s1">hide</span>
  <span class="s2">});</span>
  <span class="s0">if </span><span class="s2">(</span><span class="s1">options</span><span class="s2">.</span><span class="s1">catchRuntimeError</span><span class="s2">) {</span>
    <span class="s6">/**</span>
     <span class="s6">* </span><span class="s7">@param </span><span class="s6">{Error | undefined} error</span>
     <span class="s6">* </span><span class="s7">@param </span><span class="s6">{string} fallbackMessage</span>
     <span class="s6">*/</span>
    <span class="s0">var </span><span class="s1">handleError </span><span class="s2">= </span><span class="s0">function </span><span class="s1">handleError</span><span class="s2">(</span><span class="s1">error</span><span class="s2">, </span><span class="s1">fallbackMessage</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">errorObject </span><span class="s2">= </span><span class="s1">error </span><span class="s0">instanceof </span><span class="s1">Error </span><span class="s2">? </span><span class="s1">error </span><span class="s2">: </span><span class="s0">new </span><span class="s1">Error</span><span class="s2">(</span><span class="s1">error </span><span class="s2">|| </span><span class="s1">fallbackMessage</span><span class="s2">);</span>
      <span class="s0">var </span><span class="s1">shouldDisplay </span><span class="s2">= </span><span class="s0">typeof </span><span class="s1">options</span><span class="s2">.</span><span class="s1">catchRuntimeError </span><span class="s2">=== </span><span class="s4">&quot;function&quot; </span><span class="s2">? </span><span class="s1">options</span><span class="s2">.</span><span class="s1">catchRuntimeError</span><span class="s2">(</span><span class="s1">errorObject</span><span class="s2">) : </span><span class="s0">true</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(</span><span class="s1">shouldDisplay</span><span class="s2">) {</span>
        <span class="s1">overlayService</span><span class="s2">.</span><span class="s1">send</span><span class="s2">({</span>
          <span class="s1">type</span><span class="s2">: </span><span class="s4">&quot;RUNTIME_ERROR&quot;</span><span class="s2">,</span>
          <span class="s1">messages</span><span class="s2">: [{</span>
            <span class="s1">message</span><span class="s2">: </span><span class="s1">errorObject</span><span class="s2">.</span><span class="s1">message</span><span class="s2">,</span>
            <span class="s1">stack</span><span class="s2">: </span><span class="s1">parseErrorToStacks</span><span class="s2">(</span><span class="s1">errorObject</span><span class="s2">)</span>
          <span class="s2">}]</span>
        <span class="s2">});</span>
      <span class="s2">}</span>
    <span class="s2">};</span>
    <span class="s1">listenToRuntimeError</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">errorEvent</span><span class="s2">) {</span>
      <span class="s5">// error property may be empty in older browser like IE</span>
      <span class="s0">var </span><span class="s1">error </span><span class="s2">= </span><span class="s1">errorEvent</span><span class="s2">.</span><span class="s1">error</span><span class="s2">,</span>
        <span class="s1">message </span><span class="s2">= </span><span class="s1">errorEvent</span><span class="s2">.</span><span class="s1">message</span><span class="s2">;</span>
      <span class="s0">if </span><span class="s2">(!</span><span class="s1">error </span><span class="s2">&amp;&amp; !</span><span class="s1">message</span><span class="s2">) {</span>
        <span class="s0">return</span><span class="s2">;</span>
      <span class="s2">}</span>
      <span class="s1">handleError</span><span class="s2">(</span><span class="s1">error</span><span class="s2">, </span><span class="s1">message</span><span class="s2">);</span>
    <span class="s2">});</span>
    <span class="s1">listenToUnhandledRejection</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">promiseRejectionEvent</span><span class="s2">) {</span>
      <span class="s0">var </span><span class="s1">reason </span><span class="s2">= </span><span class="s1">promiseRejectionEvent</span><span class="s2">.</span><span class="s1">reason</span><span class="s2">;</span>
      <span class="s1">handleError</span><span class="s2">(</span><span class="s1">reason</span><span class="s2">, </span><span class="s4">&quot;Unknown promise rejection reason&quot;</span><span class="s2">);</span>
    <span class="s2">});</span>
  <span class="s2">}</span>
  <span class="s0">return </span><span class="s1">overlayService</span><span class="s2">;</span>
<span class="s2">};</span>
<span class="s0">export </span><span class="s2">{ </span><span class="s1">formatProblem</span><span class="s2">, </span><span class="s1">createOverlay </span><span class="s2">};</span></pre>
</body>
</html>