<html>
<head>
<title>ajv.bundle.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #67a37c; font-style: italic;}
.s7 { color: #7a7e85;}
.s8 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ajv.bundle.js</font>
</center></td></tr></table>
<pre><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">===</span><span class="s3">&quot;object&quot;</span><span class="s0">&amp;&amp;</span><span class="s1">typeof </span><span class="s2">module</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">f</span><span class="s0">()}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">define</span><span class="s0">===</span><span class="s3">&quot;function&quot;</span><span class="s0">&amp;&amp;</span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd</span><span class="s0">){</span><span class="s2">define</span><span class="s0">([],</span><span class="s2">f</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">g</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">window</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">global</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">global</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">self</span><span class="s0">!==</span><span class="s3">&quot;undefined&quot;</span><span class="s0">){</span><span class="s2">g</span><span class="s0">=</span><span class="s2">self</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">g</span><span class="s0">=</span><span class="s1">this</span><span class="s0">}</span><span class="s2">g</span><span class="s0">.</span><span class="s2">Ajv </span><span class="s0">= </span><span class="s2">f</span><span class="s0">()}})(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">define</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">;</span><span class="s1">return </span><span class="s0">(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">function </span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">require</span><span class="s0">&amp;&amp;</span><span class="s2">require</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">f</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot find module '&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;'&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">=</span><span class="s3">&quot;MODULE_NOT_FOUND&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">}</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]={</span><span class="s2">exports</span><span class="s0">:{}};</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s4">0</span><span class="s0">].</span><span class="s2">call</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s4">1</span><span class="s0">][</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">n</span><span class="s0">||</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">p</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">exports</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">require</span><span class="s0">&amp;&amp;</span><span class="s2">require</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++)</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">})()({</span><span class="s4">1</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>


<span class="s1">var </span><span class="s2">Cache </span><span class="s0">= </span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">Cache</span><span class="s0">() {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache </span><span class="s0">= {};</span>
<span class="s0">};</span>


<span class="s2">Cache</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">put </span><span class="s0">= </span><span class="s1">function </span><span class="s2">Cache_put</span><span class="s0">(</span><span class="s2">key</span><span class="s0">, </span><span class="s2">value</span><span class="s0">) {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">[</span><span class="s2">key</span><span class="s0">] = </span><span class="s2">value</span><span class="s0">;</span>
<span class="s0">};</span>


<span class="s2">Cache</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">get </span><span class="s0">= </span><span class="s1">function </span><span class="s2">Cache_get</span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
  <span class="s1">return this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
<span class="s0">};</span>


<span class="s2">Cache</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">del </span><span class="s0">= </span><span class="s1">function </span><span class="s2">Cache_del</span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
  <span class="s1">delete this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
<span class="s0">};</span>


<span class="s2">Cache</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clear </span><span class="s0">= </span><span class="s1">function </span><span class="s2">Cache_clear</span><span class="s0">() {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache </span><span class="s0">= {};</span>
<span class="s0">};</span>

<span class="s0">},{}],</span><span class="s4">2</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">MissingRefError </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./error_classes'</span><span class="s0">).</span><span class="s2">MissingRef</span><span class="s0">;</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">compileAsync</span><span class="s0">;</span>


<span class="s5">/**</span>
 <span class="s5">* Creates validating function for passed schema with asynchronous loading of missing schemas.</span>
 <span class="s5">* `loadSchema` option should be a function that accepts schema uri and returns promise that resolves with the schema.</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object}   schema schema object</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean}  meta optional true to compile meta-schema; this parameter can be skipped</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback an optional node-style callback, it is called with 2 parameters: error (or null) and validating function.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Promise} promise that resolves with a validating function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">compileAsync</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">meta</span><span class="s0">, </span><span class="s2">callback</span><span class="s0">) {</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s7">/* global Promise */</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">self </span><span class="s0">= </span><span class="s1">this</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">loadSchema </span><span class="s0">!= </span><span class="s3">'function'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'options.loadSchema should be a function'</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">meta </span><span class="s0">== </span><span class="s3">'function'</span><span class="s0">) {</span>
    <span class="s2">callback </span><span class="s0">= </span><span class="s2">meta</span><span class="s0">;</span>
    <span class="s2">meta </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s2">p </span><span class="s0">= </span><span class="s2">loadMetaSchemaOf</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">).</span><span class="s2">then</span><span class="s0">(</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">meta</span><span class="s0">);</span>
    <span class="s1">return </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s2">_compileAsync</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
  <span class="s0">});</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">callback</span><span class="s0">) {</span>
    <span class="s2">p</span><span class="s0">.</span><span class="s2">then</span><span class="s0">(</span>
      <span class="s1">function</span><span class="s0">(</span><span class="s2">v</span><span class="s0">) { </span><span class="s2">callback</span><span class="s0">(</span><span class="s1">null</span><span class="s0">, </span><span class="s2">v</span><span class="s0">); },</span>
      <span class="s2">callback</span>
    <span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s2">p</span><span class="s0">;</span>


  <span class="s1">function </span><span class="s2">loadMetaSchemaOf</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">sch</span><span class="s0">.</span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s2">$schema </span><span class="s0">&amp;&amp; !</span><span class="s2">self</span><span class="s0">.</span><span class="s2">getSchema</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">)</span>
            <span class="s0">? </span><span class="s2">compileAsync</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, { </span><span class="s2">$ref</span><span class="s0">: </span><span class="s2">$schema </span><span class="s0">}, </span><span class="s1">true</span><span class="s0">)</span>
            <span class="s0">: </span><span class="s2">Promise</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">();</span>
  <span class="s0">}</span>


  <span class="s1">function </span><span class="s2">_compileAsync</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">) {</span>
    <span class="s1">try </span><span class="s0">{ </span><span class="s1">return </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">); }</span>
    <span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">MissingRefError</span><span class="s0">) </span><span class="s1">return </span><span class="s2">loadMissingSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span>
      <span class="s1">throw </span><span class="s2">e</span><span class="s0">;</span>
    <span class="s0">}</span>


    <span class="s1">function </span><span class="s2">loadMissingSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">ref </span><span class="s0">= </span><span class="s2">e</span><span class="s0">.</span><span class="s2">missingSchema</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">added</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">)) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Schema ' </span><span class="s0">+ </span><span class="s2">ref </span><span class="s0">+ </span><span class="s3">' is loaded but ' </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">.</span><span class="s2">missingRef </span><span class="s0">+ </span><span class="s3">' cannot be resolved'</span><span class="s0">);</span>

      <span class="s1">var </span><span class="s2">schemaPromise </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_loadingSchemas</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">schemaPromise</span><span class="s0">) {</span>
        <span class="s2">schemaPromise </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_loadingSchemas</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">] = </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">loadSchema</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">);</span>
        <span class="s2">schemaPromise</span><span class="s0">.</span><span class="s2">then</span><span class="s0">(</span><span class="s2">removePromise</span><span class="s0">, </span><span class="s2">removePromise</span><span class="s0">);</span>
      <span class="s0">}</span>

      <span class="s1">return </span><span class="s2">schemaPromise</span><span class="s0">.</span><span class="s2">then</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">sch</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">added</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">)) {</span>
          <span class="s1">return </span><span class="s2">loadMetaSchemaOf</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">).</span><span class="s2">then</span><span class="s0">(</span><span class="s1">function </span><span class="s0">() {</span>
            <span class="s1">if </span><span class="s0">(!</span><span class="s2">added</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">)) </span><span class="s2">self</span><span class="s0">.</span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">meta</span><span class="s0">);</span>
          <span class="s0">});</span>
        <span class="s0">}</span>
      <span class="s0">}).</span><span class="s2">then</span><span class="s0">(</span><span class="s1">function</span><span class="s0">() {</span>
        <span class="s1">return </span><span class="s2">_compileAsync</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
      <span class="s0">});</span>

      <span class="s1">function </span><span class="s2">removePromise</span><span class="s0">() {</span>
        <span class="s1">delete </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_loadingSchemas</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
      <span class="s0">}</span>

      <span class="s1">function </span><span class="s2">added</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">] || </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s0">}],</span><span class="s4">3</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">resolve </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./resolve'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= {</span>
  <span class="s2">Validation</span><span class="s0">: </span><span class="s2">errorSubclass</span><span class="s0">(</span><span class="s2">ValidationError</span><span class="s0">),</span>
  <span class="s2">MissingRef</span><span class="s0">: </span><span class="s2">errorSubclass</span><span class="s0">(</span><span class="s2">MissingRefError</span><span class="s0">)</span>
<span class="s0">};</span>


<span class="s1">function </span><span class="s2">ValidationError</span><span class="s0">(</span><span class="s2">errors</span><span class="s0">) {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">message </span><span class="s0">= </span><span class="s3">'validation failed'</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s2">errors</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">ajv </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">validation </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s2">MissingRefError</span><span class="s0">.</span><span class="s2">message </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s3">'can</span><span class="s1">\'</span><span class="s3">t resolve reference ' </span><span class="s0">+ </span><span class="s2">ref </span><span class="s0">+ </span><span class="s3">' from id ' </span><span class="s0">+ </span><span class="s2">baseId</span><span class="s0">;</span>
<span class="s0">};</span>


<span class="s1">function </span><span class="s2">MissingRefError</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">, </span><span class="s2">message</span><span class="s0">) {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">message </span><span class="s0">= </span><span class="s2">message </span><span class="s0">|| </span><span class="s2">MissingRefError</span><span class="s0">.</span><span class="s2">message</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">missingRef </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">url</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">missingSchema </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">fullPath</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">missingRef</span><span class="s0">));</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">errorSubclass</span><span class="s0">(</span><span class="s2">Subclass</span><span class="s0">) {</span>
  <span class="s2">Subclass</span><span class="s0">.</span><span class="s2">prototype </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">Error</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">);</span>
  <span class="s2">Subclass</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">constructor </span><span class="s0">= </span><span class="s2">Subclass</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">Subclass</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s0">}],</span><span class="s4">4</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">util </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./util'</span><span class="s0">);</span>

<span class="s1">var </span><span class="s2">DATE </span><span class="s0">= </span><span class="s8">/^(\d\d\d\d)-(\d\d)-(\d\d)$/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">DAYS </span><span class="s0">= [</span><span class="s4">0</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">28</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">31</span><span class="s0">];</span>
<span class="s1">var </span><span class="s2">TIME </span><span class="s0">= </span><span class="s8">/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">HOSTNAME </span><span class="s0">= </span><span class="s8">/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">URI </span><span class="s0">= </span><span class="s8">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">URIREF </span><span class="s0">= </span><span class="s8">/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'&quot;()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span><span class="s0">;</span>
<span class="s7">// uri-template: https://tools.ietf.org/html/rfc6570</span>
<span class="s1">var </span><span class="s2">URITEMPLATE </span><span class="s0">= </span><span class="s8">/^(?:(?:[^\x00-\x20&quot;'&lt;&gt;%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&amp;=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i</span><span class="s0">;</span>
<span class="s7">// For the source: https://gist.github.com/dperini/729294</span>
<span class="s7">// For test cases: https://mathiasbynens.be/demo/url-regex</span>
<span class="s7">// @todo Delete current URL in favour of the commented out URL rule when this issue is fixed https://github.com/eslint/eslint/issues/7983.</span>
<span class="s7">// var URL = /^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu;</span>
<span class="s1">var </span><span class="s2">URL </span><span class="s0">= </span><span class="s8">/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">UUID </span><span class="s0">= </span><span class="s8">/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">JSON_POINTER </span><span class="s0">= </span><span class="s8">/^(?:\/(?:[^~/]|~0|~1)*)*$/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">JSON_POINTER_URI_FRAGMENT </span><span class="s0">= </span><span class="s8">/^#(?:\/(?:[a-z0-9_\-.!$&amp;'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">RELATIVE_JSON_POINTER </span><span class="s0">= </span><span class="s8">/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/</span><span class="s0">;</span>


<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">formats</span><span class="s0">;</span>

<span class="s1">function </span><span class="s2">formats</span><span class="s0">(</span><span class="s2">mode</span><span class="s0">) {</span>
  <span class="s2">mode </span><span class="s0">= </span><span class="s2">mode </span><span class="s0">== </span><span class="s3">'full' </span><span class="s0">? </span><span class="s3">'full' </span><span class="s0">: </span><span class="s3">'fast'</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">formats</span><span class="s0">[</span><span class="s2">mode</span><span class="s0">]);</span>
<span class="s0">}</span>


<span class="s2">formats</span><span class="s0">.</span><span class="s2">fast </span><span class="s0">= {</span>
  <span class="s7">// date: http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s2">date</span><span class="s0">: </span><span class="s8">/^\d\d\d\d-[0-1]\d-[0-3]\d$/</span><span class="s0">,</span>
  <span class="s7">// date-time: http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s2">time</span><span class="s0">: </span><span class="s8">/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i</span><span class="s0">,</span>
  <span class="s3">'date-time'</span><span class="s0">: </span><span class="s8">/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i</span><span class="s0">,</span>
  <span class="s7">// uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js</span>
  <span class="s2">uri</span><span class="s0">: </span><span class="s8">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i</span><span class="s0">,</span>
  <span class="s3">'uri-reference'</span><span class="s0">: </span><span class="s8">/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i</span><span class="s0">,</span>
  <span class="s3">'uri-template'</span><span class="s0">: </span><span class="s2">URITEMPLATE</span><span class="s0">,</span>
  <span class="s2">url</span><span class="s0">: </span><span class="s2">URL</span><span class="s0">,</span>
  <span class="s7">// email (sources from jsen validator):</span>
  <span class="s7">// http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363</span>
  <span class="s7">// http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'willful violation')</span>
  <span class="s2">email</span><span class="s0">: </span><span class="s8">/^[a-z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i</span><span class="s0">,</span>
  <span class="s2">hostname</span><span class="s0">: </span><span class="s2">HOSTNAME</span><span class="s0">,</span>
  <span class="s7">// optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html</span>
  <span class="s2">ipv4</span><span class="s0">: </span><span class="s8">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span><span class="s0">,</span>
  <span class="s7">// optimized http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses</span>
  <span class="s2">ipv6</span><span class="s0">: </span><span class="s8">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span><span class="s0">,</span>
  <span class="s2">regex</span><span class="s0">: </span><span class="s2">regex</span><span class="s0">,</span>
  <span class="s7">// uuid: http://tools.ietf.org/html/rfc4122</span>
  <span class="s2">uuid</span><span class="s0">: </span><span class="s2">UUID</span><span class="s0">,</span>
  <span class="s7">// JSON-pointer: https://tools.ietf.org/html/rfc6901</span>
  <span class="s7">// uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A</span>
  <span class="s3">'json-pointer'</span><span class="s0">: </span><span class="s2">JSON_POINTER</span><span class="s0">,</span>
  <span class="s3">'json-pointer-uri-fragment'</span><span class="s0">: </span><span class="s2">JSON_POINTER_URI_FRAGMENT</span><span class="s0">,</span>
  <span class="s7">// relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00</span>
  <span class="s3">'relative-json-pointer'</span><span class="s0">: </span><span class="s2">RELATIVE_JSON_POINTER</span>
<span class="s0">};</span>


<span class="s2">formats</span><span class="s0">.</span><span class="s2">full </span><span class="s0">= {</span>
  <span class="s2">date</span><span class="s0">: </span><span class="s2">date</span><span class="s0">,</span>
  <span class="s2">time</span><span class="s0">: </span><span class="s2">time</span><span class="s0">,</span>
  <span class="s3">'date-time'</span><span class="s0">: </span><span class="s2">date_time</span><span class="s0">,</span>
  <span class="s2">uri</span><span class="s0">: </span><span class="s2">uri</span><span class="s0">,</span>
  <span class="s3">'uri-reference'</span><span class="s0">: </span><span class="s2">URIREF</span><span class="s0">,</span>
  <span class="s3">'uri-template'</span><span class="s0">: </span><span class="s2">URITEMPLATE</span><span class="s0">,</span>
  <span class="s2">url</span><span class="s0">: </span><span class="s2">URL</span><span class="s0">,</span>
  <span class="s2">email</span><span class="s0">: </span><span class="s8">/^[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i</span><span class="s0">,</span>
  <span class="s2">hostname</span><span class="s0">: </span><span class="s2">HOSTNAME</span><span class="s0">,</span>
  <span class="s2">ipv4</span><span class="s0">: </span><span class="s8">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span><span class="s0">,</span>
  <span class="s2">ipv6</span><span class="s0">: </span><span class="s8">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span><span class="s0">,</span>
  <span class="s2">regex</span><span class="s0">: </span><span class="s2">regex</span><span class="s0">,</span>
  <span class="s2">uuid</span><span class="s0">: </span><span class="s2">UUID</span><span class="s0">,</span>
  <span class="s3">'json-pointer'</span><span class="s0">: </span><span class="s2">JSON_POINTER</span><span class="s0">,</span>
  <span class="s3">'json-pointer-uri-fragment'</span><span class="s0">: </span><span class="s2">JSON_POINTER_URI_FRAGMENT</span><span class="s0">,</span>
  <span class="s3">'relative-json-pointer'</span><span class="s0">: </span><span class="s2">RELATIVE_JSON_POINTER</span>
<span class="s0">};</span>


<span class="s1">function </span><span class="s2">isLeapYear</span><span class="s0">(</span><span class="s2">year</span><span class="s0">) {</span>
  <span class="s7">// https://tools.ietf.org/html/rfc3339#appendix-C</span>
  <span class="s1">return </span><span class="s2">year </span><span class="s0">% </span><span class="s4">4 </span><span class="s0">=== </span><span class="s4">0 </span><span class="s0">&amp;&amp; (</span><span class="s2">year </span><span class="s0">% </span><span class="s4">100 </span><span class="s0">!== </span><span class="s4">0 </span><span class="s0">|| </span><span class="s2">year </span><span class="s0">% </span><span class="s4">400 </span><span class="s0">=== </span><span class="s4">0</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">date</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s7">// full-date from http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">DATE</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">matches</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>

  <span class="s1">var </span><span class="s2">year </span><span class="s0">= +</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">month </span><span class="s0">= +</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">day </span><span class="s0">= +</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">3</span><span class="s0">];</span>

  <span class="s1">return </span><span class="s2">month </span><span class="s0">&gt;= </span><span class="s4">1 </span><span class="s0">&amp;&amp; </span><span class="s2">month </span><span class="s0">&lt;= </span><span class="s4">12 </span><span class="s0">&amp;&amp; </span><span class="s2">day </span><span class="s0">&gt;= </span><span class="s4">1 </span><span class="s0">&amp;&amp;</span>
          <span class="s2">day </span><span class="s0">&lt;= (</span><span class="s2">month </span><span class="s0">== </span><span class="s4">2 </span><span class="s0">&amp;&amp; </span><span class="s2">isLeapYear</span><span class="s0">(</span><span class="s2">year</span><span class="s0">) ? </span><span class="s4">29 </span><span class="s0">: </span><span class="s2">DAYS</span><span class="s0">[</span><span class="s2">month</span><span class="s0">]);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">time</span><span class="s0">(</span><span class="s2">str</span><span class="s0">, </span><span class="s2">full</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">TIME</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">matches</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>

  <span class="s1">var </span><span class="s2">hour </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">minute </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">second </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">3</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">timeZone </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">5</span><span class="s0">];</span>
  <span class="s1">return </span><span class="s0">((</span><span class="s2">hour </span><span class="s0">&lt;= </span><span class="s4">23 </span><span class="s0">&amp;&amp; </span><span class="s2">minute </span><span class="s0">&lt;= </span><span class="s4">59 </span><span class="s0">&amp;&amp; </span><span class="s2">second </span><span class="s0">&lt;= </span><span class="s4">59</span><span class="s0">) ||</span>
          <span class="s0">(</span><span class="s2">hour </span><span class="s0">== </span><span class="s4">23 </span><span class="s0">&amp;&amp; </span><span class="s2">minute </span><span class="s0">== </span><span class="s4">59 </span><span class="s0">&amp;&amp; </span><span class="s2">second </span><span class="s0">== </span><span class="s4">60</span><span class="s0">)) &amp;&amp;</span>
         <span class="s0">(!</span><span class="s2">full </span><span class="s0">|| </span><span class="s2">timeZone</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">DATE_TIME_SEPARATOR </span><span class="s0">= </span><span class="s8">/t|\s/i</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">date_time</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s7">// http://tools.ietf.org/html/rfc3339#section-5.6</span>
  <span class="s1">var </span><span class="s2">dateTime </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">DATE_TIME_SEPARATOR</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">dateTime</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">2 </span><span class="s0">&amp;&amp; </span><span class="s2">date</span><span class="s0">(</span><span class="s2">dateTime</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]) &amp;&amp; </span><span class="s2">time</span><span class="s0">(</span><span class="s2">dateTime</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s1">true</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">NOT_URI_FRAGMENT </span><span class="s0">= </span><span class="s8">/\/|:/</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">uri</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s7">// http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required &quot;.&quot;</span>
  <span class="s1">return </span><span class="s2">NOT_URI_FRAGMENT</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) &amp;&amp; </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">str</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">Z_ANCHOR </span><span class="s0">= </span><span class="s8">/[^\\]\\Z/</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">regex</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Z_ANCHOR</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">str</span><span class="s0">)) </span><span class="s1">return false</span><span class="s0">;</span>
  <span class="s1">try </span><span class="s0">{</span>
    <span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">str</span><span class="s0">);</span>
    <span class="s1">return true</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
    <span class="s1">return false</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}],</span><span class="s4">5</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">resolve </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./resolve'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">util </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./util'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">errorClasses </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./error_classes'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">stableStringify </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'fast-json-stable-stringify'</span><span class="s0">);</span>

<span class="s1">var </span><span class="s2">validateGenerator </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'../dotjs/validate'</span><span class="s0">);</span>

<span class="s5">/**</span>
 <span class="s5">* Functions below are used inside compiled validations function</span>
 <span class="s5">*/</span>

<span class="s1">var </span><span class="s2">ucs2length </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">ucs2length</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">equal </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'fast-deep-equal'</span><span class="s0">);</span>

<span class="s7">// this error is thrown by async schemas to return validation errors via exception</span>
<span class="s1">var </span><span class="s2">ValidationError </span><span class="s0">= </span><span class="s2">errorClasses</span><span class="s0">.</span><span class="s2">Validation</span><span class="s0">;</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">compile</span><span class="s0">;</span>


<span class="s5">/**</span>
 <span class="s5">* Compiles schema to validation function</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root object with information about the root schema for this schema</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} localRefs the hash of local references inside the schema (created by resolve.id), used for inline resolution</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base ID for IDs in the schema</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} validation function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">compile</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true, evil: true */</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s1">var </span><span class="s2">self </span><span class="s0">= </span><span class="s1">this</span>
    <span class="s0">, </span><span class="s2">opts </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span>
    <span class="s0">, </span><span class="s2">refVal </span><span class="s0">= [ </span><span class="s2">undefined </span><span class="s0">]</span>
    <span class="s0">, </span><span class="s2">refs </span><span class="s0">= {}</span>
    <span class="s0">, </span><span class="s2">patterns </span><span class="s0">= []</span>
    <span class="s0">, </span><span class="s2">patternsHash </span><span class="s0">= {}</span>
    <span class="s0">, </span><span class="s2">defaults </span><span class="s0">= []</span>
    <span class="s0">, </span><span class="s2">defaultsHash </span><span class="s0">= {}</span>
    <span class="s0">, </span><span class="s2">customRules </span><span class="s0">= [];</span>

  <span class="s2">root </span><span class="s0">= </span><span class="s2">root </span><span class="s0">|| { </span><span class="s2">schema</span><span class="s0">: </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">refVal</span><span class="s0">: </span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">refs</span><span class="s0">: </span><span class="s2">refs </span><span class="s0">};</span>

  <span class="s1">var </span><span class="s2">c </span><span class="s0">= </span><span class="s2">checkCompiling</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">compilation </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">[</span><span class="s2">c</span><span class="s0">.</span><span class="s2">index</span><span class="s0">];</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compiling</span><span class="s0">) </span><span class="s1">return </span><span class="s0">(</span><span class="s2">compilation</span><span class="s0">.</span><span class="s2">callValidate </span><span class="s0">= </span><span class="s2">callValidate</span><span class="s0">);</span>

  <span class="s1">var </span><span class="s2">formats </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_formats</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">RULES </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">;</span>

  <span class="s1">try </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">v </span><span class="s0">= </span><span class="s2">localCompile</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
    <span class="s2">compilation</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">= </span><span class="s2">v</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">cv </span><span class="s0">= </span><span class="s2">compilation</span><span class="s0">.</span><span class="s2">callValidate</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">cv</span><span class="s0">) {</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">refs </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">;</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">refVal </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">refVal</span><span class="s0">;</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">root </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span>
      <span class="s2">cv</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">$async</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">sourceCode</span><span class="s0">) </span><span class="s2">cv</span><span class="s0">.</span><span class="s2">source </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">source</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
    <span class="s2">endCompiling</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s7">/* @this   {*} - custom context, see passContext option */</span>
  <span class="s1">function </span><span class="s2">callValidate</span><span class="s0">() {</span>
    <span class="s7">/* jshint validthis: true */</span>
    <span class="s1">var </span><span class="s2">validate </span><span class="s0">= </span><span class="s2">compilation</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">result </span><span class="s0">= </span><span class="s2">validate</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">arguments</span><span class="s0">);</span>
    <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s2">validate</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s2">result</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">localCompile</span><span class="s0">(</span><span class="s2">_schema</span><span class="s0">, </span><span class="s2">_root</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">isRoot </span><span class="s0">= !</span><span class="s2">_root </span><span class="s0">|| (</span><span class="s2">_root </span><span class="s0">&amp;&amp; </span><span class="s2">_root</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">== </span><span class="s2">_schema</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">_root</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">!= </span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)</span>
      <span class="s1">return </span><span class="s2">compile</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">_schema</span><span class="s0">, </span><span class="s2">_root</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>

    <span class="s1">var </span><span class="s2">$async </span><span class="s0">= </span><span class="s2">_schema</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">;</span>

    <span class="s1">var </span><span class="s2">sourceCode </span><span class="s0">= </span><span class="s2">validateGenerator</span><span class="s0">({</span>
      <span class="s2">isTop</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
      <span class="s2">schema</span><span class="s0">: </span><span class="s2">_schema</span><span class="s0">,</span>
      <span class="s2">isRoot</span><span class="s0">: </span><span class="s2">isRoot</span><span class="s0">,</span>
      <span class="s2">baseId</span><span class="s0">: </span><span class="s2">baseId</span><span class="s0">,</span>
      <span class="s2">root</span><span class="s0">: </span><span class="s2">_root</span><span class="s0">,</span>
      <span class="s2">schemaPath</span><span class="s0">: </span><span class="s3">''</span><span class="s0">,</span>
      <span class="s2">errSchemaPath</span><span class="s0">: </span><span class="s3">'#'</span><span class="s0">,</span>
      <span class="s2">errorPath</span><span class="s0">: </span><span class="s3">'&quot;&quot;'</span><span class="s0">,</span>
      <span class="s2">MissingRefError</span><span class="s0">: </span><span class="s2">errorClasses</span><span class="s0">.</span><span class="s2">MissingRef</span><span class="s0">,</span>
      <span class="s2">RULES</span><span class="s0">: </span><span class="s2">RULES</span><span class="s0">,</span>
      <span class="s2">validate</span><span class="s0">: </span><span class="s2">validateGenerator</span><span class="s0">,</span>
      <span class="s2">util</span><span class="s0">: </span><span class="s2">util</span><span class="s0">,</span>
      <span class="s2">resolve</span><span class="s0">: </span><span class="s2">resolve</span><span class="s0">,</span>
      <span class="s2">resolveRef</span><span class="s0">: </span><span class="s2">resolveRef</span><span class="s0">,</span>
      <span class="s2">usePattern</span><span class="s0">: </span><span class="s2">usePattern</span><span class="s0">,</span>
      <span class="s2">useDefault</span><span class="s0">: </span><span class="s2">useDefault</span><span class="s0">,</span>
      <span class="s2">useCustomRule</span><span class="s0">: </span><span class="s2">useCustomRule</span><span class="s0">,</span>
      <span class="s2">opts</span><span class="s0">: </span><span class="s2">opts</span><span class="s0">,</span>
      <span class="s2">formats</span><span class="s0">: </span><span class="s2">formats</span><span class="s0">,</span>
      <span class="s2">logger</span><span class="s0">: </span><span class="s2">self</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">,</span>
      <span class="s2">self</span><span class="s0">: </span><span class="s2">self</span>
    <span class="s0">});</span>

    <span class="s2">sourceCode </span><span class="s0">= </span><span class="s2">vars</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">refValCode</span><span class="s0">) + </span><span class="s2">vars</span><span class="s0">(</span><span class="s2">patterns</span><span class="s0">, </span><span class="s2">patternCode</span><span class="s0">)</span>
                   <span class="s0">+ </span><span class="s2">vars</span><span class="s0">(</span><span class="s2">defaults</span><span class="s0">, </span><span class="s2">defaultCode</span><span class="s0">) + </span><span class="s2">vars</span><span class="s0">(</span><span class="s2">customRules</span><span class="s0">, </span><span class="s2">customRuleCode</span><span class="s0">)</span>
                   <span class="s0">+ </span><span class="s2">sourceCode</span><span class="s0">;</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">processCode</span><span class="s0">) </span><span class="s2">sourceCode </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">processCode</span><span class="s0">(</span><span class="s2">sourceCode</span><span class="s0">, </span><span class="s2">_schema</span><span class="s0">);</span>
    <span class="s7">// console.log('\n\n\n *** \n', JSON.stringify(sourceCode));</span>
    <span class="s1">var </span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">try </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s2">makeValidate </span><span class="s0">= </span><span class="s1">new </span><span class="s2">Function</span><span class="s0">(</span>
        <span class="s3">'self'</span><span class="s0">,</span>
        <span class="s3">'RULES'</span><span class="s0">,</span>
        <span class="s3">'formats'</span><span class="s0">,</span>
        <span class="s3">'root'</span><span class="s0">,</span>
        <span class="s3">'refVal'</span><span class="s0">,</span>
        <span class="s3">'defaults'</span><span class="s0">,</span>
        <span class="s3">'customRules'</span><span class="s0">,</span>
        <span class="s3">'equal'</span><span class="s0">,</span>
        <span class="s3">'ucs2length'</span><span class="s0">,</span>
        <span class="s3">'ValidationError'</span><span class="s0">,</span>
        <span class="s2">sourceCode</span>
      <span class="s0">);</span>

      <span class="s2">validate </span><span class="s0">= </span><span class="s2">makeValidate</span><span class="s0">(</span>
        <span class="s2">self</span><span class="s0">,</span>
        <span class="s2">RULES</span><span class="s0">,</span>
        <span class="s2">formats</span><span class="s0">,</span>
        <span class="s2">root</span><span class="s0">,</span>
        <span class="s2">refVal</span><span class="s0">,</span>
        <span class="s2">defaults</span><span class="s0">,</span>
        <span class="s2">customRules</span><span class="s0">,</span>
        <span class="s2">equal</span><span class="s0">,</span>
        <span class="s2">ucs2length</span><span class="s0">,</span>
        <span class="s2">ValidationError</span>
      <span class="s0">);</span>

      <span class="s2">refVal</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] = </span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
      <span class="s2">self</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">'Error compiling schema, function code:'</span><span class="s0">, </span><span class="s2">sourceCode</span><span class="s0">);</span>
      <span class="s1">throw </span><span class="s2">e</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s2">validate</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">_schema</span><span class="s0">;</span>
    <span class="s2">validate</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
    <span class="s2">validate</span><span class="s0">.</span><span class="s2">refs </span><span class="s0">= </span><span class="s2">refs</span><span class="s0">;</span>
    <span class="s2">validate</span><span class="s0">.</span><span class="s2">refVal </span><span class="s0">= </span><span class="s2">refVal</span><span class="s0">;</span>
    <span class="s2">validate</span><span class="s0">.</span><span class="s2">root </span><span class="s0">= </span><span class="s2">isRoot </span><span class="s0">? </span><span class="s2">validate </span><span class="s0">: </span><span class="s2">_root</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) </span><span class="s2">validate</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">sourceCode </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">) {</span>
      <span class="s2">validate</span><span class="s0">.</span><span class="s2">source </span><span class="s0">= {</span>
        <span class="s2">code</span><span class="s0">: </span><span class="s2">sourceCode</span><span class="s0">,</span>
        <span class="s2">patterns</span><span class="s0">: </span><span class="s2">patterns</span><span class="s0">,</span>
        <span class="s2">defaults</span><span class="s0">: </span><span class="s2">defaults</span>
      <span class="s0">};</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">validate</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">resolveRef</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">, </span><span class="s2">isRoot</span><span class="s0">) {</span>
    <span class="s2">ref </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">url</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">refIndex </span><span class="s0">= </span><span class="s2">refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
    <span class="s1">var </span><span class="s2">_refVal</span><span class="s0">, </span><span class="s2">refCode</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">refIndex </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s2">_refVal </span><span class="s0">= </span><span class="s2">refVal</span><span class="s0">[</span><span class="s2">refIndex</span><span class="s0">];</span>
      <span class="s2">refCode </span><span class="s0">= </span><span class="s3">'refVal[' </span><span class="s0">+ </span><span class="s2">refIndex </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
      <span class="s1">return </span><span class="s2">resolvedRef</span><span class="s0">(</span><span class="s2">_refVal</span><span class="s0">, </span><span class="s2">refCode</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">isRoot </span><span class="s0">&amp;&amp; </span><span class="s2">root</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">rootRefId </span><span class="s0">= </span><span class="s2">root</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">rootRefId </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s2">_refVal </span><span class="s0">= </span><span class="s2">root</span><span class="s0">.</span><span class="s2">refVal</span><span class="s0">[</span><span class="s2">rootRefId</span><span class="s0">];</span>
        <span class="s2">refCode </span><span class="s0">= </span><span class="s2">addLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">, </span><span class="s2">_refVal</span><span class="s0">);</span>
        <span class="s1">return </span><span class="s2">resolvedRef</span><span class="s0">(</span><span class="s2">_refVal</span><span class="s0">, </span><span class="s2">refCode</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s2">refCode </span><span class="s0">= </span><span class="s2">addLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">v </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">localCompile</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">v </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">localSchema </span><span class="s0">= </span><span class="s2">localRefs </span><span class="s0">&amp;&amp; </span><span class="s2">localRefs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">localSchema</span><span class="s0">) {</span>
        <span class="s2">v </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">inlineRef</span><span class="s0">(</span><span class="s2">localSchema</span><span class="s0">, </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">inlineRefs</span><span class="s0">)</span>
            <span class="s0">? </span><span class="s2">localSchema</span>
            <span class="s0">: </span><span class="s2">compile</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">localSchema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">v </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s2">removeLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">replaceLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">, </span><span class="s2">v</span><span class="s0">);</span>
      <span class="s1">return </span><span class="s2">resolvedRef</span><span class="s0">(</span><span class="s2">v</span><span class="s0">, </span><span class="s2">refCode</span><span class="s0">);</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">addLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">, </span><span class="s2">v</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">refId </span><span class="s0">= </span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
    <span class="s2">refVal</span><span class="s0">[</span><span class="s2">refId</span><span class="s0">] = </span><span class="s2">v</span><span class="s0">;</span>
    <span class="s2">refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">] = </span><span class="s2">refId</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s3">'refVal' </span><span class="s0">+ </span><span class="s2">refId</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">removeLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">) {</span>
    <span class="s1">delete </span><span class="s2">refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">replaceLocalRef</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">, </span><span class="s2">v</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">refId </span><span class="s0">= </span><span class="s2">refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
    <span class="s2">refVal</span><span class="s0">[</span><span class="s2">refId</span><span class="s0">] = </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">resolvedRef</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">code</span><span class="s0">) {</span>
    <span class="s1">return typeof </span><span class="s2">refVal </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">refVal </span><span class="s0">== </span><span class="s3">'boolean'</span>
            <span class="s0">? { </span><span class="s2">code</span><span class="s0">: </span><span class="s2">code</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">: </span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">inline</span><span class="s0">: </span><span class="s1">true </span><span class="s0">}</span>
            <span class="s0">: { </span><span class="s2">code</span><span class="s0">: </span><span class="s2">code</span><span class="s0">, </span><span class="s2">$async</span><span class="s0">: </span><span class="s2">refVal </span><span class="s0">&amp;&amp; !!</span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">};</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">usePattern</span><span class="s0">(</span><span class="s2">regexStr</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">patternsHash</span><span class="s0">[</span><span class="s2">regexStr</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">index </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s2">index </span><span class="s0">= </span><span class="s2">patternsHash</span><span class="s0">[</span><span class="s2">regexStr</span><span class="s0">] = </span><span class="s2">patterns</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
      <span class="s2">patterns</span><span class="s0">[</span><span class="s2">index</span><span class="s0">] = </span><span class="s2">regexStr</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s3">'pattern' </span><span class="s0">+ </span><span class="s2">index</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">useDefault</span><span class="s0">(</span><span class="s2">value</span><span class="s0">) {</span>
    <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">value</span><span class="s0">) {</span>
      <span class="s1">case </span><span class="s3">'boolean'</span><span class="s0">:</span>
      <span class="s1">case </span><span class="s3">'number'</span><span class="s0">:</span>
        <span class="s1">return </span><span class="s3">'' </span><span class="s0">+ </span><span class="s2">value</span><span class="s0">;</span>
      <span class="s1">case </span><span class="s3">'string'</span><span class="s0">:</span>
        <span class="s1">return </span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
      <span class="s1">case </span><span class="s3">'object'</span><span class="s0">:</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">value </span><span class="s0">=== </span><span class="s1">null</span><span class="s0">) </span><span class="s1">return </span><span class="s3">'null'</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">valueStr </span><span class="s0">= </span><span class="s2">stableStringify</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">defaultsHash</span><span class="s0">[</span><span class="s2">valueStr</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">index </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
          <span class="s2">index </span><span class="s0">= </span><span class="s2">defaultsHash</span><span class="s0">[</span><span class="s2">valueStr</span><span class="s0">] = </span><span class="s2">defaults</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
          <span class="s2">defaults</span><span class="s0">[</span><span class="s2">index</span><span class="s0">] = </span><span class="s2">value</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s3">'default' </span><span class="s0">+ </span><span class="s2">index</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">useCustomRule</span><span class="s0">(</span><span class="s2">rule</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">deps </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">deps </span><span class="s0">&amp;&amp; !</span><span class="s2">deps</span><span class="s0">.</span><span class="s2">every</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">keyword</span><span class="s0">);</span>
      <span class="s0">}))</span>
        <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'parent schema must have all required keywords: ' </span><span class="s0">+ </span><span class="s2">deps</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">','</span><span class="s0">));</span>

      <span class="s1">var </span><span class="s2">validateSchema </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">validateSchema</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">validateSchema</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">valid </span><span class="s0">= </span><span class="s2">validateSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">valid</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">message </span><span class="s0">= </span><span class="s3">'keyword schema is invalid: ' </span><span class="s0">+ </span><span class="s2">self</span><span class="s0">.</span><span class="s2">errorsText</span><span class="s0">(</span><span class="s2">validateSchema</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">);</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s2">self</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">message</span><span class="s0">);</span>
          <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">message</span><span class="s0">);</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">compile </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">compile</span>
      <span class="s0">, </span><span class="s2">inline </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">inline</span>
      <span class="s0">, </span><span class="s2">macro </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">macro</span><span class="s0">;</span>

    <span class="s1">var </span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">compile</span><span class="s0">) {</span>
      <span class="s2">validate </span><span class="s0">= </span><span class="s2">compile</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">macro</span><span class="s0">) {</span>
      <span class="s2">validate </span><span class="s0">= </span><span class="s2">macro</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) </span><span class="s2">self</span><span class="s0">.</span><span class="s2">validateSchema</span><span class="s0">(</span><span class="s2">validate</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">inline</span><span class="s0">) {</span>
      <span class="s2">validate </span><span class="s0">= </span><span class="s2">inline</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">it</span><span class="s0">, </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">validate </span><span class="s0">= </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">validate</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">validate </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">)</span>
      <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'custom keyword &quot;' </span><span class="s0">+ </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">keyword </span><span class="s0">+ </span><span class="s3">'&quot;failed to compile'</span><span class="s0">);</span>

    <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">customRules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
    <span class="s2">customRules</span><span class="s0">[</span><span class="s2">index</span><span class="s0">] = </span><span class="s2">validate</span><span class="s0">;</span>

    <span class="s1">return </span><span class="s0">{</span>
      <span class="s2">code</span><span class="s0">: </span><span class="s3">'customRule' </span><span class="s0">+ </span><span class="s2">index</span><span class="s0">,</span>
      <span class="s2">validate</span><span class="s0">: </span><span class="s2">validate</span>
    <span class="s0">};</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Checks if the schema is currently compiled</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} object with properties &quot;index&quot; (compilation index) and &quot;compiling&quot; (boolean)</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">checkCompiling</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">compIndex</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">index </span><span class="s0">&gt;= </span><span class="s4">0</span><span class="s0">) </span><span class="s1">return </span><span class="s0">{ </span><span class="s2">index</span><span class="s0">: </span><span class="s2">index</span><span class="s0">, </span><span class="s2">compiling</span><span class="s0">: </span><span class="s1">true </span><span class="s0">};</span>
  <span class="s2">index </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">[</span><span class="s2">index</span><span class="s0">] = {</span>
    <span class="s2">schema</span><span class="s0">: </span><span class="s2">schema</span><span class="s0">,</span>
    <span class="s2">root</span><span class="s0">: </span><span class="s2">root</span><span class="s0">,</span>
    <span class="s2">baseId</span><span class="s0">: </span><span class="s2">baseId</span>
  <span class="s0">};</span>
  <span class="s1">return </span><span class="s0">{ </span><span class="s2">index</span><span class="s0">: </span><span class="s2">index</span><span class="s0">, </span><span class="s2">compiling</span><span class="s0">: </span><span class="s1">false </span><span class="s0">};</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Removes the schema from the currently compiled list</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">endCompiling</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s2">compIndex</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">i </span><span class="s0">&gt;= </span><span class="s4">0</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s4">1</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Index of schema compilation in the currently compiled list</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema to compile</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} baseId base schema ID</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Integer} compilation index</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">compIndex</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s1">var </span><span class="s2">c </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">== </span><span class="s2">schema </span><span class="s0">&amp;&amp; </span><span class="s2">c</span><span class="s0">.</span><span class="s2">root </span><span class="s0">== </span><span class="s2">root </span><span class="s0">&amp;&amp; </span><span class="s2">c</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">== </span><span class="s2">baseId</span><span class="s0">) </span><span class="s1">return </span><span class="s2">i</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">patternCode</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s2">patterns</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s3">'var pattern' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">' = new RegExp(' </span><span class="s0">+ </span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">patterns</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]) + </span><span class="s3">');'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">defaultCode</span><span class="s0">(</span><span class="s2">i</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s3">'var default' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">' = defaults[' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">'];'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">refValCode</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s2">refVal</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">refVal</span><span class="s0">[</span><span class="s2">i</span><span class="s0">] === </span><span class="s2">undefined </span><span class="s0">? </span><span class="s3">'' </span><span class="s0">: </span><span class="s3">'var refVal' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">' = refVal[' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">'];'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">customRuleCode</span><span class="s0">(</span><span class="s2">i</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s3">'var customRule' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">' = customRules[' </span><span class="s0">+ </span><span class="s2">i </span><span class="s0">+ </span><span class="s3">'];'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">vars</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">, </span><span class="s2">statement</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) </span><span class="s1">return </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">code </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
    <span class="s2">code </span><span class="s0">+= </span><span class="s2">statement</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s2">arr</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">code</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;../dotjs/validate&quot;</span><span class="s0">:</span><span class="s4">38</span><span class="s0">,</span><span class="s3">&quot;./error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s3">&quot;./resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s0">,</span><span class="s3">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">,</span><span class="s3">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s0">,</span><span class="s3">&quot;fast-json-stable-stringify&quot;</span><span class="s0">:</span><span class="s4">43</span><span class="s0">}],</span><span class="s4">6</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">URI </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'uri-js'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">equal </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'fast-deep-equal'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">util </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./util'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">SchemaObject </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./schema_obj'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">traverse </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'json-schema-traverse'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">;</span>

<span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">;</span>
<span class="s2">resolve</span><span class="s0">.</span><span class="s2">fullPath </span><span class="s0">= </span><span class="s2">getFullPath</span><span class="s0">;</span>
<span class="s2">resolve</span><span class="s0">.</span><span class="s2">url </span><span class="s0">= </span><span class="s2">resolveUrl</span><span class="s0">;</span>
<span class="s2">resolve</span><span class="s0">.</span><span class="s2">ids </span><span class="s0">= </span><span class="s2">resolveIds</span><span class="s0">;</span>
<span class="s2">resolve</span><span class="s0">.</span><span class="s2">inlineRef </span><span class="s0">= </span><span class="s2">inlineRef</span><span class="s0">;</span>
<span class="s2">resolve</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">resolveSchema</span><span class="s0">;</span>

<span class="s5">/**</span>
 <span class="s5">* [resolve and compile the references ($ref)]</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Function} compile reference to schema compilation funciton (localCompile)</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root object with information about the root schema for the current schema</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} ref reference to resolve</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object|Function} schema object (if the schema can be inlined) or validation function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">compile</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">refVal </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">refVal </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">refVal</span><span class="s0">]) </span><span class="s2">refVal </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">refVal</span><span class="s0">];</span>
    <span class="s1">else return </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">compile</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">refVal</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s2">refVal </span><span class="s0">= </span><span class="s2">refVal </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">];</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">refVal </span><span class="s1">instanceof </span><span class="s2">SchemaObject</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">inlineRef</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">inlineRefs</span><span class="s0">)</span>
            <span class="s0">? </span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">schema</span>
            <span class="s0">: </span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s2">res </span><span class="s0">= </span><span class="s2">resolveSchema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">v</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">res</span><span class="s0">) {</span>
    <span class="s2">schema </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
    <span class="s2">root </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span>
    <span class="s2">baseId </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema </span><span class="s1">instanceof </span><span class="s2">SchemaObject</span><span class="s0">) {</span>
    <span class="s2">v </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s2">compile</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">schema </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
    <span class="s2">v </span><span class="s0">= </span><span class="s2">inlineRef</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">inlineRefs</span><span class="s0">)</span>
        <span class="s0">? </span><span class="s2">schema</span>
        <span class="s0">: </span><span class="s2">compile</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s2">v</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Resolve schema, its root and baseId</span>
 <span class="s5">* </span><span class="s6">@this </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} root root object with properties schema, refVal, refs</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} ref  reference to resolve</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} object with properties schema, root, baseId</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">resolveSchema</span><span class="s0">(</span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">p </span><span class="s0">= </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">)</span>
    <span class="s0">, </span><span class="s2">refPath </span><span class="s0">= </span><span class="s2">_getFullPath</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)</span>
    <span class="s0">, </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">getFullPath</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">));</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">).</span><span class="s2">length </span><span class="s0">=== </span><span class="s4">0 </span><span class="s0">|| </span><span class="s2">refPath </span><span class="s0">!== </span><span class="s2">baseId</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">refPath</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">refVal </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">refVal </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) {</span>
      <span class="s1">return </span><span class="s2">resolveRecursive</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">p</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">refVal </span><span class="s1">instanceof </span><span class="s2">SchemaObject</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">);</span>
      <span class="s2">root </span><span class="s0">= </span><span class="s2">refVal</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">refVal </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">id</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">refVal </span><span class="s1">instanceof </span><span class="s2">SchemaObject</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">refVal</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">id </span><span class="s0">== </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">))</span>
          <span class="s1">return </span><span class="s0">{ </span><span class="s2">schema</span><span class="s0">: </span><span class="s2">refVal</span><span class="s0">, </span><span class="s2">root</span><span class="s0">: </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">: </span><span class="s2">baseId </span><span class="s0">};</span>
        <span class="s2">root </span><span class="s0">= </span><span class="s2">refVal</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
    <span class="s2">baseId </span><span class="s0">= </span><span class="s2">getFullPath</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">));</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">getJsonPointer</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">p</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s2">resolveRecursive</span><span class="s0">(</span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">, </span><span class="s2">parsedRef</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">res </span><span class="s0">= </span><span class="s2">resolveSchema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">res</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">schema </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
    <span class="s2">root </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">id</span><span class="s0">) </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">resolveUrl</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">id</span><span class="s0">);</span>
    <span class="s1">return </span><span class="s2">getJsonPointer</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">parsedRef</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">PREVENT_SCOPE_CHANGE </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">toHash</span><span class="s0">([</span><span class="s3">'properties'</span><span class="s0">, </span><span class="s3">'patternProperties'</span><span class="s0">, </span><span class="s3">'enum'</span><span class="s0">, </span><span class="s3">'dependencies'</span><span class="s0">, </span><span class="s3">'definitions'</span><span class="s0">]);</span>
<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s2">getJsonPointer</span><span class="s0">(</span><span class="s2">parsedRef</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s2">parsedRef</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">parsedRef</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">parsedRef</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">) != </span><span class="s3">'/'</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">parts </span><span class="s0">= </span><span class="s2">parsedRef</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'/'</span><span class="s0">);</span>

  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">1</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">parts</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s1">var </span><span class="s2">part </span><span class="s0">= </span><span class="s2">parts</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">part</span><span class="s0">) {</span>
      <span class="s2">part </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">unescapeFragment</span><span class="s0">(</span><span class="s2">part</span><span class="s0">);</span>
      <span class="s2">schema </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">part</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">schema </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s1">break</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">id</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">PREVENT_SCOPE_CHANGE</span><span class="s0">[</span><span class="s2">part</span><span class="s0">]) {</span>
        <span class="s2">id </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">id</span><span class="s0">) </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">resolveUrl</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">id</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$ref</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$ref </span><span class="s0">= </span><span class="s2">resolveUrl</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$ref</span><span class="s0">);</span>
          <span class="s1">var </span><span class="s2">res </span><span class="s0">= </span><span class="s2">resolveSchema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">$ref</span><span class="s0">);</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">res</span><span class="s0">) {</span>
            <span class="s2">schema </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
            <span class="s2">root </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span>
            <span class="s2">baseId </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">schema </span><span class="s0">!== </span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)</span>
    <span class="s1">return </span><span class="s0">{ </span><span class="s2">schema</span><span class="s0">: </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">: </span><span class="s2">root</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">: </span><span class="s2">baseId </span><span class="s0">};</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">SIMPLE_INLINED </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">toHash</span><span class="s0">([</span>
  <span class="s3">'type'</span><span class="s0">, </span><span class="s3">'format'</span><span class="s0">, </span><span class="s3">'pattern'</span><span class="s0">,</span>
  <span class="s3">'maxLength'</span><span class="s0">, </span><span class="s3">'minLength'</span><span class="s0">,</span>
  <span class="s3">'maxProperties'</span><span class="s0">, </span><span class="s3">'minProperties'</span><span class="s0">,</span>
  <span class="s3">'maxItems'</span><span class="s0">, </span><span class="s3">'minItems'</span><span class="s0">,</span>
  <span class="s3">'maximum'</span><span class="s0">, </span><span class="s3">'minimum'</span><span class="s0">,</span>
  <span class="s3">'uniqueItems'</span><span class="s0">, </span><span class="s3">'multipleOf'</span><span class="s0">,</span>
  <span class="s3">'required'</span><span class="s0">, </span><span class="s3">'enum'</span>
<span class="s0">]);</span>
<span class="s1">function </span><span class="s2">inlineRef</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">limit</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">limit </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">limit </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s2">limit </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">) </span><span class="s1">return </span><span class="s2">checkNoRef</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">);</span>
  <span class="s1">else if </span><span class="s0">(</span><span class="s2">limit</span><span class="s0">) </span><span class="s1">return </span><span class="s2">countKeys</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) &lt;= </span><span class="s2">limit</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">checkNoRef</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">item</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
      <span class="s2">item </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">item </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; !</span><span class="s2">checkNoRef</span><span class="s0">(</span><span class="s2">item</span><span class="s0">)) </span><span class="s1">return false</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">key </span><span class="s0">== </span><span class="s3">'$ref'</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>
      <span class="s2">item </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">item </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; !</span><span class="s2">checkNoRef</span><span class="s0">(</span><span class="s2">item</span><span class="s0">)) </span><span class="s1">return false</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return true</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">countKeys</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">count </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">item</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
      <span class="s2">item </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">item </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) </span><span class="s2">count </span><span class="s0">+= </span><span class="s2">countKeys</span><span class="s0">(</span><span class="s2">item</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">count </span><span class="s0">== </span><span class="s2">Infinity</span><span class="s0">) </span><span class="s1">return </span><span class="s2">Infinity</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">key </span><span class="s0">== </span><span class="s3">'$ref'</span><span class="s0">) </span><span class="s1">return </span><span class="s2">Infinity</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">SIMPLE_INLINED</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]) {</span>
        <span class="s2">count</span><span class="s0">++;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">item </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">item </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) </span><span class="s2">count </span><span class="s0">+= </span><span class="s2">countKeys</span><span class="s0">(</span><span class="s2">item</span><span class="s0">) + </span><span class="s4">1</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">count </span><span class="s0">== </span><span class="s2">Infinity</span><span class="s0">) </span><span class="s1">return </span><span class="s2">Infinity</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">count</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">getFullPath</span><span class="s0">(</span><span class="s2">id</span><span class="s0">, </span><span class="s2">normalize</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">normalize </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) </span><span class="s2">id </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">id</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">p </span><span class="s0">= </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">id</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">_getFullPath</span><span class="s0">(</span><span class="s2">p</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">_getFullPath</span><span class="s0">(</span><span class="s2">p</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">p</span><span class="s0">).</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'#'</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">] + </span><span class="s3">'#'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">TRAILING_SLASH_HASH </span><span class="s0">= </span><span class="s8">/#\/?$/</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">id</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">id </span><span class="s0">? </span><span class="s2">id</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">TRAILING_SLASH_HASH</span><span class="s0">, </span><span class="s3">''</span><span class="s0">) : </span><span class="s3">''</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">resolveUrl</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">id</span><span class="s0">) {</span>
  <span class="s2">id </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">id</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">id</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s7">/* @this Ajv */</span>
<span class="s1">function </span><span class="s2">resolveIds</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">schemaId </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">));</span>
  <span class="s1">var </span><span class="s2">baseIds </span><span class="s0">= {</span><span class="s3">''</span><span class="s0">: </span><span class="s2">schemaId</span><span class="s0">};</span>
  <span class="s1">var </span><span class="s2">fullPaths </span><span class="s0">= {</span><span class="s3">''</span><span class="s0">: </span><span class="s2">getFullPath</span><span class="s0">(</span><span class="s2">schemaId</span><span class="s0">, </span><span class="s1">false</span><span class="s0">)};</span>
  <span class="s1">var </span><span class="s2">localRefs </span><span class="s0">= {};</span>
  <span class="s1">var </span><span class="s2">self </span><span class="s0">= </span><span class="s1">this</span><span class="s0">;</span>

  <span class="s2">traverse</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, {</span><span class="s2">allKeys</span><span class="s0">: </span><span class="s1">true</span><span class="s0">}, </span><span class="s1">function</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">parentJsonPtr</span><span class="s0">, </span><span class="s2">parentKeyword</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">keyIndex</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">jsonPtr </span><span class="s0">=== </span><span class="s3">''</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">baseIds</span><span class="s0">[</span><span class="s2">parentJsonPtr</span><span class="s0">];</span>
    <span class="s1">var </span><span class="s2">fullPath </span><span class="s0">= </span><span class="s2">fullPaths</span><span class="s0">[</span><span class="s2">parentJsonPtr</span><span class="s0">] + </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">parentKeyword</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">keyIndex </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">)</span>
      <span class="s2">fullPath </span><span class="s0">+= </span><span class="s3">'/' </span><span class="s0">+ (</span><span class="s1">typeof </span><span class="s2">keyIndex </span><span class="s0">== </span><span class="s3">'number' </span><span class="s0">? </span><span class="s2">keyIndex </span><span class="s0">: </span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeFragment</span><span class="s0">(</span><span class="s2">keyIndex</span><span class="s0">));</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">id </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) {</span>
      <span class="s2">id </span><span class="s0">= </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">baseId </span><span class="s0">? </span><span class="s2">URI</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">id</span><span class="s0">) : </span><span class="s2">id</span><span class="s0">);</span>

      <span class="s1">var </span><span class="s2">refVal </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">refVal </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) </span><span class="s2">refVal </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">refVal</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">refVal </span><span class="s0">&amp;&amp; </span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">equal</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">, </span><span class="s2">refVal</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">))</span>
          <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'id &quot;' </span><span class="s0">+ </span><span class="s2">id </span><span class="s0">+ </span><span class="s3">'&quot; resolves to more than one schema'</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">id </span><span class="s0">!= </span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">fullPath</span><span class="s0">)) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">id</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] == </span><span class="s3">'#'</span><span class="s0">) {</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">localRefs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">] &amp;&amp; !</span><span class="s2">equal</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">, </span><span class="s2">localRefs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">]))</span>
            <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'id &quot;' </span><span class="s0">+ </span><span class="s2">id </span><span class="s0">+ </span><span class="s3">'&quot; resolves to more than one schema'</span><span class="s0">);</span>
          <span class="s2">localRefs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">] = </span><span class="s2">sch</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">] = </span><span class="s2">fullPath</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">baseIds</span><span class="s0">[</span><span class="s2">jsonPtr</span><span class="s0">] = </span><span class="s2">baseId</span><span class="s0">;</span>
    <span class="s2">fullPaths</span><span class="s0">[</span><span class="s2">jsonPtr</span><span class="s0">] = </span><span class="s2">fullPath</span><span class="s0">;</span>
  <span class="s0">});</span>

  <span class="s1">return </span><span class="s2">localRefs</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./schema_obj&quot;</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s3">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">,</span><span class="s3">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s0">,</span><span class="s3">&quot;json-schema-traverse&quot;</span><span class="s0">:</span><span class="s4">44</span><span class="s0">,</span><span class="s3">&quot;uri-js&quot;</span><span class="s0">:</span><span class="s4">45</span><span class="s0">}],</span><span class="s4">7</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">ruleModules </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'../dotjs'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">toHash </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./util'</span><span class="s0">).</span><span class="s2">toHash</span><span class="s0">;</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">rules</span><span class="s0">() {</span>
  <span class="s1">var </span><span class="s2">RULES </span><span class="s0">= [</span>
    <span class="s0">{ </span><span class="s2">type</span><span class="s0">: </span><span class="s3">'number'</span><span class="s0">,</span>
      <span class="s2">rules</span><span class="s0">: [ { </span><span class="s3">'maximum'</span><span class="s0">: [</span><span class="s3">'exclusiveMaximum'</span><span class="s0">] },</span>
               <span class="s0">{ </span><span class="s3">'minimum'</span><span class="s0">: [</span><span class="s3">'exclusiveMinimum'</span><span class="s0">] }, </span><span class="s3">'multipleOf'</span><span class="s0">, </span><span class="s3">'format'</span><span class="s0">] },</span>
    <span class="s0">{ </span><span class="s2">type</span><span class="s0">: </span><span class="s3">'string'</span><span class="s0">,</span>
      <span class="s2">rules</span><span class="s0">: [ </span><span class="s3">'maxLength'</span><span class="s0">, </span><span class="s3">'minLength'</span><span class="s0">, </span><span class="s3">'pattern'</span><span class="s0">, </span><span class="s3">'format' </span><span class="s0">] },</span>
    <span class="s0">{ </span><span class="s2">type</span><span class="s0">: </span><span class="s3">'array'</span><span class="s0">,</span>
      <span class="s2">rules</span><span class="s0">: [ </span><span class="s3">'maxItems'</span><span class="s0">, </span><span class="s3">'minItems'</span><span class="s0">, </span><span class="s3">'items'</span><span class="s0">, </span><span class="s3">'contains'</span><span class="s0">, </span><span class="s3">'uniqueItems' </span><span class="s0">] },</span>
    <span class="s0">{ </span><span class="s2">type</span><span class="s0">: </span><span class="s3">'object'</span><span class="s0">,</span>
      <span class="s2">rules</span><span class="s0">: [ </span><span class="s3">'maxProperties'</span><span class="s0">, </span><span class="s3">'minProperties'</span><span class="s0">, </span><span class="s3">'required'</span><span class="s0">, </span><span class="s3">'dependencies'</span><span class="s0">, </span><span class="s3">'propertyNames'</span><span class="s0">,</span>
               <span class="s0">{ </span><span class="s3">'properties'</span><span class="s0">: [</span><span class="s3">'additionalProperties'</span><span class="s0">, </span><span class="s3">'patternProperties'</span><span class="s0">] } ] },</span>
    <span class="s0">{ </span><span class="s2">rules</span><span class="s0">: [ </span><span class="s3">'$ref'</span><span class="s0">, </span><span class="s3">'const'</span><span class="s0">, </span><span class="s3">'enum'</span><span class="s0">, </span><span class="s3">'not'</span><span class="s0">, </span><span class="s3">'anyOf'</span><span class="s0">, </span><span class="s3">'oneOf'</span><span class="s0">, </span><span class="s3">'allOf'</span><span class="s0">, </span><span class="s3">'if' </span><span class="s0">] }</span>
  <span class="s0">];</span>

  <span class="s1">var </span><span class="s2">ALL </span><span class="s0">= [ </span><span class="s3">'type'</span><span class="s0">, </span><span class="s3">'$comment' </span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">KEYWORDS </span><span class="s0">= [</span>
    <span class="s3">'$schema'</span><span class="s0">, </span><span class="s3">'$id'</span><span class="s0">, </span><span class="s3">'id'</span><span class="s0">, </span><span class="s3">'$data'</span><span class="s0">, </span><span class="s3">'$async'</span><span class="s0">, </span><span class="s3">'title'</span><span class="s0">,</span>
    <span class="s3">'description'</span><span class="s0">, </span><span class="s3">'default'</span><span class="s0">, </span><span class="s3">'definitions'</span><span class="s0">,</span>
    <span class="s3">'examples'</span><span class="s0">, </span><span class="s3">'readOnly'</span><span class="s0">, </span><span class="s3">'writeOnly'</span><span class="s0">,</span>
    <span class="s3">'contentMediaType'</span><span class="s0">, </span><span class="s3">'contentEncoding'</span><span class="s0">,</span>
    <span class="s3">'additionalItems'</span><span class="s0">, </span><span class="s3">'then'</span><span class="s0">, </span><span class="s3">'else'</span>
  <span class="s0">];</span>
  <span class="s1">var </span><span class="s2">TYPES </span><span class="s0">= [ </span><span class="s3">'number'</span><span class="s0">, </span><span class="s3">'integer'</span><span class="s0">, </span><span class="s3">'string'</span><span class="s0">, </span><span class="s3">'array'</span><span class="s0">, </span><span class="s3">'object'</span><span class="s0">, </span><span class="s3">'boolean'</span><span class="s0">, </span><span class="s3">'null' </span><span class="s0">];</span>
  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">all </span><span class="s0">= </span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">ALL</span><span class="s0">);</span>
  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">types </span><span class="s0">= </span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">TYPES</span><span class="s0">);</span>

  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">group</span><span class="s0">) {</span>
    <span class="s2">group</span><span class="s0">.</span><span class="s2">rules </span><span class="s0">= </span><span class="s2">group</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">.</span><span class="s2">map</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">implKeywords</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">keyword </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">key </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span>
        <span class="s2">implKeywords </span><span class="s0">= </span><span class="s2">keyword</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
        <span class="s2">keyword </span><span class="s0">= </span><span class="s2">key</span><span class="s0">;</span>
        <span class="s2">implKeywords</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">k</span><span class="s0">) {</span>
          <span class="s2">ALL</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">k</span><span class="s0">);</span>
          <span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">[</span><span class="s2">k</span><span class="s0">] = </span><span class="s1">true</span><span class="s0">;</span>
        <span class="s0">});</span>
      <span class="s0">}</span>
      <span class="s2">ALL</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">);</span>
      <span class="s1">var </span><span class="s2">rule </span><span class="s0">= </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">] = {</span>
        <span class="s2">keyword</span><span class="s0">: </span><span class="s2">keyword</span><span class="s0">,</span>
        <span class="s2">code</span><span class="s0">: </span><span class="s2">ruleModules</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">],</span>
        <span class="s1">implements</span><span class="s0">: </span><span class="s2">implKeywords</span>
      <span class="s0">};</span>
      <span class="s1">return </span><span class="s2">rule</span><span class="s0">;</span>
    <span class="s0">});</span>

    <span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">.</span><span class="s2">$comment </span><span class="s0">= {</span>
      <span class="s2">keyword</span><span class="s0">: </span><span class="s3">'$comment'</span><span class="s0">,</span>
      <span class="s2">code</span><span class="s0">: </span><span class="s2">ruleModules</span><span class="s0">.</span><span class="s2">$comment</span>
    <span class="s0">};</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">group</span><span class="s0">.</span><span class="s2">type</span><span class="s0">) </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">types</span><span class="s0">[</span><span class="s2">group</span><span class="s0">.</span><span class="s2">type</span><span class="s0">] = </span><span class="s2">group</span><span class="s0">;</span>
  <span class="s0">});</span>

  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords </span><span class="s0">= </span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">ALL</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">KEYWORDS</span><span class="s0">));</span>
  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">custom </span><span class="s0">= {};</span>

  <span class="s1">return </span><span class="s2">RULES</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s0">},{</span><span class="s3">&quot;../dotjs&quot;</span><span class="s0">:</span><span class="s4">27</span><span class="s0">,</span><span class="s3">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}],</span><span class="s4">8</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">util </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./util'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">SchemaObject</span><span class="s0">;</span>

<span class="s1">function </span><span class="s2">SchemaObject</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">) {</span>
  <span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">, </span><span class="s1">this</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">}],</span><span class="s4">9</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s7">// https://mathiasbynens.be/notes/javascript-encoding</span>
<span class="s7">// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">ucs2length</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">length </span><span class="s0">= </span><span class="s4">0</span>
    <span class="s0">, </span><span class="s2">len </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">length</span>
    <span class="s0">, </span><span class="s2">pos </span><span class="s0">= </span><span class="s4">0</span>
    <span class="s0">, </span><span class="s2">value</span><span class="s0">;</span>
  <span class="s1">while </span><span class="s0">(</span><span class="s2">pos </span><span class="s0">&lt; </span><span class="s2">len</span><span class="s0">) {</span>
    <span class="s2">length</span><span class="s0">++;</span>
    <span class="s2">value </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">pos</span><span class="s0">++);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">value </span><span class="s0">&gt;= </span><span class="s4">0xD800 </span><span class="s0">&amp;&amp; </span><span class="s2">value </span><span class="s0">&lt;= </span><span class="s4">0xDBFF </span><span class="s0">&amp;&amp; </span><span class="s2">pos </span><span class="s0">&lt; </span><span class="s2">len</span><span class="s0">) {</span>
      <span class="s7">// high surrogate, and there is a next character</span>
      <span class="s2">value </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">pos</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">((</span><span class="s2">value </span><span class="s0">&amp; </span><span class="s4">0xFC00</span><span class="s0">) == </span><span class="s4">0xDC00</span><span class="s0">) </span><span class="s2">pos</span><span class="s0">++; </span><span class="s7">// low surrogate</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">length</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s0">},{}],</span><span class="s4">10</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>


<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= {</span>
  <span class="s2">copy</span><span class="s0">: </span><span class="s2">copy</span><span class="s0">,</span>
  <span class="s2">checkDataType</span><span class="s0">: </span><span class="s2">checkDataType</span><span class="s0">,</span>
  <span class="s2">checkDataTypes</span><span class="s0">: </span><span class="s2">checkDataTypes</span><span class="s0">,</span>
  <span class="s2">coerceToTypes</span><span class="s0">: </span><span class="s2">coerceToTypes</span><span class="s0">,</span>
  <span class="s2">toHash</span><span class="s0">: </span><span class="s2">toHash</span><span class="s0">,</span>
  <span class="s2">getProperty</span><span class="s0">: </span><span class="s2">getProperty</span><span class="s0">,</span>
  <span class="s2">escapeQuotes</span><span class="s0">: </span><span class="s2">escapeQuotes</span><span class="s0">,</span>
  <span class="s2">equal</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'fast-deep-equal'</span><span class="s0">),</span>
  <span class="s2">ucs2length</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./ucs2length'</span><span class="s0">),</span>
  <span class="s2">varOccurences</span><span class="s0">: </span><span class="s2">varOccurences</span><span class="s0">,</span>
  <span class="s2">varReplace</span><span class="s0">: </span><span class="s2">varReplace</span><span class="s0">,</span>
  <span class="s2">schemaHasRules</span><span class="s0">: </span><span class="s2">schemaHasRules</span><span class="s0">,</span>
  <span class="s2">schemaHasRulesExcept</span><span class="s0">: </span><span class="s2">schemaHasRulesExcept</span><span class="s0">,</span>
  <span class="s2">schemaUnknownRules</span><span class="s0">: </span><span class="s2">schemaUnknownRules</span><span class="s0">,</span>
  <span class="s2">toQuotedString</span><span class="s0">: </span><span class="s2">toQuotedString</span><span class="s0">,</span>
  <span class="s2">getPathExpr</span><span class="s0">: </span><span class="s2">getPathExpr</span><span class="s0">,</span>
  <span class="s2">getPath</span><span class="s0">: </span><span class="s2">getPath</span><span class="s0">,</span>
  <span class="s2">getData</span><span class="s0">: </span><span class="s2">getData</span><span class="s0">,</span>
  <span class="s2">unescapeFragment</span><span class="s0">: </span><span class="s2">unescapeFragment</span><span class="s0">,</span>
  <span class="s2">unescapeJsonPointer</span><span class="s0">: </span><span class="s2">unescapeJsonPointer</span><span class="s0">,</span>
  <span class="s2">escapeFragment</span><span class="s0">: </span><span class="s2">escapeFragment</span><span class="s0">,</span>
  <span class="s2">escapeJsonPointer</span><span class="s0">: </span><span class="s2">escapeJsonPointer</span>
<span class="s0">};</span>


<span class="s1">function </span><span class="s2">copy</span><span class="s0">(</span><span class="s2">o</span><span class="s0">, </span><span class="s2">to</span><span class="s0">) {</span>
  <span class="s2">to </span><span class="s0">= </span><span class="s2">to </span><span class="s0">|| {};</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">o</span><span class="s0">) </span><span class="s2">to</span><span class="s0">[</span><span class="s2">key</span><span class="s0">] = </span><span class="s2">o</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
  <span class="s1">return </span><span class="s2">to</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">checkDataType</span><span class="s0">(</span><span class="s2">dataType</span><span class="s0">, </span><span class="s2">data</span><span class="s0">, </span><span class="s2">strictNumbers</span><span class="s0">, </span><span class="s2">negate</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">EQUAL </span><span class="s0">= </span><span class="s2">negate </span><span class="s0">? </span><span class="s3">' !== ' </span><span class="s0">: </span><span class="s3">' === '</span>
    <span class="s0">, </span><span class="s2">AND </span><span class="s0">= </span><span class="s2">negate </span><span class="s0">? </span><span class="s3">' || ' </span><span class="s0">: </span><span class="s3">' &amp;&amp; '</span>
    <span class="s0">, </span><span class="s2">OK </span><span class="s0">= </span><span class="s2">negate </span><span class="s0">? </span><span class="s3">'!' </span><span class="s0">: </span><span class="s3">''</span>
    <span class="s0">, </span><span class="s2">NOT </span><span class="s0">= </span><span class="s2">negate </span><span class="s0">? </span><span class="s3">'' </span><span class="s0">: </span><span class="s3">'!'</span><span class="s0">;</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s2">dataType</span><span class="s0">) {</span>
    <span class="s1">case </span><span class="s3">'null'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s3">'null'</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'array'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">OK </span><span class="s0">+ </span><span class="s3">'Array.isArray(' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">')'</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'object'</span><span class="s0">: </span><span class="s1">return </span><span class="s3">'(' </span><span class="s0">+ </span><span class="s2">OK </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">AND </span><span class="s0">+</span>
                          <span class="s3">'typeof ' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s3">'&quot;object&quot;' </span><span class="s0">+ </span><span class="s2">AND </span><span class="s0">+</span>
                          <span class="s2">NOT </span><span class="s0">+ </span><span class="s3">'Array.isArray(' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">'))'</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'integer'</span><span class="s0">: </span><span class="s1">return </span><span class="s3">'(typeof ' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s3">'&quot;number&quot;' </span><span class="s0">+ </span><span class="s2">AND </span><span class="s0">+</span>
                           <span class="s2">NOT </span><span class="s0">+ </span><span class="s3">'(' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">' % 1)' </span><span class="s0">+</span>
                           <span class="s2">AND </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+</span>
                           <span class="s0">(</span><span class="s2">strictNumbers </span><span class="s0">? (</span><span class="s2">AND </span><span class="s0">+ </span><span class="s2">OK </span><span class="s0">+ </span><span class="s3">'isFinite(' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">')'</span><span class="s0">) : </span><span class="s3">''</span><span class="s0">) + </span><span class="s3">')'</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'number'</span><span class="s0">: </span><span class="s1">return </span><span class="s3">'(typeof ' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s3">'&quot;' </span><span class="s0">+ </span><span class="s2">dataType </span><span class="s0">+ </span><span class="s3">'&quot;' </span><span class="s0">+</span>
                          <span class="s0">(</span><span class="s2">strictNumbers </span><span class="s0">? (</span><span class="s2">AND </span><span class="s0">+ </span><span class="s2">OK </span><span class="s0">+ </span><span class="s3">'isFinite(' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">')'</span><span class="s0">) : </span><span class="s3">''</span><span class="s0">) + </span><span class="s3">')'</span><span class="s0">;</span>
    <span class="s1">default</span><span class="s0">: </span><span class="s1">return </span><span class="s3">'typeof ' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s2">EQUAL </span><span class="s0">+ </span><span class="s3">'&quot;' </span><span class="s0">+ </span><span class="s2">dataType </span><span class="s0">+ </span><span class="s3">'&quot;'</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">checkDataTypes</span><span class="s0">(</span><span class="s2">dataTypes</span><span class="s0">, </span><span class="s2">data</span><span class="s0">, </span><span class="s2">strictNumbers</span><span class="s0">) {</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s2">dataTypes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
    <span class="s1">case </span><span class="s4">1</span><span class="s0">: </span><span class="s1">return </span><span class="s2">checkDataType</span><span class="s0">(</span><span class="s2">dataTypes</span><span class="s0">[</span><span class="s4">0</span><span class="s0">], </span><span class="s2">data</span><span class="s0">, </span><span class="s2">strictNumbers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
    <span class="s1">default</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s2">code </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">types </span><span class="s0">= </span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">dataTypes</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">types</span><span class="s0">.</span><span class="s2">array </span><span class="s0">&amp;&amp; </span><span class="s2">types</span><span class="s0">.</span><span class="s2">object</span><span class="s0">) {</span>
        <span class="s2">code </span><span class="s0">= </span><span class="s2">types</span><span class="s0">.</span><span class="s2">null </span><span class="s0">? </span><span class="s3">'('</span><span class="s0">: </span><span class="s3">'(!' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">' || '</span><span class="s0">;</span>
        <span class="s2">code </span><span class="s0">+= </span><span class="s3">'typeof ' </span><span class="s0">+ </span><span class="s2">data </span><span class="s0">+ </span><span class="s3">' !== &quot;object&quot;)'</span><span class="s0">;</span>
        <span class="s1">delete </span><span class="s2">types</span><span class="s0">.</span><span class="s2">null</span><span class="s0">;</span>
        <span class="s1">delete </span><span class="s2">types</span><span class="s0">.</span><span class="s2">array</span><span class="s0">;</span>
        <span class="s1">delete </span><span class="s2">types</span><span class="s0">.</span><span class="s2">object</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">types</span><span class="s0">.</span><span class="s2">number</span><span class="s0">) </span><span class="s1">delete </span><span class="s2">types</span><span class="s0">.</span><span class="s2">integer</span><span class="s0">;</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">t </span><span class="s1">in </span><span class="s2">types</span><span class="s0">)</span>
        <span class="s2">code </span><span class="s0">+= (</span><span class="s2">code </span><span class="s0">? </span><span class="s3">' &amp;&amp; ' </span><span class="s0">: </span><span class="s3">'' </span><span class="s0">) + </span><span class="s2">checkDataType</span><span class="s0">(</span><span class="s2">t</span><span class="s0">, </span><span class="s2">data</span><span class="s0">, </span><span class="s2">strictNumbers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>

      <span class="s1">return </span><span class="s2">code</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">COERCE_TO_TYPES </span><span class="s0">= </span><span class="s2">toHash</span><span class="s0">([ </span><span class="s3">'string'</span><span class="s0">, </span><span class="s3">'number'</span><span class="s0">, </span><span class="s3">'integer'</span><span class="s0">, </span><span class="s3">'boolean'</span><span class="s0">, </span><span class="s3">'null' </span><span class="s0">]);</span>
<span class="s1">function </span><span class="s2">coerceToTypes</span><span class="s0">(</span><span class="s2">optionCoerceTypes</span><span class="s0">, </span><span class="s2">dataTypes</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">dataTypes</span><span class="s0">)) {</span>
    <span class="s1">var </span><span class="s2">types </span><span class="s0">= [];</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">dataTypes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
      <span class="s1">var </span><span class="s2">t </span><span class="s0">= </span><span class="s2">dataTypes</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">COERCE_TO_TYPES</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]) </span><span class="s2">types</span><span class="s0">[</span><span class="s2">types</span><span class="s0">.</span><span class="s2">length</span><span class="s0">] = </span><span class="s2">t</span><span class="s0">;</span>
      <span class="s1">else if </span><span class="s0">(</span><span class="s2">optionCoerceTypes </span><span class="s0">=== </span><span class="s3">'array' </span><span class="s0">&amp;&amp; </span><span class="s2">t </span><span class="s0">=== </span><span class="s3">'array'</span><span class="s0">) </span><span class="s2">types</span><span class="s0">[</span><span class="s2">types</span><span class="s0">.</span><span class="s2">length</span><span class="s0">] = </span><span class="s2">t</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">types</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) </span><span class="s1">return </span><span class="s2">types</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">COERCE_TO_TYPES</span><span class="s0">[</span><span class="s2">dataTypes</span><span class="s0">]) {</span>
    <span class="s1">return </span><span class="s0">[</span><span class="s2">dataTypes</span><span class="s0">];</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">optionCoerceTypes </span><span class="s0">=== </span><span class="s3">'array' </span><span class="s0">&amp;&amp; </span><span class="s2">dataTypes </span><span class="s0">=== </span><span class="s3">'array'</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s0">[</span><span class="s3">'array'</span><span class="s0">];</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">hash </span><span class="s0">= {};</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) </span><span class="s2">hash</span><span class="s0">[</span><span class="s2">arr</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]] = </span><span class="s1">true</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">hash</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">IDENTIFIER </span><span class="s0">= </span><span class="s8">/^[a-z$_][a-z$_0-9]*$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">SINGLE_QUOTE </span><span class="s0">= </span><span class="s8">/'|\\/g</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
  <span class="s1">return typeof </span><span class="s2">key </span><span class="s0">== </span><span class="s3">'number'</span>
          <span class="s0">? </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">key </span><span class="s0">+ </span><span class="s3">']'</span>
          <span class="s0">: </span><span class="s2">IDENTIFIER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">key</span><span class="s0">)</span>
            <span class="s0">? </span><span class="s3">'.' </span><span class="s0">+ </span><span class="s2">key</span>
            <span class="s0">: </span><span class="s3">&quot;['&quot; </span><span class="s0">+ </span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">key</span><span class="s0">) + </span><span class="s3">&quot;']&quot;</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">SINGLE_QUOTE</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\\</span><span class="s3">$&amp;'</span><span class="s0">)</span>
            <span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\n/g</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\\</span><span class="s3">n'</span><span class="s0">)</span>
            <span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\r/g</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\\</span><span class="s3">r'</span><span class="s0">)</span>
            <span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\f/g</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\\</span><span class="s3">f'</span><span class="s0">)</span>
            <span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\t/g</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\\</span><span class="s3">t'</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">str</span><span class="s0">, </span><span class="s2">dataVar</span><span class="s0">) {</span>
  <span class="s2">dataVar </span><span class="s0">+= </span><span class="s3">'[^0-9]'</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">dataVar</span><span class="s0">, </span><span class="s3">'g'</span><span class="s0">));</span>
  <span class="s1">return </span><span class="s2">matches </span><span class="s0">? </span><span class="s2">matches</span><span class="s0">.</span><span class="s2">length </span><span class="s0">: </span><span class="s4">0</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">str</span><span class="s0">, </span><span class="s2">dataVar</span><span class="s0">, </span><span class="s2">expr</span><span class="s0">) {</span>
  <span class="s2">dataVar </span><span class="s0">+= </span><span class="s3">'([^0-9])'</span><span class="s0">;</span>
  <span class="s2">expr </span><span class="s0">= </span><span class="s2">expr</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\$/g</span><span class="s0">, </span><span class="s3">'$$$$'</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">dataVar</span><span class="s0">, </span><span class="s3">'g'</span><span class="s0">), </span><span class="s2">expr </span><span class="s0">+ </span><span class="s3">'$1'</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">rules</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">== </span><span class="s3">'boolean'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">!</span><span class="s2">schema</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) </span><span class="s1">if </span><span class="s0">(</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]) </span><span class="s1">return true</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">schemaHasRulesExcept</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">rules</span><span class="s0">, </span><span class="s2">exceptKeyword</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">== </span><span class="s3">'boolean'</span><span class="s0">) </span><span class="s1">return </span><span class="s0">!</span><span class="s2">schema </span><span class="s0">&amp;&amp; </span><span class="s2">exceptKeyword </span><span class="s0">!= </span><span class="s3">'not'</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) </span><span class="s1">if </span><span class="s0">(</span><span class="s2">key </span><span class="s0">!= </span><span class="s2">exceptKeyword </span><span class="s0">&amp;&amp; </span><span class="s2">rules</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]) </span><span class="s1">return true</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">schemaUnknownRules</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">rules</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">== </span><span class="s3">'boolean'</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) </span><span class="s1">if </span><span class="s0">(!</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]) </span><span class="s1">return </span><span class="s2">key</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ </span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">currentPath</span><span class="s0">, </span><span class="s2">expr</span><span class="s0">, </span><span class="s2">jsonPointers</span><span class="s0">, </span><span class="s2">isNumber</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">path </span><span class="s0">= </span><span class="s2">jsonPointers </span><span class="s7">// false by default</span>
              <span class="s0">? </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">/</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">expr </span><span class="s0">+ (</span><span class="s2">isNumber </span><span class="s0">? </span><span class="s3">'' </span><span class="s0">: </span><span class="s3">'.replace(/~/g, </span><span class="s1">\'</span><span class="s3">~0</span><span class="s1">\'</span><span class="s3">).replace(/</span><span class="s1">\\</span><span class="s3">//g, </span><span class="s1">\'</span><span class="s3">~1</span><span class="s1">\'</span><span class="s3">)'</span><span class="s0">)</span>
              <span class="s0">: (</span><span class="s2">isNumber </span><span class="s0">? </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">[</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">expr </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">]</span><span class="s1">\'</span><span class="s3">' </span><span class="s0">: </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">[</span><span class="s1">\\\'\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">expr </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'\\\'</span><span class="s3">]</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">joinPaths</span><span class="s0">(</span><span class="s2">currentPath</span><span class="s0">, </span><span class="s2">path</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">getPath</span><span class="s0">(</span><span class="s2">currentPath</span><span class="s0">, </span><span class="s2">prop</span><span class="s0">, </span><span class="s2">jsonPointers</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">path </span><span class="s0">= </span><span class="s2">jsonPointers </span><span class="s7">// false by default</span>
              <span class="s0">? </span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">escapeJsonPointer</span><span class="s0">(</span><span class="s2">prop</span><span class="s0">))</span>
              <span class="s0">: </span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">prop</span><span class="s0">));</span>
  <span class="s1">return </span><span class="s2">joinPaths</span><span class="s0">(</span><span class="s2">currentPath</span><span class="s0">, </span><span class="s2">path</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">var </span><span class="s2">JSON_POINTER </span><span class="s0">= </span><span class="s8">/^\/(?:[^~]|~0|~1)*$/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">RELATIVE_JSON_POINTER </span><span class="s0">= </span><span class="s8">/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">lvl</span><span class="s0">, </span><span class="s2">paths</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">up</span><span class="s0">, </span><span class="s2">jsonPointer</span><span class="s0">, </span><span class="s2">data</span><span class="s0">, </span><span class="s2">matches</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$data </span><span class="s0">=== </span><span class="s3">''</span><span class="s0">) </span><span class="s1">return </span><span class="s3">'rootData'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] == </span><span class="s3">'/'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">JSON_POINTER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">$data</span><span class="s0">)) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid JSON-pointer: ' </span><span class="s0">+ </span><span class="s2">$data</span><span class="s0">);</span>
    <span class="s2">jsonPointer </span><span class="s0">= </span><span class="s2">$data</span><span class="s0">;</span>
    <span class="s2">data </span><span class="s0">= </span><span class="s3">'rootData'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">matches </span><span class="s0">= </span><span class="s2">$data</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">RELATIVE_JSON_POINTER</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">matches</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid JSON-pointer: ' </span><span class="s0">+ </span><span class="s2">$data</span><span class="s0">);</span>
    <span class="s2">up </span><span class="s0">= +</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>
    <span class="s2">jsonPointer </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">jsonPointer </span><span class="s0">== </span><span class="s3">'#'</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">up </span><span class="s0">&gt;= </span><span class="s2">lvl</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Cannot access property/index ' </span><span class="s0">+ </span><span class="s2">up </span><span class="s0">+ </span><span class="s3">' levels up, current level is ' </span><span class="s0">+ </span><span class="s2">lvl</span><span class="s0">);</span>
      <span class="s1">return </span><span class="s2">paths</span><span class="s0">[</span><span class="s2">lvl </span><span class="s0">- </span><span class="s2">up</span><span class="s0">];</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">up </span><span class="s0">&gt; </span><span class="s2">lvl</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Cannot access data ' </span><span class="s0">+ </span><span class="s2">up </span><span class="s0">+ </span><span class="s3">' levels up, current level is ' </span><span class="s0">+ </span><span class="s2">lvl</span><span class="s0">);</span>
    <span class="s2">data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ ((</span><span class="s2">lvl </span><span class="s0">- </span><span class="s2">up</span><span class="s0">) || </span><span class="s3">''</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">jsonPointer</span><span class="s0">) </span><span class="s1">return </span><span class="s2">data</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s2">expr </span><span class="s0">= </span><span class="s2">data</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">segments </span><span class="s0">= </span><span class="s2">jsonPointer</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'/'</span><span class="s0">);</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">segments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s1">var </span><span class="s2">segment </span><span class="s0">= </span><span class="s2">segments</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">segment</span><span class="s0">) {</span>
      <span class="s2">data </span><span class="s0">+= </span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">unescapeJsonPointer</span><span class="s0">(</span><span class="s2">segment</span><span class="s0">));</span>
      <span class="s2">expr </span><span class="s0">+= </span><span class="s3">' &amp;&amp; ' </span><span class="s0">+ </span><span class="s2">data</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">expr</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">joinPaths </span><span class="s0">(</span><span class="s2">a</span><span class="s0">, </span><span class="s2">b</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">a </span><span class="s0">== </span><span class="s3">'&quot;&quot;'</span><span class="s0">) </span><span class="s1">return </span><span class="s2">b</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s0">(</span><span class="s2">a </span><span class="s0">+ </span><span class="s3">' + ' </span><span class="s0">+ </span><span class="s2">b</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/([^\\])' \+ '/g</span><span class="s0">, </span><span class="s3">'$1'</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">unescapeFragment</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">unescapeJsonPointer</span><span class="s0">(</span><span class="s2">decodeURIComponent</span><span class="s0">(</span><span class="s2">str</span><span class="s0">));</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">escapeFragment</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">encodeURIComponent</span><span class="s0">(</span><span class="s2">escapeJsonPointer</span><span class="s0">(</span><span class="s2">str</span><span class="s0">));</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">escapeJsonPointer</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/~/g</span><span class="s0">, </span><span class="s3">'~0'</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\//g</span><span class="s0">, </span><span class="s3">'~1'</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">unescapeJsonPointer</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/~1/g</span><span class="s0">, </span><span class="s3">'/'</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/~0/g</span><span class="s0">, </span><span class="s3">'~'</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./ucs2length&quot;</span><span class="s0">:</span><span class="s4">9</span><span class="s0">,</span><span class="s3">&quot;fast-deep-equal&quot;</span><span class="s0">:</span><span class="s4">42</span><span class="s0">}],</span><span class="s4">11</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">KEYWORDS </span><span class="s0">= [</span>
  <span class="s3">'multipleOf'</span><span class="s0">,</span>
  <span class="s3">'maximum'</span><span class="s0">,</span>
  <span class="s3">'exclusiveMaximum'</span><span class="s0">,</span>
  <span class="s3">'minimum'</span><span class="s0">,</span>
  <span class="s3">'exclusiveMinimum'</span><span class="s0">,</span>
  <span class="s3">'maxLength'</span><span class="s0">,</span>
  <span class="s3">'minLength'</span><span class="s0">,</span>
  <span class="s3">'pattern'</span><span class="s0">,</span>
  <span class="s3">'additionalItems'</span><span class="s0">,</span>
  <span class="s3">'maxItems'</span><span class="s0">,</span>
  <span class="s3">'minItems'</span><span class="s0">,</span>
  <span class="s3">'uniqueItems'</span><span class="s0">,</span>
  <span class="s3">'maxProperties'</span><span class="s0">,</span>
  <span class="s3">'minProperties'</span><span class="s0">,</span>
  <span class="s3">'required'</span><span class="s0">,</span>
  <span class="s3">'additionalProperties'</span><span class="s0">,</span>
  <span class="s3">'enum'</span><span class="s0">,</span>
  <span class="s3">'format'</span><span class="s0">,</span>
  <span class="s3">'const'</span>
<span class="s0">];</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">, </span><span class="s2">keywordsJsonPointers</span><span class="s0">) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">keywordsJsonPointers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s2">metaSchema </span><span class="s0">= </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">));</span>
    <span class="s1">var </span><span class="s2">segments </span><span class="s0">= </span><span class="s2">keywordsJsonPointers</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'/'</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">keywords </span><span class="s0">= </span><span class="s2">metaSchema</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">j</span><span class="s0">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s2">j</span><span class="s0">=</span><span class="s4">1</span><span class="s0">; </span><span class="s2">j</span><span class="s0">&lt;</span><span class="s2">segments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">j</span><span class="s0">++)</span>
      <span class="s2">keywords </span><span class="s0">= </span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">segments</span><span class="s0">[</span><span class="s2">j</span><span class="s0">]];</span>

    <span class="s1">for </span><span class="s0">(</span><span class="s2">j</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">j</span><span class="s0">&lt;</span><span class="s2">KEYWORDS</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">j</span><span class="s0">++) {</span>
      <span class="s1">var </span><span class="s2">key </span><span class="s0">= </span><span class="s2">KEYWORDS</span><span class="s0">[</span><span class="s2">j</span><span class="s0">];</span>
      <span class="s1">var </span><span class="s2">schema </span><span class="s0">= </span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
        <span class="s2">keywords</span><span class="s0">[</span><span class="s2">key</span><span class="s0">] = {</span>
          <span class="s2">anyOf</span><span class="s0">: [</span>
            <span class="s2">schema</span><span class="s0">,</span>
            <span class="s0">{ </span><span class="s2">$ref</span><span class="s0">: </span><span class="s3">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' </span><span class="s0">}</span>
          <span class="s0">]</span>
        <span class="s0">};</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s1">return </span><span class="s2">metaSchema</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s0">},{}],</span><span class="s4">12</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">metaSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./refs/json-schema-draft-07.json'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= {</span>
  <span class="s2">$id</span><span class="s0">: </span><span class="s3">'https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js'</span><span class="s0">,</span>
  <span class="s2">definitions</span><span class="s0">: {</span>
    <span class="s2">simpleTypes</span><span class="s0">: </span><span class="s2">metaSchema</span><span class="s0">.</span><span class="s2">definitions</span><span class="s0">.</span><span class="s2">simpleTypes</span>
  <span class="s0">},</span>
  <span class="s2">type</span><span class="s0">: </span><span class="s3">'object'</span><span class="s0">,</span>
  <span class="s2">dependencies</span><span class="s0">: {</span>
    <span class="s2">schema</span><span class="s0">: [</span><span class="s3">'validate'</span><span class="s0">],</span>
    <span class="s2">$data</span><span class="s0">: [</span><span class="s3">'validate'</span><span class="s0">],</span>
    <span class="s2">statements</span><span class="s0">: [</span><span class="s3">'inline'</span><span class="s0">],</span>
    <span class="s2">valid</span><span class="s0">: {</span><span class="s2">not</span><span class="s0">: {</span><span class="s2">required</span><span class="s0">: [</span><span class="s3">'macro'</span><span class="s0">]}}</span>
  <span class="s0">},</span>
  <span class="s2">properties</span><span class="s0">: {</span>
    <span class="s2">type</span><span class="s0">: </span><span class="s2">metaSchema</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span>
    <span class="s2">schema</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">statements</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">dependencies</span><span class="s0">: {</span>
      <span class="s2">type</span><span class="s0">: </span><span class="s3">'array'</span><span class="s0">,</span>
      <span class="s2">items</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'string'</span><span class="s0">}</span>
    <span class="s0">},</span>
    <span class="s2">metaSchema</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'object'</span><span class="s0">},</span>
    <span class="s2">modifying</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">valid</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">$data</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">async</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
    <span class="s2">errors</span><span class="s0">: {</span>
      <span class="s2">anyOf</span><span class="s0">: [</span>
        <span class="s0">{</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">},</span>
        <span class="s0">{</span><span class="s1">const</span><span class="s0">: </span><span class="s3">'full'</span><span class="s0">}</span>
      <span class="s0">]</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">};</span>

<span class="s0">},{</span><span class="s3">&quot;./refs/json-schema-draft-07.json&quot;</span><span class="s0">:</span><span class="s4">41</span><span class="s0">}],</span><span class="s4">13</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate__limit</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$isMax </span><span class="s0">= </span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maximum'</span><span class="s0">,</span>
    <span class="s2">$exclusiveKeyword </span><span class="s0">= </span><span class="s2">$isMax </span><span class="s0">? </span><span class="s3">'exclusiveMaximum' </span><span class="s0">: </span><span class="s3">'exclusiveMinimum'</span><span class="s0">,</span>
    <span class="s2">$schemaExcl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$exclusiveKeyword</span><span class="s0">],</span>
    <span class="s2">$isDataExcl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schemaExcl </span><span class="s0">&amp;&amp; </span><span class="s2">$schemaExcl</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$op </span><span class="s0">= </span><span class="s2">$isMax </span><span class="s0">? </span><span class="s3">'&lt;' </span><span class="s0">: </span><span class="s3">'&gt;'</span><span class="s0">,</span>
    <span class="s2">$notOp </span><span class="s0">= </span><span class="s2">$isMax </span><span class="s0">? </span><span class="s3">'&gt;' </span><span class="s0">: </span><span class="s3">'&lt;'</span><span class="s0">,</span>
    <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'number' </span><span class="s0">|| </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">+ </span><span class="s3">' must be number'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isDataExcl </span><span class="s0">|| </span><span class="s2">$schemaExcl </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schemaExcl </span><span class="s0">== </span><span class="s3">'number' </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schemaExcl </span><span class="s0">== </span><span class="s3">'boolean'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$exclusiveKeyword </span><span class="s0">+ </span><span class="s3">' must be number or boolean'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isDataExcl</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$schemaValueExcl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schemaExcl</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">),</span>
      <span class="s2">$exclusive </span><span class="s0">= </span><span class="s3">'exclusive' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$exclType </span><span class="s0">= </span><span class="s3">'exclType' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$exclIsNumber </span><span class="s0">= </span><span class="s3">'exclIsNumber' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$opExpr </span><span class="s0">= </span><span class="s3">'op' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$opStr </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$opExpr </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schemaExcl' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$schemaValueExcl</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValueExcl </span><span class="s0">= </span><span class="s3">'schemaExcl' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$exclusive</span><span class="s0">) + </span><span class="s3">'; var ' </span><span class="s0">+ (</span><span class="s2">$exclType</span><span class="s0">) + </span><span class="s3">' = typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValueExcl</span><span class="s0">) + </span><span class="s3">'; if (' </span><span class="s0">+ (</span><span class="s2">$exclType</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">boolean</span><span class="s1">\' </span><span class="s3">&amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$exclType</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">undefined</span><span class="s1">\' </span><span class="s3">&amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$exclType</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) { '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'_exclusiveLimit'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$exclusiveKeyword</span><span class="s0">) + </span><span class="s3">' should be boolean</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else if ( '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$exclType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\' </span><span class="s3">? ( (' </span><span class="s0">+ (</span><span class="s2">$exclusive</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' === undefined || ' </span><span class="s0">+ (</span><span class="s2">$schemaValueExcl</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">'= ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">') ? ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">'= ' </span><span class="s0">+ (</span><span class="s2">$schemaValueExcl</span><span class="s0">) + </span><span class="s3">' : ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' ) : ( (' </span><span class="s0">+ (</span><span class="s2">$exclusive</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$schemaValueExcl</span><span class="s0">) + </span><span class="s3">' === true) ? ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">'= ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' : ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' ) || ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' !== ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { var op' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$exclusive</span><span class="s0">) + </span><span class="s3">' ? </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">'=</span><span class="s1">\'</span><span class="s3">; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$schema </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
      <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
      <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schemaValueExcl</span><span class="s0">;</span>
      <span class="s2">$isData </span><span class="s0">= </span><span class="s2">$isDataExcl</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">$exclIsNumber </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">$schemaExcl </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">,</span>
      <span class="s2">$opStr </span><span class="s0">= </span><span class="s2">$op</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$exclIsNumber </span><span class="s0">&amp;&amp; </span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$opExpr </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ </span><span class="s2">$opStr </span><span class="s0">+ </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ( ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' === undefined || ' </span><span class="s0">+ (</span><span class="s2">$schemaExcl</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">'= ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' ? ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">'= ' </span><span class="s0">+ (</span><span class="s2">$schemaExcl</span><span class="s0">) + </span><span class="s3">' : ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' ) || ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' !== ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$exclIsNumber </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s2">$exclusive </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
        <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
        <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
        <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schemaExcl</span><span class="s0">;</span>
        <span class="s2">$notOp </span><span class="s0">+= </span><span class="s3">'='</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$exclIsNumber</span><span class="s0">) </span><span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">Math</span><span class="s0">[</span><span class="s2">$isMax </span><span class="s0">? </span><span class="s3">'min' </span><span class="s0">: </span><span class="s3">'max'</span><span class="s0">](</span><span class="s2">$schemaExcl</span><span class="s0">, </span><span class="s2">$schema</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$schemaExcl </span><span class="s0">=== (</span><span class="s2">$exclIsNumber </span><span class="s0">? </span><span class="s2">$schemaValue </span><span class="s0">: </span><span class="s1">true</span><span class="s0">)) {</span>
          <span class="s2">$exclusive </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
          <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
          <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$exclusiveKeyword</span><span class="s0">;</span>
          <span class="s2">$notOp </span><span class="s0">+= </span><span class="s3">'='</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">$exclusive </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
          <span class="s2">$opStr </span><span class="s0">+= </span><span class="s3">'='</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s2">$opExpr </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ </span><span class="s2">$opStr </span><span class="s0">+ </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$notOp</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' !== ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'_limit'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { comparison: ' </span><span class="s0">+ (</span><span class="s2">$opExpr</span><span class="s0">) + </span><span class="s3">', limit: ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">', exclusive: ' </span><span class="s0">+ (</span><span class="s2">$exclusive</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be ' </span><span class="s0">+ (</span><span class="s2">$opStr</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">14</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate__limitItems</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">+ </span><span class="s3">' must be number'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$op </span><span class="s0">= </span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxItems' </span><span class="s0">? </span><span class="s3">'&gt;' </span><span class="s0">: </span><span class="s3">'&lt;'</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'if ( '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length ' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'_limitItems'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { limit: ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT have '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxItems'</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'more'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'fewer'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' than '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' items</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">15</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate__limitLength</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">+ </span><span class="s3">' must be number'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$op </span><span class="s0">= </span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxLength' </span><span class="s0">? </span><span class="s3">'&gt;' </span><span class="s0">: </span><span class="s3">'&lt;'</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'if ( '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">unicode </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ucs2length(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'_limitLength'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { limit: ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT be '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxLength'</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'longer'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'shorter'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' than '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' characters</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">16</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate__limitProperties</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">+ </span><span class="s3">' must be number'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$op </span><span class="s0">= </span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxProperties' </span><span class="s0">? </span><span class="s3">'&gt;' </span><span class="s0">: </span><span class="s3">'&lt;'</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'if ( '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' Object.keys(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">').length ' </span><span class="s0">+ (</span><span class="s2">$op</span><span class="s0">) + </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'_limitProperties'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { limit: ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT have '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">== </span><span class="s3">'maxProperties'</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'more'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'fewer'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' than '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' properties</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">17</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_allOf</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">,</span>
    <span class="s2">$allSchemasEmpty </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
      <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
    <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
      <span class="s2">$sch </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
        <span class="s2">$allSchemasEmpty </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$i</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
          <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$allSchemasEmpty</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, -</span><span class="s4">1</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">18</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_anyOf</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$noEmptySchema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">every</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">));</span>
  <span class="s0">});</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$noEmptySchema</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors; var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false;  '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
        <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
      <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
        <span class="s2">$sch </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$i</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">'; if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'anyOf'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should match some schema in anyOf</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError(vErrors); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else {  errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (vErrors !== null) { if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">') vErrors.length = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; else vErrors = null; } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">19</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_comment</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$comment </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$comment </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' console.log(' </span><span class="s0">+ (</span><span class="s2">$comment</span><span class="s0">) + </span><span class="s3">');'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$comment </span><span class="s0">== </span><span class="s3">'function'</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' self._opts.$comment(' </span><span class="s0">+ (</span><span class="s2">$comment</span><span class="s0">) + </span><span class="s3">', ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">', validate.root.schema);'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">20</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_const</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = equal(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">'); if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'const'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { allowedValue: schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be equal to constant</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">21</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_contains</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$idx </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$dataNxt </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">,</span>
    <span class="s2">$nextData </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ </span><span class="s2">$dataNxt</span><span class="s0">,</span>
    <span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">,</span>
    <span class="s2">$nonEmptySchema </span><span class="s0">= (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">));</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$nonEmptySchema</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = false; for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' = 0; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' &lt; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { '</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$idx</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$idx </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$idx</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') break; }  '</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') {'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length == 0) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'contains'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should contain a valid item</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else { '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$nonEmptySchema</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (vErrors !== null) { if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">') vErrors.length = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; else vErrors = null; } '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">22</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_custom</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$rule </span><span class="s0">= </span><span class="s1">this</span><span class="s0">,</span>
    <span class="s2">$definition </span><span class="s0">= </span><span class="s3">'definition' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$rDef </span><span class="s0">= </span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">definition</span><span class="s0">,</span>
    <span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$compile</span><span class="s0">, </span><span class="s2">$inline</span><span class="s0">, </span><span class="s2">$macro</span><span class="s0">, </span><span class="s2">$ruleValidate</span><span class="s0">, </span><span class="s2">$validateCode</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData </span><span class="s0">&amp;&amp; </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) {</span>
    <span class="s2">$validateCode </span><span class="s0">= </span><span class="s3">'keywordValidate' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$validateSchema </span><span class="s0">= </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">validateSchema</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$definition</span><span class="s0">) + </span><span class="s3">' = RULES.custom[</span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$keyword</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">].definition; var ' </span><span class="s0">+ (</span><span class="s2">$validateCode</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$definition</span><span class="s0">) + </span><span class="s3">'.validate;'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$ruleValidate </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">useCustomRule</span><span class="s0">(</span><span class="s2">$rule</span><span class="s0">, </span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">$ruleValidate</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'validate.schema' </span><span class="s0">+ </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$validateCode </span><span class="s0">= </span><span class="s2">$ruleValidate</span><span class="s0">.</span><span class="s2">code</span><span class="s0">;</span>
    <span class="s2">$compile </span><span class="s0">= </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">;</span>
    <span class="s2">$inline </span><span class="s0">= </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">inline</span><span class="s0">;</span>
    <span class="s2">$macro </span><span class="s0">= </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">macro</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$ruleErrs </span><span class="s0">= </span><span class="s2">$validateCode </span><span class="s0">+ </span><span class="s3">'.errors'</span><span class="s0">,</span>
    <span class="s2">$i </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$ruleErr </span><span class="s0">= </span><span class="s3">'ruleErr' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$asyncKeyword </span><span class="s0">= </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">async</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$asyncKeyword </span><span class="s0">&amp;&amp; !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'async keyword in sync schema'</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$inline </span><span class="s0">|| </span><span class="s2">$macro</span><span class="s0">)) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">' = null;'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData </span><span class="s0">&amp;&amp; </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) {</span>
    <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' === undefined) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; } else { '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$validateSchema</span><span class="s0">) {</span>
      <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$definition</span><span class="s0">) + </span><span class="s3">'.validateSchema(' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'); if (' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$inline</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">statements</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$ruleValidate</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$ruleValidate</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$macro</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
    <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$ruleValidate</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/validate\.schema/g</span><span class="s0">, </span><span class="s2">$validateCode</span><span class="s0">);</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">);</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">$validateCode</span><span class="s0">) + </span><span class="s3">'.call( '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">passContext</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'this'</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'self'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$compile </span><span class="s0">|| </span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' , validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , (dataPath || </span><span class="s1">\'\'</span><span class="s3">)'</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">!= </span><span class="s3">'&quot;&quot;'</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">$parentData </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s3">'data' </span><span class="s0">+ ((</span><span class="s2">$dataLvl </span><span class="s0">- </span><span class="s4">1</span><span class="s0">) || </span><span class="s3">''</span><span class="s0">) : </span><span class="s3">'parentData'</span><span class="s0">,</span>
      <span class="s2">$parentDataProperty </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataLvl</span><span class="s0">] : </span><span class="s3">'parentDataProperty'</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$parentDataProperty</span><span class="s0">) + </span><span class="s3">' , rootData )  '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">def_callRuleValidate </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$asyncKeyword</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'await '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">def_callRuleValidate</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$asyncKeyword</span><span class="s0">) {</span>
        <span class="s2">$ruleErrs </span><span class="s0">= </span><span class="s3">'customErrors' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">' = null; try { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = await ' </span><span class="s0">+ (</span><span class="s2">def_callRuleValidate</span><span class="s0">) + </span><span class="s3">'; } catch (e) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; if (e instanceof ValidationError) ' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">' = e.errors; else throw e; } '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">' = null; ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">def_callRuleValidate</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">modifying</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">') ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$parentDataProperty</span><span class="s0">) + </span><span class="s3">'];'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">valid </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' !'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$macro</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (!</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s2">$errorKeyword </span><span class="s0">= </span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'custom'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should pass &quot;' </span><span class="s0">+ (</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">) + </span><span class="s3">'&quot; keyword validation</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">def_customError </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$inline</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">!= </span><span class="s3">'full'</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'=' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'&lt;errors; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">' = vErrors[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']; if (' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath === undefined) ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath = (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">'; if (' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schemaPath === undefined) { ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schemaPath = &quot;' </span><span class="s0">+ (</span><span class="s2">$errSchemaPath</span><span class="s0">) + </span><span class="s3">'&quot;; } '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schema = ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.data = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">def_customError</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' == errors) { ' </span><span class="s0">+ (</span><span class="s2">def_customError</span><span class="s0">) + </span><span class="s3">' } else {  for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'=' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'&lt;errors; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">' = vErrors[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']; if (' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath === undefined) ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath = (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">'; if (' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schemaPath === undefined) { ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schemaPath = &quot;' </span><span class="s0">+ (</span><span class="s2">$errSchemaPath</span><span class="s0">) + </span><span class="s3">'&quot;; } '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schema = ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.data = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } } '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$macro</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'   var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'custom'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should pass &quot;' </span><span class="s0">+ (</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">) + </span><span class="s3">'&quot; keyword validation</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError(vErrors); '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; return false; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$rDef</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">def_customError</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (Array.isArray(' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">')) { if (vErrors === null) vErrors = ' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">'; else vErrors = vErrors.concat(' </span><span class="s0">+ (</span><span class="s2">$ruleErrs</span><span class="s0">) + </span><span class="s3">'); errors = vErrors.length;  for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'=' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'&lt;errors; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">' = vErrors[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']; if (' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath === undefined) ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.dataPath = (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">';  ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schemaPath = &quot;' </span><span class="s0">+ (</span><span class="s2">$errSchemaPath</span><span class="s0">) + </span><span class="s3">'&quot;;  '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.schema = ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$ruleErr</span><span class="s0">) + </span><span class="s3">'.data = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } } else { ' </span><span class="s0">+ (</span><span class="s2">def_customError</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">23</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_dependencies</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schemaDeps </span><span class="s0">= {},</span>
    <span class="s2">$propertyDeps </span><span class="s0">= {},</span>
    <span class="s2">$ownProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">ownProperties</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s2">$property </span><span class="s1">in </span><span class="s2">$schema</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$property </span><span class="s0">== </span><span class="s3">'__proto__'</span><span class="s0">) </span><span class="s1">continue</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$sch </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">[</span><span class="s2">$property</span><span class="s0">];</span>
    <span class="s1">var </span><span class="s2">$deps </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">) ? </span><span class="s2">$propertyDeps </span><span class="s0">: </span><span class="s2">$schemaDeps</span><span class="s0">;</span>
    <span class="s2">$deps</span><span class="s0">[</span><span class="s2">$property</span><span class="s0">] = </span><span class="s2">$sch</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;'</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$currentErrorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var missing' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">$property </span><span class="s1">in </span><span class="s2">$propertyDeps</span><span class="s0">) {</span>
    <span class="s2">$deps </span><span class="s0">= </span><span class="s2">$propertyDeps</span><span class="s0">[</span><span class="s2">$property</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">' !== undefined '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp; Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp; ( '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$deps</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
            <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$i</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s1">var </span><span class="s2">$prop </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$useData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">;</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ( ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">') &amp;&amp; (missing' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers </span><span class="s0">? </span><span class="s2">$propertyKey </span><span class="s0">: </span><span class="s2">$prop</span><span class="s0">)) + </span><span class="s3">') ) '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">')) {  '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">$propertyPath </span><span class="s0">= </span><span class="s3">'missing' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
          <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$propertyPath </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyPath</span><span class="s0">, </span><span class="s1">true</span><span class="s0">) : </span><span class="s2">$currentErrorPath </span><span class="s0">+ </span><span class="s3">' + ' </span><span class="s0">+ </span><span class="s2">$propertyPath</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'dependencies'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { property: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">, missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">, depsCount: ' </span><span class="s0">+ (</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">', deps: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">1 </span><span class="s0">? </span><span class="s2">$deps</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] : </span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">))) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should have '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">1</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'property ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]));</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'properties ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">)));</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' when property ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">' is present</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) { '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">arr2 </span><span class="s0">= </span><span class="s2">$deps</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr2</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">i2 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l2 </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">i2 </span><span class="s0">&lt; </span><span class="s2">l2</span><span class="s0">) {</span>
            <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">[</span><span class="s2">i2 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s1">var </span><span class="s2">$prop </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$useData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
              <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPath</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">') {  var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'dependencies'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { property: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">, missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">, depsCount: ' </span><span class="s0">+ (</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">', deps: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">1 </span><span class="s0">? </span><span class="s2">$deps</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] : </span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">))) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should have '</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">1</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'property ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]));</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'properties ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$deps</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">)));</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' when property ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">' is present</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }   '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">$currentErrorPath</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">$property </span><span class="s1">in </span><span class="s2">$schemaDeps</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$sch </span><span class="s0">= </span><span class="s2">$schemaDeps</span><span class="s0">[</span><span class="s2">$property</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; if ( ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">' !== undefined '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp; Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">);</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeFragment</span><span class="s0">(</span><span class="s2">$property</span><span class="s0">);</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'   ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' == errors) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">24</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_enum</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$i </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$vSchema </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">' = validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' === undefined) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; else if (!Array.isArray(schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">')) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; else {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false;for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'=0; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'&lt;' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) if (equal(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'])) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; break; }'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  }  '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'enum'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { allowedValues: schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be equal to one of the allowed values</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">25</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_format</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">format </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$unknownFormats </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">unknownFormats</span><span class="s0">,</span>
    <span class="s2">$allowUnknown </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">$unknownFormats</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$format </span><span class="s0">= </span><span class="s3">'format' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$isObject </span><span class="s0">= </span><span class="s3">'isObject' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$formatType </span><span class="s0">= </span><span class="s3">'formatType' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' = formats[' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">']; var ' </span><span class="s0">+ (</span><span class="s2">$isObject</span><span class="s0">) + </span><span class="s3">' = typeof ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">object</span><span class="s1">\' </span><span class="s3">&amp;&amp; !(' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' instanceof RegExp) &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'.validate; var ' </span><span class="s0">+ (</span><span class="s2">$formatType</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$isObject</span><span class="s0">) + </span><span class="s3">' &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'.type || </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\'</span><span class="s3">; if (' </span><span class="s0">+ (</span><span class="s2">$isObject</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var async' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'.async; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'.validate; } if (  '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ('</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$unknownFormats </span><span class="s0">!= </span><span class="s3">'ignore'</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' &amp;&amp; !' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$allowUnknown</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp; self._opts.unknownFormats.indexOf(' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">') == -1 '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">') || '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$formatType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$ruleType</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">&amp;&amp; !(typeof ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">function</span><span class="s1">\' </span><span class="s3">? '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (async' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' ? await ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') : ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">')) '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' : ' </span><span class="s0">+ (</span><span class="s2">$format</span><span class="s0">) + </span><span class="s3">'.test(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'))))) {'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">$format </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">formats</span><span class="s0">[</span><span class="s2">$schema</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">$format</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$unknownFormats </span><span class="s0">== </span><span class="s3">'ignore'</span><span class="s0">) {</span>
        <span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">'unknown format &quot;' </span><span class="s0">+ </span><span class="s2">$schema </span><span class="s0">+ </span><span class="s3">'&quot; ignored in schema at path &quot;' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'&quot;'</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$allowUnknown </span><span class="s0">&amp;&amp; </span><span class="s2">$unknownFormats</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">) &gt;= </span><span class="s4">0</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'unknown format &quot;' </span><span class="s0">+ </span><span class="s2">$schema </span><span class="s0">+ </span><span class="s3">'&quot; is used in schema at path &quot;' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'&quot;'</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">$isObject </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">$format </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; !(</span><span class="s2">$format </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">) &amp;&amp; </span><span class="s2">$format</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$formatType </span><span class="s0">= </span><span class="s2">$isObject </span><span class="s0">&amp;&amp; </span><span class="s2">$format</span><span class="s0">.</span><span class="s2">type </span><span class="s0">|| </span><span class="s3">'string'</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isObject</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$async </span><span class="s0">= </span><span class="s2">$format</span><span class="s0">.</span><span class="s2">async </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">;</span>
      <span class="s2">$format </span><span class="s0">= </span><span class="s2">$format</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$formatType </span><span class="s0">!= </span><span class="s2">$ruleType</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'async format in sync schema'</span><span class="s0">);</span>
      <span class="s1">var </span><span class="s2">$formatRef </span><span class="s0">= </span><span class="s3">'formats' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">) + </span><span class="s3">'.validate'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!(await ' </span><span class="s0">+ (</span><span class="s2">$formatRef</span><span class="s0">) + </span><span class="s3">'(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'))) { '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (! '</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$formatRef </span><span class="s0">= </span><span class="s3">'formats' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isObject</span><span class="s0">) </span><span class="s2">$formatRef </span><span class="s0">+= </span><span class="s3">'.validate'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">$format </span><span class="s0">== </span><span class="s3">'function'</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$formatRef</span><span class="s0">) + </span><span class="s3">'(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$formatRef</span><span class="s0">) + </span><span class="s3">'.test(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'format'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { format:  '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should match format &quot;'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'&quot;</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">26</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_if</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$thenSch </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s3">'then'</span><span class="s0">],</span>
    <span class="s2">$elseSch </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s3">'else'</span><span class="s0">],</span>
    <span class="s2">$thenPresent </span><span class="s0">= </span><span class="s2">$thenSch </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$thenSch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$thenSch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$thenSch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$thenSch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">)),</span>
    <span class="s2">$elsePresent </span><span class="s0">= </span><span class="s2">$elseSch </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$elseSch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$elseSch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$elseSch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$elseSch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">)),</span>
    <span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$thenPresent </span><span class="s0">|| </span><span class="s2">$elsePresent</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$ifClause</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors; var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true;  '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (vErrors !== null) { if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">') vErrors.length = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; else vErrors = null; }  '</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$thenPresent</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') {  '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s3">'then'</span><span class="s0">];</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.then'</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/then'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$thenPresent </span><span class="s0">&amp;&amp; </span><span class="s2">$elsePresent</span><span class="s0">) {</span>
        <span class="s2">$ifClause </span><span class="s0">= </span><span class="s3">'ifClause' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$ifClause</span><span class="s0">) + </span><span class="s3">' = </span><span class="s1">\'</span><span class="s3">then</span><span class="s1">\'</span><span class="s3">; '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">$ifClause </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">then</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$elsePresent</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$elsePresent</span><span class="s0">) {</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s3">'else'</span><span class="s0">];</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.else'</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/else'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$thenPresent </span><span class="s0">&amp;&amp; </span><span class="s2">$elsePresent</span><span class="s0">) {</span>
        <span class="s2">$ifClause </span><span class="s0">= </span><span class="s3">'ifClause' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$ifClause</span><span class="s0">) + </span><span class="s3">' = </span><span class="s1">\'</span><span class="s3">else</span><span class="s1">\'</span><span class="s3">; '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">$ifClause </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">else</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'if'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { failingKeyword: ' </span><span class="s0">+ (</span><span class="s2">$ifClause</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should match &quot;</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$ifClause</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">&quot; schema</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError(vErrors); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }   '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">27</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s7">//all requires must be explicit because browserify won't work with dynamic requires</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= {</span>
  <span class="s3">'$ref'</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./ref'</span><span class="s0">),</span>
  <span class="s2">allOf</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./allOf'</span><span class="s0">),</span>
  <span class="s2">anyOf</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./anyOf'</span><span class="s0">),</span>
  <span class="s3">'$comment'</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./comment'</span><span class="s0">),</span>
  <span class="s1">const</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./const'</span><span class="s0">),</span>
  <span class="s2">contains</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./contains'</span><span class="s0">),</span>
  <span class="s2">dependencies</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./dependencies'</span><span class="s0">),</span>
  <span class="s3">'enum'</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./enum'</span><span class="s0">),</span>
  <span class="s2">format</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./format'</span><span class="s0">),</span>
  <span class="s3">'if'</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./if'</span><span class="s0">),</span>
  <span class="s2">items</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./items'</span><span class="s0">),</span>
  <span class="s2">maximum</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limit'</span><span class="s0">),</span>
  <span class="s2">minimum</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limit'</span><span class="s0">),</span>
  <span class="s2">maxItems</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitItems'</span><span class="s0">),</span>
  <span class="s2">minItems</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitItems'</span><span class="s0">),</span>
  <span class="s2">maxLength</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitLength'</span><span class="s0">),</span>
  <span class="s2">minLength</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitLength'</span><span class="s0">),</span>
  <span class="s2">maxProperties</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitProperties'</span><span class="s0">),</span>
  <span class="s2">minProperties</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./_limitProperties'</span><span class="s0">),</span>
  <span class="s2">multipleOf</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./multipleOf'</span><span class="s0">),</span>
  <span class="s2">not</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./not'</span><span class="s0">),</span>
  <span class="s2">oneOf</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./oneOf'</span><span class="s0">),</span>
  <span class="s2">pattern</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./pattern'</span><span class="s0">),</span>
  <span class="s2">properties</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./properties'</span><span class="s0">),</span>
  <span class="s2">propertyNames</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./propertyNames'</span><span class="s0">),</span>
  <span class="s2">required</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./required'</span><span class="s0">),</span>
  <span class="s2">uniqueItems</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./uniqueItems'</span><span class="s0">),</span>
  <span class="s2">validate</span><span class="s0">: </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./validate'</span><span class="s0">)</span>
<span class="s0">};</span>

<span class="s0">},{</span><span class="s3">&quot;./_limit&quot;</span><span class="s0">:</span><span class="s4">13</span><span class="s0">,</span><span class="s3">&quot;./_limitItems&quot;</span><span class="s0">:</span><span class="s4">14</span><span class="s0">,</span><span class="s3">&quot;./_limitLength&quot;</span><span class="s0">:</span><span class="s4">15</span><span class="s0">,</span><span class="s3">&quot;./_limitProperties&quot;</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s3">&quot;./allOf&quot;</span><span class="s0">:</span><span class="s4">17</span><span class="s0">,</span><span class="s3">&quot;./anyOf&quot;</span><span class="s0">:</span><span class="s4">18</span><span class="s0">,</span><span class="s3">&quot;./comment&quot;</span><span class="s0">:</span><span class="s4">19</span><span class="s0">,</span><span class="s3">&quot;./const&quot;</span><span class="s0">:</span><span class="s4">20</span><span class="s0">,</span><span class="s3">&quot;./contains&quot;</span><span class="s0">:</span><span class="s4">21</span><span class="s0">,</span><span class="s3">&quot;./dependencies&quot;</span><span class="s0">:</span><span class="s4">23</span><span class="s0">,</span><span class="s3">&quot;./enum&quot;</span><span class="s0">:</span><span class="s4">24</span><span class="s0">,</span><span class="s3">&quot;./format&quot;</span><span class="s0">:</span><span class="s4">25</span><span class="s0">,</span><span class="s3">&quot;./if&quot;</span><span class="s0">:</span><span class="s4">26</span><span class="s0">,</span><span class="s3">&quot;./items&quot;</span><span class="s0">:</span><span class="s4">28</span><span class="s0">,</span><span class="s3">&quot;./multipleOf&quot;</span><span class="s0">:</span><span class="s4">29</span><span class="s0">,</span><span class="s3">&quot;./not&quot;</span><span class="s0">:</span><span class="s4">30</span><span class="s0">,</span><span class="s3">&quot;./oneOf&quot;</span><span class="s0">:</span><span class="s4">31</span><span class="s0">,</span><span class="s3">&quot;./pattern&quot;</span><span class="s0">:</span><span class="s4">32</span><span class="s0">,</span><span class="s3">&quot;./properties&quot;</span><span class="s0">:</span><span class="s4">33</span><span class="s0">,</span><span class="s3">&quot;./propertyNames&quot;</span><span class="s0">:</span><span class="s4">34</span><span class="s0">,</span><span class="s3">&quot;./ref&quot;</span><span class="s0">:</span><span class="s4">35</span><span class="s0">,</span><span class="s3">&quot;./required&quot;</span><span class="s0">:</span><span class="s4">36</span><span class="s0">,</span><span class="s3">&quot;./uniqueItems&quot;</span><span class="s0">:</span><span class="s4">37</span><span class="s0">,</span><span class="s3">&quot;./validate&quot;</span><span class="s0">:</span><span class="s4">38</span><span class="s0">}],</span><span class="s4">28</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_items</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$idx </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$dataNxt </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">,</span>
    <span class="s2">$nextData </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ </span><span class="s2">$dataNxt</span><span class="s0">,</span>
    <span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">)) {</span>
    <span class="s1">var </span><span class="s2">$additionalItems </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">additionalItems</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$additionalItems </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length &lt;= ' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$currErrSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
      <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/additionalItems'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
      <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
      <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'additionalItems'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { limit: ' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT have more than ' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">' items</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">$currErrSchemaPath</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
        <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
      <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
        <span class="s2">$sch </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length &gt; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$i</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$i</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$i</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }  '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
            <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">$additionalItems </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$additionalItems </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$additionalItems</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$additionalItems </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$additionalItems</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$additionalItems</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.additionalItems'</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/additionalItems'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length &gt; ' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">') {  for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' &lt; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { '</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$idx</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
      <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$idx </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$idx</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') break; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } }  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s4">0</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">' &lt; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { '</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$idx</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$idx </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$idx</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') break; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' == errors) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">29</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_multipleOf</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">)) {</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keyword </span><span class="s0">+ </span><span class="s3">' must be number'</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">';if ('</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; ( typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\' </span><span class="s3">|| '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' / ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">', '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">multipleOfPrecision</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' Math.abs(Math.round(division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">') - division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">') &gt; 1e-' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">multipleOfPrecision</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' !== parseInt(division' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  )  '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) {   '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'multipleOf'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { multipleOf: ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be multiple of '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">30</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_not</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;  '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$allErrorsOption</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">) {</span>
      <span class="s2">$allErrorsOption </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$allErrorsOption</span><span class="s0">) </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors </span><span class="s0">= </span><span class="s2">$allErrorsOption</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'not'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT be valid</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else {  errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (vErrors !== null) { if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">') vErrors.length = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; else vErrors = null; } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'not'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT be valid</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (false) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">31</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_oneOf</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">,</span>
    <span class="s2">$prevValid </span><span class="s0">= </span><span class="s3">'prevValid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$passingSchemas </span><span class="s0">= </span><span class="s3">'passingSchemas' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors , ' </span><span class="s0">+ (</span><span class="s2">$prevValid</span><span class="s0">) + </span><span class="s3">' = false , ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false , ' </span><span class="s0">+ (</span><span class="s2">$passingSchemas</span><span class="s0">) + </span><span class="s3">' = null; '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
  <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
      <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
    <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
      <span class="s2">$sch </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$i</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$i</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$prevValid</span><span class="s0">) + </span><span class="s3">') { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; ' </span><span class="s0">+ (</span><span class="s2">$passingSchemas</span><span class="s0">) + </span><span class="s3">' = [' </span><span class="s0">+ (</span><span class="s2">$passingSchemas</span><span class="s0">) + </span><span class="s3">', ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']; } else { '</span><span class="s0">;</span>
        <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$prevValid</span><span class="s0">) + </span><span class="s3">' = true; ' </span><span class="s0">+ (</span><span class="s2">$passingSchemas</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'; }'</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">'if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'oneOf'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { passingSchemas: ' </span><span class="s0">+ (</span><span class="s2">$passingSchemas</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should match exactly one schema in oneOf</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError(vErrors); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} else {  errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (vErrors !== null) { if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">') vErrors.length = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; else vErrors = null; }'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">32</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_pattern</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$regexp </span><span class="s0">= </span><span class="s2">$isData </span><span class="s0">? </span><span class="s3">'(new RegExp(' </span><span class="s0">+ </span><span class="s2">$schemaValue </span><span class="s0">+ </span><span class="s3">'))' </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">usePattern</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'if ( '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' !== undefined &amp;&amp; typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\'</span><span class="s3">) || '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' !' </span><span class="s0">+ (</span><span class="s2">$regexp</span><span class="s0">) + </span><span class="s3">'.test(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') ) {   '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
  <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'pattern'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { pattern:  '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should match pattern &quot;'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'&quot;</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">));</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s7">/* istanbul ignore if */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'} '</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">33</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_properties</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$key </span><span class="s0">= </span><span class="s3">'key' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$idx </span><span class="s0">= </span><span class="s3">'idx' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$dataNxt </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">,</span>
    <span class="s2">$nextData </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ </span><span class="s2">$dataNxt</span><span class="s0">,</span>
    <span class="s2">$dataProperties </span><span class="s0">= </span><span class="s3">'dataProperties' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schemaKeys </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema </span><span class="s0">|| {}).</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">notProto</span><span class="s0">),</span>
    <span class="s2">$pProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">patternProperties </span><span class="s0">|| {},</span>
    <span class="s2">$pPropertyKeys </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$pProperties</span><span class="s0">).</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">notProto</span><span class="s0">),</span>
    <span class="s2">$aProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">additionalProperties</span><span class="s0">,</span>
    <span class="s2">$someProperties </span><span class="s0">= </span><span class="s2">$schemaKeys</span><span class="s0">.</span><span class="s2">length </span><span class="s0">|| </span><span class="s2">$pPropertyKeys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span>
    <span class="s2">$noAdditional </span><span class="s0">= </span><span class="s2">$aProperties </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">,</span>
    <span class="s2">$additionalIsSchema </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">$aProperties </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$aProperties</span><span class="s0">).</span><span class="s2">length</span><span class="s0">,</span>
    <span class="s2">$removeAdditional </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">removeAdditional</span><span class="s0">,</span>
    <span class="s2">$checkAdditional </span><span class="s0">= </span><span class="s2">$noAdditional </span><span class="s0">|| </span><span class="s2">$additionalIsSchema </span><span class="s0">|| </span><span class="s2">$removeAdditional</span><span class="s0">,</span>
    <span class="s2">$ownProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">ownProperties</span><span class="s0">,</span>
    <span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$required </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">required</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$required </span><span class="s0">&amp;&amp; !(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$required</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) &amp;&amp; </span><span class="s2">$required</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&lt; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">loopRequired</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$requiredHash </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toHash</span><span class="s0">(</span><span class="s2">$required</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">notProto</span><span class="s0">(</span><span class="s2">p</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">p </span><span class="s0">!== </span><span class="s3">'__proto__'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;var ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true;'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' = undefined;'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$checkAdditional</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' || Object.keys(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'); for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'=0; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'&lt;' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' for (var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' in ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$someProperties</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var isAdditional' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = !(false '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$schemaKeys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$schemaKeys</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">8</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">'.hasOwnProperty(' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schemaKeys</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">i1 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
              <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">while </span><span class="s0">(</span><span class="s2">i1 </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
              <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">i1 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' == ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$pPropertyKeys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">arr2 </span><span class="s0">= </span><span class="s2">$pPropertyKeys</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr2</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$pProperty</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l2 </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l2</span><span class="s0">) {</span>
            <span class="s2">$pProperty </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">usePattern</span><span class="s0">(</span><span class="s2">$pProperty</span><span class="s0">)) + </span><span class="s3">'.test(' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">') '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ); if (isAdditional' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$removeAdditional </span><span class="s0">== </span><span class="s3">'all'</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' delete ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s2">$currentErrorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$additionalProperty </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$key </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
        <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$key</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$noAdditional</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$removeAdditional</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' delete ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = false; '</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$currErrSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
          <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/additionalProperties'</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
          <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
          <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'additionalProperties'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { additionalProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$additionalProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is an invalid additional property'</span><span class="s0">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should NOT have additional properties'</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
          <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
          <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s7">/* istanbul ignore if */</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
            <span class="s0">}</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">$currErrSchemaPath</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' break; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$additionalIsSchema</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$removeAdditional </span><span class="s0">== </span><span class="s3">'failing'</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;  '</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$aProperties</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.additionalProperties'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/additionalProperties'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$key</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
          <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$key </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$key</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { errors = ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">'; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">']; }  '</span><span class="s0">;</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$aProperties</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.additionalProperties'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/additionalProperties'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$key</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
          <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$key </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$key</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') break; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">$currentErrorPath</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$someProperties</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }  '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$useDefaults </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">&amp;&amp; !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$schemaKeys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">arr3 </span><span class="s0">= </span><span class="s2">$schemaKeys</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">arr3</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">i3 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
        <span class="s2">l3 </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
      <span class="s1">while </span><span class="s0">(</span><span class="s2">i3 </span><span class="s0">&lt; </span><span class="s2">l3</span><span class="s0">) {</span>
        <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">[</span><span class="s2">i3 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
        <span class="s1">var </span><span class="s2">$sch </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">[</span><span class="s2">$propertyKey</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
          <span class="s1">var </span><span class="s2">$prop </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
            <span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">,</span>
            <span class="s2">$hasDefault </span><span class="s0">= </span><span class="s2">$useDefaults </span><span class="s0">&amp;&amp; </span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeFragment</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPath</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">);</span>
          <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">);</span>
            <span class="s1">var </span><span class="s2">$useData </span><span class="s0">= </span><span class="s2">$passData</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">var </span><span class="s2">$useData </span><span class="s0">= </span><span class="s2">$nextData</span><span class="s0">;</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$hasDefault</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$requiredHash </span><span class="s0">&amp;&amp; </span><span class="s2">$requiredHash</span><span class="s0">[</span><span class="s2">$propertyKey</span><span class="s0">]) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = false; '</span><span class="s0">;</span>
              <span class="s1">var </span><span class="s2">$currentErrorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">,</span>
                <span class="s2">$currErrSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">,</span>
                <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">);</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
                <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPath</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
              <span class="s0">}</span>
              <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/required'</span><span class="s0">;</span>
              <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
              <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
              <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
                  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
                    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
                  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
                  <span class="s0">}</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
              <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
              <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
                <span class="s7">/* istanbul ignore if */</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
                <span class="s0">}</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">$currErrSchemaPath</span><span class="s0">;</span>
              <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">$currentErrorPath</span><span class="s0">;</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else { '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; } else { '</span><span class="s0">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' !== undefined '</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp;   Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) { '</span><span class="s0">;</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' } '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
          <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$pPropertyKeys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">arr4 </span><span class="s0">= </span><span class="s2">$pPropertyKeys</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">arr4</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$pProperty</span><span class="s0">, </span><span class="s2">i4 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
        <span class="s2">l4 </span><span class="s0">= </span><span class="s2">arr4</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
      <span class="s1">while </span><span class="s0">(</span><span class="s2">i4 </span><span class="s0">&lt; </span><span class="s2">l4</span><span class="s0">) {</span>
        <span class="s2">$pProperty </span><span class="s0">= </span><span class="s2">arr4</span><span class="s0">[</span><span class="s2">i4 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
        <span class="s1">var </span><span class="s2">$sch </span><span class="s0">= </span><span class="s2">$pProperties</span><span class="s0">[</span><span class="s2">$pProperty</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$sch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$sch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$sch</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.patternProperties' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$pProperty</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/patternProperties/' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeFragment</span><span class="s0">(</span><span class="s2">$pProperty</span><span class="s0">);</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' || Object.keys(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'); for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'=0; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'&lt;' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' for (var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' in ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">usePattern</span><span class="s0">(</span><span class="s2">$pProperty</span><span class="s0">)) + </span><span class="s3">'.test(' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">')) { '</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">, </span><span class="s2">$key</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
          <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$key </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataNxt</span><span class="s0">] = </span><span class="s2">$key</span><span class="s0">;</span>
          <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
          <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') break; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else ' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }  '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
            <span class="s2">$closingBraces </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' == errors) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">34</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_propertyNames</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errs </span><span class="s0">= </span><span class="s3">'errs__' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$closingBraces </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
  <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'var ' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' = errors;'</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">((</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$schema </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">))) {</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s2">$schemaPath</span><span class="s0">;</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$errSchemaPath</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$key </span><span class="s0">= </span><span class="s3">'key' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$idx </span><span class="s0">= </span><span class="s3">'idx' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$i </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$invalidName </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$key </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">,</span>
      <span class="s2">$dataNxt </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">,</span>
      <span class="s2">$nextData </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ </span><span class="s2">$dataNxt</span><span class="s0">,</span>
      <span class="s2">$dataProperties </span><span class="s0">= </span><span class="s3">'dataProperties' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
      <span class="s2">$ownProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">ownProperties</span><span class="s0">,</span>
      <span class="s2">$currentBaseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' = undefined; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">' || Object.keys(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'); for (var ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'=0; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'&lt;' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">'++) { var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$dataProperties</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$idx</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' for (var ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">' in ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var startErrs' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = errors; '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$key</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$wasComposite </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">);</span>
    <span class="s2">$it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">$currentBaseId</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varOccurences</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">) &lt; </span><span class="s4">2</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">varReplace</span><span class="s0">(</span><span class="s2">$code</span><span class="s0">, </span><span class="s2">$nextData</span><span class="s0">, </span><span class="s2">$passData</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$nextData</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">= </span><span class="s2">$wasComposite</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'=startErrs' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">'; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'&lt;errors; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { vErrors[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'].propertyName = ' </span><span class="s0">+ (</span><span class="s2">$key</span><span class="s0">) + </span><span class="s3">'; }   var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'propertyNames'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { propertyName: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$invalidName</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">property name </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$invalidName</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\' </span><span class="s3">is invalid</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError(vErrors); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' break; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } }'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces</span><span class="s0">) + </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$errs</span><span class="s0">) + </span><span class="s3">' == errors) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">35</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_ref</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$async</span><span class="s0">, </span><span class="s2">$refCode</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'#' </span><span class="s0">|| </span><span class="s2">$schema </span><span class="s0">== </span><span class="s3">'#/'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isRoot</span><span class="s0">) {</span>
      <span class="s2">$async </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">;</span>
      <span class="s2">$refCode </span><span class="s0">= </span><span class="s3">'validate'</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">$async </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">;</span>
      <span class="s2">$refCode </span><span class="s0">= </span><span class="s3">'root.refVal[0]'</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">$refVal </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">resolveRef</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">isRoot</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$refVal </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$message </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">MissingRefError</span><span class="s0">.</span><span class="s2">message</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">$schema</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">missingRefs </span><span class="s0">== </span><span class="s3">'fail'</span><span class="s0">) {</span>
        <span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">$message</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'$ref'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { ref: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">can</span><span class="s1">\\\'</span><span class="s3">t resolve reference ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">)) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (false) { '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">missingRefs </span><span class="s0">== </span><span class="s3">'ignore'</span><span class="s0">) {</span>
        <span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">$message</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">throw new </span><span class="s2">it</span><span class="s0">.</span><span class="s2">MissingRefError</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">$message</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">inline</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$it </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">it</span><span class="s0">);</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">++;</span>
      <span class="s1">var </span><span class="s2">$nextValid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
      <span class="s2">$it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$it</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/validate\.schema/g</span><span class="s0">, </span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">code</span><span class="s0">);</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$nextValid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">$async </span><span class="s0">= </span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">=== </span><span class="s1">true </span><span class="s0">|| (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async </span><span class="s0">&amp;&amp; </span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">);</span>
      <span class="s2">$refCode </span><span class="s0">= </span><span class="s2">$refVal</span><span class="s0">.</span><span class="s2">code</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$refCode</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">passContext</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$refCode</span><span class="s0">) + </span><span class="s3">'.call(this, '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$refCode</span><span class="s0">) + </span><span class="s3">'( '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', (dataPath || </span><span class="s1">\'\'</span><span class="s3">)'</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">!= </span><span class="s3">'&quot;&quot;'</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">$parentData </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s3">'data' </span><span class="s0">+ ((</span><span class="s2">$dataLvl </span><span class="s0">- </span><span class="s4">1</span><span class="s0">) || </span><span class="s3">''</span><span class="s0">) : </span><span class="s3">'parentData'</span><span class="s0">,</span>
      <span class="s2">$parentDataProperty </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataLvl</span><span class="s0">] : </span><span class="s3">'parentDataProperty'</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">' , ' </span><span class="s0">+ (</span><span class="s2">$parentDataProperty</span><span class="s0">) + </span><span class="s3">', rootData)  '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">__callValidate </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'async schema referenced by sync schema'</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' try { await ' </span><span class="s0">+ (</span><span class="s2">__callValidate</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">__callValidate</span><span class="s0">) + </span><span class="s3">') { if (vErrors === null) vErrors = ' </span><span class="s0">+ (</span><span class="s2">$refCode</span><span class="s0">) + </span><span class="s3">'.errors; else vErrors = vErrors.concat(' </span><span class="s0">+ (</span><span class="s2">$refCode</span><span class="s0">) + </span><span class="s3">'.errors); errors = vErrors.length; } '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">36</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_required</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$vSchema </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&lt; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">loopRequired </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">properties </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">).</span><span class="s2">length</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$required </span><span class="s0">= [];</span>
      <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">$property</span><span class="s0">, </span><span class="s2">i1 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
          <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
        <span class="s1">while </span><span class="s0">(</span><span class="s2">i1 </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
          <span class="s2">$property </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">i1 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
          <span class="s1">var </span><span class="s2">$propertySch </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">[</span><span class="s2">$property</span><span class="s0">];</span>
          <span class="s1">if </span><span class="s0">(!(</span><span class="s2">$propertySch </span><span class="s0">&amp;&amp; (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">? (</span><span class="s1">typeof </span><span class="s2">$propertySch </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$propertySch</span><span class="s0">).</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">0</span><span class="s0">) || </span><span class="s2">$propertySch </span><span class="s0">=== </span><span class="s1">false </span><span class="s0">: </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRules</span><span class="s0">(</span><span class="s2">$propertySch</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">)))) {</span>
            <span class="s2">$required</span><span class="s0">[</span><span class="s2">$required</span><span class="s0">.</span><span class="s2">length</span><span class="s0">] = </span><span class="s2">$property</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">var </span><span class="s2">$required </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData </span><span class="s0">|| </span><span class="s2">$required</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$currentErrorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">,</span>
      <span class="s2">$loopRequired </span><span class="s0">= </span><span class="s2">$isData </span><span class="s0">|| </span><span class="s2">$required</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt;= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">loopRequired</span><span class="s0">,</span>
      <span class="s2">$ownProperties </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">ownProperties</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var missing' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$loopRequired</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">' = validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">$i </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
          <span class="s2">$propertyPath </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">,</span>
          <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$propertyPath </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyPath</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' === undefined) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; else if (!Array.isArray(schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">')) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; else {'</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">' = 0; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">' &lt; ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']] !== undefined '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp;   Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']) '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'; if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') break; } '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  }  '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else { '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">arr2 </span><span class="s0">= </span><span class="s2">$required</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr2</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l2 </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l2</span><span class="s0">) {</span>
            <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$i</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s1">var </span><span class="s2">$prop </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$useData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">;</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ( ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">') &amp;&amp; (missing' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers </span><span class="s0">? </span><span class="s2">$propertyKey </span><span class="s0">: </span><span class="s2">$prop</span><span class="s0">)) + </span><span class="s3">') ) '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">') {  '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">$propertyPath </span><span class="s0">= </span><span class="s3">'missing' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
          <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$propertyPath </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyPath</span><span class="s0">, </span><span class="s1">true</span><span class="s0">) : </span><span class="s2">$currentErrorPath </span><span class="s0">+ </span><span class="s3">' + ' </span><span class="s0">+ </span><span class="s2">$propertyPath</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } else { '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$loopRequired</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">' = validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">$i </span><span class="s0">= </span><span class="s3">'i' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
          <span class="s2">$propertyPath </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">,</span>
          <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">+ ' </span><span class="s0">+ </span><span class="s2">$propertyPath </span><span class="s0">+ </span><span class="s3">' + </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
          <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPathExpr</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyPath</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">' &amp;&amp; !Array.isArray(' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">')) {  var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if (' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">' !== undefined) { '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' for (var ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">' = 0; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">' &lt; ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'.length; ' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">'++) { if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']] === undefined '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', ' </span><span class="s0">+ (</span><span class="s2">$vSchema</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$i</span><span class="s0">) + </span><span class="s3">']) '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">') {  var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  }  '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">var </span><span class="s2">arr3 </span><span class="s0">= </span><span class="s2">$required</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr3</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">i3 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l3 </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">i3 </span><span class="s0">&lt; </span><span class="s2">l3</span><span class="s0">) {</span>
            <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">[</span><span class="s2">i3 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s1">var </span><span class="s2">$prop </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$missingProperty </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">),</span>
              <span class="s2">$useData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">$prop</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
              <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getPath</span><span class="s0">(</span><span class="s2">$currentErrorPath</span><span class="s0">, </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">jsonPointers</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if ( ' </span><span class="s0">+ (</span><span class="s2">$useData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$ownProperties</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ! Object.prototype.hasOwnProperty.call(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">', </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">escapeQuotes</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">)) + </span><span class="s3">'</span><span class="s1">\'</span><span class="s3">) '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">') {  var err =   '</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'required'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { missingProperty: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'is a required property'</span><span class="s0">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'should have required property </span><span class="s1">\\\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$missingProperty</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\\\'</span><span class="s3">'</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath </span><span class="s0">= </span><span class="s2">$currentErrorPath</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) {'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">37</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_uniqueItems</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
  <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$isData </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s2">$schema </span><span class="s0">&amp;&amp; </span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">,</span>
    <span class="s2">$schemaValue</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var schema' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getData</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">, </span><span class="s2">$dataLvl</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">)) + </span><span class="s3">'; '</span><span class="s0">;</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s3">'schema' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">$schemaValue </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">((</span><span class="s2">$schema </span><span class="s0">|| </span><span class="s2">$isData</span><span class="s0">) &amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">uniqueItems </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">'; if (' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' === false || ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' === undefined) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; else if (typeof ' </span><span class="s0">+ (</span><span class="s2">$schemaValue</span><span class="s0">) + </span><span class="s3">' != </span><span class="s1">\'</span><span class="s3">boolean</span><span class="s1">\'</span><span class="s3">) ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; else { '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var i = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length , ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true , j; if (i &gt; 1) { '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$itemType </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">items </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">items</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span>
      <span class="s2">$typeIsArray </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">$itemType</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">$itemType </span><span class="s0">|| </span><span class="s2">$itemType </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">|| </span><span class="s2">$itemType </span><span class="s0">== </span><span class="s3">'array' </span><span class="s0">|| (</span><span class="s2">$typeIsArray </span><span class="s0">&amp;&amp; (</span><span class="s2">$itemType</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">'object'</span><span class="s0">) &gt;= </span><span class="s4">0 </span><span class="s0">|| </span><span class="s2">$itemType</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">'array'</span><span class="s0">) &gt;= </span><span class="s4">0</span><span class="s0">))) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' outer: for (;i--;) { for (j = i; j--;) { if (equal(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[i], ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[j])) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; break outer; } } } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var itemIndices = {}, item; for (;i--;) { var item = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[i]; '</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$method </span><span class="s0">= </span><span class="s3">'checkDataType' </span><span class="s0">+ (</span><span class="s2">$typeIsArray </span><span class="s0">? </span><span class="s3">'s' </span><span class="s0">: </span><span class="s3">''</span><span class="s0">);</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">[</span><span class="s2">$method</span><span class="s0">](</span><span class="s2">$itemType</span><span class="s0">, </span><span class="s3">'item'</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictNumbers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">)) + </span><span class="s3">') continue; '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (typeof item == </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\'</span><span class="s3">) item = </span><span class="s1">\'</span><span class="s3">&quot;</span><span class="s1">\' </span><span class="s3">+ item; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (typeof itemIndices[item] == </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\'</span><span class="s3">) { ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; j = itemIndices[item]; break; } itemIndices[item] = i; } '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'  }  '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (!' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">') {   '</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
    <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s3">'uniqueItems'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { i: i, j: j } '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should NOT have duplicate items (items ## </span><span class="s1">\' </span><span class="s3">+ j + </span><span class="s1">\' </span><span class="s3">and </span><span class="s1">\' </span><span class="s3">+ i + </span><span class="s1">\' </span><span class="s3">are identical)</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema:  '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$isData</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">);</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$schema</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'         , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s7">/* istanbul ignore if */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (true) { '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">38</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">generate_validate</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$keyword</span><span class="s0">, </span><span class="s2">$ruleType</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$async </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">,</span>
    <span class="s2">$refKeywords </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaHasRulesExcept</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">, </span><span class="s3">'$ref'</span><span class="s0">),</span>
    <span class="s2">$id </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$unknownKwd </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">schemaUnknownRules</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$unknownKwd</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$keywordsMsg </span><span class="s0">= </span><span class="s3">'unknown keyword: ' </span><span class="s0">+ </span><span class="s2">$unknownKwd</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictKeywords </span><span class="s0">=== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">$keywordsMsg</span><span class="s0">);</span>
      <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$keywordsMsg</span><span class="s0">);</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var validate = '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) {</span>
      <span class="s2">it</span><span class="s0">.</span><span class="s2">async </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'async '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'function(data, dataPath, parentData, parentDataProperty, rootData) { </span><span class="s1">\'</span><span class="s3">use strict</span><span class="s1">\'</span><span class="s3">; '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$id </span><span class="s0">&amp;&amp; (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">sourceCode </span><span class="s0">|| </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">processCode</span><span class="s0">)) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s3">'/</span><span class="s1">\*</span><span class="s3"># sourceURL=' </span><span class="s0">+ </span><span class="s2">$id </span><span class="s0">+ </span><span class="s3">' */'</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">== </span><span class="s3">'boolean' </span><span class="s0">|| !(</span><span class="s2">$refKeywords </span><span class="s0">|| </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$ref</span><span class="s0">)) {</span>
    <span class="s1">var </span><span class="s2">$keyword </span><span class="s0">= </span><span class="s3">'false schema'</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$keyword</span><span class="s0">];</span>
    <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$keyword</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">$keyword</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">) {</span>
        <span class="s2">$breakOnError </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = false; '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
      <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
      <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'false schema'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: {} '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">boolean schema is false</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: false , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
      <span class="s0">}</span>
      <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
        <span class="s7">/* istanbul ignore if */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' return data; '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = null; return true; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }; return validate; '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">$top </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">,</span>
      <span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level </span><span class="s0">= </span><span class="s4">0</span><span class="s0">,</span>
      <span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel </span><span class="s0">= </span><span class="s4">0</span><span class="s0">,</span>
      <span class="s2">$data </span><span class="s0">= </span><span class="s3">'data'</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">rootId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">fullPath</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">root</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">));</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">|| </span><span class="s2">it</span><span class="s0">.</span><span class="s2">rootId</span><span class="s0">;</span>
    <span class="s1">delete </span><span class="s2">it</span><span class="s0">.</span><span class="s2">isTop</span><span class="s0">;</span>
    <span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr </span><span class="s0">= [</span><span class="s3">&quot;&quot;</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">default </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$defaultMsg </span><span class="s0">= </span><span class="s3">'default is ignored in the schema root'</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults </span><span class="s0">=== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
      <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var vErrors = null; '</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var errors = 0;     '</span><span class="s0">;</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (rootData === undefined) rootData = data; '</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">$lvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">level</span><span class="s0">,</span>
      <span class="s2">$dataLvl </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataLevel</span><span class="s0">,</span>
      <span class="s2">$data </span><span class="s0">= </span><span class="s3">'data' </span><span class="s0">+ (</span><span class="s2">$dataLvl </span><span class="s0">|| </span><span class="s3">''</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$id</span><span class="s0">) </span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">url</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">, </span><span class="s2">$id</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async </span><span class="s0">&amp;&amp; !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'async schema in sync schema'</span><span class="s0">);</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var errs_' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">' = errors;'</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">$valid </span><span class="s0">= </span><span class="s3">'valid' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
    <span class="s2">$breakOnError </span><span class="s0">= !</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allErrors</span><span class="s0">,</span>
    <span class="s2">$closingBraces1 </span><span class="s0">= </span><span class="s3">''</span><span class="s0">,</span>
    <span class="s2">$closingBraces2 </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$errorKeyword</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">$typeSchema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span>
    <span class="s2">$typeIsArray </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">$typeSchema</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeSchema </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">nullable </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">nullable </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">'null'</span><span class="s0">) == -</span><span class="s4">1</span><span class="s0">) </span><span class="s2">$typeSchema </span><span class="s0">= </span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s3">'null'</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$typeSchema </span><span class="s0">!= </span><span class="s3">'null'</span><span class="s0">) {</span>
      <span class="s2">$typeSchema </span><span class="s0">= [</span><span class="s2">$typeSchema</span><span class="s0">, </span><span class="s3">'null'</span><span class="s0">];</span>
      <span class="s2">$typeIsArray </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray </span><span class="s0">&amp;&amp; </span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">length </span><span class="s0">== </span><span class="s4">1</span><span class="s0">) {</span>
    <span class="s2">$typeSchema </span><span class="s0">= </span><span class="s2">$typeSchema</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span>
    <span class="s2">$typeIsArray </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$ref </span><span class="s0">&amp;&amp; </span><span class="s2">$refKeywords</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">extendRefs </span><span class="s0">== </span><span class="s3">'fail'</span><span class="s0">) {</span>
      <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'$ref: validation keywords used in schema at path &quot;' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'&quot; (see option extendRefs)'</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">extendRefs </span><span class="s0">!== </span><span class="s1">true</span><span class="s0">) {</span>
      <span class="s2">$refKeywords </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
      <span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">'$ref: keywords ignored in schema at path &quot;' </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'&quot;'</span><span class="s0">);</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$comment </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">$comment</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">.</span><span class="s2">$comment</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s3">'$comment'</span><span class="s0">));</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeSchema</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">coerceTypes</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$coerceToTypes </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">coerceToTypes</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">coerceTypes</span><span class="s0">, </span><span class="s2">$typeSchema</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">$rulesGroup </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">types</span><span class="s0">[</span><span class="s2">$typeSchema</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$coerceToTypes </span><span class="s0">|| </span><span class="s2">$typeIsArray </span><span class="s0">|| </span><span class="s2">$rulesGroup </span><span class="s0">=== </span><span class="s1">true </span><span class="s0">|| (</span><span class="s2">$rulesGroup </span><span class="s0">&amp;&amp; !</span><span class="s2">$shouldUseGroup</span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">))) {</span>
      <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.type'</span><span class="s0">,</span>
        <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/type'</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.type'</span><span class="s0">,</span>
        <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/type'</span><span class="s0">,</span>
        <span class="s2">$method </span><span class="s0">= </span><span class="s2">$typeIsArray </span><span class="s0">? </span><span class="s3">'checkDataTypes' </span><span class="s0">: </span><span class="s3">'checkDataType'</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">[</span><span class="s2">$method</span><span class="s0">](</span><span class="s2">$typeSchema</span><span class="s0">, </span><span class="s2">$data</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictNumbers</span><span class="s0">, </span><span class="s1">true</span><span class="s0">)) + </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$coerceToTypes</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">$dataType </span><span class="s0">= </span><span class="s3">'dataType' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">,</span>
          <span class="s2">$coerced </span><span class="s0">= </span><span class="s3">'coerced' </span><span class="s0">+ </span><span class="s2">$lvl</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' = typeof ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; var ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = undefined; '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">coerceTypes </span><span class="s0">== </span><span class="s3">'array'</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">object</span><span class="s1">\' </span><span class="s3">&amp;&amp; Array.isArray(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">') &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'.length == 1) { ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'[0]; ' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' = typeof ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; if (' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">checkDataType</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">type</span><span class="s0">, </span><span class="s2">$data</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictNumbers</span><span class="s0">)) + </span><span class="s3">') ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; } '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' !== undefined) ; '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">arr1 </span><span class="s0">= </span><span class="s2">$coerceToTypes</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">arr1</span><span class="s0">) {</span>
          <span class="s1">var </span><span class="s2">$type</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
            <span class="s2">l1 </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
          <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l1</span><span class="s0">) {</span>
            <span class="s2">$type </span><span class="s0">= </span><span class="s2">arr1</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else if (' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">boolean</span><span class="s1">\'</span><span class="s3">) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = </span><span class="s1">\'\' </span><span class="s3">+ ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; else if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === null) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = </span><span class="s1">\'\'</span><span class="s3">; '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'number' </span><span class="s0">|| </span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'integer'</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else if (' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">boolean</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === null || (' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\' </span><span class="s3">&amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' &amp;&amp; ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' == +' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'integer'</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' &amp;&amp; !(' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' % 1)'</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">')) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = +' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'boolean'</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === </span><span class="s1">\'</span><span class="s3">false</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === 0 || ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === null) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = false; else if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === </span><span class="s1">\'</span><span class="s3">true</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === 1) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = true; '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'null'</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else if (' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === </span><span class="s1">\'\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === 0 || ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' === false) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = null; '</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">coerceTypes </span><span class="s0">== </span><span class="s3">'array' </span><span class="s0">&amp;&amp; </span><span class="s2">$type </span><span class="s0">== </span><span class="s3">'array'</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else if (' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">string</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">number</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$dataType</span><span class="s0">) + </span><span class="s3">' == </span><span class="s1">\'</span><span class="s3">boolean</span><span class="s1">\' </span><span class="s3">|| ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' == null) ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' = [' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">']; '</span><span class="s0">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else {   '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'type'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { type: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } if (' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">' !== undefined) {  '</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">$parentData </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s3">'data' </span><span class="s0">+ ((</span><span class="s2">$dataLvl </span><span class="s0">- </span><span class="s4">1</span><span class="s0">) || </span><span class="s3">''</span><span class="s0">) : </span><span class="s3">'parentData'</span><span class="s0">,</span>
          <span class="s2">$parentDataProperty </span><span class="s0">= </span><span class="s2">$dataLvl </span><span class="s0">? </span><span class="s2">it</span><span class="s0">.</span><span class="s2">dataPathArr</span><span class="s0">[</span><span class="s2">$dataLvl</span><span class="s0">] : </span><span class="s3">'parentDataProperty'</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' = ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">'; '</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">$dataLvl</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'if (' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">' !== undefined)'</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$parentData</span><span class="s0">) + </span><span class="s3">'[' </span><span class="s0">+ (</span><span class="s2">$parentDataProperty</span><span class="s0">) + </span><span class="s3">'] = ' </span><span class="s0">+ (</span><span class="s2">$coerced</span><span class="s0">) + </span><span class="s3">'; } '</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
        <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'type'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { type: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
          <span class="s7">/* istanbul ignore if */</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
          <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
          <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$ref </span><span class="s0">&amp;&amp; !</span><span class="s2">$refKeywords</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">.</span><span class="s2">$ref</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s3">'$ref'</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } if (errors === '</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$top</span><span class="s0">) {</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'0'</span><span class="s0">;</span>
      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">out </span><span class="s0">+= </span><span class="s3">'errs_' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">);</span>
      <span class="s0">}</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { '</span><span class="s0">;</span>
      <span class="s2">$closingBraces2 </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
    <span class="s0">}</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">arr2 </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">arr2</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">$rulesGroup</span><span class="s0">, </span><span class="s2">i2 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
        <span class="s2">l2 </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
      <span class="s1">while </span><span class="s0">(</span><span class="s2">i2 </span><span class="s0">&lt; </span><span class="s2">l2</span><span class="s0">) {</span>
        <span class="s2">$rulesGroup </span><span class="s0">= </span><span class="s2">arr2</span><span class="s0">[</span><span class="s2">i2 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">$shouldUseGroup</span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">)) {</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">checkDataType</span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type</span><span class="s0">, </span><span class="s2">$data</span><span class="s0">, </span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictNumbers</span><span class="s0">)) + </span><span class="s3">') { '</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">) {</span>
              <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">,</span>
                <span class="s2">$schemaKeys </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">);</span>
              <span class="s1">var </span><span class="s2">arr3 </span><span class="s0">= </span><span class="s2">$schemaKeys</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">arr3</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">$propertyKey</span><span class="s0">, </span><span class="s2">i3 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
                  <span class="s2">l3 </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
                <span class="s1">while </span><span class="s0">(</span><span class="s2">i3 </span><span class="s0">&lt; </span><span class="s2">l3</span><span class="s0">) {</span>
                  <span class="s2">$propertyKey </span><span class="s0">= </span><span class="s2">arr3</span><span class="s0">[</span><span class="s2">i3 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
                  <span class="s1">var </span><span class="s2">$sch </span><span class="s0">= </span><span class="s2">$schema</span><span class="s0">[</span><span class="s2">$propertyKey</span><span class="s0">];</span>
                  <span class="s1">if </span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
                    <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">getProperty</span><span class="s0">(</span><span class="s2">$propertyKey</span><span class="s0">);</span>
                    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">) {</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults</span><span class="s0">) {</span>
                        <span class="s1">var </span><span class="s2">$defaultMsg </span><span class="s0">= </span><span class="s3">'default is ignored for: ' </span><span class="s0">+ </span><span class="s2">$passData</span><span class="s0">;</span>
                        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults </span><span class="s0">=== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
                        <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
                      <span class="s0">}</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">== </span><span class="s3">'empty'</span><span class="s0">) {</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === null || ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === </span><span class="s1">\'\' </span><span class="s3">'</span><span class="s0">;</span>
                      <span class="s0">}</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' = '</span><span class="s0">;</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">== </span><span class="s3">'shared'</span><span class="s0">) {</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">useDefault</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
                      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
                      <span class="s0">}</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'; '</span><span class="s0">;</span>
                    <span class="s0">}</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type </span><span class="s0">== </span><span class="s3">'array' </span><span class="s0">&amp;&amp; </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">items</span><span class="s0">)) {</span>
              <span class="s1">var </span><span class="s2">arr4 </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">items</span><span class="s0">;</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">arr4</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">$sch</span><span class="s0">, </span><span class="s2">$i </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
                  <span class="s2">l4 </span><span class="s0">= </span><span class="s2">arr4</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
                <span class="s1">while </span><span class="s0">(</span><span class="s2">$i </span><span class="s0">&lt; </span><span class="s2">l4</span><span class="s0">) {</span>
                  <span class="s2">$sch </span><span class="s0">= </span><span class="s2">arr4</span><span class="s0">[</span><span class="s2">$i </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
                  <span class="s1">if </span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
                    <span class="s1">var </span><span class="s2">$passData </span><span class="s0">= </span><span class="s2">$data </span><span class="s0">+ </span><span class="s3">'[' </span><span class="s0">+ </span><span class="s2">$i </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
                    <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule</span><span class="s0">) {</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults</span><span class="s0">) {</span>
                        <span class="s1">var </span><span class="s2">$defaultMsg </span><span class="s0">= </span><span class="s3">'default is ignored for: ' </span><span class="s0">+ </span><span class="s2">$passData</span><span class="s0">;</span>
                        <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">strictDefaults </span><span class="s0">=== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s2">it</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
                        <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">$defaultMsg</span><span class="s0">);</span>
                      <span class="s0">}</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === undefined '</span><span class="s0">;</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">== </span><span class="s3">'empty'</span><span class="s0">) {</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' || ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === null || ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' === </span><span class="s1">\'\' </span><span class="s3">'</span><span class="s0">;</span>
                      <span class="s0">}</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ) ' </span><span class="s0">+ (</span><span class="s2">$passData</span><span class="s0">) + </span><span class="s3">' = '</span><span class="s0">;</span>
                      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">useDefaults </span><span class="s0">== </span><span class="s3">'shared'</span><span class="s0">) {</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">useDefault</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
                      <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">$sch</span><span class="s0">.</span><span class="s2">default</span><span class="s0">)) + </span><span class="s3">' '</span><span class="s0">;</span>
                      <span class="s0">}</span>
                      <span class="s2">out </span><span class="s0">+= </span><span class="s3">'; '</span><span class="s0">;</span>
                    <span class="s0">}</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">var </span><span class="s2">arr5 </span><span class="s0">= </span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">;</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">arr5</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">$rule</span><span class="s0">, </span><span class="s2">i5 </span><span class="s0">= -</span><span class="s4">1</span><span class="s0">,</span>
              <span class="s2">l5 </span><span class="s0">= </span><span class="s2">arr5</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">while </span><span class="s0">(</span><span class="s2">i5 </span><span class="s0">&lt; </span><span class="s2">l5</span><span class="s0">) {</span>
              <span class="s2">$rule </span><span class="s0">= </span><span class="s2">arr5</span><span class="s0">[</span><span class="s2">i5 </span><span class="s0">+= </span><span class="s4">1</span><span class="s0">];</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">$shouldUseRule</span><span class="s0">(</span><span class="s2">$rule</span><span class="s0">)) {</span>
                <span class="s1">var </span><span class="s2">$code </span><span class="s0">= </span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s2">it</span><span class="s0">, </span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type</span><span class="s0">);</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">$code</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$code</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
                  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
                    <span class="s2">$closingBraces1 </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
                  <span class="s0">}</span>
                <span class="s0">}</span>
              <span class="s0">}</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces1</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
            <span class="s2">$closingBraces1 </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeSchema </span><span class="s0">&amp;&amp; </span><span class="s2">$typeSchema </span><span class="s0">=== </span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">type </span><span class="s0">&amp;&amp; !</span><span class="s2">$coerceToTypes</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else { '</span><span class="s0">;</span>
              <span class="s1">var </span><span class="s2">$schemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath </span><span class="s0">+ </span><span class="s3">'.type'</span><span class="s0">,</span>
                <span class="s2">$errSchemaPath </span><span class="s0">= </span><span class="s2">it</span><span class="s0">.</span><span class="s2">errSchemaPath </span><span class="s0">+ </span><span class="s3">'/type'</span><span class="s0">;</span>
              <span class="s1">var </span><span class="s2">$$outStack </span><span class="s0">= </span><span class="s2">$$outStack </span><span class="s0">|| [];</span>
              <span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">out</span><span class="s0">);</span>
              <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">; </span><span class="s7">/* istanbul ignore else */</span>
              <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">createErrors </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' { keyword: </span><span class="s1">\'</span><span class="s3">' </span><span class="s0">+ (</span><span class="s2">$errorKeyword </span><span class="s0">|| </span><span class="s3">'type'</span><span class="s0">) + </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">, dataPath: (dataPath || </span><span class="s1">\'\'</span><span class="s3">) + ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">errorPath</span><span class="s0">) + </span><span class="s3">' , schemaPath: ' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">toQuotedString</span><span class="s0">(</span><span class="s2">$errSchemaPath</span><span class="s0">)) + </span><span class="s3">' , params: { type: </span><span class="s1">\'</span><span class="s3">'</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">} '</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">messages </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , message: </span><span class="s1">\'</span><span class="s3">should be '</span><span class="s0">;</span>
                  <span class="s1">if </span><span class="s0">(</span><span class="s2">$typeIsArray</span><span class="s0">) {</span>
                    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span>
                  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s2">out </span><span class="s0">+= </span><span class="s3">'' </span><span class="s0">+ (</span><span class="s2">$typeSchema</span><span class="s0">);</span>
                  <span class="s0">}</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">'</span><span class="s1">\' </span><span class="s3">'</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">verbose</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' , schema: validate.schema' </span><span class="s0">+ (</span><span class="s2">$schemaPath</span><span class="s0">) + </span><span class="s3">' , parentSchema: validate.schema' </span><span class="s0">+ (</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schemaPath</span><span class="s0">) + </span><span class="s3">' , data: ' </span><span class="s0">+ (</span><span class="s2">$data</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' {} '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s1">var </span><span class="s2">__err </span><span class="s0">= </span><span class="s2">out</span><span class="s0">;</span>
              <span class="s2">out </span><span class="s0">= </span><span class="s2">$$outStack</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
              <span class="s1">if </span><span class="s0">(!</span><span class="s2">it</span><span class="s0">.</span><span class="s2">compositeRule </span><span class="s0">&amp;&amp; </span><span class="s2">$breakOnError</span><span class="s0">) {</span>
                <span class="s7">/* istanbul ignore if */</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">async</span><span class="s0">) {</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' throw new ValidationError([' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']); '</span><span class="s0">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                  <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = [' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">']; return false; '</span><span class="s0">;</span>
                <span class="s0">}</span>
              <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var err = ' </span><span class="s0">+ (</span><span class="s2">__err</span><span class="s0">) + </span><span class="s3">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span><span class="s0">;</span>
              <span class="s0">}</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">' } '</span><span class="s0">;</span>
            <span class="s0">}</span>
          <span class="s0">}</span>
          <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (errors === '</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">$top</span><span class="s0">) {</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'0'</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
              <span class="s2">out </span><span class="s0">+= </span><span class="s3">'errs_' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s3">') { '</span><span class="s0">;</span>
            <span class="s2">$closingBraces2 </span><span class="s0">+= </span><span class="s3">'}'</span><span class="s0">;</span>
          <span class="s0">}</span>
        <span class="s0">}</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$breakOnError</span><span class="s0">) {</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' ' </span><span class="s0">+ (</span><span class="s2">$closingBraces2</span><span class="s0">) + </span><span class="s3">' '</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$top</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">$async</span><span class="s0">) {</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' if (errors === 0) return data;           '</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' else throw new ValidationError(vErrors); '</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' validate.errors = vErrors; '</span><span class="s0">;</span>
      <span class="s2">out </span><span class="s0">+= </span><span class="s3">' return errors === 0;       '</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' }; return validate;'</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s2">out </span><span class="s0">+= </span><span class="s3">' var ' </span><span class="s0">+ (</span><span class="s2">$valid</span><span class="s0">) + </span><span class="s3">' = errors === errs_' </span><span class="s0">+ (</span><span class="s2">$lvl</span><span class="s0">) + </span><span class="s3">';'</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">$shouldUseGroup</span><span class="s0">(</span><span class="s2">$rulesGroup</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">rules </span><span class="s0">= </span><span class="s2">$rulesGroup</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">$shouldUseRule</span><span class="s0">(</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">i</span><span class="s0">])) </span><span class="s1">return true</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">$shouldUseRule</span><span class="s0">(</span><span class="s2">$rule</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">keyword</span><span class="s0">] !== </span><span class="s2">undefined </span><span class="s0">|| (</span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">implements </span><span class="s0">&amp;&amp; </span><span class="s2">$ruleImplementsSomeKeyword</span><span class="s0">(</span><span class="s2">$rule</span><span class="s0">));</span>
  <span class="s0">}</span>

  <span class="s1">function </span><span class="s2">$ruleImplementsSomeKeyword</span><span class="s0">(</span><span class="s2">$rule</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">impl </span><span class="s0">= </span><span class="s2">$rule</span><span class="s0">.</span><span class="s2">implements</span><span class="s0">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">impl</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">it</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">impl</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]] !== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s1">return true</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">out</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">39</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">IDENTIFIER </span><span class="s0">= </span><span class="s8">/^[a-z_$][a-z0-9_$-]*$/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">customRuleCode </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./dotjs/custom'</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">definitionSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./definition_schema'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= {</span>
  <span class="s2">add</span><span class="s0">: </span><span class="s2">addKeyword</span><span class="s0">,</span>
  <span class="s2">get</span><span class="s0">: </span><span class="s2">getKeyword</span><span class="s0">,</span>
  <span class="s2">remove</span><span class="s0">: </span><span class="s2">removeKeyword</span><span class="s0">,</span>
  <span class="s2">validate</span><span class="s0">: </span><span class="s2">validateKeyword</span>
<span class="s0">};</span>


<span class="s5">/**</span>
 <span class="s5">* Define custom keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">addKeyword</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">definition</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s7">/* eslint no-shadow: 0 */</span>
  <span class="s1">var </span><span class="s2">RULES </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">])</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Keyword ' </span><span class="s0">+ </span><span class="s2">keyword </span><span class="s0">+ </span><span class="s3">' is already defined'</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(!</span><span class="s2">IDENTIFIER</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">))</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Keyword ' </span><span class="s0">+ </span><span class="s2">keyword </span><span class="s0">+ </span><span class="s3">' is not a valid identifier'</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">definition</span><span class="s0">) {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">validateKeyword</span><span class="s0">(</span><span class="s2">definition</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>

    <span class="s1">var </span><span class="s2">dataType </span><span class="s0">= </span><span class="s2">definition</span><span class="s0">.</span><span class="s2">type</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">dataType</span><span class="s0">)) {</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">dataType</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
        <span class="s2">_addRule</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">dataType</span><span class="s0">[</span><span class="s2">i</span><span class="s0">], </span><span class="s2">definition</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s2">_addRule</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">dataType</span><span class="s0">, </span><span class="s2">definition</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">metaSchema </span><span class="s0">= </span><span class="s2">definition</span><span class="s0">.</span><span class="s2">metaSchema</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">definition</span><span class="s0">.</span><span class="s2">$data </span><span class="s0">&amp;&amp; </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) {</span>
        <span class="s2">metaSchema </span><span class="s0">= {</span>
          <span class="s2">anyOf</span><span class="s0">: [</span>
            <span class="s2">metaSchema</span><span class="s0">,</span>
            <span class="s0">{ </span><span class="s3">'$ref'</span><span class="s0">: </span><span class="s3">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' </span><span class="s0">}</span>
          <span class="s0">]</span>
        <span class="s0">};</span>
      <span class="s0">}</span>
      <span class="s2">definition</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
    <span class="s0">}</span>
  <span class="s0">}</span>

  <span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">] = </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">] = </span><span class="s1">true</span><span class="s0">;</span>


  <span class="s1">function </span><span class="s2">_addRule</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">, </span><span class="s2">dataType</span><span class="s0">, </span><span class="s2">definition</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">ruleGroup</span><span class="s0">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
      <span class="s1">var </span><span class="s2">rg </span><span class="s0">= </span><span class="s2">RULES</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">rg</span><span class="s0">.</span><span class="s2">type </span><span class="s0">== </span><span class="s2">dataType</span><span class="s0">) {</span>
        <span class="s2">ruleGroup </span><span class="s0">= </span><span class="s2">rg</span><span class="s0">;</span>
        <span class="s1">break</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(!</span><span class="s2">ruleGroup</span><span class="s0">) {</span>
      <span class="s2">ruleGroup </span><span class="s0">= { </span><span class="s2">type</span><span class="s0">: </span><span class="s2">dataType</span><span class="s0">, </span><span class="s2">rules</span><span class="s0">: [] };</span>
      <span class="s2">RULES</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">ruleGroup</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">rule </span><span class="s0">= {</span>
      <span class="s2">keyword</span><span class="s0">: </span><span class="s2">keyword</span><span class="s0">,</span>
      <span class="s2">definition</span><span class="s0">: </span><span class="s2">definition</span><span class="s0">,</span>
      <span class="s2">custom</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
      <span class="s2">code</span><span class="s0">: </span><span class="s2">customRuleCode</span><span class="s0">,</span>
      <span class="s1">implements</span><span class="s0">: </span><span class="s2">definition</span><span class="s0">.</span><span class="s2">implements</span>
    <span class="s0">};</span>
    <span class="s2">ruleGroup</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">rule</span><span class="s0">);</span>
    <span class="s2">RULES</span><span class="s0">.</span><span class="s2">custom</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">] = </span><span class="s2">rule</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Get keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword pre-defined or custom keyword.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">getKeyword</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">rule </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">custom</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">];</span>
  <span class="s1">return </span><span class="s2">rule </span><span class="s0">? </span><span class="s2">rule</span><span class="s0">.</span><span class="s2">definition </span><span class="s0">: </span><span class="s1">this</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">] || </span><span class="s1">false</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Remove keyword</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} keyword pre-defined or custom keyword.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">removeKeyword</span><span class="s0">(</span><span class="s2">keyword</span><span class="s0">) {</span>
  <span class="s7">/* jshint validthis: true */</span>
  <span class="s1">var </span><span class="s2">RULES </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">RULES</span><span class="s0">;</span>
  <span class="s1">delete </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">];</span>
  <span class="s1">delete </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">all</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">];</span>
  <span class="s1">delete </span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">custom</span><span class="s0">[</span><span class="s2">keyword</span><span class="s0">];</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">RULES</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s1">var </span><span class="s2">rules </span><span class="s0">= </span><span class="s2">RULES</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">rules</span><span class="s0">;</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">j</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">j</span><span class="s0">&lt;</span><span class="s2">rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">j</span><span class="s0">++) {</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">j</span><span class="s0">].</span><span class="s2">keyword </span><span class="s0">== </span><span class="s2">keyword</span><span class="s0">) {</span>
        <span class="s2">rules</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">j</span><span class="s0">, </span><span class="s4">1</span><span class="s0">);</span>
        <span class="s1">break</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Validate keyword definition</span>
 <span class="s5">* </span><span class="s6">@this  </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} definition keyword definition object.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} throwError true to throw exception if definition is invalid</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{boolean} validation result</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">validateKeyword</span><span class="s0">(</span><span class="s2">definition</span><span class="s0">, </span><span class="s2">throwError</span><span class="s0">) {</span>
  <span class="s2">validateKeyword</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">v </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_validateKeyword </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_validateKeyword</span>
                                  <span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">definitionSchema</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">v</span><span class="s0">(</span><span class="s2">definition</span><span class="s0">)) </span><span class="s1">return true</span><span class="s0">;</span>
  <span class="s2">validateKeyword</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">throwError</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'custom keyword definition is invalid: '  </span><span class="s0">+ </span><span class="s1">this</span><span class="s0">.</span><span class="s2">errorsText</span><span class="s0">(</span><span class="s2">v</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">));</span>
  <span class="s1">else</span>
    <span class="s1">return false</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s0">},{</span><span class="s3">&quot;./definition_schema&quot;</span><span class="s0">:</span><span class="s4">12</span><span class="s0">,</span><span class="s3">&quot;./dotjs/custom&quot;</span><span class="s0">:</span><span class="s4">22</span><span class="s0">}],</span><span class="s4">40</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={</span>
    <span class="s3">&quot;$schema&quot;</span><span class="s0">: </span><span class="s3">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;$id&quot;</span><span class="s0">: </span><span class="s3">&quot;https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;description&quot;</span><span class="s0">: </span><span class="s3">&quot;Meta-schema for $data reference (JSON Schema extension proposal)&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;object&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;required&quot;</span><span class="s0">: [ </span><span class="s3">&quot;$data&quot; </span><span class="s0">],</span>
    <span class="s3">&quot;properties&quot;</span><span class="s0">: {</span>
        <span class="s3">&quot;$data&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;relative-json-pointer&quot; </span><span class="s0">}, </span>
                <span class="s0">{ </span><span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;json-pointer&quot; </span><span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">}</span>
    <span class="s0">},</span>
    <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: </span><span class="s1">false</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">41</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={</span>
    <span class="s3">&quot;$schema&quot;</span><span class="s0">: </span><span class="s3">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;$id&quot;</span><span class="s0">: </span><span class="s3">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;title&quot;</span><span class="s0">: </span><span class="s3">&quot;Core schema meta-schema&quot;</span><span class="s0">,</span>
    <span class="s3">&quot;definitions&quot;</span><span class="s0">: {</span>
        <span class="s3">&quot;schemaArray&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;array&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s0">,</span>
            <span class="s3">&quot;items&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">}</span>
        <span class="s0">},</span>
        <span class="s3">&quot;nonNegativeInteger&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;integer&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;minimum&quot;</span><span class="s0">: </span><span class="s4">0</span>
        <span class="s0">},</span>
        <span class="s3">&quot;nonNegativeIntegerDefault0&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;allOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">},</span>
                <span class="s0">{ </span><span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s4">0 </span><span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">},</span>
        <span class="s3">&quot;simpleTypes&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;enum&quot;</span><span class="s0">: [</span>
                <span class="s3">&quot;array&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;boolean&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;integer&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;null&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;number&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;object&quot;</span><span class="s0">,</span>
                <span class="s3">&quot;string&quot;</span>
            <span class="s0">]</span>
        <span class="s0">},</span>
        <span class="s3">&quot;stringArray&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;array&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;items&quot;</span><span class="s0">: { </span><span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot; </span><span class="s0">},</span>
            <span class="s3">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: []</span>
        <span class="s0">}</span>
    <span class="s0">},</span>
    <span class="s3">&quot;type&quot;</span><span class="s0">: [</span><span class="s3">&quot;object&quot;</span><span class="s0">, </span><span class="s3">&quot;boolean&quot;</span><span class="s0">],</span>
    <span class="s3">&quot;properties&quot;</span><span class="s0">: {</span>
        <span class="s3">&quot;$id&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;uri-reference&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;$schema&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;uri&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;$ref&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;uri-reference&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;$comment&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;title&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;description&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
        <span class="s3">&quot;readOnly&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s1">false</span>
        <span class="s0">},</span>
        <span class="s3">&quot;examples&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;array&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;items&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">},</span>
        <span class="s3">&quot;multipleOf&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;number&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;exclusiveMinimum&quot;</span><span class="s0">: </span><span class="s4">0</span>
        <span class="s0">},</span>
        <span class="s3">&quot;maximum&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;number&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;exclusiveMaximum&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;number&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;minimum&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;number&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;exclusiveMinimum&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;number&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;maxLength&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;minLength&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;pattern&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;regex&quot;</span>
        <span class="s0">},</span>
        <span class="s3">&quot;additionalItems&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;items&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
                <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/schemaArray&quot; </span><span class="s0">}</span>
            <span class="s0">],</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">},</span>
        <span class="s3">&quot;maxItems&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;minItems&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;uniqueItems&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s1">false</span>
        <span class="s0">},</span>
        <span class="s3">&quot;contains&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;maxProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeInteger&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;minProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/nonNegativeIntegerDefault0&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;required&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/stringArray&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;definitions&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;object&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">},</span>
        <span class="s3">&quot;properties&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;object&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">},</span>
        <span class="s3">&quot;patternProperties&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;object&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
            <span class="s3">&quot;propertyNames&quot;</span><span class="s0">: { </span><span class="s3">&quot;format&quot;</span><span class="s0">: </span><span class="s3">&quot;regex&quot; </span><span class="s0">},</span>
            <span class="s3">&quot;default&quot;</span><span class="s0">: {}</span>
        <span class="s0">},</span>
        <span class="s3">&quot;dependencies&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;object&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;additionalProperties&quot;</span><span class="s0">: {</span>
                <span class="s3">&quot;anyOf&quot;</span><span class="s0">: [</span>
                    <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
                    <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/stringArray&quot; </span><span class="s0">}</span>
                <span class="s0">]</span>
            <span class="s0">}</span>
        <span class="s0">},</span>
        <span class="s3">&quot;propertyNames&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;const&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
        <span class="s3">&quot;enum&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;array&quot;</span><span class="s0">,</span>
            <span class="s3">&quot;items&quot;</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
            <span class="s3">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s0">,</span>
            <span class="s3">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">},</span>
        <span class="s3">&quot;type&quot;</span><span class="s0">: {</span>
            <span class="s3">&quot;anyOf&quot;</span><span class="s0">: [</span>
                <span class="s0">{ </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/simpleTypes&quot; </span><span class="s0">},</span>
                <span class="s0">{</span>
                    <span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;array&quot;</span><span class="s0">,</span>
                    <span class="s3">&quot;items&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/simpleTypes&quot; </span><span class="s0">},</span>
                    <span class="s3">&quot;minItems&quot;</span><span class="s0">: </span><span class="s4">1</span><span class="s0">,</span>
                    <span class="s3">&quot;uniqueItems&quot;</span><span class="s0">: </span><span class="s1">true</span>
                <span class="s0">}</span>
            <span class="s0">]</span>
        <span class="s0">},</span>
        <span class="s3">&quot;format&quot;</span><span class="s0">: { </span><span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;contentMediaType&quot;</span><span class="s0">: { </span><span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;contentEncoding&quot;</span><span class="s0">: { </span><span class="s3">&quot;type&quot;</span><span class="s0">: </span><span class="s3">&quot;string&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;if&quot;</span><span class="s0">: {</span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot;</span><span class="s0">},</span>
        <span class="s3">&quot;then&quot;</span><span class="s0">: {</span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot;</span><span class="s0">},</span>
        <span class="s3">&quot;else&quot;</span><span class="s0">: {</span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot;</span><span class="s0">},</span>
        <span class="s3">&quot;allOf&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/schemaArray&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;anyOf&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/schemaArray&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;oneOf&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#/definitions/schemaArray&quot; </span><span class="s0">},</span>
        <span class="s3">&quot;not&quot;</span><span class="s0">: { </span><span class="s3">&quot;$ref&quot;</span><span class="s0">: </span><span class="s3">&quot;#&quot; </span><span class="s0">}</span>
    <span class="s0">},</span>
    <span class="s3">&quot;default&quot;</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">42</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s7">// do not edit .js files directly - edit src/index.jst</span>



<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s2">equal</span><span class="s0">(</span><span class="s2">a</span><span class="s0">, </span><span class="s2">b</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">a </span><span class="s0">=== </span><span class="s2">b</span><span class="s0">) </span><span class="s1">return true</span><span class="s0">;</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">a </span><span class="s0">&amp;&amp; </span><span class="s2">b </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">a </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">b </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">constructor </span><span class="s0">!== </span><span class="s2">b</span><span class="s0">.</span><span class="s2">constructor</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>

    <span class="s1">var </span><span class="s2">length</span><span class="s0">, </span><span class="s2">i</span><span class="s0">, </span><span class="s2">keys</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)) {</span>
      <span class="s2">length </span><span class="s0">= </span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">length </span><span class="s0">!= </span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s2">i </span><span class="s0">= </span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">-- !== </span><span class="s4">0</span><span class="s0">;)</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">equal</span><span class="s0">(</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">], </span><span class="s2">b</span><span class="s0">[</span><span class="s2">i</span><span class="s0">])) </span><span class="s1">return false</span><span class="s0">;</span>
      <span class="s1">return true</span><span class="s0">;</span>
    <span class="s0">}</span>



    <span class="s1">if </span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">constructor </span><span class="s0">=== </span><span class="s2">RegExp</span><span class="s0">) </span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">source </span><span class="s0">=== </span><span class="s2">b</span><span class="s0">.</span><span class="s2">source </span><span class="s0">&amp;&amp; </span><span class="s2">a</span><span class="s0">.</span><span class="s2">flags </span><span class="s0">=== </span><span class="s2">b</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">valueOf </span><span class="s0">!== </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">valueOf</span><span class="s0">) </span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">valueOf</span><span class="s0">() === </span><span class="s2">b</span><span class="s0">.</span><span class="s2">valueOf</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">toString </span><span class="s0">!== </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">) </span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">() === </span><span class="s2">b</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span>

    <span class="s2">keys </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">a</span><span class="s0">);</span>
    <span class="s2">length </span><span class="s0">= </span><span class="s2">keys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">length </span><span class="s0">!== </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">b</span><span class="s0">).</span><span class="s2">length</span><span class="s0">) </span><span class="s1">return false</span><span class="s0">;</span>

    <span class="s1">for </span><span class="s0">(</span><span class="s2">i </span><span class="s0">= </span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">-- !== </span><span class="s4">0</span><span class="s0">;)</span>
      <span class="s1">if </span><span class="s0">(!</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">b</span><span class="s0">, </span><span class="s2">keys</span><span class="s0">[</span><span class="s2">i</span><span class="s0">])) </span><span class="s1">return false</span><span class="s0">;</span>

    <span class="s1">for </span><span class="s0">(</span><span class="s2">i </span><span class="s0">= </span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">-- !== </span><span class="s4">0</span><span class="s0">;) {</span>
      <span class="s1">var </span><span class="s2">key </span><span class="s0">= </span><span class="s2">keys</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>

      <span class="s1">if </span><span class="s0">(!</span><span class="s2">equal</span><span class="s0">(</span><span class="s2">a</span><span class="s0">[</span><span class="s2">key</span><span class="s0">], </span><span class="s2">b</span><span class="s0">[</span><span class="s2">key</span><span class="s0">])) </span><span class="s1">return false</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">return true</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s7">// true if both NaN, false otherwise</span>
  <span class="s1">return </span><span class="s2">a</span><span class="s0">!==</span><span class="s2">a </span><span class="s0">&amp;&amp; </span><span class="s2">b</span><span class="s0">!==</span><span class="s2">b</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s0">},{}],</span><span class="s4">43</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">data</span><span class="s0">, </span><span class="s2">opts</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">opts</span><span class="s0">) </span><span class="s2">opts </span><span class="s0">= {};</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">opts </span><span class="s0">=== </span><span class="s3">'function'</span><span class="s0">) </span><span class="s2">opts </span><span class="s0">= { </span><span class="s2">cmp</span><span class="s0">: </span><span class="s2">opts </span><span class="s0">};</span>
    <span class="s1">var </span><span class="s2">cycles </span><span class="s0">= (</span><span class="s1">typeof </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cycles </span><span class="s0">=== </span><span class="s3">'boolean'</span><span class="s0">) ? </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cycles </span><span class="s0">: </span><span class="s1">false</span><span class="s0">;</span>

    <span class="s1">var </span><span class="s2">cmp </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cmp </span><span class="s0">&amp;&amp; (</span><span class="s1">function </span><span class="s0">(</span><span class="s2">f</span><span class="s0">) {</span>
        <span class="s1">return function </span><span class="s0">(</span><span class="s2">node</span><span class="s0">) {</span>
            <span class="s1">return function </span><span class="s0">(</span><span class="s2">a</span><span class="s0">, </span><span class="s2">b</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">aobj </span><span class="s0">= { </span><span class="s2">key</span><span class="s0">: </span><span class="s2">a</span><span class="s0">, </span><span class="s2">value</span><span class="s0">: </span><span class="s2">node</span><span class="s0">[</span><span class="s2">a</span><span class="s0">] };</span>
                <span class="s1">var </span><span class="s2">bobj </span><span class="s0">= { </span><span class="s2">key</span><span class="s0">: </span><span class="s2">b</span><span class="s0">, </span><span class="s2">value</span><span class="s0">: </span><span class="s2">node</span><span class="s0">[</span><span class="s2">b</span><span class="s0">] };</span>
                <span class="s1">return </span><span class="s2">f</span><span class="s0">(</span><span class="s2">aobj</span><span class="s0">, </span><span class="s2">bobj</span><span class="s0">);</span>
            <span class="s0">};</span>
        <span class="s0">};</span>
    <span class="s0">})(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cmp</span><span class="s0">);</span>

    <span class="s1">var </span><span class="s2">seen </span><span class="s0">= [];</span>
    <span class="s1">return </span><span class="s0">(</span><span class="s1">function </span><span class="s2">stringify </span><span class="s0">(</span><span class="s2">node</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">node </span><span class="s0">&amp;&amp; </span><span class="s2">node</span><span class="s0">.</span><span class="s2">toJSON </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">node</span><span class="s0">.</span><span class="s2">toJSON </span><span class="s0">=== </span><span class="s3">'function'</span><span class="s0">) {</span>
            <span class="s2">node </span><span class="s0">= </span><span class="s2">node</span><span class="s0">.</span><span class="s2">toJSON</span><span class="s0">();</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">node </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">node </span><span class="s0">== </span><span class="s3">'number'</span><span class="s0">) </span><span class="s1">return </span><span class="s2">isFinite</span><span class="s0">(</span><span class="s2">node</span><span class="s0">) ? </span><span class="s3">'' </span><span class="s0">+ </span><span class="s2">node </span><span class="s0">: </span><span class="s3">'null'</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">node </span><span class="s0">!== </span><span class="s3">'object'</span><span class="s0">) </span><span class="s1">return </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">node</span><span class="s0">);</span>

        <span class="s1">var </span><span class="s2">i</span><span class="s0">, </span><span class="s2">out</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">node</span><span class="s0">)) {</span>
            <span class="s2">out </span><span class="s0">= </span><span class="s3">'['</span><span class="s0">;</span>
            <span class="s1">for </span><span class="s0">(</span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">node</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">i</span><span class="s0">) </span><span class="s2">out </span><span class="s0">+= </span><span class="s3">','</span><span class="s0">;</span>
                <span class="s2">out </span><span class="s0">+= </span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">node</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]) || </span><span class="s3">'null'</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s1">return </span><span class="s2">out </span><span class="s0">+ </span><span class="s3">']'</span><span class="s0">;</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">node </span><span class="s0">=== </span><span class="s1">null</span><span class="s0">) </span><span class="s1">return </span><span class="s3">'null'</span><span class="s0">;</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">seen</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">node</span><span class="s0">) !== -</span><span class="s4">1</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">cycles</span><span class="s0">) </span><span class="s1">return </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s3">'__cycle__'</span><span class="s0">);</span>
            <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'Converting circular structure to JSON'</span><span class="s0">);</span>
        <span class="s0">}</span>

        <span class="s1">var </span><span class="s2">seenIndex </span><span class="s0">= </span><span class="s2">seen</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">node</span><span class="s0">) - </span><span class="s4">1</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">keys </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">node</span><span class="s0">).</span><span class="s2">sort</span><span class="s0">(</span><span class="s2">cmp </span><span class="s0">&amp;&amp; </span><span class="s2">cmp</span><span class="s0">(</span><span class="s2">node</span><span class="s0">));</span>
        <span class="s2">out </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">keys</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
            <span class="s1">var </span><span class="s2">key </span><span class="s0">= </span><span class="s2">keys</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
            <span class="s1">var </span><span class="s2">value </span><span class="s0">= </span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">node</span><span class="s0">[</span><span class="s2">key</span><span class="s0">]);</span>

            <span class="s1">if </span><span class="s0">(!</span><span class="s2">value</span><span class="s0">) </span><span class="s1">continue</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">out</span><span class="s0">) </span><span class="s2">out </span><span class="s0">+= </span><span class="s3">','</span><span class="s0">;</span>
            <span class="s2">out </span><span class="s0">+= </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">key</span><span class="s0">) + </span><span class="s3">':' </span><span class="s0">+ </span><span class="s2">value</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">seen</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">seenIndex</span><span class="s0">, </span><span class="s4">1</span><span class="s0">);</span>
        <span class="s1">return </span><span class="s3">'{' </span><span class="s0">+ </span><span class="s2">out </span><span class="s0">+ </span><span class="s3">'}'</span><span class="s0">;</span>
    <span class="s0">})(</span><span class="s2">data</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s0">},{}],</span><span class="s4">44</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">traverse </span><span class="s0">= </span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">opts</span><span class="s0">, </span><span class="s2">cb</span><span class="s0">) {</span>
  <span class="s7">// Legacy support for v0.3.1 and earlier.</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">opts </span><span class="s0">== </span><span class="s3">'function'</span><span class="s0">) {</span>
    <span class="s2">cb </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">;</span>
    <span class="s2">opts </span><span class="s0">= {};</span>
  <span class="s0">}</span>

  <span class="s2">cb </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cb </span><span class="s0">|| </span><span class="s2">cb</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">pre </span><span class="s0">= (</span><span class="s1">typeof </span><span class="s2">cb </span><span class="s0">== </span><span class="s3">'function'</span><span class="s0">) ? </span><span class="s2">cb </span><span class="s0">: </span><span class="s2">cb</span><span class="s0">.</span><span class="s2">pre </span><span class="s0">|| </span><span class="s1">function</span><span class="s0">() {};</span>
  <span class="s1">var </span><span class="s2">post </span><span class="s0">= </span><span class="s2">cb</span><span class="s0">.</span><span class="s2">post </span><span class="s0">|| </span><span class="s1">function</span><span class="s0">() {};</span>

  <span class="s2">_traverse</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">, </span><span class="s2">pre</span><span class="s0">, </span><span class="s2">post</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s3">''</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">);</span>
<span class="s0">};</span>


<span class="s2">traverse</span><span class="s0">.</span><span class="s2">keywords </span><span class="s0">= {</span>
  <span class="s2">additionalItems</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">items</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">contains</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">additionalProperties</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">propertyNames</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">not</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">};</span>

<span class="s2">traverse</span><span class="s0">.</span><span class="s2">arrayKeywords </span><span class="s0">= {</span>
  <span class="s2">items</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">allOf</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">anyOf</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">oneOf</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">};</span>

<span class="s2">traverse</span><span class="s0">.</span><span class="s2">propsKeywords </span><span class="s0">= {</span>
  <span class="s2">definitions</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">properties</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">patternProperties</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">dependencies</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">};</span>

<span class="s2">traverse</span><span class="s0">.</span><span class="s2">skipKeywords </span><span class="s0">= {</span>
  <span class="s1">default</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s1">enum</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s1">const</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">required</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">maximum</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">minimum</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">exclusiveMaximum</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">exclusiveMinimum</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">multipleOf</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">maxLength</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">minLength</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">pattern</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">format</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">maxItems</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">minItems</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">uniqueItems</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">maxProperties</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
  <span class="s2">minProperties</span><span class="s0">: </span><span class="s1">true</span>
<span class="s0">};</span>


<span class="s1">function </span><span class="s2">_traverse</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">, </span><span class="s2">pre</span><span class="s0">, </span><span class="s2">post</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">parentJsonPtr</span><span class="s0">, </span><span class="s2">parentKeyword</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">keyIndex</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; !</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">)) {</span>
    <span class="s2">pre</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">parentJsonPtr</span><span class="s0">, </span><span class="s2">parentKeyword</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">keyIndex</span><span class="s0">);</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">schema</span><span class="s0">) {</span>
      <span class="s1">var </span><span class="s2">sch </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">sch</span><span class="s0">)) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">key </span><span class="s1">in </span><span class="s2">traverse</span><span class="s0">.</span><span class="s2">arrayKeywords</span><span class="s0">) {</span>
          <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">sch</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
            <span class="s2">_traverse</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">, </span><span class="s2">pre</span><span class="s0">, </span><span class="s2">post</span><span class="s0">, </span><span class="s2">sch</span><span class="s0">[</span><span class="s2">i</span><span class="s0">], </span><span class="s2">jsonPtr </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">key </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">i</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">i</span><span class="s0">);</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">key </span><span class="s1">in </span><span class="s2">traverse</span><span class="s0">.</span><span class="s2">propsKeywords</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">sch </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">sch </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) {</span>
          <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">prop </span><span class="s1">in </span><span class="s2">sch</span><span class="s0">)</span>
            <span class="s2">_traverse</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">, </span><span class="s2">pre</span><span class="s0">, </span><span class="s2">post</span><span class="s0">, </span><span class="s2">sch</span><span class="s0">[</span><span class="s2">prop</span><span class="s0">], </span><span class="s2">jsonPtr </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">key </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">escapeJsonPtr</span><span class="s0">(</span><span class="s2">prop</span><span class="s0">), </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">prop</span><span class="s0">);</span>
        <span class="s0">}</span>
      <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">key </span><span class="s1">in </span><span class="s2">traverse</span><span class="s0">.</span><span class="s2">keywords </span><span class="s0">|| (</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">allKeys </span><span class="s0">&amp;&amp; !(</span><span class="s2">key </span><span class="s1">in </span><span class="s2">traverse</span><span class="s0">.</span><span class="s2">skipKeywords</span><span class="s0">))) {</span>
        <span class="s2">_traverse</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">, </span><span class="s2">pre</span><span class="s0">, </span><span class="s2">post</span><span class="s0">, </span><span class="s2">sch</span><span class="s0">, </span><span class="s2">jsonPtr </span><span class="s0">+ </span><span class="s3">'/' </span><span class="s0">+ </span><span class="s2">key</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">);</span>
      <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s2">post</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">jsonPtr</span><span class="s0">, </span><span class="s2">rootSchema</span><span class="s0">, </span><span class="s2">parentJsonPtr</span><span class="s0">, </span><span class="s2">parentKeyword</span><span class="s0">, </span><span class="s2">parentSchema</span><span class="s0">, </span><span class="s2">keyIndex</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">escapeJsonPtr</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
  <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/~/g</span><span class="s0">, </span><span class="s3">'~0'</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/\//g</span><span class="s0">, </span><span class="s3">'~1'</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s0">},{}],</span><span class="s4">45</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s5">/** </span><span class="s6">@license </span><span class="s5">URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */</span>
<span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">global</span><span class="s0">, </span><span class="s2">factory</span><span class="s0">) {</span>
	<span class="s1">typeof </span><span class="s2">exports </span><span class="s0">=== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">module </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">? </span><span class="s2">factory</span><span class="s0">(</span><span class="s2">exports</span><span class="s0">) :</span>
	<span class="s1">typeof </span><span class="s2">define </span><span class="s0">=== </span><span class="s3">'function' </span><span class="s0">&amp;&amp; </span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd </span><span class="s0">? </span><span class="s2">define</span><span class="s0">([</span><span class="s3">'exports'</span><span class="s0">], </span><span class="s2">factory</span><span class="s0">) :</span>
	<span class="s0">(</span><span class="s2">factory</span><span class="s0">((</span><span class="s2">global</span><span class="s0">.</span><span class="s2">URI </span><span class="s0">= </span><span class="s2">global</span><span class="s0">.</span><span class="s2">URI </span><span class="s0">|| {})));</span>
<span class="s0">}(</span><span class="s1">this</span><span class="s0">, (</span><span class="s1">function </span><span class="s0">(</span><span class="s2">exports</span><span class="s0">) { </span><span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">function </span><span class="s2">merge</span><span class="s0">() {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_len </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">, </span><span class="s2">sets </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">_len</span><span class="s0">), </span><span class="s2">_key </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">_key </span><span class="s0">&lt; </span><span class="s2">_len</span><span class="s0">; </span><span class="s2">_key</span><span class="s0">++) {</span>
        <span class="s2">sets</span><span class="s0">[</span><span class="s2">_key</span><span class="s0">] = </span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">_key</span><span class="s0">];</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">sets</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">1</span><span class="s0">) {</span>
        <span class="s2">sets</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] = </span><span class="s2">sets</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, -</span><span class="s4">1</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">xl </span><span class="s0">= </span><span class="s2">sets</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">x </span><span class="s0">= </span><span class="s4">1</span><span class="s0">; </span><span class="s2">x </span><span class="s0">&lt; </span><span class="s2">xl</span><span class="s0">; ++</span><span class="s2">x</span><span class="s0">) {</span>
            <span class="s2">sets</span><span class="s0">[</span><span class="s2">x</span><span class="s0">] = </span><span class="s2">sets</span><span class="s0">[</span><span class="s2">x</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">, -</span><span class="s4">1</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s2">sets</span><span class="s0">[</span><span class="s2">xl</span><span class="s0">] = </span><span class="s2">sets</span><span class="s0">[</span><span class="s2">xl</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span>
        <span class="s1">return </span><span class="s2">sets</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">''</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s2">sets</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s3">&quot;(?:&quot; </span><span class="s0">+ </span><span class="s2">str </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">typeOf</span><span class="s0">(</span><span class="s2">o</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">o </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s3">&quot;undefined&quot; </span><span class="s0">: </span><span class="s2">o </span><span class="s0">=== </span><span class="s1">null </span><span class="s0">? </span><span class="s3">&quot;null&quot; </span><span class="s0">: </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">o</span><span class="s0">).</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot; &quot;</span><span class="s0">).</span><span class="s2">pop</span><span class="s0">().</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;]&quot;</span><span class="s0">).</span><span class="s2">shift</span><span class="s0">().</span><span class="s2">toLowerCase</span><span class="s0">();</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">toUpperCase</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">();</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">toArray</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">obj </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">obj </span><span class="s0">!== </span><span class="s1">null </span><span class="s0">? </span><span class="s2">obj </span><span class="s1">instanceof </span><span class="s2">Array </span><span class="s0">? </span><span class="s2">obj </span><span class="s0">: </span><span class="s1">typeof </span><span class="s2">obj</span><span class="s0">.</span><span class="s2">length </span><span class="s0">!== </span><span class="s3">&quot;number&quot; </span><span class="s0">|| </span><span class="s2">obj</span><span class="s0">.</span><span class="s2">split </span><span class="s0">|| </span><span class="s2">obj</span><span class="s0">.</span><span class="s2">setInterval </span><span class="s0">|| </span><span class="s2">obj</span><span class="s0">.</span><span class="s2">call </span><span class="s0">? [</span><span class="s2">obj</span><span class="s0">] : </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">obj</span><span class="s0">) : [];</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">assign</span><span class="s0">(</span><span class="s2">target</span><span class="s0">, </span><span class="s2">source</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">obj </span><span class="s0">= </span><span class="s2">target</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">source</span><span class="s0">) {</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">source</span><span class="s0">) {</span>
            <span class="s2">obj</span><span class="s0">[</span><span class="s2">key</span><span class="s0">] = </span><span class="s2">source</span><span class="s0">[</span><span class="s2">key</span><span class="s0">];</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">obj</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">buildExps</span><span class="s0">(</span><span class="s2">isIRI</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">ALPHA$$ </span><span class="s0">= </span><span class="s3">&quot;[A-Za-z]&quot;</span><span class="s0">,</span>
        <span class="s2">CR$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">x0D]&quot;</span><span class="s0">,</span>
        <span class="s2">DIGIT$$ </span><span class="s0">= </span><span class="s3">&quot;[0-9]&quot;</span><span class="s0">,</span>
        <span class="s2">DQUOTE$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">x22]&quot;</span><span class="s0">,</span>
        <span class="s2">HEXDIG$$ </span><span class="s0">= </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">DIGIT$$</span><span class="s0">, </span><span class="s3">&quot;[A-Fa-f]&quot;</span><span class="s0">),</span>
        <span class="s7">//case-insensitive</span>
    <span class="s2">LF$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">x0A]&quot;</span><span class="s0">,</span>
        <span class="s2">SP$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">x20]&quot;</span><span class="s0">,</span>
        <span class="s2">PCT_ENCODED$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%[EFef]&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%[89A-Fa-f]&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">)),</span>
        <span class="s7">//expanded</span>
    <span class="s2">GEN_DELIMS$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?</span><span class="s1">\\</span><span class="s3">#</span><span class="s1">\\</span><span class="s3">[</span><span class="s1">\\</span><span class="s3">]</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">,</span>
        <span class="s2">SUB_DELIMS$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">!</span><span class="s1">\\</span><span class="s3">$</span><span class="s1">\\</span><span class="s3">&amp;</span><span class="s1">\\</span><span class="s3">'</span><span class="s1">\\</span><span class="s3">(</span><span class="s1">\\</span><span class="s3">)</span><span class="s1">\\</span><span class="s3">*</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">,</span><span class="s1">\\</span><span class="s3">;</span><span class="s1">\\</span><span class="s3">=]&quot;</span><span class="s0">,</span>
        <span class="s2">RESERVED$$ </span><span class="s0">= </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">GEN_DELIMS$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">),</span>
        <span class="s2">UCSCHAR$$ </span><span class="s0">= </span><span class="s2">isIRI </span><span class="s0">? </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">xA0-</span><span class="s1">\\</span><span class="s3">u200D</span><span class="s1">\\</span><span class="s3">u2010-</span><span class="s1">\\</span><span class="s3">u2029</span><span class="s1">\\</span><span class="s3">u202F-</span><span class="s1">\\</span><span class="s3">uD7FF</span><span class="s1">\\</span><span class="s3">uF900-</span><span class="s1">\\</span><span class="s3">uFDCF</span><span class="s1">\\</span><span class="s3">uFDF0-</span><span class="s1">\\</span><span class="s3">uFFEF]&quot; </span><span class="s0">: </span><span class="s3">&quot;[]&quot;</span><span class="s0">,</span>
        <span class="s7">//subset, excludes bidi control characters</span>
    <span class="s2">IPRIVATE$$ </span><span class="s0">= </span><span class="s2">isIRI </span><span class="s0">? </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">uE000-</span><span class="s1">\\</span><span class="s3">uF8FF]&quot; </span><span class="s0">: </span><span class="s3">&quot;[]&quot;</span><span class="s0">,</span>
        <span class="s7">//subset</span>
    <span class="s2">UNRESERVED$$ </span><span class="s0">= </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">ALPHA$$</span><span class="s0">, </span><span class="s2">DIGIT$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">.</span><span class="s1">\\</span><span class="s3">_</span><span class="s1">\\</span><span class="s3">~]&quot;</span><span class="s0">, </span><span class="s2">UCSCHAR$$</span><span class="s0">),</span>
        <span class="s2">SCHEME$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">ALPHA$$ </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">ALPHA$$</span><span class="s0">, </span><span class="s2">DIGIT$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">.]&quot;</span><span class="s0">) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">USERINFO$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:]&quot;</span><span class="s0">)) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">DEC_OCTET$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;25[0-5]&quot;</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;2[0-4]&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;1&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$ </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;[1-9]&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">),</span>
        <span class="s2">DEC_OCTET_RELAXED$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;25[0-5]&quot;</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;2[0-4]&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;1&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$ </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;0?[1-9]&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">) + </span><span class="s3">&quot;|0?0?&quot; </span><span class="s0">+ </span><span class="s2">DIGIT$$</span><span class="s0">),</span>
        <span class="s7">//relaxed parsing rules</span>
    <span class="s2">IPV4ADDRESS$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">DEC_OCTET_RELAXED$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">.&quot; </span><span class="s0">+ </span><span class="s2">DEC_OCTET_RELAXED$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">.&quot; </span><span class="s0">+ </span><span class="s2">DEC_OCTET_RELAXED$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">.&quot; </span><span class="s0">+ </span><span class="s2">DEC_OCTET_RELAXED$</span><span class="s0">),</span>
        <span class="s2">H16$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;{1,4}&quot;</span><span class="s0">),</span>
        <span class="s2">LS32$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">IPV4ADDRESS$</span><span class="s0">),</span>
        <span class="s2">IPV6ADDRESS1$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{6}&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//                           6( h16 &quot;:&quot; ) ls32</span>
    <span class="s2">IPV6ADDRESS2$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{5}&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//                      &quot;::&quot; 5( h16 &quot;:&quot; ) ls32</span>
    <span class="s2">IPV6ADDRESS3$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{4}&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//[               h16 ] &quot;::&quot; 4( h16 &quot;:&quot; ) ls32</span>
    <span class="s2">IPV6ADDRESS4$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,1}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{3}&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//[ *1( h16 &quot;:&quot; ) h16 ] &quot;::&quot; 3( h16 &quot;:&quot; ) ls32</span>
    <span class="s2">IPV6ADDRESS5$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,2}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{2}&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//[ *2( h16 &quot;:&quot; ) h16 ] &quot;::&quot; 2( h16 &quot;:&quot; ) ls32</span>
    <span class="s2">IPV6ADDRESS6$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,3}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//[ *3( h16 &quot;:&quot; ) h16 ] &quot;::&quot;    h16 &quot;:&quot;   ls32</span>
    <span class="s2">IPV6ADDRESS7$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,4}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">LS32$</span><span class="s0">),</span>
        <span class="s7">//[ *4( h16 &quot;:&quot; ) h16 ] &quot;::&quot;              ls32</span>
    <span class="s2">IPV6ADDRESS8$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,5}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">),</span>
        <span class="s7">//[ *5( h16 &quot;:&quot; ) h16 ] &quot;::&quot;              h16</span>
    <span class="s2">IPV6ADDRESS9$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">H16$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">) + </span><span class="s3">&quot;{0,6}&quot; </span><span class="s0">+ </span><span class="s2">H16$</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">:&quot;</span><span class="s0">),</span>
        <span class="s7">//[ *6( h16 &quot;:&quot; ) h16 ] &quot;::&quot;</span>
    <span class="s2">IPV6ADDRESS$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">([</span><span class="s2">IPV6ADDRESS1$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS2$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS3$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS4$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS5$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS6$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS7$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS8$</span><span class="s0">, </span><span class="s2">IPV6ADDRESS9$</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;|&quot;</span><span class="s0">)),</span>
        <span class="s2">ZONEID$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">UNRESERVED$$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PCT_ENCODED$</span><span class="s0">) + </span><span class="s3">&quot;+&quot;</span><span class="s0">),</span>
        <span class="s7">//RFC 6874</span>
    <span class="s2">IPV6ADDRZ$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">IPV6ADDRESS$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">%25&quot; </span><span class="s0">+ </span><span class="s2">ZONEID$</span><span class="s0">),</span>
        <span class="s7">//RFC 6874</span>
    <span class="s2">IPV6ADDRZ_RELAXED$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">IPV6ADDRESS$ </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">%25|</span><span class="s1">\\</span><span class="s3">%(?!&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;{2})&quot;</span><span class="s0">) + </span><span class="s2">ZONEID$</span><span class="s0">),</span>
        <span class="s7">//RFC 6874, with relaxed parsing rules</span>
    <span class="s2">IPVFUTURE$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;[vV]&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;+</span><span class="s1">\\</span><span class="s3">.&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:]&quot;</span><span class="s0">) + </span><span class="s3">&quot;+&quot;</span><span class="s0">),</span>
        <span class="s2">IP_LITERAL$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">[&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">IPV6ADDRZ_RELAXED$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">IPV6ADDRESS$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">IPVFUTURE$</span><span class="s0">) + </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">]&quot;</span><span class="s0">),</span>
        <span class="s7">//RFC 6874</span>
    <span class="s2">REG_NAME$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">)) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">HOST$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">IP_LITERAL$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">IPV4ADDRESS$ </span><span class="s0">+ </span><span class="s3">&quot;(?!&quot; </span><span class="s0">+ </span><span class="s2">REG_NAME$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">REG_NAME$</span><span class="s0">),</span>
        <span class="s2">PORT$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">DIGIT$$ </span><span class="s0">+ </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">AUTHORITY$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">USERINFO$ </span><span class="s0">+ </span><span class="s3">&quot;@&quot;</span><span class="s0">) + </span><span class="s3">&quot;?&quot; </span><span class="s0">+ </span><span class="s2">HOST$ </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">PORT$</span><span class="s0">) + </span><span class="s3">&quot;?&quot;</span><span class="s0">),</span>
        <span class="s2">PCHAR$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">)),</span>
        <span class="s2">SEGMENT$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCHAR$ </span><span class="s0">+ </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">SEGMENT_NZ$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCHAR$ </span><span class="s0">+ </span><span class="s3">&quot;+&quot;</span><span class="s0">),</span>
        <span class="s2">SEGMENT_NZ_NC$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">)) + </span><span class="s3">&quot;+&quot;</span><span class="s0">),</span>
        <span class="s2">PATH_ABEMPTY$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/&quot; </span><span class="s0">+ </span><span class="s2">SEGMENT$</span><span class="s0">) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">PATH_ABSOLUTE$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">SEGMENT_NZ$ </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$</span><span class="s0">) + </span><span class="s3">&quot;?&quot;</span><span class="s0">),</span>
        <span class="s7">//simplified</span>
    <span class="s2">PATH_NOSCHEME$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">SEGMENT_NZ_NC$ </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$</span><span class="s0">),</span>
        <span class="s7">//simplified</span>
    <span class="s2">PATH_ROOTLESS$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">SEGMENT_NZ$ </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$</span><span class="s0">),</span>
        <span class="s7">//simplified</span>
    <span class="s2">PATH_EMPTY$ </span><span class="s0">= </span><span class="s3">&quot;(?!&quot; </span><span class="s0">+ </span><span class="s2">PCHAR$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">,</span>
        <span class="s2">PATH$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PATH_ABEMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_NOSCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ROOTLESS$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$</span><span class="s0">),</span>
        <span class="s2">QUERY$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCHAR$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]&quot;</span><span class="s0">, </span><span class="s2">IPRIVATE$$</span><span class="s0">)) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">FRAGMENT$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">PCHAR$ </span><span class="s0">+ </span><span class="s3">&quot;|[</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]&quot;</span><span class="s0">) + </span><span class="s3">&quot;*&quot;</span><span class="s0">),</span>
        <span class="s2">HIER_PART$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot; </span><span class="s0">+ </span><span class="s2">AUTHORITY$ </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ROOTLESS$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$</span><span class="s0">),</span>
        <span class="s2">URI$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">SCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">HIER_PART$ </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?&quot; </span><span class="s0">+ </span><span class="s2">QUERY$</span><span class="s0">) + </span><span class="s3">&quot;?&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">#&quot; </span><span class="s0">+ </span><span class="s2">FRAGMENT$</span><span class="s0">) + </span><span class="s3">&quot;?&quot;</span><span class="s0">),</span>
        <span class="s2">RELATIVE_PART$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot; </span><span class="s0">+ </span><span class="s2">AUTHORITY$ </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_NOSCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$</span><span class="s0">),</span>
        <span class="s2">RELATIVE$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">RELATIVE_PART$ </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?&quot; </span><span class="s0">+ </span><span class="s2">QUERY$</span><span class="s0">) + </span><span class="s3">&quot;?&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">#&quot; </span><span class="s0">+ </span><span class="s2">FRAGMENT$</span><span class="s0">) + </span><span class="s3">&quot;?&quot;</span><span class="s0">),</span>
        <span class="s2">URI_REFERENCE$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">URI$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">RELATIVE$</span><span class="s0">),</span>
        <span class="s2">ABSOLUTE_URI$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">SCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">HIER_PART$ </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?&quot; </span><span class="s0">+ </span><span class="s2">QUERY$</span><span class="s0">) + </span><span class="s3">&quot;?&quot;</span><span class="s0">),</span>
        <span class="s2">GENERIC_REF$ </span><span class="s0">= </span><span class="s3">&quot;^(&quot; </span><span class="s0">+ </span><span class="s2">SCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;)</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/(&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;(&quot; </span><span class="s0">+ </span><span class="s2">USERINFO$ </span><span class="s0">+ </span><span class="s3">&quot;)@&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">HOST$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:(&quot; </span><span class="s0">+ </span><span class="s2">PORT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ROOTLESS$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?(&quot; </span><span class="s0">+ </span><span class="s2">QUERY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">#(&quot; </span><span class="s0">+ </span><span class="s2">FRAGMENT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?$&quot;</span><span class="s0">,</span>
        <span class="s2">RELATIVE_REF$ </span><span class="s0">= </span><span class="s3">&quot;^(){0}&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/(&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;(&quot; </span><span class="s0">+ </span><span class="s2">USERINFO$ </span><span class="s0">+ </span><span class="s3">&quot;)@&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">HOST$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:(&quot; </span><span class="s0">+ </span><span class="s2">PORT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_NOSCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?(&quot; </span><span class="s0">+ </span><span class="s2">QUERY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">#(&quot; </span><span class="s0">+ </span><span class="s2">FRAGMENT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?$&quot;</span><span class="s0">,</span>
        <span class="s2">ABSOLUTE_REF$ </span><span class="s0">= </span><span class="s3">&quot;^(&quot; </span><span class="s0">+ </span><span class="s2">SCHEME$ </span><span class="s0">+ </span><span class="s3">&quot;)</span><span class="s1">\\</span><span class="s3">:&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/(&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;(&quot; </span><span class="s0">+ </span><span class="s2">USERINFO$ </span><span class="s0">+ </span><span class="s3">&quot;)@&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">HOST$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:(&quot; </span><span class="s0">+ </span><span class="s2">PORT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABEMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ABSOLUTE$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_ROOTLESS$ </span><span class="s0">+ </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">PATH_EMPTY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">?(&quot; </span><span class="s0">+ </span><span class="s2">QUERY$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?$&quot;</span><span class="s0">,</span>
        <span class="s2">SAMEDOC_REF$ </span><span class="s0">= </span><span class="s3">&quot;^&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">#(&quot; </span><span class="s0">+ </span><span class="s2">FRAGMENT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?$&quot;</span><span class="s0">,</span>
        <span class="s2">AUTHORITY_REF$ </span><span class="s0">= </span><span class="s3">&quot;^&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;(&quot; </span><span class="s0">+ </span><span class="s2">USERINFO$ </span><span class="s0">+ </span><span class="s3">&quot;)@&quot;</span><span class="s0">) + </span><span class="s3">&quot;?(&quot; </span><span class="s0">+ </span><span class="s2">HOST$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">:(&quot; </span><span class="s0">+ </span><span class="s2">PORT$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?$&quot;</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s0">{</span>
        <span class="s2">NOT_SCHEME</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^]&quot;</span><span class="s0">, </span><span class="s2">ALPHA$$</span><span class="s0">, </span><span class="s2">DIGIT$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">.]&quot;</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_USERINFO</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">:]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_HOST</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">[</span><span class="s1">\\</span><span class="s3">]</span><span class="s1">\\</span><span class="s3">:]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_PATH</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_PATH_NOSCHEME</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_QUERY</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">@</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]&quot;</span><span class="s0">, </span><span class="s2">IPRIVATE$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">NOT_FRAGMENT</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">@</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]&quot;</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">ESCAPE</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SUB_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">UNRESERVED</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">OTHER_CHARS</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^</span><span class="s1">\\</span><span class="s3">%]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">RESERVED$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">PCT_ENCODED</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$</span><span class="s0">, </span><span class="s3">&quot;g&quot;</span><span class="s0">),</span>
        <span class="s2">IPV4ADDRESS</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">&quot;^(&quot; </span><span class="s0">+ </span><span class="s2">IPV4ADDRESS$ </span><span class="s0">+ </span><span class="s3">&quot;)$&quot;</span><span class="s0">),</span>
        <span class="s2">IPV6ADDRESS</span><span class="s0">: </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">&quot;^</span><span class="s1">\\</span><span class="s3">[?(&quot; </span><span class="s0">+ </span><span class="s2">IPV6ADDRESS$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">%25|</span><span class="s1">\\</span><span class="s3">%(?!&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;{2})&quot;</span><span class="s0">) + </span><span class="s3">&quot;(&quot; </span><span class="s0">+ </span><span class="s2">ZONEID$ </span><span class="s0">+ </span><span class="s3">&quot;)&quot;</span><span class="s0">) + </span><span class="s3">&quot;?</span><span class="s1">\\</span><span class="s3">]?$&quot;</span><span class="s0">) </span><span class="s7">//RFC 6874, with relaxed parsing rules</span>
    <span class="s0">};</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s2">URI_PROTOCOL </span><span class="s0">= </span><span class="s2">buildExps</span><span class="s0">(</span><span class="s1">false</span><span class="s0">);</span>

<span class="s1">var </span><span class="s2">IRI_PROTOCOL </span><span class="s0">= </span><span class="s2">buildExps</span><span class="s0">(</span><span class="s1">true</span><span class="s0">);</span>

<span class="s1">var </span><span class="s2">slicedToArray </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
  <span class="s1">function </span><span class="s2">sliceIterator</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">, </span><span class="s2">i</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">_arr </span><span class="s0">= [];</span>
    <span class="s1">var </span><span class="s2">_n </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">_d </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">_e </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>

    <span class="s1">try </span><span class="s0">{</span>
      <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_i </span><span class="s0">= </span><span class="s2">arr</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">](), </span><span class="s2">_s</span><span class="s0">; !(</span><span class="s2">_n </span><span class="s0">= (</span><span class="s2">_s </span><span class="s0">= </span><span class="s2">_i</span><span class="s0">.</span><span class="s2">next</span><span class="s0">()).</span><span class="s2">done</span><span class="s0">); </span><span class="s2">_n </span><span class="s0">= </span><span class="s1">true</span><span class="s0">) {</span>
        <span class="s2">_arr</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">_s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">i </span><span class="s0">&amp;&amp; </span><span class="s2">_arr</span><span class="s0">.</span><span class="s2">length </span><span class="s0">=== </span><span class="s2">i</span><span class="s0">) </span><span class="s1">break</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">err</span><span class="s0">) {</span>
      <span class="s2">_d </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
      <span class="s2">_e </span><span class="s0">= </span><span class="s2">err</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
      <span class="s1">try </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">_n </span><span class="s0">&amp;&amp; </span><span class="s2">_i</span><span class="s0">[</span><span class="s3">&quot;return&quot;</span><span class="s0">]) </span><span class="s2">_i</span><span class="s0">[</span><span class="s3">&quot;return&quot;</span><span class="s0">]();</span>
      <span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">_d</span><span class="s0">) </span><span class="s1">throw </span><span class="s2">_e</span><span class="s0">;</span>
      <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">_arr</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">return function </span><span class="s0">(</span><span class="s2">arr</span><span class="s0">, </span><span class="s2">i</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">)) {</span>
      <span class="s1">return </span><span class="s2">arr</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator </span><span class="s1">in </span><span class="s2">Object</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">)) {</span>
      <span class="s1">return </span><span class="s2">sliceIterator</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">, </span><span class="s2">i</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
      <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">&quot;Invalid attempt to destructure non-iterable instance&quot;</span><span class="s0">);</span>
    <span class="s0">}</span>
  <span class="s0">};</span>
<span class="s0">}();</span>













<span class="s1">var </span><span class="s2">toConsumableArray </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">arr</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">)) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">arr2 </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">); </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">arr</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) </span><span class="s2">arr2</span><span class="s0">[</span><span class="s2">i</span><span class="s0">] = </span><span class="s2">arr</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>

    <span class="s1">return </span><span class="s2">arr2</span><span class="s0">;</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">return </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">};</span>

<span class="s5">/** Highest positive signed 32-bit float value */</span>

<span class="s1">var </span><span class="s2">maxInt </span><span class="s0">= </span><span class="s4">2147483647</span><span class="s0">; </span><span class="s7">// aka. 0x7FFFFFFF or 2^31-1</span>

<span class="s5">/** Bootstring parameters */</span>
<span class="s1">var </span><span class="s2">base </span><span class="s0">= </span><span class="s4">36</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">tMin </span><span class="s0">= </span><span class="s4">1</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">tMax </span><span class="s0">= </span><span class="s4">26</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">skew </span><span class="s0">= </span><span class="s4">38</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">damp </span><span class="s0">= </span><span class="s4">700</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">initialBias </span><span class="s0">= </span><span class="s4">72</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">initialN </span><span class="s0">= </span><span class="s4">128</span><span class="s0">; </span><span class="s7">// 0x80</span>
<span class="s1">var </span><span class="s2">delimiter </span><span class="s0">= </span><span class="s3">'-'</span><span class="s0">; </span><span class="s7">// '\x2D'</span>

<span class="s5">/** Regular expressions */</span>
<span class="s1">var </span><span class="s2">regexPunycode </span><span class="s0">= </span><span class="s8">/^xn--/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">regexNonASCII </span><span class="s0">= </span><span class="s8">/[^\0-\x7E]/</span><span class="s0">; </span><span class="s7">// non-ASCII chars</span>
<span class="s1">var </span><span class="s2">regexSeparators </span><span class="s0">= </span><span class="s8">/[\x2E\u3002\uFF0E\uFF61]/g</span><span class="s0">; </span><span class="s7">// RFC 3490 separators</span>

<span class="s5">/** Error messages */</span>
<span class="s1">var </span><span class="s2">errors </span><span class="s0">= {</span>
	<span class="s3">'overflow'</span><span class="s0">: </span><span class="s3">'Overflow: input needs wider integers to process'</span><span class="s0">,</span>
	<span class="s3">'not-basic'</span><span class="s0">: </span><span class="s3">'Illegal input &gt;= 0x80 (not a basic code point)'</span><span class="s0">,</span>
	<span class="s3">'invalid-input'</span><span class="s0">: </span><span class="s3">'Invalid input'</span>
<span class="s0">};</span>

<span class="s5">/** Convenience shortcuts */</span>
<span class="s1">var </span><span class="s2">baseMinusTMin </span><span class="s0">= </span><span class="s2">base </span><span class="s0">- </span><span class="s2">tMin</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">floor </span><span class="s0">= </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">stringFromCharCode </span><span class="s0">= </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">;</span>

<span class="s7">/*--------------------------------------------------------------------------*/</span>

<span class="s5">/**</span>
 <span class="s5">* A generic error utility function.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} type The error type.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Error} Throws a `RangeError` with the applicable error message.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">error$1</span><span class="s0">(</span><span class="s2">type</span><span class="s0">) {</span>
	<span class="s1">throw new </span><span class="s2">RangeError</span><span class="s0">(</span><span class="s2">errors</span><span class="s0">[</span><span class="s2">type</span><span class="s0">]);</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* A generic `Array#map` utility function.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Array} array The array to iterate over.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback The function that gets called for every array</span>
 <span class="s5">* item.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} A new array of values returned by the callback function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">map</span><span class="s0">(</span><span class="s2">array</span><span class="s0">, </span><span class="s2">fn</span><span class="s0">) {</span>
	<span class="s1">var </span><span class="s2">result </span><span class="s0">= [];</span>
	<span class="s1">var </span><span class="s2">length </span><span class="s0">= </span><span class="s2">array</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
	<span class="s1">while </span><span class="s0">(</span><span class="s2">length</span><span class="s0">--) {</span>
		<span class="s2">result</span><span class="s0">[</span><span class="s2">length</span><span class="s0">] = </span><span class="s2">fn</span><span class="s0">(</span><span class="s2">array</span><span class="s0">[</span><span class="s2">length</span><span class="s0">]);</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s2">result</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* A simple `Array#map`-like wrapper to work with domain name strings or email</span>
 <span class="s5">* addresses.</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} domain The domain name or email address.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Function} callback The function that gets called for every</span>
 <span class="s5">* character.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} A new string of characters returned by the callback</span>
 <span class="s5">* function.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">mapDomain</span><span class="s0">(</span><span class="s2">string</span><span class="s0">, </span><span class="s2">fn</span><span class="s0">) {</span>
	<span class="s1">var </span><span class="s2">parts </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'@'</span><span class="s0">);</span>
	<span class="s1">var </span><span class="s2">result </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">parts</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">1</span><span class="s0">) {</span>
		<span class="s7">// In email addresses, only the domain name should be punycoded. Leave</span>
		<span class="s7">// the local part (i.e. everything up to `@`) intact.</span>
		<span class="s2">result </span><span class="s0">= </span><span class="s2">parts</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] + </span><span class="s3">'@'</span><span class="s0">;</span>
		<span class="s2">string </span><span class="s0">= </span><span class="s2">parts</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>
	<span class="s0">}</span>
	<span class="s7">// Avoid `split(regex)` for IE8 compatibility. See #17.</span>
	<span class="s2">string </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">regexSeparators</span><span class="s0">, </span><span class="s3">'</span><span class="s1">\x2E</span><span class="s3">'</span><span class="s0">);</span>
	<span class="s1">var </span><span class="s2">labels </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'.'</span><span class="s0">);</span>
	<span class="s1">var </span><span class="s2">encoded </span><span class="s0">= </span><span class="s2">map</span><span class="s0">(</span><span class="s2">labels</span><span class="s0">, </span><span class="s2">fn</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">'.'</span><span class="s0">);</span>
	<span class="s1">return </span><span class="s2">result </span><span class="s0">+ </span><span class="s2">encoded</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* Creates an array containing the numeric code points of each Unicode</span>
 <span class="s5">* character in the string. While JavaScript uses UCS-2 internally,</span>
 <span class="s5">* this function will convert a pair of surrogate halves (each of which</span>
 <span class="s5">* UCS-2 exposes as separate characters) into a single code point,</span>
 <span class="s5">* matching UTF-16.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`punycode.ucs2.encode`</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode.ucs2</span>
 <span class="s5">* </span><span class="s6">@name </span><span class="s5">decode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} string The Unicode input string (UCS-2).</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Array} The new array of code points.</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">ucs2decode</span><span class="s0">(</span><span class="s2">string</span><span class="s0">) {</span>
	<span class="s1">var </span><span class="s2">output </span><span class="s0">= [];</span>
	<span class="s1">var </span><span class="s2">counter </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">length </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
	<span class="s1">while </span><span class="s0">(</span><span class="s2">counter </span><span class="s0">&lt; </span><span class="s2">length</span><span class="s0">) {</span>
		<span class="s1">var </span><span class="s2">value </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">counter</span><span class="s0">++);</span>
		<span class="s1">if </span><span class="s0">(</span><span class="s2">value </span><span class="s0">&gt;= </span><span class="s4">0xD800 </span><span class="s0">&amp;&amp; </span><span class="s2">value </span><span class="s0">&lt;= </span><span class="s4">0xDBFF </span><span class="s0">&amp;&amp; </span><span class="s2">counter </span><span class="s0">&lt; </span><span class="s2">length</span><span class="s0">) {</span>
			<span class="s7">// It's a high surrogate, and there is a next character.</span>
			<span class="s1">var </span><span class="s2">extra </span><span class="s0">= </span><span class="s2">string</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">counter</span><span class="s0">++);</span>
			<span class="s1">if </span><span class="s0">((</span><span class="s2">extra </span><span class="s0">&amp; </span><span class="s4">0xFC00</span><span class="s0">) == </span><span class="s4">0xDC00</span><span class="s0">) {</span>
				<span class="s7">// Low surrogate.</span>
				<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(((</span><span class="s2">value </span><span class="s0">&amp; </span><span class="s4">0x3FF</span><span class="s0">) &lt;&lt; </span><span class="s4">10</span><span class="s0">) + (</span><span class="s2">extra </span><span class="s0">&amp; </span><span class="s4">0x3FF</span><span class="s0">) + </span><span class="s4">0x10000</span><span class="s0">);</span>
			<span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
				<span class="s7">// It's an unmatched surrogate; only append this code unit, in case the</span>
				<span class="s7">// next code unit is the high surrogate of a surrogate pair.</span>
				<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
				<span class="s2">counter</span><span class="s0">--;</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
			<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
		<span class="s0">}</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s2">output</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s5">/**</span>
 <span class="s5">* Creates a string based on an array of numeric code points.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`punycode.ucs2.decode`</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode.ucs2</span>
 <span class="s5">* </span><span class="s6">@name </span><span class="s5">encode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Array} codePoints The array of numeric code points.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The new Unicode string (UCS-2).</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">ucs2encode </span><span class="s0">= </span><span class="s1">function </span><span class="s2">ucs2encode</span><span class="s0">(</span><span class="s2">array</span><span class="s0">) {</span>
	<span class="s1">return </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCodePoint</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">String</span><span class="s0">, </span><span class="s2">toConsumableArray</span><span class="s0">(</span><span class="s2">array</span><span class="s0">));</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a basic code point into a digit/integer.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`digitToBasic()`</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Number} codePoint The basic numeric code point value.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Number} The numeric value of a basic code point (for use in</span>
 <span class="s5">* representing integers) in the range `0` to `base - 1`, or `base` if</span>
 <span class="s5">* the code point does not represent a value.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">basicToDigit </span><span class="s0">= </span><span class="s1">function </span><span class="s2">basicToDigit</span><span class="s0">(</span><span class="s2">codePoint</span><span class="s0">) {</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x30 </span><span class="s0">&lt; </span><span class="s4">0x0A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x16</span><span class="s0">;</span>
	<span class="s0">}</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x41 </span><span class="s0">&lt; </span><span class="s4">0x1A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x41</span><span class="s0">;</span>
	<span class="s0">}</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x61 </span><span class="s0">&lt; </span><span class="s4">0x1A</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s2">codePoint </span><span class="s0">- </span><span class="s4">0x61</span><span class="s0">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s2">base</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a digit/integer into a basic code point.</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">`basicToDigit()`</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Number} digit The numeric value of a basic code point.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{Number} The basic code point whose value (when used for</span>
 <span class="s5">* representing integers) is `digit`, which needs to be in the range</span>
 <span class="s5">* `0` to `base - 1`. If `flag` is non-zero, the uppercase form is</span>
 <span class="s5">* used; else, the lowercase form is used. The behavior is undefined</span>
 <span class="s5">* if `flag` is non-zero and `digit` has no uppercase form.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">digitToBasic </span><span class="s0">= </span><span class="s1">function </span><span class="s2">digitToBasic</span><span class="s0">(</span><span class="s2">digit</span><span class="s0">, </span><span class="s2">flag</span><span class="s0">) {</span>
	<span class="s7">//  0..25 map to ASCII a..z or A..Z</span>
	<span class="s7">// 26..35 map to ASCII 0..9</span>
	<span class="s1">return </span><span class="s2">digit </span><span class="s0">+ </span><span class="s4">22 </span><span class="s0">+ </span><span class="s4">75 </span><span class="s0">* (</span><span class="s2">digit </span><span class="s0">&lt; </span><span class="s4">26</span><span class="s0">) - ((</span><span class="s2">flag </span><span class="s0">!= </span><span class="s4">0</span><span class="s0">) &lt;&lt; </span><span class="s4">5</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Bias adaptation function as per section 3.4 of RFC 3492.</span>
 <span class="s5">* https://tools.ietf.org/html/rfc3492#section-3.4</span>
 <span class="s5">* </span><span class="s6">@private</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">adapt </span><span class="s0">= </span><span class="s1">function </span><span class="s2">adapt</span><span class="s0">(</span><span class="s2">delta</span><span class="s0">, </span><span class="s2">numPoints</span><span class="s0">, </span><span class="s2">firstTime</span><span class="s0">) {</span>
	<span class="s1">var </span><span class="s2">k </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
	<span class="s2">delta </span><span class="s0">= </span><span class="s2">firstTime </span><span class="s0">? </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">delta </span><span class="s0">/ </span><span class="s2">damp</span><span class="s0">) : </span><span class="s2">delta </span><span class="s0">&gt;&gt; </span><span class="s4">1</span><span class="s0">;</span>
	<span class="s2">delta </span><span class="s0">+= </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">delta </span><span class="s0">/ </span><span class="s2">numPoints</span><span class="s0">);</span>
	<span class="s1">for </span><span class="s0">(; </span><span class="s7">/* no initialization */</span><span class="s2">delta </span><span class="s0">&gt; </span><span class="s2">baseMinusTMin </span><span class="s0">* </span><span class="s2">tMax </span><span class="s0">&gt;&gt; </span><span class="s4">1</span><span class="s0">; </span><span class="s2">k </span><span class="s0">+= </span><span class="s2">base</span><span class="s0">) {</span>
		<span class="s2">delta </span><span class="s0">= </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">delta </span><span class="s0">/ </span><span class="s2">baseMinusTMin</span><span class="s0">);</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">k </span><span class="s0">+ (</span><span class="s2">baseMinusTMin </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">) * </span><span class="s2">delta </span><span class="s0">/ (</span><span class="s2">delta </span><span class="s0">+ </span><span class="s2">skew</span><span class="s0">));</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Punycode string of ASCII-only symbols to a string of Unicode</span>
 <span class="s5">* symbols.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The Punycode string of ASCII-only symbols.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The resulting string of Unicode symbols.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">decode </span><span class="s0">= </span><span class="s1">function </span><span class="s2">decode</span><span class="s0">(</span><span class="s2">input</span><span class="s0">) {</span>
	<span class="s7">// Don't use UCS-2.</span>
	<span class="s1">var </span><span class="s2">output </span><span class="s0">= [];</span>
	<span class="s1">var </span><span class="s2">inputLength </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">n </span><span class="s0">= </span><span class="s2">initialN</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">bias </span><span class="s0">= </span><span class="s2">initialBias</span><span class="s0">;</span>

	<span class="s7">// Handle the basic code points: let `basic` be the number of input code</span>
	<span class="s7">// points before the last delimiter, or `0` if there is none, then copy</span>
	<span class="s7">// the first basic code points to the output.</span>

	<span class="s1">var </span><span class="s2">basic </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">lastIndexOf</span><span class="s0">(</span><span class="s2">delimiter</span><span class="s0">);</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">basic </span><span class="s0">&lt; </span><span class="s4">0</span><span class="s0">) {</span>
		<span class="s2">basic </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
	<span class="s0">}</span>

	<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">j </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">j </span><span class="s0">&lt; </span><span class="s2">basic</span><span class="s0">; ++</span><span class="s2">j</span><span class="s0">) {</span>
		<span class="s7">// if it's not a basic code point</span>
		<span class="s1">if </span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">j</span><span class="s0">) &gt;= </span><span class="s4">0x80</span><span class="s0">) {</span>
			<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'not-basic'</span><span class="s0">);</span>
		<span class="s0">}</span>
		<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">j</span><span class="s0">));</span>
	<span class="s0">}</span>

	<span class="s7">// Main decoding loop: start just after the last delimiter if any basic code</span>
	<span class="s7">// points were copied; start at the beginning otherwise.</span>

	<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">basic </span><span class="s0">&gt; </span><span class="s4">0 </span><span class="s0">? </span><span class="s2">basic </span><span class="s0">+ </span><span class="s4">1 </span><span class="s0">: </span><span class="s4">0</span><span class="s0">; </span><span class="s2">index </span><span class="s0">&lt; </span><span class="s2">inputLength</span><span class="s0">;) </span><span class="s7">/* no final expression */</span><span class="s0">{</span>

		<span class="s7">// `index` is the index of the next character to be consumed.</span>
		<span class="s7">// Decode a generalized variable-length integer into `delta`,</span>
		<span class="s7">// which gets added to `i`. The overflow checking is easier</span>
		<span class="s7">// if we increase `i` as we go, then subtract off its starting</span>
		<span class="s7">// value at the end to obtain `delta`.</span>
		<span class="s1">var </span><span class="s2">oldi </span><span class="s0">= </span><span class="s2">i</span><span class="s0">;</span>
		<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">w </span><span class="s0">= </span><span class="s4">1</span><span class="s0">, </span><span class="s2">k </span><span class="s0">= </span><span class="s2">base</span><span class="s0">;; </span><span class="s7">/* no condition */</span><span class="s2">k </span><span class="s0">+= </span><span class="s2">base</span><span class="s0">) {</span>

			<span class="s1">if </span><span class="s0">(</span><span class="s2">index </span><span class="s0">&gt;= </span><span class="s2">inputLength</span><span class="s0">) {</span>
				<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'invalid-input'</span><span class="s0">);</span>
			<span class="s0">}</span>

			<span class="s1">var </span><span class="s2">digit </span><span class="s0">= </span><span class="s2">basicToDigit</span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">index</span><span class="s0">++));</span>

			<span class="s1">if </span><span class="s0">(</span><span class="s2">digit </span><span class="s0">&gt;= </span><span class="s2">base </span><span class="s0">|| </span><span class="s2">digit </span><span class="s0">&gt; </span><span class="s2">floor</span><span class="s0">((</span><span class="s2">maxInt </span><span class="s0">- </span><span class="s2">i</span><span class="s0">) / </span><span class="s2">w</span><span class="s0">)) {</span>
				<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'overflow'</span><span class="s0">);</span>
			<span class="s0">}</span>

			<span class="s2">i </span><span class="s0">+= </span><span class="s2">digit </span><span class="s0">* </span><span class="s2">w</span><span class="s0">;</span>
			<span class="s1">var </span><span class="s2">t </span><span class="s0">= </span><span class="s2">k </span><span class="s0">&lt;= </span><span class="s2">bias </span><span class="s0">? </span><span class="s2">tMin </span><span class="s0">: </span><span class="s2">k </span><span class="s0">&gt;= </span><span class="s2">bias </span><span class="s0">+ </span><span class="s2">tMax </span><span class="s0">? </span><span class="s2">tMax </span><span class="s0">: </span><span class="s2">k </span><span class="s0">- </span><span class="s2">bias</span><span class="s0">;</span>

			<span class="s1">if </span><span class="s0">(</span><span class="s2">digit </span><span class="s0">&lt; </span><span class="s2">t</span><span class="s0">) {</span>
				<span class="s1">break</span><span class="s0">;</span>
			<span class="s0">}</span>

			<span class="s1">var </span><span class="s2">baseMinusT </span><span class="s0">= </span><span class="s2">base </span><span class="s0">- </span><span class="s2">t</span><span class="s0">;</span>
			<span class="s1">if </span><span class="s0">(</span><span class="s2">w </span><span class="s0">&gt; </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">maxInt </span><span class="s0">/ </span><span class="s2">baseMinusT</span><span class="s0">)) {</span>
				<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'overflow'</span><span class="s0">);</span>
			<span class="s0">}</span>

			<span class="s2">w </span><span class="s0">*= </span><span class="s2">baseMinusT</span><span class="s0">;</span>
		<span class="s0">}</span>

		<span class="s1">var </span><span class="s2">out </span><span class="s0">= </span><span class="s2">output</span><span class="s0">.</span><span class="s2">length </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s2">bias </span><span class="s0">= </span><span class="s2">adapt</span><span class="s0">(</span><span class="s2">i </span><span class="s0">- </span><span class="s2">oldi</span><span class="s0">, </span><span class="s2">out</span><span class="s0">, </span><span class="s2">oldi </span><span class="s0">== </span><span class="s4">0</span><span class="s0">);</span>

		<span class="s7">// `i` was supposed to wrap around from `out` to `0`,</span>
		<span class="s7">// incrementing `n` each time, so we'll fix that now:</span>
		<span class="s1">if </span><span class="s0">(</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">i </span><span class="s0">/ </span><span class="s2">out</span><span class="s0">) &gt; </span><span class="s2">maxInt </span><span class="s0">- </span><span class="s2">n</span><span class="s0">) {</span>
			<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'overflow'</span><span class="s0">);</span>
		<span class="s0">}</span>

		<span class="s2">n </span><span class="s0">+= </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">i </span><span class="s0">/ </span><span class="s2">out</span><span class="s0">);</span>
		<span class="s2">i </span><span class="s0">%= </span><span class="s2">out</span><span class="s0">;</span>

		<span class="s7">// Insert `n` at position `i` of the output.</span>
		<span class="s2">output</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">++, </span><span class="s4">0</span><span class="s0">, </span><span class="s2">n</span><span class="s0">);</span>
	<span class="s0">}</span>

	<span class="s1">return </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCodePoint</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">String</span><span class="s0">, </span><span class="s2">output</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a string of Unicode symbols (e.g. a domain name label) to a</span>
 <span class="s5">* Punycode string of ASCII-only symbols.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The string of Unicode symbols.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The resulting Punycode string of ASCII-only symbols.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">encode </span><span class="s0">= </span><span class="s1">function </span><span class="s2">encode</span><span class="s0">(</span><span class="s2">input</span><span class="s0">) {</span>
	<span class="s1">var </span><span class="s2">output </span><span class="s0">= [];</span>

	<span class="s7">// Convert the input in UCS-2 to an array of Unicode code points.</span>
	<span class="s2">input </span><span class="s0">= </span><span class="s2">ucs2decode</span><span class="s0">(</span><span class="s2">input</span><span class="s0">);</span>

	<span class="s7">// Cache the length.</span>
	<span class="s1">var </span><span class="s2">inputLength </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>

	<span class="s7">// Initialize the state.</span>
	<span class="s1">var </span><span class="s2">n </span><span class="s0">= </span><span class="s2">initialN</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">delta </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">bias </span><span class="s0">= </span><span class="s2">initialBias</span><span class="s0">;</span>

	<span class="s7">// Handle the basic code points.</span>
	<span class="s1">var </span><span class="s2">_iteratorNormalCompletion </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">_didIteratorError </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">_iteratorError </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>

	<span class="s1">try </span><span class="s0">{</span>
		<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_iterator </span><span class="s0">= </span><span class="s2">input</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">](), </span><span class="s2">_step</span><span class="s0">; !(</span><span class="s2">_iteratorNormalCompletion </span><span class="s0">= (</span><span class="s2">_step </span><span class="s0">= </span><span class="s2">_iterator</span><span class="s0">.</span><span class="s2">next</span><span class="s0">()).</span><span class="s2">done</span><span class="s0">); </span><span class="s2">_iteratorNormalCompletion </span><span class="s0">= </span><span class="s1">true</span><span class="s0">) {</span>
			<span class="s1">var </span><span class="s2">_currentValue2 </span><span class="s0">= </span><span class="s2">_step</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span>

			<span class="s1">if </span><span class="s0">(</span><span class="s2">_currentValue2 </span><span class="s0">&lt; </span><span class="s4">0x80</span><span class="s0">) {</span>
				<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">stringFromCharCode</span><span class="s0">(</span><span class="s2">_currentValue2</span><span class="s0">));</span>
			<span class="s0">}</span>
		<span class="s0">}</span>
	<span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">err</span><span class="s0">) {</span>
		<span class="s2">_didIteratorError </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
		<span class="s2">_iteratorError </span><span class="s0">= </span><span class="s2">err</span><span class="s0">;</span>
	<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">if </span><span class="s0">(!</span><span class="s2">_iteratorNormalCompletion </span><span class="s0">&amp;&amp; </span><span class="s2">_iterator</span><span class="s0">.</span><span class="s2">return</span><span class="s0">) {</span>
				<span class="s2">_iterator</span><span class="s0">.</span><span class="s2">return</span><span class="s0">();</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">if </span><span class="s0">(</span><span class="s2">_didIteratorError</span><span class="s0">) {</span>
				<span class="s1">throw </span><span class="s2">_iteratorError</span><span class="s0">;</span>
			<span class="s0">}</span>
		<span class="s0">}</span>
	<span class="s0">}</span>

	<span class="s1">var </span><span class="s2">basicLength </span><span class="s0">= </span><span class="s2">output</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
	<span class="s1">var </span><span class="s2">handledCPCount </span><span class="s0">= </span><span class="s2">basicLength</span><span class="s0">;</span>

	<span class="s7">// `handledCPCount` is the number of code points that have been handled;</span>
	<span class="s7">// `basicLength` is the number of basic code points.</span>

	<span class="s7">// Finish the basic string with a delimiter unless it's empty.</span>
	<span class="s1">if </span><span class="s0">(</span><span class="s2">basicLength</span><span class="s0">) {</span>
		<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">delimiter</span><span class="s0">);</span>
	<span class="s0">}</span>

	<span class="s7">// Main encoding loop:</span>
	<span class="s1">while </span><span class="s0">(</span><span class="s2">handledCPCount </span><span class="s0">&lt; </span><span class="s2">inputLength</span><span class="s0">) {</span>

		<span class="s7">// All non-basic code points &lt; n have been handled already. Find the next</span>
		<span class="s7">// larger one:</span>
		<span class="s1">var </span><span class="s2">m </span><span class="s0">= </span><span class="s2">maxInt</span><span class="s0">;</span>
		<span class="s1">var </span><span class="s2">_iteratorNormalCompletion2 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
		<span class="s1">var </span><span class="s2">_didIteratorError2 </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
		<span class="s1">var </span><span class="s2">_iteratorError2 </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>

		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_iterator2 </span><span class="s0">= </span><span class="s2">input</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">](), </span><span class="s2">_step2</span><span class="s0">; !(</span><span class="s2">_iteratorNormalCompletion2 </span><span class="s0">= (</span><span class="s2">_step2 </span><span class="s0">= </span><span class="s2">_iterator2</span><span class="s0">.</span><span class="s2">next</span><span class="s0">()).</span><span class="s2">done</span><span class="s0">); </span><span class="s2">_iteratorNormalCompletion2 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">) {</span>
				<span class="s1">var </span><span class="s2">currentValue </span><span class="s0">= </span><span class="s2">_step2</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span>

				<span class="s1">if </span><span class="s0">(</span><span class="s2">currentValue </span><span class="s0">&gt;= </span><span class="s2">n </span><span class="s0">&amp;&amp; </span><span class="s2">currentValue </span><span class="s0">&lt; </span><span class="s2">m</span><span class="s0">) {</span>
					<span class="s2">m </span><span class="s0">= </span><span class="s2">currentValue</span><span class="s0">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>

			<span class="s7">// Increase `delta` enough to advance the decoder's &lt;n,i&gt; state to &lt;m,0&gt;,</span>
			<span class="s7">// but guard against overflow.</span>
		<span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">err</span><span class="s0">) {</span>
			<span class="s2">_didIteratorError2 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
			<span class="s2">_iteratorError2 </span><span class="s0">= </span><span class="s2">err</span><span class="s0">;</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">try </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(!</span><span class="s2">_iteratorNormalCompletion2 </span><span class="s0">&amp;&amp; </span><span class="s2">_iterator2</span><span class="s0">.</span><span class="s2">return</span><span class="s0">) {</span>
					<span class="s2">_iterator2</span><span class="s0">.</span><span class="s2">return</span><span class="s0">();</span>
				<span class="s0">}</span>
			<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(</span><span class="s2">_didIteratorError2</span><span class="s0">) {</span>
					<span class="s1">throw </span><span class="s2">_iteratorError2</span><span class="s0">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">}</span>

		<span class="s1">var </span><span class="s2">handledCPCountPlusOne </span><span class="s0">= </span><span class="s2">handledCPCount </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">if </span><span class="s0">(</span><span class="s2">m </span><span class="s0">- </span><span class="s2">n </span><span class="s0">&gt; </span><span class="s2">floor</span><span class="s0">((</span><span class="s2">maxInt </span><span class="s0">- </span><span class="s2">delta</span><span class="s0">) / </span><span class="s2">handledCPCountPlusOne</span><span class="s0">)) {</span>
			<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'overflow'</span><span class="s0">);</span>
		<span class="s0">}</span>

		<span class="s2">delta </span><span class="s0">+= (</span><span class="s2">m </span><span class="s0">- </span><span class="s2">n</span><span class="s0">) * </span><span class="s2">handledCPCountPlusOne</span><span class="s0">;</span>
		<span class="s2">n </span><span class="s0">= </span><span class="s2">m</span><span class="s0">;</span>

		<span class="s1">var </span><span class="s2">_iteratorNormalCompletion3 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
		<span class="s1">var </span><span class="s2">_didIteratorError3 </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
		<span class="s1">var </span><span class="s2">_iteratorError3 </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>

		<span class="s1">try </span><span class="s0">{</span>
			<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_iterator3 </span><span class="s0">= </span><span class="s2">input</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">](), </span><span class="s2">_step3</span><span class="s0">; !(</span><span class="s2">_iteratorNormalCompletion3 </span><span class="s0">= (</span><span class="s2">_step3 </span><span class="s0">= </span><span class="s2">_iterator3</span><span class="s0">.</span><span class="s2">next</span><span class="s0">()).</span><span class="s2">done</span><span class="s0">); </span><span class="s2">_iteratorNormalCompletion3 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">) {</span>
				<span class="s1">var </span><span class="s2">_currentValue </span><span class="s0">= </span><span class="s2">_step3</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span>

				<span class="s1">if </span><span class="s0">(</span><span class="s2">_currentValue </span><span class="s0">&lt; </span><span class="s2">n </span><span class="s0">&amp;&amp; ++</span><span class="s2">delta </span><span class="s0">&gt; </span><span class="s2">maxInt</span><span class="s0">) {</span>
					<span class="s2">error$1</span><span class="s0">(</span><span class="s3">'overflow'</span><span class="s0">);</span>
				<span class="s0">}</span>
				<span class="s1">if </span><span class="s0">(</span><span class="s2">_currentValue </span><span class="s0">== </span><span class="s2">n</span><span class="s0">) {</span>
					<span class="s7">// Represent delta as a generalized variable-length integer.</span>
					<span class="s1">var </span><span class="s2">q </span><span class="s0">= </span><span class="s2">delta</span><span class="s0">;</span>
					<span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">k </span><span class="s0">= </span><span class="s2">base</span><span class="s0">;; </span><span class="s7">/* no condition */</span><span class="s2">k </span><span class="s0">+= </span><span class="s2">base</span><span class="s0">) {</span>
						<span class="s1">var </span><span class="s2">t </span><span class="s0">= </span><span class="s2">k </span><span class="s0">&lt;= </span><span class="s2">bias </span><span class="s0">? </span><span class="s2">tMin </span><span class="s0">: </span><span class="s2">k </span><span class="s0">&gt;= </span><span class="s2">bias </span><span class="s0">+ </span><span class="s2">tMax </span><span class="s0">? </span><span class="s2">tMax </span><span class="s0">: </span><span class="s2">k </span><span class="s0">- </span><span class="s2">bias</span><span class="s0">;</span>
						<span class="s1">if </span><span class="s0">(</span><span class="s2">q </span><span class="s0">&lt; </span><span class="s2">t</span><span class="s0">) {</span>
							<span class="s1">break</span><span class="s0">;</span>
						<span class="s0">}</span>
						<span class="s1">var </span><span class="s2">qMinusT </span><span class="s0">= </span><span class="s2">q </span><span class="s0">- </span><span class="s2">t</span><span class="s0">;</span>
						<span class="s1">var </span><span class="s2">baseMinusT </span><span class="s0">= </span><span class="s2">base </span><span class="s0">- </span><span class="s2">t</span><span class="s0">;</span>
						<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">stringFromCharCode</span><span class="s0">(</span><span class="s2">digitToBasic</span><span class="s0">(</span><span class="s2">t </span><span class="s0">+ </span><span class="s2">qMinusT </span><span class="s0">% </span><span class="s2">baseMinusT</span><span class="s0">, </span><span class="s4">0</span><span class="s0">)));</span>
						<span class="s2">q </span><span class="s0">= </span><span class="s2">floor</span><span class="s0">(</span><span class="s2">qMinusT </span><span class="s0">/ </span><span class="s2">baseMinusT</span><span class="s0">);</span>
					<span class="s0">}</span>

					<span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">stringFromCharCode</span><span class="s0">(</span><span class="s2">digitToBasic</span><span class="s0">(</span><span class="s2">q</span><span class="s0">, </span><span class="s4">0</span><span class="s0">)));</span>
					<span class="s2">bias </span><span class="s0">= </span><span class="s2">adapt</span><span class="s0">(</span><span class="s2">delta</span><span class="s0">, </span><span class="s2">handledCPCountPlusOne</span><span class="s0">, </span><span class="s2">handledCPCount </span><span class="s0">== </span><span class="s2">basicLength</span><span class="s0">);</span>
					<span class="s2">delta </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
					<span class="s0">++</span><span class="s2">handledCPCount</span><span class="s0">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">err</span><span class="s0">) {</span>
			<span class="s2">_didIteratorError3 </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
			<span class="s2">_iteratorError3 </span><span class="s0">= </span><span class="s2">err</span><span class="s0">;</span>
		<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
			<span class="s1">try </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(!</span><span class="s2">_iteratorNormalCompletion3 </span><span class="s0">&amp;&amp; </span><span class="s2">_iterator3</span><span class="s0">.</span><span class="s2">return</span><span class="s0">) {</span>
					<span class="s2">_iterator3</span><span class="s0">.</span><span class="s2">return</span><span class="s0">();</span>
				<span class="s0">}</span>
			<span class="s0">} </span><span class="s1">finally </span><span class="s0">{</span>
				<span class="s1">if </span><span class="s0">(</span><span class="s2">_didIteratorError3</span><span class="s0">) {</span>
					<span class="s1">throw </span><span class="s2">_iteratorError3</span><span class="s0">;</span>
				<span class="s0">}</span>
			<span class="s0">}</span>
		<span class="s0">}</span>

		<span class="s0">++</span><span class="s2">delta</span><span class="s0">;</span>
		<span class="s0">++</span><span class="s2">n</span><span class="s0">;</span>
	<span class="s0">}</span>
	<span class="s1">return </span><span class="s2">output</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">''</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Punycode string representing a domain name or an email address</span>
 <span class="s5">* to Unicode. Only the Punycoded parts of the input will be converted, i.e.</span>
 <span class="s5">* it doesn't matter if you call it on a string that has already been</span>
 <span class="s5">* converted to Unicode.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The Punycoded domain name or email address to</span>
 <span class="s5">* convert to Unicode.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The Unicode representation of the given Punycode</span>
 <span class="s5">* string.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">toUnicode </span><span class="s0">= </span><span class="s1">function </span><span class="s2">toUnicode</span><span class="s0">(</span><span class="s2">input</span><span class="s0">) {</span>
	<span class="s1">return </span><span class="s2">mapDomain</span><span class="s0">(</span><span class="s2">input</span><span class="s0">, </span><span class="s1">function </span><span class="s0">(</span><span class="s2">string</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s2">regexPunycode</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">string</span><span class="s0">) ? </span><span class="s2">decode</span><span class="s0">(</span><span class="s2">string</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">4</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">()) : </span><span class="s2">string</span><span class="s0">;</span>
	<span class="s0">});</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* Converts a Unicode string representing a domain name or an email address to</span>
 <span class="s5">* Punycode. Only the non-ASCII parts of the domain name will be converted,</span>
 <span class="s5">* i.e. it doesn't matter if you call it with a domain that's already in</span>
 <span class="s5">* ASCII.</span>
 <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} input The domain name or email address to convert, as a</span>
 <span class="s5">* Unicode string.</span>
 <span class="s5">* </span><span class="s6">@returns </span><span class="s5">{String} The Punycode representation of the given domain name or</span>
 <span class="s5">* email address.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">toASCII </span><span class="s0">= </span><span class="s1">function </span><span class="s2">toASCII</span><span class="s0">(</span><span class="s2">input</span><span class="s0">) {</span>
	<span class="s1">return </span><span class="s2">mapDomain</span><span class="s0">(</span><span class="s2">input</span><span class="s0">, </span><span class="s1">function </span><span class="s0">(</span><span class="s2">string</span><span class="s0">) {</span>
		<span class="s1">return </span><span class="s2">regexNonASCII</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">string</span><span class="s0">) ? </span><span class="s3">'xn--' </span><span class="s0">+ </span><span class="s2">encode</span><span class="s0">(</span><span class="s2">string</span><span class="s0">) : </span><span class="s2">string</span><span class="s0">;</span>
	<span class="s0">});</span>
<span class="s0">};</span>

<span class="s7">/*--------------------------------------------------------------------------*/</span>

<span class="s5">/** Define the public API */</span>
<span class="s1">var </span><span class="s2">punycode </span><span class="s0">= {</span>
	<span class="s5">/**</span>
  <span class="s5">* A string representing the current Punycode.js version number.</span>
  <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
  <span class="s5">* </span><span class="s6">@type </span><span class="s5">String</span>
  <span class="s5">*/</span>
	<span class="s3">'version'</span><span class="s0">: </span><span class="s3">'2.1.0'</span><span class="s0">,</span>
	<span class="s5">/**</span>
  <span class="s5">* An object of methods to convert from JavaScript's internal character</span>
  <span class="s5">* representation (UCS-2) to Unicode code points, and back.</span>
  <span class="s5">* </span><span class="s6">@see </span><span class="s5">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</span>
  <span class="s5">* </span><span class="s6">@memberOf </span><span class="s5">punycode</span>
  <span class="s5">* </span><span class="s6">@type </span><span class="s5">Object</span>
  <span class="s5">*/</span>
	<span class="s3">'ucs2'</span><span class="s0">: {</span>
		<span class="s3">'decode'</span><span class="s0">: </span><span class="s2">ucs2decode</span><span class="s0">,</span>
		<span class="s3">'encode'</span><span class="s0">: </span><span class="s2">ucs2encode</span>
	<span class="s0">},</span>
	<span class="s3">'decode'</span><span class="s0">: </span><span class="s2">decode</span><span class="s0">,</span>
	<span class="s3">'encode'</span><span class="s0">: </span><span class="s2">encode</span><span class="s0">,</span>
	<span class="s3">'toASCII'</span><span class="s0">: </span><span class="s2">toASCII</span><span class="s0">,</span>
	<span class="s3">'toUnicode'</span><span class="s0">: </span><span class="s2">toUnicode</span>
<span class="s0">};</span>

<span class="s5">/**</span>
 <span class="s5">* URI.js</span>
 <span class="s5">*</span>
 <span class="s5">* </span><span class="s6">@fileoverview </span><span class="s5">An RFC 3986 compliant, scheme extendable URI parsing/validating/resolving library for JavaScript.</span>
 <span class="s5">* </span><span class="s6">@author </span><span class="s5">&lt;a href=&quot;mailto:gary.court@gmail.com&quot;&gt;Gary Court&lt;/a&gt;</span>
 <span class="s5">* </span><span class="s6">@see </span><span class="s5">http://github.com/garycourt/uri-js</span>
 <span class="s5">*/</span>
<span class="s5">/**</span>
 <span class="s5">* Copyright 2011 Gary Court. All rights reserved.</span>
 <span class="s5">*</span>
 <span class="s5">* Redistribution and use in source and binary forms, with or without modification, are</span>
 <span class="s5">* permitted provided that the following conditions are met:</span>
 <span class="s5">*</span>
 <span class="s5">*    1. Redistributions of source code must retain the above copyright notice, this list of</span>
 <span class="s5">*       conditions and the following disclaimer.</span>
 <span class="s5">*</span>
 <span class="s5">*    2. Redistributions in binary form must reproduce the above copyright notice, this list</span>
 <span class="s5">*       of conditions and the following disclaimer in the documentation and/or other materials</span>
 <span class="s5">*       provided with the distribution.</span>
 <span class="s5">*</span>
 <span class="s5">* THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
 <span class="s5">* WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND</span>
 <span class="s5">* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR</span>
 <span class="s5">* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
 <span class="s5">* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
 <span class="s5">* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON</span>
 <span class="s5">* ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
 <span class="s5">* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF</span>
 <span class="s5">* ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
 <span class="s5">*</span>
 <span class="s5">* The views and conclusions contained in the software and documentation are those of the</span>
 <span class="s5">* authors and should not be interpreted as representing official policies, either expressed</span>
 <span class="s5">* or implied, of Gary Court.</span>
 <span class="s5">*/</span>
<span class="s1">var </span><span class="s2">SCHEMES </span><span class="s0">= {};</span>
<span class="s1">function </span><span class="s2">pctEncChar</span><span class="s0">(</span><span class="s2">chr</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">c </span><span class="s0">= </span><span class="s2">chr</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">e </span><span class="s0">= </span><span class="s1">void </span><span class="s4">0</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&lt; </span><span class="s4">16</span><span class="s0">) </span><span class="s2">e </span><span class="s0">= </span><span class="s3">&quot;%0&quot; </span><span class="s0">+ </span><span class="s2">c</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">();</span><span class="s1">else if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&lt; </span><span class="s4">128</span><span class="s0">) </span><span class="s2">e </span><span class="s0">= </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">c</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">();</span><span class="s1">else if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&lt; </span><span class="s4">2048</span><span class="s0">) </span><span class="s2">e </span><span class="s0">= </span><span class="s3">&quot;%&quot; </span><span class="s0">+ (</span><span class="s2">c </span><span class="s0">&gt;&gt; </span><span class="s4">6 </span><span class="s0">| </span><span class="s4">192</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">() + </span><span class="s3">&quot;%&quot; </span><span class="s0">+ (</span><span class="s2">c </span><span class="s0">&amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">();</span><span class="s1">else </span><span class="s2">e </span><span class="s0">= </span><span class="s3">&quot;%&quot; </span><span class="s0">+ (</span><span class="s2">c </span><span class="s0">&gt;&gt; </span><span class="s4">12 </span><span class="s0">| </span><span class="s4">224</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">() + </span><span class="s3">&quot;%&quot; </span><span class="s0">+ (</span><span class="s2">c </span><span class="s0">&gt;&gt; </span><span class="s4">6 </span><span class="s0">&amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">() + </span><span class="s3">&quot;%&quot; </span><span class="s0">+ (</span><span class="s2">c </span><span class="s0">&amp; </span><span class="s4">63 </span><span class="s0">| </span><span class="s4">128</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">();</span>
    <span class="s1">return </span><span class="s2">e</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">pctDecChars</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">newStr </span><span class="s0">= </span><span class="s3">&quot;&quot;</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s4">0</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">il </span><span class="s0">= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
    <span class="s1">while </span><span class="s0">(</span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">il</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">c </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">), </span><span class="s4">16</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&lt; </span><span class="s4">128</span><span class="s0">) {</span>
            <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span>
            <span class="s2">i </span><span class="s0">+= </span><span class="s4">3</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&gt;= </span><span class="s4">194 </span><span class="s0">&amp;&amp; </span><span class="s2">c </span><span class="s0">&lt; </span><span class="s4">224</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">il </span><span class="s0">- </span><span class="s2">i </span><span class="s0">&gt;= </span><span class="s4">6</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">c2 </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i </span><span class="s0">+ </span><span class="s4">4</span><span class="s0">, </span><span class="s4">2</span><span class="s0">), </span><span class="s4">16</span><span class="s0">);</span>
                <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">((</span><span class="s2">c </span><span class="s0">&amp; </span><span class="s4">31</span><span class="s0">) &lt;&lt; </span><span class="s4">6 </span><span class="s0">| </span><span class="s2">c2 </span><span class="s0">&amp; </span><span class="s4">63</span><span class="s0">);</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s4">6</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">i </span><span class="s0">+= </span><span class="s4">6</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">c </span><span class="s0">&gt;= </span><span class="s4">224</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">il </span><span class="s0">- </span><span class="s2">i </span><span class="s0">&gt;= </span><span class="s4">9</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">_c </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i </span><span class="s0">+ </span><span class="s4">4</span><span class="s0">, </span><span class="s4">2</span><span class="s0">), </span><span class="s4">16</span><span class="s0">);</span>
                <span class="s1">var </span><span class="s2">c3 </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i </span><span class="s0">+ </span><span class="s4">7</span><span class="s0">, </span><span class="s4">2</span><span class="s0">), </span><span class="s4">16</span><span class="s0">);</span>
                <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">((</span><span class="s2">c </span><span class="s0">&amp; </span><span class="s4">15</span><span class="s0">) &lt;&lt; </span><span class="s4">12 </span><span class="s0">| (</span><span class="s2">_c </span><span class="s0">&amp; </span><span class="s4">63</span><span class="s0">) &lt;&lt; </span><span class="s4">6 </span><span class="s0">| </span><span class="s2">c3 </span><span class="s0">&amp; </span><span class="s4">63</span><span class="s0">);</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s4">9</span><span class="s0">);</span>
            <span class="s0">}</span>
            <span class="s2">i </span><span class="s0">+= </span><span class="s4">9</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">newStr </span><span class="s0">+= </span><span class="s2">str</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">i</span><span class="s0">, </span><span class="s4">3</span><span class="s0">);</span>
            <span class="s2">i </span><span class="s0">+= </span><span class="s4">3</span><span class="s0">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">newStr</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">_normalizeComponentEncoding</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">) {</span>
    <span class="s1">function </span><span class="s2">decodeUnreserved</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">decStr </span><span class="s0">= </span><span class="s2">pctDecChars</span><span class="s0">(</span><span class="s2">str</span><span class="s0">);</span>
        <span class="s1">return </span><span class="s0">!</span><span class="s2">decStr</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">UNRESERVED</span><span class="s0">) ? </span><span class="s2">str </span><span class="s0">: </span><span class="s2">decStr</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_SCHEME</span><span class="s0">, </span><span class="s3">&quot;&quot;</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_USERINFO</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_HOST</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">? </span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_PATH </span><span class="s0">: </span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_PATH_NOSCHEME</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">query</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_QUERY</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">NOT_FRAGMENT</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">);</span>
    <span class="s1">return </span><span class="s2">components</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">_stripLeadingZeros</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">str</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/^0*(.*)/</span><span class="s0">, </span><span class="s3">&quot;$1&quot;</span><span class="s0">) || </span><span class="s3">&quot;0&quot;</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">_normalizeIPv4</span><span class="s0">(</span><span class="s2">host</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">host</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">IPV4ADDRESS</span><span class="s0">) || [];</span>

    <span class="s1">var </span><span class="s2">_matches </span><span class="s0">= </span><span class="s2">slicedToArray</span><span class="s0">(</span><span class="s2">matches</span><span class="s0">, </span><span class="s4">2</span><span class="s0">),</span>
        <span class="s2">address </span><span class="s0">= </span><span class="s2">_matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">address</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">address</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">).</span><span class="s2">map</span><span class="s0">(</span><span class="s2">_stripLeadingZeros</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s2">host</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">function </span><span class="s2">_normalizeIPv6</span><span class="s0">(</span><span class="s2">host</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">host</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">IPV6ADDRESS</span><span class="s0">) || [];</span>

    <span class="s1">var </span><span class="s2">_matches2 </span><span class="s0">= </span><span class="s2">slicedToArray</span><span class="s0">(</span><span class="s2">matches</span><span class="s0">, </span><span class="s4">3</span><span class="s0">),</span>
        <span class="s2">address </span><span class="s0">= </span><span class="s2">_matches2</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span>
        <span class="s2">zone </span><span class="s0">= </span><span class="s2">_matches2</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">address</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">_address$toLowerCase$ </span><span class="s0">= </span><span class="s2">address</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">().</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'::'</span><span class="s0">).</span><span class="s2">reverse</span><span class="s0">(),</span>
            <span class="s2">_address$toLowerCase$2 </span><span class="s0">= </span><span class="s2">slicedToArray</span><span class="s0">(</span><span class="s2">_address$toLowerCase$</span><span class="s0">, </span><span class="s4">2</span><span class="s0">),</span>
            <span class="s2">last </span><span class="s0">= </span><span class="s2">_address$toLowerCase$2</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span>
            <span class="s2">first </span><span class="s0">= </span><span class="s2">_address$toLowerCase$2</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>

        <span class="s1">var </span><span class="s2">firstFields </span><span class="s0">= </span><span class="s2">first </span><span class="s0">? </span><span class="s2">first</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">).</span><span class="s2">map</span><span class="s0">(</span><span class="s2">_stripLeadingZeros</span><span class="s0">) : [];</span>
        <span class="s1">var </span><span class="s2">lastFields </span><span class="s0">= </span><span class="s2">last</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">).</span><span class="s2">map</span><span class="s0">(</span><span class="s2">_stripLeadingZeros</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">isLastFieldIPv4Address </span><span class="s0">= </span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">IPV4ADDRESS</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">lastFields</span><span class="s0">[</span><span class="s2">lastFields</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">]);</span>
        <span class="s1">var </span><span class="s2">fieldCount </span><span class="s0">= </span><span class="s2">isLastFieldIPv4Address </span><span class="s0">? </span><span class="s4">7 </span><span class="s0">: </span><span class="s4">8</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">lastFieldsStart </span><span class="s0">= </span><span class="s2">lastFields</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s2">fieldCount</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">fields </span><span class="s0">= </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">fieldCount</span><span class="s0">);</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">x </span><span class="s0">= </span><span class="s4">0</span><span class="s0">; </span><span class="s2">x </span><span class="s0">&lt; </span><span class="s2">fieldCount</span><span class="s0">; ++</span><span class="s2">x</span><span class="s0">) {</span>
            <span class="s2">fields</span><span class="s0">[</span><span class="s2">x</span><span class="s0">] = </span><span class="s2">firstFields</span><span class="s0">[</span><span class="s2">x</span><span class="s0">] || </span><span class="s2">lastFields</span><span class="s0">[</span><span class="s2">lastFieldsStart </span><span class="s0">+ </span><span class="s2">x</span><span class="s0">] || </span><span class="s3">''</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">isLastFieldIPv4Address</span><span class="s0">) {</span>
            <span class="s2">fields</span><span class="s0">[</span><span class="s2">fieldCount </span><span class="s0">- </span><span class="s4">1</span><span class="s0">] = </span><span class="s2">_normalizeIPv4</span><span class="s0">(</span><span class="s2">fields</span><span class="s0">[</span><span class="s2">fieldCount </span><span class="s0">- </span><span class="s4">1</span><span class="s0">], </span><span class="s2">protocol</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">allZeroFields </span><span class="s0">= </span><span class="s2">fields</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">acc</span><span class="s0">, </span><span class="s2">field</span><span class="s0">, </span><span class="s2">index</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(!</span><span class="s2">field </span><span class="s0">|| </span><span class="s2">field </span><span class="s0">=== </span><span class="s3">&quot;0&quot;</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">lastLongest </span><span class="s0">= </span><span class="s2">acc</span><span class="s0">[</span><span class="s2">acc</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s4">1</span><span class="s0">];</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">lastLongest </span><span class="s0">&amp;&amp; </span><span class="s2">lastLongest</span><span class="s0">.</span><span class="s2">index </span><span class="s0">+ </span><span class="s2">lastLongest</span><span class="s0">.</span><span class="s2">length </span><span class="s0">=== </span><span class="s2">index</span><span class="s0">) {</span>
                    <span class="s2">lastLongest</span><span class="s0">.</span><span class="s2">length</span><span class="s0">++;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s2">acc</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({ </span><span class="s2">index</span><span class="s0">: </span><span class="s2">index</span><span class="s0">, </span><span class="s2">length</span><span class="s0">: </span><span class="s4">1 </span><span class="s0">});</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s1">return </span><span class="s2">acc</span><span class="s0">;</span>
        <span class="s0">}, []);</span>
        <span class="s1">var </span><span class="s2">longestZeroFields </span><span class="s0">= </span><span class="s2">allZeroFields</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">a</span><span class="s0">, </span><span class="s2">b</span><span class="s0">) {</span>
            <span class="s1">return </span><span class="s2">b</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
        <span class="s0">})[</span><span class="s4">0</span><span class="s0">];</span>
        <span class="s1">var </span><span class="s2">newHost </span><span class="s0">= </span><span class="s1">void </span><span class="s4">0</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">longestZeroFields </span><span class="s0">&amp;&amp; </span><span class="s2">longestZeroFields</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">1</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">newFirst </span><span class="s0">= </span><span class="s2">fields</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, </span><span class="s2">longestZeroFields</span><span class="s0">.</span><span class="s2">index</span><span class="s0">);</span>
            <span class="s1">var </span><span class="s2">newLast </span><span class="s0">= </span><span class="s2">fields</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">longestZeroFields</span><span class="s0">.</span><span class="s2">index </span><span class="s0">+ </span><span class="s2">longestZeroFields</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span>
            <span class="s2">newHost </span><span class="s0">= </span><span class="s2">newFirst</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">) + </span><span class="s3">&quot;::&quot; </span><span class="s0">+ </span><span class="s2">newLast</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">);</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">newHost </span><span class="s0">= </span><span class="s2">fields</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">zone</span><span class="s0">) {</span>
            <span class="s2">newHost </span><span class="s0">+= </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">zone</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">newHost</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">return </span><span class="s2">host</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s2">URI_PARSE </span><span class="s0">= </span><span class="s8">/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">NO_MATCH_IS_UNDEFINED </span><span class="s0">= </span><span class="s3">&quot;&quot;</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s8">/(){0}/</span><span class="s0">)[</span><span class="s4">1</span><span class="s0">] === </span><span class="s2">undefined</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">uriString</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">options </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">1 </span><span class="s0">&amp;&amp; </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] !== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] : {};</span>

    <span class="s1">var </span><span class="s2">components </span><span class="s0">= {};</span>
    <span class="s1">var </span><span class="s2">protocol </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">!== </span><span class="s1">false </span><span class="s0">? </span><span class="s2">IRI_PROTOCOL </span><span class="s0">: </span><span class="s2">URI_PROTOCOL</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">=== </span><span class="s3">&quot;suffix&quot;</span><span class="s0">) </span><span class="s2">uriString </span><span class="s0">= (</span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">? </span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">+ </span><span class="s3">&quot;:&quot; </span><span class="s0">: </span><span class="s3">&quot;&quot;</span><span class="s0">) + </span><span class="s3">&quot;//&quot; </span><span class="s0">+ </span><span class="s2">uriString</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">URI_PARSE</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">matches</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">NO_MATCH_IS_UNDEFINED</span><span class="s0">) {</span>
            <span class="s7">//store each component</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">3</span><span class="s0">];</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">4</span><span class="s0">];</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">5</span><span class="s0">], </span><span class="s4">10</span><span class="s0">);</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">6</span><span class="s0">] || </span><span class="s3">&quot;&quot;</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">7</span><span class="s0">];</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">8</span><span class="s0">];</span>
            <span class="s7">//fix port number</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">port</span><span class="s0">)) {</span>
                <span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">5</span><span class="s0">];</span>
            <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s7">//IE FIX for improper RegExp matching</span>
            <span class="s7">//store each component</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] || </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">3</span><span class="s0">] : </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;//&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">4</span><span class="s0">] : </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">matches</span><span class="s0">[</span><span class="s4">5</span><span class="s0">], </span><span class="s4">10</span><span class="s0">);</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">6</span><span class="s0">] || </span><span class="s3">&quot;&quot;</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;?&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">7</span><span class="s0">] : </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;#&quot;</span><span class="s0">) !== -</span><span class="s4">1 </span><span class="s0">? </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">8</span><span class="s0">] : </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s7">//fix port number</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">port</span><span class="s0">)) {</span>
                <span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">uriString</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s8">/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/</span><span class="s0">) ? </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">4</span><span class="s0">] : </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">) {</span>
            <span class="s7">//normalize IP hosts</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">_normalizeIPv6</span><span class="s0">(</span><span class="s2">_normalizeIPv4</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">), </span><span class="s2">protocol</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s7">//determine reference type</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; !</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">= </span><span class="s3">&quot;same-document&quot;</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">= </span><span class="s3">&quot;relative&quot;</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">= </span><span class="s3">&quot;absolute&quot;</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">= </span><span class="s3">&quot;uri&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//check for reference errors</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">&amp;&amp; </span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">!== </span><span class="s3">&quot;suffix&quot; </span><span class="s0">&amp;&amp; </span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">!== </span><span class="s2">components</span><span class="s0">.</span><span class="s2">reference</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;URI is not a &quot; </span><span class="s0">+ </span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">+ </span><span class="s3">&quot; reference.&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//find scheme handler</span>
        <span class="s1">var </span><span class="s2">schemeHandler </span><span class="s0">= </span><span class="s2">SCHEMES</span><span class="s0">[(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">()];</span>
        <span class="s7">//check if scheme can't handle IRIs</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">unicodeSupport </span><span class="s0">&amp;&amp; (!</span><span class="s2">schemeHandler </span><span class="s0">|| !</span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">unicodeSupport</span><span class="s0">)) {</span>
            <span class="s7">//if host component is a domain name</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">&amp;&amp; (</span><span class="s2">options</span><span class="s0">.</span><span class="s2">domainHost </span><span class="s0">|| </span><span class="s2">schemeHandler </span><span class="s0">&amp;&amp; </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">domainHost</span><span class="s0">)) {</span>
                <span class="s7">//convert Unicode IDN -&gt; ASCII IDN</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toASCII</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">pctDecChars</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">());</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
                    <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;Host's domain name can not be converted to ASCII via punycode: &quot; </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s7">//convert IRI -&gt; URI</span>
            <span class="s2">_normalizeComponentEncoding</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">URI_PROTOCOL</span><span class="s0">);</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s7">//normalize encodings</span>
            <span class="s2">_normalizeComponentEncoding</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s7">//perform scheme specific parsing</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">schemeHandler </span><span class="s0">&amp;&amp; </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">) {</span>
            <span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
        <span class="s0">}</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;URI can not be parsed.&quot;</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">components</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">_recomposeAuthority</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">protocol </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">!== </span><span class="s1">false </span><span class="s0">? </span><span class="s2">IRI_PROTOCOL </span><span class="s0">: </span><span class="s2">URI_PROTOCOL</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">uriTokens </span><span class="s0">= [];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">userinfo</span><span class="s0">);</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s7">//normalize IP hosts, add brackets and escape zone separator for IPv6</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">_normalizeIPv6</span><span class="s0">(</span><span class="s2">_normalizeIPv4</span><span class="s0">(</span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">), </span><span class="s2">protocol</span><span class="s0">), </span><span class="s2">protocol</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">IPV6ADDRESS</span><span class="s0">, </span><span class="s1">function </span><span class="s0">(</span><span class="s2">_</span><span class="s0">, </span><span class="s2">$1</span><span class="s0">, </span><span class="s2">$2</span><span class="s0">) {</span>
            <span class="s1">return </span><span class="s3">&quot;[&quot; </span><span class="s0">+ </span><span class="s2">$1 </span><span class="s0">+ (</span><span class="s2">$2 </span><span class="s0">? </span><span class="s3">&quot;%25&quot; </span><span class="s0">+ </span><span class="s2">$2 </span><span class="s0">: </span><span class="s3">&quot;&quot;</span><span class="s0">) + </span><span class="s3">&quot;]&quot;</span><span class="s0">;</span>
        <span class="s0">}));</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== </span><span class="s3">&quot;number&quot; </span><span class="s0">|| </span><span class="s1">typeof </span><span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== </span><span class="s3">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">);</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">port</span><span class="s0">));</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">length </span><span class="s0">? </span><span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">) : </span><span class="s2">undefined</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">var </span><span class="s2">RDS1 </span><span class="s0">= </span><span class="s8">/^\.\.?\//</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">RDS2 </span><span class="s0">= </span><span class="s8">/^\/\.(\/|$)/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">RDS3 </span><span class="s0">= </span><span class="s8">/^\/\.\.(\/|$)/</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">RDS5 </span><span class="s0">= </span><span class="s8">/^\/?(?:.|\n)*?(?=\/|$)/</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">input</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">output </span><span class="s0">= [];</span>
    <span class="s1">while </span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">RDS1</span><span class="s0">)) {</span>
            <span class="s2">input </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">RDS1</span><span class="s0">, </span><span class="s3">&quot;&quot;</span><span class="s0">);</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">RDS2</span><span class="s0">)) {</span>
            <span class="s2">input </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">RDS2</span><span class="s0">, </span><span class="s3">&quot;/&quot;</span><span class="s0">);</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">input</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">RDS3</span><span class="s0">)) {</span>
            <span class="s2">input </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">RDS3</span><span class="s0">, </span><span class="s3">&quot;/&quot;</span><span class="s0">);</span>
            <span class="s2">output</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span>
        <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">input </span><span class="s0">=== </span><span class="s3">&quot;.&quot; </span><span class="s0">|| </span><span class="s2">input </span><span class="s0">=== </span><span class="s3">&quot;..&quot;</span><span class="s0">) {</span>
            <span class="s2">input </span><span class="s0">= </span><span class="s3">&quot;&quot;</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">var </span><span class="s2">im </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">RDS5</span><span class="s0">);</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">im</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">s </span><span class="s0">= </span><span class="s2">im</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span>
                <span class="s2">input </span><span class="s0">= </span><span class="s2">input</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span>
                <span class="s2">output</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unexpected dot segment condition&quot;</span><span class="s0">);</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">output</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">components</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">options </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">1 </span><span class="s0">&amp;&amp; </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] !== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] : {};</span>

    <span class="s1">var </span><span class="s2">protocol </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s2">IRI_PROTOCOL </span><span class="s0">: </span><span class="s2">URI_PROTOCOL</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">uriTokens </span><span class="s0">= [];</span>
    <span class="s7">//find scheme handler</span>
    <span class="s1">var </span><span class="s2">schemeHandler </span><span class="s0">= </span><span class="s2">SCHEMES</span><span class="s0">[(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">()];</span>
    <span class="s7">//perform scheme specific serialization</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">schemeHandler </span><span class="s0">&amp;&amp; </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">) </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">) {</span>
        <span class="s7">//if host component is an IPv6 address</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">IPV6ADDRESS</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">)) {}</span>
        <span class="s7">//TODO: normalize IPv6 address as per RFC 5952</span>

        <span class="s7">//if host component is a domain name</span>
        <span class="s1">else if </span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">domainHost </span><span class="s0">|| </span><span class="s2">schemeHandler </span><span class="s0">&amp;&amp; </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">domainHost</span><span class="s0">) {</span>
                <span class="s7">//convert IDN via punycode</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s2">components</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= !</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toASCII</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">protocol</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">pctDecChars</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">()) : </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toUnicode</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">);</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
                    <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;Host's domain name can not be converted to &quot; </span><span class="s0">+ (!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s3">&quot;ASCII&quot; </span><span class="s0">: </span><span class="s3">&quot;Unicode&quot;</span><span class="s0">) + </span><span class="s3">&quot; via punycode: &quot; </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s7">//normalize encoding</span>
    <span class="s2">_normalizeComponentEncoding</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">protocol</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">!== </span><span class="s3">&quot;suffix&quot; </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">) {</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">);</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">var </span><span class="s2">authority </span><span class="s0">= </span><span class="s2">_recomposeAuthority</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">authority </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">options</span><span class="s0">.</span><span class="s2">reference </span><span class="s0">!== </span><span class="s3">&quot;suffix&quot;</span><span class="s0">) {</span>
            <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;//&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">authority</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">) !== </span><span class="s3">&quot;/&quot;</span><span class="s0">) {</span>
            <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">s </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">absolutePath </span><span class="s0">&amp;&amp; (!</span><span class="s2">schemeHandler </span><span class="s0">|| !</span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">absolutePath</span><span class="s0">)) {</span>
            <span class="s2">s </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">authority </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) {</span>
            <span class="s2">s </span><span class="s0">= </span><span class="s2">s</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s8">/^\/\//</span><span class="s0">, </span><span class="s3">&quot;/%2F&quot;</span><span class="s0">); </span><span class="s7">//don't allow the path to start with &quot;//&quot;</span>
        <span class="s0">}</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;?&quot;</span><span class="s0">);</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">query</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;#&quot;</span><span class="s0">);</span>
        <span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">uriTokens</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">); </span><span class="s7">//merge tokens into a string</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">resolveComponents</span><span class="s0">(</span><span class="s2">base</span><span class="s0">, </span><span class="s2">relative</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">options </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s4">2 </span><span class="s0">&amp;&amp; </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">] !== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">] : {};</span>
    <span class="s1">var </span><span class="s2">skipNormalization </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">3</span><span class="s0">];</span>

    <span class="s1">var </span><span class="s2">target </span><span class="s0">= {};</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">skipNormalization</span><span class="s0">) {</span>
        <span class="s2">base </span><span class="s0">= </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">base</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">); </span><span class="s7">//normalize base components</span>
        <span class="s2">relative </span><span class="s0">= </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">relative</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">); </span><span class="s7">//normalize relative components</span>
    <span class="s0">}</span>
    <span class="s2">options </span><span class="s0">= </span><span class="s2">options </span><span class="s0">|| {};</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">tolerant </span><span class="s0">&amp;&amp; </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">) {</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">;</span>
        <span class="s7">//target.authority = relative.authority;</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">userinfo</span><span class="s0">;</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">host</span><span class="s0">;</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">port</span><span class="s0">;</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path </span><span class="s0">|| </span><span class="s3">&quot;&quot;</span><span class="s0">);</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">query</span><span class="s0">;</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">host </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">port </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
            <span class="s7">//target.authority = relative.authority;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">userinfo</span><span class="s0">;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">host</span><span class="s0">;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">port</span><span class="s0">;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path </span><span class="s0">|| </span><span class="s3">&quot;&quot;</span><span class="s0">);</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">query</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s1">if </span><span class="s0">(!</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">) {</span>
                <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">query </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) {</span>
                    <span class="s2">target</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">query</span><span class="s0">;</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s2">target</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">query</span><span class="s0">;</span>
                <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s1">if </span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">) === </span><span class="s3">&quot;/&quot;</span><span class="s0">) {</span>
                    <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">);</span>
                <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                    <span class="s1">if </span><span class="s0">((</span><span class="s2">base</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s2">base</span><span class="s0">.</span><span class="s2">host </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">|| </span><span class="s2">base</span><span class="s0">.</span><span class="s2">port </span><span class="s0">!== </span><span class="s2">undefined</span><span class="s0">) &amp;&amp; !</span><span class="s2">base</span><span class="s0">.</span><span class="s2">path</span><span class="s0">) {</span>
                        <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s3">&quot;/&quot; </span><span class="s0">+ </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span>
                    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(!</span><span class="s2">base</span><span class="s0">.</span><span class="s2">path</span><span class="s0">) {</span>
                        <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span>
                    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                        <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, </span><span class="s2">base</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">lastIndexOf</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">) + </span><span class="s4">1</span><span class="s0">) + </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span>
                    <span class="s0">}</span>
                    <span class="s2">target</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">(</span><span class="s2">target</span><span class="s0">.</span><span class="s2">path</span><span class="s0">);</span>
                <span class="s0">}</span>
                <span class="s2">target</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">query</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s7">//target.authority = base.authority;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">userinfo </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">userinfo</span><span class="s0">;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">host </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">host</span><span class="s0">;</span>
            <span class="s2">target</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">port</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">target</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">base</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">;</span>
    <span class="s0">}</span>
    <span class="s2">target</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">relative</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s2">target</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">baseURI</span><span class="s0">, </span><span class="s2">relativeURI</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">schemelessOptions </span><span class="s0">= </span><span class="s2">assign</span><span class="s0">({ </span><span class="s2">scheme</span><span class="s0">: </span><span class="s3">'null' </span><span class="s0">}, </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s1">return </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">resolveComponents</span><span class="s0">(</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">baseURI</span><span class="s0">, </span><span class="s2">schemelessOptions</span><span class="s0">), </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">relativeURI</span><span class="s0">, </span><span class="s2">schemelessOptions</span><span class="s0">), </span><span class="s2">schemelessOptions</span><span class="s0">, </span><span class="s1">true</span><span class="s0">), </span><span class="s2">schemelessOptions</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">uri</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">uri </span><span class="s0">=== </span><span class="s3">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s2">uri </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">uri</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">typeOf</span><span class="s0">(</span><span class="s2">uri</span><span class="s0">) === </span><span class="s3">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s2">uri </span><span class="s0">= </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">uri</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">uri</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">equal</span><span class="s0">(</span><span class="s2">uriA</span><span class="s0">, </span><span class="s2">uriB</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">uriA </span><span class="s0">=== </span><span class="s3">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s2">uriA </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">uriA</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">typeOf</span><span class="s0">(</span><span class="s2">uriA</span><span class="s0">) === </span><span class="s3">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s2">uriA </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">uriA</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">uriB </span><span class="s0">=== </span><span class="s3">&quot;string&quot;</span><span class="s0">) {</span>
        <span class="s2">uriB </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">uriB</span><span class="s0">, </span><span class="s2">options</span><span class="s0">), </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">} </span><span class="s1">else if </span><span class="s0">(</span><span class="s2">typeOf</span><span class="s0">(</span><span class="s2">uriB</span><span class="s0">) === </span><span class="s3">&quot;object&quot;</span><span class="s0">) {</span>
        <span class="s2">uriB </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">uriB</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">return </span><span class="s2">uriA </span><span class="s0">=== </span><span class="s2">uriB</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">escapeComponent</span><span class="s0">(</span><span class="s2">str</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">str </span><span class="s0">&amp;&amp; </span><span class="s2">str</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(!</span><span class="s2">options </span><span class="s0">|| !</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s2">URI_PROTOCOL</span><span class="s0">.</span><span class="s2">ESCAPE </span><span class="s0">: </span><span class="s2">IRI_PROTOCOL</span><span class="s0">.</span><span class="s2">ESCAPE</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s1">function </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">str</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">str </span><span class="s0">&amp;&amp; </span><span class="s2">str</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">().</span><span class="s2">replace</span><span class="s0">(!</span><span class="s2">options </span><span class="s0">|| !</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s2">URI_PROTOCOL</span><span class="s0">.</span><span class="s2">PCT_ENCODED </span><span class="s0">: </span><span class="s2">IRI_PROTOCOL</span><span class="s0">.</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">pctDecChars</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s1">var </span><span class="s2">handler </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;http&quot;</span><span class="s0">,</span>
    <span class="s2">domainHost</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s1">function </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s7">//report missing host</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">components</span><span class="s0">.</span><span class="s2">host</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;HTTP URIs must have a host.&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">components</span><span class="s0">;</span>
    <span class="s0">},</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s1">function </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">secure </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">() === </span><span class="s3">&quot;https&quot;</span><span class="s0">;</span>
        <span class="s7">//normalize the default port</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== (</span><span class="s2">secure </span><span class="s0">? </span><span class="s4">443 </span><span class="s0">: </span><span class="s4">80</span><span class="s0">) || </span><span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== </span><span class="s3">&quot;&quot;</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//normalize the empty path</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">components</span><span class="s0">.</span><span class="s2">path</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s3">&quot;/&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//NOTE: We do not parse query strings for HTTP URIs</span>
        <span class="s7">//as WWW Form Url Encoded query strings are part of the HTML4+ spec,</span>
        <span class="s7">//and not the HTTP spec.</span>
        <span class="s1">return </span><span class="s2">components</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">handler$1 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;https&quot;</span><span class="s0">,</span>
    <span class="s2">domainHost</span><span class="s0">: </span><span class="s2">handler</span><span class="s0">.</span><span class="s2">domainHost</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s2">handler</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">,</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s2">handler</span><span class="s0">.</span><span class="s2">serialize</span>
<span class="s0">};</span>

<span class="s1">function </span><span class="s2">isSecure</span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">) {</span>
    <span class="s1">return typeof </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">=== </span><span class="s3">'boolean' </span><span class="s0">? </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">: </span><span class="s2">String</span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">() === </span><span class="s3">&quot;wss&quot;</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s7">//RFC 6455</span>
<span class="s1">var </span><span class="s2">handler$2 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;ws&quot;</span><span class="s0">,</span>
    <span class="s2">domainHost</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s1">function </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">wsComponents </span><span class="s0">= </span><span class="s2">components</span><span class="s0">;</span>
        <span class="s7">//indicate if the secure flag is set</span>
        <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">= </span><span class="s2">isSecure</span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">);</span>
        <span class="s7">//construct resouce name</span>
        <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">resourceName </span><span class="s0">= (</span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">|| </span><span class="s3">'/'</span><span class="s0">) + (</span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">query </span><span class="s0">? </span><span class="s3">'?' </span><span class="s0">+ </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">query </span><span class="s0">: </span><span class="s3">''</span><span class="s0">);</span>
        <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s1">return </span><span class="s2">wsComponents</span><span class="s0">;</span>
    <span class="s0">},</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s1">function </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s7">//normalize the default port</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== (</span><span class="s2">isSecure</span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">) ? </span><span class="s4">443 </span><span class="s0">: </span><span class="s4">80</span><span class="s0">) || </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">port </span><span class="s0">=== </span><span class="s3">&quot;&quot;</span><span class="s0">) {</span>
            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">port </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//ensure scheme matches secure flag</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">=== </span><span class="s3">'boolean'</span><span class="s0">) {</span>
            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">? </span><span class="s3">'wss' </span><span class="s0">: </span><span class="s3">'ws'</span><span class="s0">;</span>
            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">secure </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//reconstruct path from resource name</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">resourceName</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">_wsComponents$resourc </span><span class="s0">= </span><span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">resourceName</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">'?'</span><span class="s0">),</span>
                <span class="s2">_wsComponents$resourc2 </span><span class="s0">= </span><span class="s2">slicedToArray</span><span class="s0">(</span><span class="s2">_wsComponents$resourc</span><span class="s0">, </span><span class="s4">2</span><span class="s0">),</span>
                <span class="s2">path </span><span class="s0">= </span><span class="s2">_wsComponents$resourc2</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span>
                <span class="s2">query </span><span class="s0">= </span><span class="s2">_wsComponents$resourc2</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span>

            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">path </span><span class="s0">&amp;&amp; </span><span class="s2">path </span><span class="s0">!== </span><span class="s3">'/' </span><span class="s0">? </span><span class="s2">path </span><span class="s0">: </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">query</span><span class="s0">;</span>
            <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">resourceName </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s7">//forbid fragment component</span>
        <span class="s2">wsComponents</span><span class="s0">.</span><span class="s2">fragment </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s1">return </span><span class="s2">wsComponents</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">handler$3 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;wss&quot;</span><span class="s0">,</span>
    <span class="s2">domainHost</span><span class="s0">: </span><span class="s2">handler$2</span><span class="s0">.</span><span class="s2">domainHost</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s2">handler$2</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">,</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s2">handler$2</span><span class="s0">.</span><span class="s2">serialize</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">O </span><span class="s0">= {};</span>
<span class="s1">var </span><span class="s2">isIRI </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
<span class="s7">//RFC 3986</span>
<span class="s1">var </span><span class="s2">UNRESERVED$$ </span><span class="s0">= </span><span class="s3">&quot;[A-Za-z0-9</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">.</span><span class="s1">\\</span><span class="s3">_</span><span class="s1">\\</span><span class="s3">~&quot; </span><span class="s0">+ (</span><span class="s2">isIRI </span><span class="s0">? </span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">xA0-</span><span class="s1">\\</span><span class="s3">u200D</span><span class="s1">\\</span><span class="s3">u2010-</span><span class="s1">\\</span><span class="s3">u2029</span><span class="s1">\\</span><span class="s3">u202F-</span><span class="s1">\\</span><span class="s3">uD7FF</span><span class="s1">\\</span><span class="s3">uF900-</span><span class="s1">\\</span><span class="s3">uFDCF</span><span class="s1">\\</span><span class="s3">uFDF0-</span><span class="s1">\\</span><span class="s3">uFFEF&quot; </span><span class="s0">: </span><span class="s3">&quot;&quot;</span><span class="s0">) + </span><span class="s3">&quot;]&quot;</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">HEXDIG$$ </span><span class="s0">= </span><span class="s3">&quot;[0-9A-Fa-f]&quot;</span><span class="s0">; </span><span class="s7">//case-insensitive</span>
<span class="s1">var </span><span class="s2">PCT_ENCODED$ </span><span class="s0">= </span><span class="s2">subexp</span><span class="s0">(</span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%[EFef]&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%[89A-Fa-f]&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">) + </span><span class="s3">&quot;|&quot; </span><span class="s0">+ </span><span class="s2">subexp</span><span class="s0">(</span><span class="s3">&quot;%&quot; </span><span class="s0">+ </span><span class="s2">HEXDIG$$ </span><span class="s0">+ </span><span class="s2">HEXDIG$$</span><span class="s0">)); </span><span class="s7">//expanded</span>
<span class="s7">//RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] &amp; ; =</span>
<span class="s7">//const ATEXT$$ = &quot;[A-Za-z0-9\\!\\#\\$\\%\\&amp;\\'\\*\\+\\-\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~]&quot;;</span>
<span class="s7">//const WSP$$ = &quot;[\\x20\\x09]&quot;;</span>
<span class="s7">//const OBS_QTEXT$$ = &quot;[\\x01-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]&quot;;  //(%d1-8 / %d11-12 / %d14-31 / %d127)</span>
<span class="s7">//const QTEXT$$ = merge(&quot;[\\x21\\x23-\\x5B\\x5D-\\x7E]&quot;, OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext</span>
<span class="s7">//const VCHAR$$ = &quot;[\\x21-\\x7E]&quot;;</span>
<span class="s7">//const WSP$$ = &quot;[\\x20\\x09]&quot;;</span>
<span class="s7">//const OBS_QP$ = subexp(&quot;\\\\&quot; + merge(&quot;[\\x00\\x0D\\x0A]&quot;, OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext</span>
<span class="s7">//const FWS$ = subexp(subexp(WSP$$ + &quot;*&quot; + &quot;\\x0D\\x0A&quot;) + &quot;?&quot; + WSP$$ + &quot;+&quot;);</span>
<span class="s7">//const QUOTED_PAIR$ = subexp(subexp(&quot;\\\\&quot; + subexp(VCHAR$$ + &quot;|&quot; + WSP$$)) + &quot;|&quot; + OBS_QP$);</span>
<span class="s7">//const QUOTED_STRING$ = subexp('\\&quot;' + subexp(FWS$ + &quot;?&quot; + QCONTENT$) + &quot;*&quot; + FWS$ + &quot;?&quot; + '\\&quot;');</span>
<span class="s1">var </span><span class="s2">ATEXT$$ </span><span class="s0">= </span><span class="s3">&quot;[A-Za-z0-9</span><span class="s1">\\</span><span class="s3">!</span><span class="s1">\\</span><span class="s3">$</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">'</span><span class="s1">\\</span><span class="s3">*</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">^</span><span class="s1">\\</span><span class="s3">_</span><span class="s1">\\</span><span class="s3">`</span><span class="s1">\\</span><span class="s3">{</span><span class="s1">\\</span><span class="s3">|</span><span class="s1">\\</span><span class="s3">}</span><span class="s1">\\</span><span class="s3">~]&quot;</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">QTEXT$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">!</span><span class="s1">\\</span><span class="s3">$</span><span class="s1">\\</span><span class="s3">%</span><span class="s1">\\</span><span class="s3">'</span><span class="s1">\\</span><span class="s3">(</span><span class="s1">\\</span><span class="s3">)</span><span class="s1">\\</span><span class="s3">*</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">,</span><span class="s1">\\</span><span class="s3">-</span><span class="s1">\\</span><span class="s3">.0-9</span><span class="s1">\\</span><span class="s3">&lt;</span><span class="s1">\\</span><span class="s3">&gt;A-Z</span><span class="s1">\\</span><span class="s3">x5E-</span><span class="s1">\\</span><span class="s3">x7E]&quot;</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">VCHAR$$ </span><span class="s0">= </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">QTEXT$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\\&quot;\\\\</span><span class="s3">]&quot;</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">SOME_DELIMS$$ </span><span class="s0">= </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">!</span><span class="s1">\\</span><span class="s3">$</span><span class="s1">\\</span><span class="s3">'</span><span class="s1">\\</span><span class="s3">(</span><span class="s1">\\</span><span class="s3">)</span><span class="s1">\\</span><span class="s3">*</span><span class="s1">\\</span><span class="s3">+</span><span class="s1">\\</span><span class="s3">,</span><span class="s1">\\</span><span class="s3">;</span><span class="s1">\\</span><span class="s3">:</span><span class="s1">\\</span><span class="s3">@]&quot;</span><span class="s0">;</span>
<span class="s1">var </span><span class="s2">UNRESERVED </span><span class="s0">= </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s3">&quot;g&quot;</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">PCT_ENCODED </span><span class="s0">= </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">PCT_ENCODED$</span><span class="s0">, </span><span class="s3">&quot;g&quot;</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">NOT_LOCAL_PART </span><span class="s0">= </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^]&quot;</span><span class="s0">, </span><span class="s2">ATEXT$$</span><span class="s0">, </span><span class="s3">&quot;[</span><span class="s1">\\</span><span class="s3">.]&quot;</span><span class="s0">, </span><span class="s3">'[</span><span class="s1">\\</span><span class="s3">&quot;]'</span><span class="s0">, </span><span class="s2">VCHAR$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">NOT_HFNAME </span><span class="s0">= </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">merge</span><span class="s0">(</span><span class="s3">&quot;[^]&quot;</span><span class="s0">, </span><span class="s2">UNRESERVED$$</span><span class="s0">, </span><span class="s2">SOME_DELIMS$$</span><span class="s0">), </span><span class="s3">&quot;g&quot;</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">NOT_HFVALUE </span><span class="s0">= </span><span class="s2">NOT_HFNAME</span><span class="s0">;</span>
<span class="s1">function </span><span class="s2">decodeUnreserved</span><span class="s0">(</span><span class="s2">str</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">decStr </span><span class="s0">= </span><span class="s2">pctDecChars</span><span class="s0">(</span><span class="s2">str</span><span class="s0">);</span>
    <span class="s1">return </span><span class="s0">!</span><span class="s2">decStr</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">UNRESERVED</span><span class="s0">) ? </span><span class="s2">str </span><span class="s0">: </span><span class="s2">decStr</span><span class="s0">;</span>
<span class="s0">}</span>
<span class="s1">var </span><span class="s2">handler$4 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;mailto&quot;</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s1">function </span><span class="s2">parse$$1</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">mailtoComponents </span><span class="s0">= </span><span class="s2">components</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">to </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">to </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">? </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">) : [];</span>
        <span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">query</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">unknownHeaders </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
            <span class="s1">var </span><span class="s2">headers </span><span class="s0">= {};</span>
            <span class="s1">var </span><span class="s2">hfields </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">query</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;&amp;&quot;</span><span class="s0">);</span>
            <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">x </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">xl </span><span class="s0">= </span><span class="s2">hfields</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">x </span><span class="s0">&lt; </span><span class="s2">xl</span><span class="s0">; ++</span><span class="s2">x</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">hfield </span><span class="s0">= </span><span class="s2">hfields</span><span class="s0">[</span><span class="s2">x</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;=&quot;</span><span class="s0">);</span>
                <span class="s1">switch </span><span class="s0">(</span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]) {</span>
                    <span class="s1">case </span><span class="s3">&quot;to&quot;</span><span class="s0">:</span>
                        <span class="s1">var </span><span class="s2">toAddrs </span><span class="s0">= </span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">);</span>
                        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_x </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">_xl </span><span class="s0">= </span><span class="s2">toAddrs</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">_x </span><span class="s0">&lt; </span><span class="s2">_xl</span><span class="s0">; ++</span><span class="s2">_x</span><span class="s0">) {</span>
                            <span class="s2">to</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">toAddrs</span><span class="s0">[</span><span class="s2">_x</span><span class="s0">]);</span>
                        <span class="s0">}</span>
                        <span class="s1">break</span><span class="s0">;</span>
                    <span class="s1">case </span><span class="s3">&quot;subject&quot;</span><span class="s0">:</span>
                        <span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">subject </span><span class="s0">= </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s2">options</span><span class="s0">);</span>
                        <span class="s1">break</span><span class="s0">;</span>
                    <span class="s1">case </span><span class="s3">&quot;body&quot;</span><span class="s0">:</span>
                        <span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">body </span><span class="s0">= </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s2">options</span><span class="s0">);</span>
                        <span class="s1">break</span><span class="s0">;</span>
                    <span class="s1">default</span><span class="s0">:</span>
                        <span class="s2">unknownHeaders </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
                        <span class="s2">headers</span><span class="s0">[</span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">0</span><span class="s0">], </span><span class="s2">options</span><span class="s0">)] = </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">hfield</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s2">options</span><span class="s0">);</span>
                        <span class="s1">break</span><span class="s0">;</span>
                <span class="s0">}</span>
            <span class="s0">}</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">unknownHeaders</span><span class="s0">) </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">headers </span><span class="s0">= </span><span class="s2">headers</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">_x2 </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">_xl2 </span><span class="s0">= </span><span class="s2">to</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">_x2 </span><span class="s0">&lt; </span><span class="s2">_xl2</span><span class="s0">; ++</span><span class="s2">_x2</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">addr </span><span class="s0">= </span><span class="s2">to</span><span class="s0">[</span><span class="s2">_x2</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">);</span>
            <span class="s2">addr</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] = </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">addr</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]);</span>
            <span class="s1">if </span><span class="s0">(!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">unicodeSupport</span><span class="s0">) {</span>
                <span class="s7">//convert Unicode IDN -&gt; ASCII IDN</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s2">addr</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] = </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toASCII</span><span class="s0">(</span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">addr</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s2">options</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">());</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
                    <span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;Email address's domain name can not be converted to ASCII via punycode: &quot; </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">;</span>
                <span class="s0">}</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s2">addr</span><span class="s0">[</span><span class="s4">1</span><span class="s0">] = </span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">addr</span><span class="s0">[</span><span class="s4">1</span><span class="s0">], </span><span class="s2">options</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">();</span>
            <span class="s0">}</span>
            <span class="s2">to</span><span class="s0">[</span><span class="s2">_x2</span><span class="s0">] = </span><span class="s2">addr</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">mailtoComponents</span><span class="s0">;</span>
    <span class="s0">},</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s1">function </span><span class="s2">serialize$$1</span><span class="s0">(</span><span class="s2">mailtoComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">components </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">to </span><span class="s0">= </span><span class="s2">toArray</span><span class="s0">(</span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">to</span><span class="s0">);</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">to</span><span class="s0">) {</span>
            <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">x </span><span class="s0">= </span><span class="s4">0</span><span class="s0">, </span><span class="s2">xl </span><span class="s0">= </span><span class="s2">to</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">x </span><span class="s0">&lt; </span><span class="s2">xl</span><span class="s0">; ++</span><span class="s2">x</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">toAddr </span><span class="s0">= </span><span class="s2">String</span><span class="s0">(</span><span class="s2">to</span><span class="s0">[</span><span class="s2">x</span><span class="s0">]);</span>
                <span class="s1">var </span><span class="s2">atIdx </span><span class="s0">= </span><span class="s2">toAddr</span><span class="s0">.</span><span class="s2">lastIndexOf</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">);</span>
                <span class="s1">var </span><span class="s2">localPart </span><span class="s0">= </span><span class="s2">toAddr</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, </span><span class="s2">atIdx</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">NOT_LOCAL_PART</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">);</span>
                <span class="s1">var </span><span class="s2">domain </span><span class="s0">= </span><span class="s2">toAddr</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">atIdx </span><span class="s0">+ </span><span class="s4">1</span><span class="s0">);</span>
                <span class="s7">//convert IDN via punycode</span>
                <span class="s1">try </span><span class="s0">{</span>
                    <span class="s2">domain </span><span class="s0">= !</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toASCII</span><span class="s0">(</span><span class="s2">unescapeComponent</span><span class="s0">(</span><span class="s2">domain</span><span class="s0">, </span><span class="s2">options</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">()) : </span><span class="s2">punycode</span><span class="s0">.</span><span class="s2">toUnicode</span><span class="s0">(</span><span class="s2">domain</span><span class="s0">);</span>
                <span class="s0">} </span><span class="s1">catch </span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
                    <span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;Email address's domain name can not be converted to &quot; </span><span class="s0">+ (!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">iri </span><span class="s0">? </span><span class="s3">&quot;ASCII&quot; </span><span class="s0">: </span><span class="s3">&quot;Unicode&quot;</span><span class="s0">) + </span><span class="s3">&quot; via punycode: &quot; </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">;</span>
                <span class="s0">}</span>
                <span class="s2">to</span><span class="s0">[</span><span class="s2">x</span><span class="s0">] = </span><span class="s2">localPart </span><span class="s0">+ </span><span class="s3">&quot;@&quot; </span><span class="s0">+ </span><span class="s2">domain</span><span class="s0">;</span>
            <span class="s0">}</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">to</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">headers </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">headers </span><span class="s0">= </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">headers </span><span class="s0">|| {};</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">) </span><span class="s2">headers</span><span class="s0">[</span><span class="s3">&quot;subject&quot;</span><span class="s0">] = </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">body</span><span class="s0">) </span><span class="s2">headers</span><span class="s0">[</span><span class="s3">&quot;body&quot;</span><span class="s0">] = </span><span class="s2">mailtoComponents</span><span class="s0">.</span><span class="s2">body</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">fields </span><span class="s0">= [];</span>
        <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">name </span><span class="s1">in </span><span class="s2">headers</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">headers</span><span class="s0">[</span><span class="s2">name</span><span class="s0">] !== </span><span class="s2">O</span><span class="s0">[</span><span class="s2">name</span><span class="s0">]) {</span>
                <span class="s2">fields</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">name</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">NOT_HFNAME</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">) + </span><span class="s3">&quot;=&quot; </span><span class="s0">+ </span><span class="s2">headers</span><span class="s0">[</span><span class="s2">name</span><span class="s0">].</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">decodeUnreserved</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">PCT_ENCODED</span><span class="s0">, </span><span class="s2">toUpperCase</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">NOT_HFVALUE</span><span class="s0">, </span><span class="s2">pctEncChar</span><span class="s0">));</span>
            <span class="s0">}</span>
        <span class="s0">}</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">fields</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
            <span class="s2">components</span><span class="s0">.</span><span class="s2">query </span><span class="s0">= </span><span class="s2">fields</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&amp;&quot;</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">components</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">URN_PARSE </span><span class="s0">= </span><span class="s8">/^([^\:]+)\:(.*)/</span><span class="s0">;</span>
<span class="s7">//RFC 2141</span>
<span class="s1">var </span><span class="s2">handler$5 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;urn&quot;</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s1">function </span><span class="s2">parse$$1</span><span class="s0">(</span><span class="s2">components</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">matches </span><span class="s0">= </span><span class="s2">components</span><span class="s0">.</span><span class="s2">path </span><span class="s0">&amp;&amp; </span><span class="s2">components</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">URN_PARSE</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">urnComponents </span><span class="s0">= </span><span class="s2">components</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">matches</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s3">&quot;urn&quot;</span><span class="s0">;</span>
            <span class="s1">var </span><span class="s2">nid </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">toLowerCase</span><span class="s0">();</span>
            <span class="s1">var </span><span class="s2">nss </span><span class="s0">= </span><span class="s2">matches</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span>
            <span class="s1">var </span><span class="s2">urnScheme </span><span class="s0">= </span><span class="s2">scheme </span><span class="s0">+ </span><span class="s3">&quot;:&quot; </span><span class="s0">+ (</span><span class="s2">options</span><span class="s0">.</span><span class="s2">nid </span><span class="s0">|| </span><span class="s2">nid</span><span class="s0">);</span>
            <span class="s1">var </span><span class="s2">schemeHandler </span><span class="s0">= </span><span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">urnScheme</span><span class="s0">];</span>
            <span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">nid </span><span class="s0">= </span><span class="s2">nid</span><span class="s0">;</span>
            <span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">nss </span><span class="s0">= </span><span class="s2">nss</span><span class="s0">;</span>
            <span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">schemeHandler</span><span class="s0">) {</span>
                <span class="s2">urnComponents </span><span class="s0">= </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">urnComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
            <span class="s0">}</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;URN can not be parsed.&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">urnComponents</span><span class="s0">;</span>
    <span class="s0">},</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s1">function </span><span class="s2">serialize$$1</span><span class="s0">(</span><span class="s2">urnComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">scheme </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">scheme </span><span class="s0">|| </span><span class="s3">&quot;urn&quot;</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">nid </span><span class="s0">= </span><span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">nid</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">urnScheme </span><span class="s0">= </span><span class="s2">scheme </span><span class="s0">+ </span><span class="s3">&quot;:&quot; </span><span class="s0">+ (</span><span class="s2">options</span><span class="s0">.</span><span class="s2">nid </span><span class="s0">|| </span><span class="s2">nid</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">schemeHandler </span><span class="s0">= </span><span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">urnScheme</span><span class="s0">];</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">schemeHandler</span><span class="s0">) {</span>
            <span class="s2">urnComponents </span><span class="s0">= </span><span class="s2">schemeHandler</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">urnComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">);</span>
        <span class="s0">}</span>
        <span class="s1">var </span><span class="s2">uriComponents </span><span class="s0">= </span><span class="s2">urnComponents</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">nss </span><span class="s0">= </span><span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">nss</span><span class="s0">;</span>
        <span class="s2">uriComponents</span><span class="s0">.</span><span class="s2">path </span><span class="s0">= (</span><span class="s2">nid </span><span class="s0">|| </span><span class="s2">options</span><span class="s0">.</span><span class="s2">nid</span><span class="s0">) + </span><span class="s3">&quot;:&quot; </span><span class="s0">+ </span><span class="s2">nss</span><span class="s0">;</span>
        <span class="s1">return </span><span class="s2">uriComponents</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">UUID </span><span class="s0">= </span><span class="s8">/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/</span><span class="s0">;</span>
<span class="s7">//RFC 4122</span>
<span class="s1">var </span><span class="s2">handler$6 </span><span class="s0">= {</span>
    <span class="s2">scheme</span><span class="s0">: </span><span class="s3">&quot;urn:uuid&quot;</span><span class="s0">,</span>
    <span class="s2">parse</span><span class="s0">: </span><span class="s1">function </span><span class="s2">parse</span><span class="s0">(</span><span class="s2">urnComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">uuidComponents </span><span class="s0">= </span><span class="s2">urnComponents</span><span class="s0">;</span>
        <span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">uuid </span><span class="s0">= </span><span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">nss</span><span class="s0">;</span>
        <span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">nss </span><span class="s0">= </span><span class="s2">undefined</span><span class="s0">;</span>
        <span class="s1">if </span><span class="s0">(!</span><span class="s2">options</span><span class="s0">.</span><span class="s2">tolerant </span><span class="s0">&amp;&amp; (!</span><span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">uuid </span><span class="s0">|| !</span><span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">uuid</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">UUID</span><span class="s0">))) {</span>
            <span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">= </span><span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">error </span><span class="s0">|| </span><span class="s3">&quot;UUID is not valid.&quot;</span><span class="s0">;</span>
        <span class="s0">}</span>
        <span class="s1">return </span><span class="s2">uuidComponents</span><span class="s0">;</span>
    <span class="s0">},</span>
    <span class="s2">serialize</span><span class="s0">: </span><span class="s1">function </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">uuidComponents</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">urnComponents </span><span class="s0">= </span><span class="s2">uuidComponents</span><span class="s0">;</span>
        <span class="s7">//normalize UUID</span>
        <span class="s2">urnComponents</span><span class="s0">.</span><span class="s2">nss </span><span class="s0">= (</span><span class="s2">uuidComponents</span><span class="s0">.</span><span class="s2">uuid </span><span class="s0">|| </span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">();</span>
        <span class="s1">return </span><span class="s2">urnComponents</span><span class="s0">;</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$1</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$1</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$2</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$2</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$3</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$3</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$4</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$4</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$5</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$5</span><span class="s0">;</span>
<span class="s2">SCHEMES</span><span class="s0">[</span><span class="s2">handler$6</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">] = </span><span class="s2">handler$6</span><span class="s0">;</span>

<span class="s2">exports</span><span class="s0">.</span><span class="s2">SCHEMES </span><span class="s0">= </span><span class="s2">SCHEMES</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">pctEncChar </span><span class="s0">= </span><span class="s2">pctEncChar</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">pctDecChars </span><span class="s0">= </span><span class="s2">pctDecChars</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">parse </span><span class="s0">= </span><span class="s2">parse</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">removeDotSegments </span><span class="s0">= </span><span class="s2">removeDotSegments</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">serialize </span><span class="s0">= </span><span class="s2">serialize</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">resolveComponents </span><span class="s0">= </span><span class="s2">resolveComponents</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">resolve </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">normalize </span><span class="s0">= </span><span class="s2">normalize</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">equal </span><span class="s0">= </span><span class="s2">equal</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">escapeComponent </span><span class="s0">= </span><span class="s2">escapeComponent</span><span class="s0">;</span>
<span class="s2">exports</span><span class="s0">.</span><span class="s2">unescapeComponent </span><span class="s0">= </span><span class="s2">unescapeComponent</span><span class="s0">;</span>

<span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">exports</span><span class="s0">, </span><span class="s3">'__esModule'</span><span class="s0">, { </span><span class="s2">value</span><span class="s0">: </span><span class="s1">true </span><span class="s0">});</span>

<span class="s0">})));</span>


<span class="s0">},{}],</span><span class="s3">&quot;ajv&quot;</span><span class="s0">:[</span><span class="s1">function</span><span class="s0">(</span><span class="s2">require</span><span class="s0">,</span><span class="s2">module</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">){</span>
<span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">compileSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">resolve </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/resolve'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">Cache </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./cache'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">SchemaObject </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/schema_obj'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">stableStringify </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'fast-json-stable-stringify'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">formats </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/formats'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">rules </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/rules'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">$dataMetaSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./data'</span><span class="s0">)</span>
  <span class="s0">, </span><span class="s2">util </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/util'</span><span class="s0">);</span>

<span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">Ajv</span><span class="s0">;</span>

<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">= </span><span class="s2">validate</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">compile </span><span class="s0">= </span><span class="s2">compile</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addSchema </span><span class="s0">= </span><span class="s2">addSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addMetaSchema </span><span class="s0">= </span><span class="s2">addMetaSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">= </span><span class="s2">validateSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getSchema </span><span class="s0">= </span><span class="s2">getSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">removeSchema </span><span class="s0">= </span><span class="s2">removeSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addFormat </span><span class="s0">= </span><span class="s2">addFormat</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">errorsText </span><span class="s0">= </span><span class="s2">errorsText</span><span class="s0">;</span>

<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">_addSchema </span><span class="s0">= </span><span class="s2">_addSchema</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">_compile </span><span class="s0">= </span><span class="s2">_compile</span><span class="s0">;</span>

<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">compileAsync </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/async'</span><span class="s0">);</span>
<span class="s1">var </span><span class="s2">customKeyword </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./keyword'</span><span class="s0">);</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addKeyword </span><span class="s0">= </span><span class="s2">customKeyword</span><span class="s0">.</span><span class="s2">add</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getKeyword </span><span class="s0">= </span><span class="s2">customKeyword</span><span class="s0">.</span><span class="s2">get</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">removeKeyword </span><span class="s0">= </span><span class="s2">customKeyword</span><span class="s0">.</span><span class="s2">remove</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">validateKeyword </span><span class="s0">= </span><span class="s2">customKeyword</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">errorClasses </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./compile/error_classes'</span><span class="s0">);</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">ValidationError </span><span class="s0">= </span><span class="s2">errorClasses</span><span class="s0">.</span><span class="s2">Validation</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">MissingRefError </span><span class="s0">= </span><span class="s2">errorClasses</span><span class="s0">.</span><span class="s2">MissingRef</span><span class="s0">;</span>
<span class="s2">Ajv</span><span class="s0">.</span><span class="s2">$dataMetaSchema </span><span class="s0">= </span><span class="s2">$dataMetaSchema</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">META_SCHEMA_ID </span><span class="s0">= </span><span class="s3">'http://json-schema.org/draft-07/schema'</span><span class="s0">;</span>

<span class="s1">var </span><span class="s2">META_IGNORE_OPTIONS </span><span class="s0">= [ </span><span class="s3">'removeAdditional'</span><span class="s0">, </span><span class="s3">'useDefaults'</span><span class="s0">, </span><span class="s3">'coerceTypes'</span><span class="s0">, </span><span class="s3">'strictDefaults' </span><span class="s0">];</span>
<span class="s1">var </span><span class="s2">META_SUPPORT_DATA </span><span class="s0">= [</span><span class="s3">'/properties'</span><span class="s0">];</span>

<span class="s5">/**</span>
 <span class="s5">* Creates validator instance.</span>
 <span class="s5">* Usage: `Ajv(opts)`</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} opts optional options</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Object} ajv instance</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">Ajv</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(!(</span><span class="s1">this instanceof </span><span class="s2">Ajv</span><span class="s0">)) </span><span class="s1">return new </span><span class="s2">Ajv</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">);</span>
  <span class="s2">opts </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">) || {};</span>
  <span class="s2">setLogger</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas </span><span class="s0">= {};</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_refs </span><span class="s0">= {};</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_fragments </span><span class="s0">= {};</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_formats </span><span class="s0">= </span><span class="s2">formats</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">format</span><span class="s0">);</span>

  <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">cache </span><span class="s0">|| </span><span class="s1">new </span><span class="s2">Cache</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_loadingSchemas </span><span class="s0">= {};</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_compilations </span><span class="s0">= [];</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">RULES </span><span class="s0">= </span><span class="s2">rules</span><span class="s0">();</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_getId </span><span class="s0">= </span><span class="s2">chooseGetId</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">);</span>

  <span class="s2">opts</span><span class="s0">.</span><span class="s2">loopRequired </span><span class="s0">= </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">loopRequired </span><span class="s0">|| </span><span class="s2">Infinity</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">errorDataPath </span><span class="s0">== </span><span class="s3">'property'</span><span class="s0">) </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">_errorDataPathProperty </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">serialize </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">serialize </span><span class="s0">= </span><span class="s2">stableStringify</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_metaOpts </span><span class="s0">= </span><span class="s2">getMetaSchemaOptions</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">formats</span><span class="s0">) </span><span class="s2">addInitialFormats</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">) </span><span class="s2">addInitialKeywords</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
  <span class="s2">addDefaultMetaSchema</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">opts</span><span class="s0">.</span><span class="s2">meta </span><span class="s0">== </span><span class="s3">'object'</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">addMetaSchema</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">meta</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">nullable</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">addKeyword</span><span class="s0">(</span><span class="s3">'nullable'</span><span class="s0">, {</span><span class="s2">metaSchema</span><span class="s0">: {</span><span class="s2">type</span><span class="s0">: </span><span class="s3">'boolean'</span><span class="s0">}});</span>
  <span class="s2">addInitialSchemas</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
<span class="s0">}</span>



<span class="s5">/**</span>
 <span class="s5">* Validate data using schema</span>
 <span class="s5">* Schema will be compiled and cached (using serialized JSON as key. [fast-json-stable-stringify](https://github.com/epoberezkin/fast-json-stable-stringify) is used to serialize.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String|Object} schemaKeyRef key, ref or schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Any} data to be validated</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Boolean} validation result. Errors from the last validation will be available in `ajv.errors` (and also in compiled schema: `schema.errors`).</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">validate</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">, </span><span class="s2">data</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schemaKeyRef </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) {</span>
    <span class="s2">v </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">getSchema</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">v</span><span class="s0">) </span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'no schema with key or ref &quot;' </span><span class="s0">+ </span><span class="s2">schemaKeyRef </span><span class="s0">+ </span><span class="s3">'&quot;'</span><span class="s0">);</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addSchema</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
    <span class="s2">v </span><span class="s0">= </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s2">valid </span><span class="s0">= </span><span class="s2">v</span><span class="s0">(</span><span class="s2">data</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">v</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">!== </span><span class="s1">true</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">valid</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Create validating function for passed schema.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Boolean} _meta true if schema is a meta-schema. Used internally to compile meta schemas of custom keywords.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} validating function</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">compile</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">_meta</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">_meta</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Adds schema to the instance.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object|Array} schema schema or array of schemas. If array is passed, `key` and other parameters will be ignored.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} key Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} _skipValidation true to skip schema validation. Used internally, option validateSchema should be used instead.</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} _meta true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">_skipValidation</span><span class="s0">, </span><span class="s2">_meta</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">)){</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">[</span><span class="s2">i</span><span class="s0">], </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">_skipValidation</span><span class="s0">, </span><span class="s2">_meta</span><span class="s0">);</span>
    <span class="s1">return this</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">id </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">id </span><span class="s0">!= </span><span class="s3">'string'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'schema id must be string'</span><span class="s0">);</span>
  <span class="s2">key </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">key </span><span class="s0">|| </span><span class="s2">id</span><span class="s0">);</span>
  <span class="s2">checkUnique</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">key</span><span class="s0">);</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">key</span><span class="s0">] = </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">_skipValidation</span><span class="s0">, </span><span class="s2">_meta</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Add schema that will be used to validate other schemas</span>
 <span class="s5">* options in META_IGNORE_OPTIONS are alway set to false</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} schema schema object</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} key optional schema key</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} skipValidation true to skip schema validation, can be used to override validateSchema option for meta-schema</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">addMetaSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">skipValidation</span><span class="s0">) {</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, </span><span class="s2">skipValidation</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Validate schema</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Object} schema schema to validate</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{Boolean} throwOrLogError pass true to throw (or log) an error if invalid</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Boolean} true if schema is valid</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">validateSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">throwOrLogError</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">$schema </span><span class="s0">= </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$schema</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">$schema </span><span class="s0">!== </span><span class="s2">undefined </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">$schema </span><span class="s0">!= </span><span class="s3">'string'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'$schema must be a string'</span><span class="s0">);</span>
  <span class="s2">$schema </span><span class="s0">= </span><span class="s2">$schema </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">defaultMeta </span><span class="s0">|| </span><span class="s2">defaultMeta</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">$schema</span><span class="s0">) {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">'meta-schema not available'</span><span class="s0">);</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
    <span class="s1">return true</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">var </span><span class="s2">valid </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">$schema</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">valid </span><span class="s0">&amp;&amp; </span><span class="s2">throwOrLogError</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">message </span><span class="s0">= </span><span class="s3">'schema is invalid: ' </span><span class="s0">+ </span><span class="s1">this</span><span class="s0">.</span><span class="s2">errorsText</span><span class="s0">();</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">== </span><span class="s3">'log'</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">message</span><span class="s0">);</span>
    <span class="s1">else throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">message</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">valid</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">defaultMeta</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">meta </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">meta</span><span class="s0">;</span>
  <span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">defaultMeta </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">meta </span><span class="s0">== </span><span class="s3">'object'</span>
                            <span class="s0">? </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">meta</span><span class="s0">) || </span><span class="s2">meta</span>
                            <span class="s0">: </span><span class="s2">self</span><span class="s0">.</span><span class="s2">getSchema</span><span class="s0">(</span><span class="s2">META_SCHEMA_ID</span><span class="s0">)</span>
                              <span class="s0">? </span><span class="s2">META_SCHEMA_ID</span>
                              <span class="s0">: </span><span class="s2">undefined</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">defaultMeta</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Get compiled schema from the instance by `key` or `ref`.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String} keyRef `key` that was passed to `addSchema` or full schema reference (`schema.id` or resolved id).</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Function} schema validating function (with property `schema`).</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">getSchema</span><span class="s0">(</span><span class="s2">keyRef</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s2">_getSchemaObj</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">keyRef</span><span class="s0">);</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schemaObj</span><span class="s0">) {</span>
    <span class="s1">case </span><span class="s3">'object'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
    <span class="s1">case </span><span class="s3">'string'</span><span class="s0">: </span><span class="s1">return this</span><span class="s0">.</span><span class="s2">getSchema</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">);</span>
    <span class="s1">case </span><span class="s3">'undefined'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">_getSchemaFragment</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">keyRef</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">_getSchemaFragment</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">ref</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">res </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, { </span><span class="s2">schema</span><span class="s0">: {} }, </span><span class="s2">ref</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">res</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">schema </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">schema</span>
      <span class="s0">, </span><span class="s2">root </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">root</span>
      <span class="s0">, </span><span class="s2">baseId </span><span class="s0">= </span><span class="s2">res</span><span class="s0">.</span><span class="s2">baseId</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">v </span><span class="s0">= </span><span class="s2">compileSchema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">undefined</span><span class="s0">, </span><span class="s2">baseId</span><span class="s0">);</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">_fragments</span><span class="s0">[</span><span class="s2">ref</span><span class="s0">] = </span><span class="s1">new </span><span class="s2">SchemaObject</span><span class="s0">({</span>
      <span class="s2">ref</span><span class="s0">: </span><span class="s2">ref</span><span class="s0">,</span>
      <span class="s2">fragment</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
      <span class="s2">schema</span><span class="s0">: </span><span class="s2">schema</span><span class="s0">,</span>
      <span class="s2">root</span><span class="s0">: </span><span class="s2">root</span><span class="s0">,</span>
      <span class="s2">baseId</span><span class="s0">: </span><span class="s2">baseId</span><span class="s0">,</span>
      <span class="s2">validate</span><span class="s0">: </span><span class="s2">v</span>
    <span class="s0">});</span>
    <span class="s1">return </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">_getSchemaObj</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">keyRef</span><span class="s0">) {</span>
  <span class="s2">keyRef </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">keyRef</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">keyRef</span><span class="s0">] || </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">keyRef</span><span class="s0">] || </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_fragments</span><span class="s0">[</span><span class="s2">keyRef</span><span class="s0">];</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Remove cached schema(s).</span>
 <span class="s5">* If no parameter is passed all schemas but meta-schemas are removed.</span>
 <span class="s5">* If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.</span>
 <span class="s5">* Even if schema is referenced by other schemas it still can be removed as other schemas have local references.</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{String|Object|RegExp} schemaKeyRef key, ref, pattern to match key/ref or schema object</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">removeSchema</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaKeyRef </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">) {</span>
    <span class="s2">_removeAllSchemas</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">, </span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
    <span class="s2">_removeAllSchemas</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">, </span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
    <span class="s1">return this</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schemaKeyRef</span><span class="s0">) {</span>
    <span class="s1">case </span><span class="s3">'undefined'</span><span class="s0">:</span>
      <span class="s2">_removeAllSchemas</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">);</span>
      <span class="s2">_removeAllSchemas</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">);</span>
      <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span>
      <span class="s1">return this</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'string'</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s2">_getSchemaObj</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">del</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">cacheKey</span><span class="s0">);</span>
      <span class="s1">delete this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">schemaKeyRef</span><span class="s0">];</span>
      <span class="s1">delete this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">schemaKeyRef</span><span class="s0">];</span>
      <span class="s1">return this</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'object'</span><span class="s0">:</span>
      <span class="s1">var </span><span class="s2">serialize </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">;</span>
      <span class="s1">var </span><span class="s2">cacheKey </span><span class="s0">= </span><span class="s2">serialize </span><span class="s0">? </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">) : </span><span class="s2">schemaKeyRef</span><span class="s0">;</span>
      <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">del</span><span class="s0">(</span><span class="s2">cacheKey</span><span class="s0">);</span>
      <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schemaKeyRef</span><span class="s0">);</span>
      <span class="s1">if </span><span class="s0">(</span><span class="s2">id</span><span class="s0">) {</span>
        <span class="s2">id </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">id</span><span class="s0">);</span>
        <span class="s1">delete this</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">id</span><span class="s0">];</span>
        <span class="s1">delete this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">];</span>
      <span class="s0">}</span>
  <span class="s0">}</span>
  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">_removeAllSchemas</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">schemas</span><span class="s0">, </span><span class="s2">regex</span><span class="s0">) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">keyRef </span><span class="s1">in </span><span class="s2">schemas</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s2">schemas</span><span class="s0">[</span><span class="s2">keyRef</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">meta </span><span class="s0">&amp;&amp; (!</span><span class="s2">regex </span><span class="s0">|| </span><span class="s2">regex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">keyRef</span><span class="s0">))) {</span>
      <span class="s2">self</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">del</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">cacheKey</span><span class="s0">);</span>
      <span class="s1">delete </span><span class="s2">schemas</span><span class="s0">[</span><span class="s2">keyRef</span><span class="s0">];</span>
    <span class="s0">}</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s2">_addSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">skipValidation</span><span class="s0">, </span><span class="s2">meta</span><span class="s0">, </span><span class="s2">shouldAddSchema</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">!= </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">schema </span><span class="s0">!= </span><span class="s3">'boolean'</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'schema should be object or boolean'</span><span class="s0">);</span>
  <span class="s1">var </span><span class="s2">serialize </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">serialize</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">cacheKey </span><span class="s0">= </span><span class="s2">serialize </span><span class="s0">? </span><span class="s2">serialize</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) : </span><span class="s2">schema</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">cached </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">cacheKey</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">cached</span><span class="s0">) </span><span class="s1">return </span><span class="s2">cached</span><span class="s0">;</span>

  <span class="s2">shouldAddSchema </span><span class="s0">= </span><span class="s2">shouldAddSchema </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">addUsedSchema </span><span class="s0">!== </span><span class="s1">false</span><span class="s0">;</span>

  <span class="s1">var </span><span class="s2">id </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">));</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">id </span><span class="s0">&amp;&amp; </span><span class="s2">shouldAddSchema</span><span class="s0">) </span><span class="s2">checkUnique</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">id</span><span class="s0">);</span>

  <span class="s1">var </span><span class="s2">willValidate </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">validateSchema </span><span class="s0">!== </span><span class="s1">false </span><span class="s0">&amp;&amp; !</span><span class="s2">skipValidation</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">recursiveMeta</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">willValidate </span><span class="s0">&amp;&amp; !(</span><span class="s2">recursiveMeta </span><span class="s0">= </span><span class="s2">id </span><span class="s0">&amp;&amp; </span><span class="s2">id </span><span class="s0">== </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">normalizeId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$schema</span><span class="s0">)))</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">validateSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>

  <span class="s1">var </span><span class="s2">localRefs </span><span class="s0">= </span><span class="s2">resolve</span><span class="s0">.</span><span class="s2">ids</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">);</span>

  <span class="s1">var </span><span class="s2">schemaObj </span><span class="s0">= </span><span class="s1">new </span><span class="s2">SchemaObject</span><span class="s0">({</span>
    <span class="s2">id</span><span class="s0">: </span><span class="s2">id</span><span class="s0">,</span>
    <span class="s2">schema</span><span class="s0">: </span><span class="s2">schema</span><span class="s0">,</span>
    <span class="s2">localRefs</span><span class="s0">: </span><span class="s2">localRefs</span><span class="s0">,</span>
    <span class="s2">cacheKey</span><span class="s0">: </span><span class="s2">cacheKey</span><span class="s0">,</span>
    <span class="s2">meta</span><span class="s0">: </span><span class="s2">meta</span>
  <span class="s0">});</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">id</span><span class="s0">[</span><span class="s4">0</span><span class="s0">] != </span><span class="s3">'#' </span><span class="s0">&amp;&amp; </span><span class="s2">shouldAddSchema</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">] = </span><span class="s2">schemaObj</span><span class="s0">;</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">put</span><span class="s0">(</span><span class="s2">cacheKey</span><span class="s0">, </span><span class="s2">schemaObj</span><span class="s0">);</span>

  <span class="s1">if </span><span class="s0">(</span><span class="s2">willValidate </span><span class="s0">&amp;&amp; </span><span class="s2">recursiveMeta</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">validateSchema</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>

  <span class="s1">return </span><span class="s2">schemaObj</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s2">_compile</span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">, </span><span class="s2">root</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">compiling</span><span class="s0">) {</span>
    <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">= </span><span class="s2">callValidate</span><span class="s0">;</span>
    <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">schema </span><span class="s0">= </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">;</span>
    <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
    <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">root </span><span class="s0">= </span><span class="s2">root </span><span class="s0">? </span><span class="s2">root </span><span class="s0">: </span><span class="s2">callValidate</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">=== </span><span class="s1">true</span><span class="s0">)</span>
      <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">$async </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s2">callValidate</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">compiling </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>

  <span class="s1">var </span><span class="s2">currentOpts</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">meta</span><span class="s0">) {</span>
    <span class="s2">currentOpts </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">_opts </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_metaOpts</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s1">var </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s1">try </span><span class="s0">{ </span><span class="s2">v </span><span class="s0">= </span><span class="s2">compileSchema</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">, </span><span class="s2">root</span><span class="s0">, </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">localRefs</span><span class="s0">); }</span>
  <span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">) {</span>
    <span class="s1">delete </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">throw </span><span class="s2">e</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">finally </span><span class="s0">{</span>
    <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">compiling </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">meta</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_opts </span><span class="s0">= </span><span class="s2">currentOpts</span><span class="s0">;</span>
  <span class="s0">}</span>

  <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate </span><span class="s0">= </span><span class="s2">v</span><span class="s0">;</span>
  <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">refs </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">;</span>
  <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">refVal </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">refVal</span><span class="s0">;</span>
  <span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">root </span><span class="s0">= </span><span class="s2">v</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span>
  <span class="s1">return </span><span class="s2">v</span><span class="s0">;</span>


  <span class="s7">/* @this   {*} - custom context, see passContext option */</span>
  <span class="s1">function </span><span class="s2">callValidate</span><span class="s0">() {</span>
    <span class="s7">/* jshint validthis: true */</span>
    <span class="s1">var </span><span class="s2">_validate </span><span class="s0">= </span><span class="s2">schemaObj</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">result </span><span class="s0">= </span><span class="s2">_validate</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">arguments</span><span class="s0">);</span>
    <span class="s2">callValidate</span><span class="s0">.</span><span class="s2">errors </span><span class="s0">= </span><span class="s2">_validate</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">;</span>
    <span class="s1">return </span><span class="s2">result</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">chooseGetId</span><span class="s0">(</span><span class="s2">opts</span><span class="s0">) {</span>
  <span class="s1">switch </span><span class="s0">(</span><span class="s2">opts</span><span class="s0">.</span><span class="s2">schemaId</span><span class="s0">) {</span>
    <span class="s1">case </span><span class="s3">'auto'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">_get$IdOrId</span><span class="s0">;</span>
    <span class="s1">case </span><span class="s3">'id'</span><span class="s0">: </span><span class="s1">return </span><span class="s2">_getId</span><span class="s0">;</span>
    <span class="s1">default</span><span class="s0">: </span><span class="s1">return </span><span class="s2">_get$Id</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>

<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s2">_getId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">'schema $id ignored'</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s7">/* @this   Ajv */</span>
<span class="s1">function </span><span class="s2">_get$Id</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id</span><span class="s0">) </span><span class="s1">this</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">(</span><span class="s3">'schema id ignored'</span><span class="s0">, </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">_get$IdOrId</span><span class="s0">(</span><span class="s2">schema</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id </span><span class="s0">&amp;&amp; </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id </span><span class="s0">&amp;&amp; </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id </span><span class="s0">!= </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id</span><span class="s0">)</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'schema $id is different from id'</span><span class="s0">);</span>
  <span class="s1">return </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$id </span><span class="s0">|| </span><span class="s2">schema</span><span class="s0">.</span><span class="s2">id</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Convert array of error message objects to string</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Array&lt;Object&gt;} errors optional array of validation errors, if not passed errors from the instance are used.</span>
 <span class="s5">* </span><span class="s6">@param  </span><span class="s5">{Object} options optional options with properties `separator` and `dataVar`.</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{String} human readable string with all errors descriptions</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">errorsText</span><span class="s0">(</span><span class="s2">errors</span><span class="s0">, </span><span class="s2">options</span><span class="s0">) {</span>
  <span class="s2">errors </span><span class="s0">= </span><span class="s2">errors </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">errors</span><span class="s0">) </span><span class="s1">return </span><span class="s3">'No errors'</span><span class="s0">;</span>
  <span class="s2">options </span><span class="s0">= </span><span class="s2">options </span><span class="s0">|| {};</span>
  <span class="s1">var </span><span class="s2">separator </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">separator </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s3">', ' </span><span class="s0">: </span><span class="s2">options</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">dataVar </span><span class="s0">= </span><span class="s2">options</span><span class="s0">.</span><span class="s2">dataVar </span><span class="s0">=== </span><span class="s2">undefined </span><span class="s0">? </span><span class="s3">'data' </span><span class="s0">: </span><span class="s2">options</span><span class="s0">.</span><span class="s2">dataVar</span><span class="s0">;</span>

  <span class="s1">var </span><span class="s2">text </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++) {</span>
    <span class="s1">var </span><span class="s2">e </span><span class="s0">= </span><span class="s2">errors</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">e</span><span class="s0">) </span><span class="s2">text </span><span class="s0">+= </span><span class="s2">dataVar </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">.</span><span class="s2">dataPath </span><span class="s0">+ </span><span class="s3">' ' </span><span class="s0">+ </span><span class="s2">e</span><span class="s0">.</span><span class="s2">message </span><span class="s0">+ </span><span class="s2">separator</span><span class="s0">;</span>
  <span class="s0">}</span>
  <span class="s1">return </span><span class="s2">text</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">, -</span><span class="s2">separator</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s5">/**</span>
 <span class="s5">* Add custom format</span>
 <span class="s5">* </span><span class="s6">@this   </span><span class="s5">Ajv</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String} name format name</span>
 <span class="s5">* </span><span class="s6">@param </span><span class="s5">{String|RegExp|Function} format string is converted to RegExp; function should return boolean (true when valid)</span>
 <span class="s5">* </span><span class="s6">@return </span><span class="s5">{Ajv} this for method chaining</span>
 <span class="s5">*/</span>
<span class="s1">function </span><span class="s2">addFormat</span><span class="s0">(</span><span class="s2">name</span><span class="s0">, </span><span class="s2">format</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">format </span><span class="s0">== </span><span class="s3">'string'</span><span class="s0">) </span><span class="s2">format </span><span class="s0">= </span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">format</span><span class="s0">);</span>
  <span class="s1">this</span><span class="s0">.</span><span class="s2">_formats</span><span class="s0">[</span><span class="s2">name</span><span class="s0">] = </span><span class="s2">format</span><span class="s0">;</span>
  <span class="s1">return this</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">addDefaultMetaSchema</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">$dataSchema</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) {</span>
    <span class="s2">$dataSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./refs/data.json'</span><span class="s0">);</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">addMetaSchema</span><span class="s0">(</span><span class="s2">$dataSchema</span><span class="s0">, </span><span class="s2">$dataSchema</span><span class="s0">.</span><span class="s2">$id</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
  <span class="s0">}</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">meta </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
  <span class="s1">var </span><span class="s2">metaSchema </span><span class="s0">= </span><span class="s2">require</span><span class="s0">(</span><span class="s3">'./refs/json-schema-draft-07.json'</span><span class="s0">);</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">$data</span><span class="s0">) </span><span class="s2">metaSchema </span><span class="s0">= </span><span class="s2">$dataMetaSchema</span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">, </span><span class="s2">META_SUPPORT_DATA</span><span class="s0">);</span>
  <span class="s2">self</span><span class="s0">.</span><span class="s2">addMetaSchema</span><span class="s0">(</span><span class="s2">metaSchema</span><span class="s0">, </span><span class="s2">META_SCHEMA_ID</span><span class="s0">, </span><span class="s1">true</span><span class="s0">);</span>
  <span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s3">'http://json-schema.org/schema'</span><span class="s0">] = </span><span class="s2">META_SCHEMA_ID</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">addInitialSchemas</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">optsSchemas </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(!</span><span class="s2">optsSchemas</span><span class="s0">) </span><span class="s1">return</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">optsSchemas</span><span class="s0">)) </span><span class="s2">self</span><span class="s0">.</span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">optsSchemas</span><span class="s0">);</span>
  <span class="s1">else for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">key </span><span class="s1">in </span><span class="s2">optsSchemas</span><span class="s0">) </span><span class="s2">self</span><span class="s0">.</span><span class="s2">addSchema</span><span class="s0">(</span><span class="s2">optsSchemas</span><span class="s0">[</span><span class="s2">key</span><span class="s0">], </span><span class="s2">key</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">addInitialFormats</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">name </span><span class="s1">in </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">formats</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">format </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">formats</span><span class="s0">[</span><span class="s2">name</span><span class="s0">];</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">addFormat</span><span class="s0">(</span><span class="s2">name</span><span class="s0">, </span><span class="s2">format</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">addInitialKeywords</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">name </span><span class="s1">in </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">keyword </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">keywords</span><span class="s0">[</span><span class="s2">name</span><span class="s0">];</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">addKeyword</span><span class="s0">(</span><span class="s2">name</span><span class="s0">, </span><span class="s2">keyword</span><span class="s0">);</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">checkUnique</span><span class="s0">(</span><span class="s2">self</span><span class="s0">, </span><span class="s2">id</span><span class="s0">) {</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_schemas</span><span class="s0">[</span><span class="s2">id</span><span class="s0">] || </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">[</span><span class="s2">id</span><span class="s0">])</span>
    <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'schema with key or id &quot;' </span><span class="s0">+ </span><span class="s2">id </span><span class="s0">+ </span><span class="s3">'&quot; already exists'</span><span class="s0">);</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">getMetaSchemaOptions</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">metaOpts </span><span class="s0">= </span><span class="s2">util</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">);</span>
  <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">; </span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">META_IGNORE_OPTIONS</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i</span><span class="s0">++)</span>
    <span class="s1">delete </span><span class="s2">metaOpts</span><span class="s0">[</span><span class="s2">META_IGNORE_OPTIONS</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]];</span>
  <span class="s1">return </span><span class="s2">metaOpts</span><span class="s0">;</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">setLogger</span><span class="s0">(</span><span class="s2">self</span><span class="s0">) {</span>
  <span class="s1">var </span><span class="s2">logger </span><span class="s0">= </span><span class="s2">self</span><span class="s0">.</span><span class="s2">_opts</span><span class="s0">.</span><span class="s2">logger</span><span class="s0">;</span>
  <span class="s1">if </span><span class="s0">(</span><span class="s2">logger </span><span class="s0">=== </span><span class="s1">false</span><span class="s0">) {</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">logger </span><span class="s0">= {</span><span class="s2">log</span><span class="s0">: </span><span class="s2">noop</span><span class="s0">, </span><span class="s2">warn</span><span class="s0">: </span><span class="s2">noop</span><span class="s0">, </span><span class="s2">error</span><span class="s0">: </span><span class="s2">noop</span><span class="s0">};</span>
  <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">logger </span><span class="s0">=== </span><span class="s2">undefined</span><span class="s0">) </span><span class="s2">logger </span><span class="s0">= </span><span class="s2">console</span><span class="s0">;</span>
    <span class="s1">if </span><span class="s0">(!(</span><span class="s1">typeof </span><span class="s2">logger </span><span class="s0">== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s2">logger</span><span class="s0">.</span><span class="s2">log </span><span class="s0">&amp;&amp; </span><span class="s2">logger</span><span class="s0">.</span><span class="s2">warn </span><span class="s0">&amp;&amp; </span><span class="s2">logger</span><span class="s0">.</span><span class="s2">error</span><span class="s0">))</span>
      <span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'logger must implement log, warn and error methods'</span><span class="s0">);</span>
    <span class="s2">self</span><span class="s0">.</span><span class="s2">logger </span><span class="s0">= </span><span class="s2">logger</span><span class="s0">;</span>
  <span class="s0">}</span>
<span class="s0">}</span>


<span class="s1">function </span><span class="s2">noop</span><span class="s0">() {}</span>

<span class="s0">},{</span><span class="s3">&quot;./cache&quot;</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;./compile&quot;</span><span class="s0">:</span><span class="s4">5</span><span class="s0">,</span><span class="s3">&quot;./compile/async&quot;</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s3">&quot;./compile/error_classes&quot;</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s3">&quot;./compile/formats&quot;</span><span class="s0">:</span><span class="s4">4</span><span class="s0">,</span><span class="s3">&quot;./compile/resolve&quot;</span><span class="s0">:</span><span class="s4">6</span><span class="s0">,</span><span class="s3">&quot;./compile/rules&quot;</span><span class="s0">:</span><span class="s4">7</span><span class="s0">,</span><span class="s3">&quot;./compile/schema_obj&quot;</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s3">&quot;./compile/util&quot;</span><span class="s0">:</span><span class="s4">10</span><span class="s0">,</span><span class="s3">&quot;./data&quot;</span><span class="s0">:</span><span class="s4">11</span><span class="s0">,</span><span class="s3">&quot;./keyword&quot;</span><span class="s0">:</span><span class="s4">39</span><span class="s0">,</span><span class="s3">&quot;./refs/data.json&quot;</span><span class="s0">:</span><span class="s4">40</span><span class="s0">,</span><span class="s3">&quot;./refs/json-schema-draft-07.json&quot;</span><span class="s0">:</span><span class="s4">41</span><span class="s0">,</span><span class="s3">&quot;fast-json-stable-stringify&quot;</span><span class="s0">:</span><span class="s4">43</span><span class="s0">}]},{},[])(</span><span class="s3">&quot;ajv&quot;</span><span class="s0">)</span>
<span class="s0">});</span>
</pre>
</body>
</html>