<html>
<head>
<title>joi-browser.min.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #42c3d4;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
joi-browser.min.js</font>
</center></td></tr></table>
<pre><span class="s0">!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">module</span><span class="s0">?</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">t</span><span class="s0">():</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">define</span><span class="s0">&amp;&amp;</span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd</span><span class="s0">?</span><span class="s2">define</span><span class="s0">([],</span><span class="s2">t</span><span class="s0">):</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">?</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">joi</span><span class="s0">=</span><span class="s2">t</span><span class="s0">():</span><span class="s2">e</span><span class="s0">.</span><span class="s2">joi</span><span class="s0">=</span><span class="s2">t</span><span class="s0">()}(</span><span class="s2">self</span><span class="s0">,(()=&gt;{</span><span class="s1">return </span><span class="s2">e</span><span class="s0">={</span><span class="s4">7629</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9474</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1687</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8652</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8901</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9708</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6914</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2294</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">g</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1152</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8863</span><span class="s0">),</span><span class="s2">b</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2036</span><span class="s0">),</span><span class="s2">v</span><span class="s0">={</span><span class="s2">Base</span><span class="s0">:</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">={},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_reset</span><span class="s0">()}</span><span class="s2">_reset</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">=</span><span class="s1">new </span><span class="s2">d</span><span class="s0">.</span><span class="s2">Ids</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">=</span><span class="s1">new </span><span class="s2">p</span><span class="s0">.</span><span class="s2">Manager</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">={},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">=[],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">={},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">={</span><span class="s2">ruleset</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">whens</span><span class="s0">:{}}}</span><span class="s2">describe</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">h</span><span class="s0">.</span><span class="s2">describe</span><span class="s0">,</span><span class="s3">&quot;Manifest functionality disabled&quot;</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">describe</span><span class="s0">(</span><span class="s1">this</span><span class="s0">)}</span><span class="s2">allow</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;allow&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;_valids&quot;</span><span class="s0">)}</span><span class="s2">alter</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid targets argument&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot set alterations inside a ruleset&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">alterations</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">alterations</span><span class="s0">||[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Alteration adjuster for&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;must be a function&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">alterations</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">target</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">adjuster</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}</span><span class="s2">artifact</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Artifact cannot be undefined&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">,</span><span class="s3">&quot;Cannot set an artifact with a rule cache&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;artifact&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">cast</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid to value&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Type&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;does not support casting to&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;cast&quot;</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s1">void </span><span class="s4">0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">default</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_default</span><span class="s0">(</span><span class="s3">&quot;default&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">description</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Description must be a non-empty string&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;description&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">empty</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;empty&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})}</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Missing error&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Must provide a valid Error object or a function&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;error&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">example</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Missing example&quot;</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,[</span><span class="s3">&quot;override&quot;</span><span class="s0">]),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inner</span><span class="s0">(</span><span class="s3">&quot;examples&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">single</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">override</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">override</span><span class="s0">})}</span><span class="s2">external</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Cannot combine options with description&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">description</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">method</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Method must be a function&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Description must be a non-empty string&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inner</span><span class="s0">(</span><span class="s3">&quot;externals&quot;</span><span class="s0">,{</span><span class="s2">method</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">t</span><span class="s0">},{</span><span class="s2">single</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})}</span><span class="s2">failover</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_default</span><span class="s0">(</span><span class="s3">&quot;failover&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">forbidden</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">(</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">)}</span><span class="s2">id</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">?(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;id must be a non-empty string&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s5">/^[^\.]+$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;id cannot contain period character&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;id&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;id&quot;</span><span class="s0">,</span><span class="s1">void </span><span class="s4">0</span><span class="s0">)}</span><span class="s2">invalid</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;_invalids&quot;</span><span class="s0">)}</span><span class="s2">label</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Label name must be a non-empty string&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;label&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">meta</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Meta cannot be undefined&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inner</span><span class="s0">(</span><span class="s3">&quot;metas&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">single</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})}</span><span class="s2">note</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Missing notes&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Notes must be non-empty strings&quot;</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_inner</span><span class="s0">(</span><span class="s3">&quot;notes&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">only</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid mode:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;only&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">optional</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">(</span><span class="s3">&quot;optional&quot;</span><span class="s0">)}</span><span class="s2">prefs</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Missing preferences&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">context</span><span class="s0">,</span><span class="s3">&quot;Cannot override context&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">,</span><span class="s3">&quot;Cannot override externals&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">,</span><span class="s3">&quot;Cannot override warnings&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">,</span><span class="s3">&quot;Cannot override debug&quot;</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">checkPreferences</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">}</span><span class="s2">presence</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Unknown presence mode&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;presence&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">raw</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;result&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;raw&quot;</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">)}</span><span class="s2">result</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;raw&quot;</span><span class="s0">,</span><span class="s3">&quot;strip&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Unknown result mode&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;result&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">required</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">(</span><span class="s3">&quot;required&quot;</span><span class="s0">)}</span><span class="s2">strict</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">,{</span><span class="s2">convert</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}),</span><span class="s2">t</span><span class="s0">}</span><span class="s2">strip</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;result&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;strip&quot;</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">)}</span><span class="s2">tag</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Missing tags&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Tags must be non-empty strings&quot;</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_inner</span><span class="s0">(</span><span class="s3">&quot;tags&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">unit</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Unit name must be a non-empty string&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;unit&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">valid</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;valid&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;only&quot;</span><span class="s0">,!!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">}</span><span class="s2">when</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">||(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">=[]);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">when</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(![</span><span class="s3">&quot;any&quot;</span><span class="s0">,</span><span class="s3">&quot;link&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">is</span><span class="s0">?[</span><span class="s2">n</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">then</span><span class="s0">||</span><span class="s3">&quot;any&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">then</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">then</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;Cannot combine&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;with&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">then</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">then</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">||</span><span class="s3">&quot;any&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;Cannot combine&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;with&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}</span><span class="s2">cache</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot set caching inside a ruleset&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">,</span><span class="s3">&quot;Cannot override schema cache&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">artifact</span><span class="s0">,</span><span class="s3">&quot;Cannot cache a rule with an artifact&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">provider</span><span class="s0">.</span><span class="s2">provision</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}</span><span class="s2">clone</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s1">this</span><span class="s0">));</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_assign</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid schema object&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;any&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;any&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;Cannot merge type&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;with another type:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot concatenate onto a schema with open ruleset&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot concatenate a schema with open ruleset&quot;</span><span class="s0">);</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;any&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;any&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s3">&quot;type&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]);</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">toSibling</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">?</span><span class="s2">l</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">=</span><span class="s2">b</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">=</span><span class="s2">b</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">())</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keep</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">method</span><span class="s0">].</span><span class="s2">multi</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">);</span><span class="s1">delete </span><span class="s2">r</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">,</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">);</span><span class="s1">delete </span><span class="s2">r</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">,</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">s</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">s</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">():</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">.</span><span class="s2">_combine</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,[</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}</span><span class="s2">extend</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">base</span><span class="s0">,</span><span class="s3">&quot;Cannot extend type with another base&quot;</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">type</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">extract</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">reach</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">fork</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot fork inside a ruleset&quot;</span><span class="s0">);</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s of</span><span class="s0">[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s2">s</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)?</span><span class="s2">s</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">fork</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s2">rule</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">,</span><span class="s3">&quot;Cannot apply rules to empty ruleset or the last rule added does not support rule properties&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Cannot apply rules to empty ruleset&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">[</span><span class="s2">n</span><span class="s0">](</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s3">&quot;Cannot change rule name&quot;</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)===</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}</span><span class="s2">get ruleset</span><span class="s0">(){</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot start a new ruleset without closing the previous one&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}</span><span class="s2">get $</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">}</span><span class="s2">tailor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot tailor inside a ruleset&quot;</span><span class="s0">);</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">alterations</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">target</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">adjuster</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}</span><span class="s2">of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">alterations</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Alteration adjuster for&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;failed to return a schema object&quot;</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_modify</span><span class="s0">({</span><span class="s2">each</span><span class="s0">:</span><span class="s2">t</span><span class="s0">=&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tailor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}</span><span class="s2">tracer</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">g</span><span class="s0">.</span><span class="s2">location</span><span class="s0">?</span><span class="s2">g</span><span class="s0">.</span><span class="s2">location</span><span class="s0">(</span><span class="s1">this</span><span class="s0">):</span><span class="s1">this</span><span class="s0">}</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">y</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">validateAsync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">y</span><span class="s0">.</span><span class="s2">entryAsync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid options&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s3">&quot;Invalid rule name&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s3">&quot;Cannot set private rule properties&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">=[],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Unknown rule&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">n</span><span class="s0">).</span><span class="s2">length</span><span class="s0">||</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">n</span><span class="s0">).</span><span class="s2">length</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">].</span><span class="s2">args</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Invalid rule definition for&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">n</span><span class="s0">){</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">i</span><span class="s0">))</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validateArg</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;or reference&quot;</span><span class="s0">)}}</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">?</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">:</span><span class="s1">delete </span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">multi</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_ruleRemove</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)),!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">priority</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">}</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">5</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">5</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">5</span><span class="s0">]:{};</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">:{},</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">?</span><span class="s2">m</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">;</span><span class="s1">return new </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)}</span><span class="s2">$_getFlag</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">$_mapLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">labels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">r</span><span class="s0">)).</span><span class="s2">abortEarly</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_externals</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">();</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=!</span><span class="s2">y</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">errors</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">}</span><span class="s2">$_modify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;each&quot;</span><span class="s0">,</span><span class="s3">&quot;once&quot;</span><span class="s0">,</span><span class="s3">&quot;ref&quot;</span><span class="s0">,</span><span class="s3">&quot;schema&quot;</span><span class="s0">]),</span><span class="s2">d</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)||</span><span class="s1">this</span><span class="s0">}</span><span class="s2">$_mutateRebuild</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot add this rule inside a ruleset&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">reset</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">reset</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_modify</span><span class="s0">({</span><span class="s2">each</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s1">let</span><span class="s0">{</span><span class="s2">source</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">[</span><span class="s2">r</span><span class="s0">][</span><span class="s2">s</span><span class="s0">]&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">[</span><span class="s2">r</span><span class="s0">][</span><span class="s2">s</span><span class="s0">].</span><span class="s2">register</span><span class="s0">;!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">family</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">a</span><span class="s0">})}}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">(</span><span class="s1">this</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">}</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">family</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})}</span><span class="s2">$_property</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s2">$_reach</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">reach</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">$_rootReferences</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">roots</span><span class="s0">()}</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]||!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">&quot;Cannot set flag inside a ruleset&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]||{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">default</span><span class="s0">)&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">),</span><span class="s2">a</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]))</span><span class="s1">return this</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">():</span><span class="s1">this</span><span class="s0">;</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)):</span><span class="s1">delete </span><span class="s2">i</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;_&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">}</span><span class="s2">$_parent</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">[</span><span class="s2">e</span><span class="s0">][</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">parent</span><span class="s0">].</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">)}</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">y</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s2">_assign</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">={},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">,{</span><span class="s2">shallow</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">():</span><span class="s1">null</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_super</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in this</span><span class="s0">.</span><span class="s2">$_super</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_super</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_super</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">bind</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s2">_bare</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_reset</span><span class="s0">();</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r </span><span class="s1">in </span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">init</span><span class="s0">}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}</span><span class="s2">_default</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;literal&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Missing&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;value&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">||!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">literal</span><span class="s0">,</span><span class="s3">&quot;Only function value supports literal option&quot;</span><span class="s0">),</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">literal</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={[</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">literal</span><span class="s0">]:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">literal</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s1">this</span><span class="s0">};</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">){</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">.concat`</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">is</span><span class="s0">?[</span><span class="s2">i</span><span class="s0">]:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">f</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">h</span><span class="s0">}=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">c</span><span class="s0">],</span><span class="s2">m</span><span class="s0">=</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">i</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">?</span><span class="s3">&quot;.&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">m</span><span class="s0">}</span><span class="s3">.is`</span><span class="s0">),</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">m</span><span class="s0">}</span><span class="s3">.then`</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">),{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">m</span><span class="s0">}</span><span class="s3">.then</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">?</span><span class="s3">`(</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">}</span><span class="s3">)`</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">m</span><span class="s0">}</span><span class="s3">.otherwise`</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">),{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">m</span><span class="s0">}</span><span class="s3">.otherwise</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">?</span><span class="s3">`(</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">}</span><span class="s3">)`</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">break</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">c</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s3">&quot;when&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),!</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s1">this</span><span class="s0">};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">active</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])</span><span class="s1">return</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">id</span><span class="s0">:</span><span class="s2">a</span><span class="s0">};</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of s</span><span class="s0">)</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">.</span><span class="s2">_combine</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,[</span><span class="s1">this</span><span class="s0">,</span><span class="s2">...s</span><span class="s0">]),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}}</span><span class="s2">_inner</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">(),</span><span class="s3">`Cannot set </span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">} </span><span class="s3">inside a ruleset`</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&amp;&amp;!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">override</span><span class="s0">||(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=[]),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">single</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">}</span><span class="s2">_inRuleset</span><span class="s0">(){</span><span class="s1">return null</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">}</span><span class="s2">_ruleRemove</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return this</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">():</span><span class="s1">this</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s2">n</span><span class="s0">.</span><span class="s2">name</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keep</span><span class="s0">?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_inRuleset</span><span class="s0">()&amp;&amp;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">&amp;&amp;--</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_temp</span><span class="s0">.</span><span class="s2">ruleset</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s2">_values</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">));</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">override</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)),!</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">b</span><span class="s0">:</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s1">new </span><span class="s2">b</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()),!</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">])</span><span class="s1">return </span><span class="s2">r</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">override</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Cannot call allow/valid/invalid with undefined&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">override</span><span class="s0">,</span><span class="s3">&quot;Override must be the first value&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;_invalids&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;_valids&quot;</span><span class="s0">:</span><span class="s3">&quot;_invalids&quot;</span><span class="s0">;</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">remove</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">length</span><span class="s0">||(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;_valids&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">only</span><span class="s0">,</span><span class="s3">&quot;Setting invalid value&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;leaves schema rejecting all values due to previous valid rule&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">null</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">add</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}}};</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">any</span><span class="s0">]={</span><span class="s2">version</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">compile</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">,</span><span class="s2">root</span><span class="s0">:</span><span class="s3">&quot;$_root&quot;</span><span class="s0">},</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isImmutable</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">deny</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">invalid</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">disallow</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">invalid</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">equal</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">exist</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">required</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">not</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">invalid</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">options</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">new </span><span class="s2">v</span><span class="s0">.</span><span class="s2">Base</span><span class="s0">},</span><span class="s4">8652</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">max</span><span class="s0">:</span><span class="s4">1e3</span><span class="s0">,</span><span class="s2">supported</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">([</span><span class="s3">&quot;undefined&quot;</span><span class="s0">,</span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span><span class="s3">&quot;number&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">])};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">provider</span><span class="s0">={</span><span class="s2">provision</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Cache</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Cache</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;max&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">max</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">max</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">max</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">isFinite</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">max</span><span class="s0">),</span><span class="s3">&quot;Invalid max cache size&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_max</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">max</span><span class="s0">||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">max</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_list</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">List</span><span class="s0">}</span><span class="s2">get length</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">size</span><span class="s0">}</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">supported</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">void this</span><span class="s0">.</span><span class="s2">_list</span><span class="s0">.</span><span class="s2">first</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_list</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_compact</span><span class="s0">()}</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_list</span><span class="s0">.</span><span class="s2">first</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s2">_compact</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">size</span><span class="s0">&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_max</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_list</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_map</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)}}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">List</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s2">unshift</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">next</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">prev</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">.</span><span class="s2">next</span><span class="s0">=</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">=</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}</span><span class="s2">first</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">head</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_remove</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))}</span><span class="s2">pop</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_remove</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">)}</span><span class="s2">_remove</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">next</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">prev</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">prev</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">next</span><span class="s0">=</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tail</span><span class="s0">=</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">prev</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">next</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}}},</span><span class="s4">8160</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7916</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5934</span><span class="s0">);</span><span class="s1">let </span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">={</span><span class="s2">isoDate</span><span class="s0">:</span><span class="s5">/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/</span><span class="s0">};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">={</span><span class="s2">abortEarly</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">allowUnknown</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">artifacts</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">cache</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">dateFormat</span><span class="s0">:</span><span class="s3">&quot;iso&quot;</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:{</span><span class="s2">escapeHtml</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">label</span><span class="s0">:</span><span class="s3">&quot;path&quot;</span><span class="s0">,</span><span class="s2">language</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">render</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">stack</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">wrap</span><span class="s0">:{</span><span class="s2">label</span><span class="s0">:</span><span class="s3">'&quot;'</span><span class="s0">,</span><span class="s2">array</span><span class="s0">:</span><span class="s3">&quot;[]&quot;</span><span class="s0">}},</span><span class="s2">externals</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">messages</span><span class="s0">:{},</span><span class="s2">nonEnumerables</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">noDefaults</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">presence</span><span class="s0">:</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s2">skipFunctions</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">stripUnknown</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">warnings</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">={</span><span class="s2">any</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">for</span><span class="s0">(</span><span class="s3">&quot;@hapi/joi/schema&quot;</span><span class="s0">),</span><span class="s2">arraySingle</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;arraySingle&quot;</span><span class="s0">),</span><span class="s2">deepDefault</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;deepDefault&quot;</span><span class="s0">),</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;errors&quot;</span><span class="s0">),</span><span class="s2">literal</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;literal&quot;</span><span class="s0">),</span><span class="s2">override</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;override&quot;</span><span class="s0">),</span><span class="s2">parent</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;parent&quot;</span><span class="s0">),</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;prefs&quot;</span><span class="s0">),</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;ref&quot;</span><span class="s0">),</span><span class="s2">template</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;template&quot;</span><span class="s0">),</span><span class="s2">values</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;values&quot;</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:</span><span class="s3">&quot;Options&quot;</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Options must be of type object&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)));</span><span class="s2">s</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">} </span><span class="s3">contain unknown keys: </span><span class="s2">$</span><span class="s0">{</span><span class="s2">n</span><span class="s0">}</span><span class="s3">`</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">checkPreferences</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">||</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3378</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">n</span><span class="s0">([</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">details</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">message</span><span class="s0">])},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">t</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">default</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isIsoDate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">isoDate</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isNumber</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">]||</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">template</span><span class="s0">])},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">any</span><span class="s0">];</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">legacy</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s3">&quot;Cannot mix different versions of joi schemas&quot;</span><span class="s0">),!</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isValues</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">values</span><span class="s0">]},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">||</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6914</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">||{};</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">)),</span><span class="s1">delete </span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">],</span><span class="s2">n</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tryWithPath</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">e</span><span class="s0">()}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">throw void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">t</span><span class="s0">+</span><span class="s3">&quot;.&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">append</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">} </span><span class="s3">(</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">}</span><span class="s3">)`</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">validateArg</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">message</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">r</span><span class="s0">?</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">} </span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">`</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s3">&quot;Method no longer accepts array arguments:&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s4">3292</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s2">n</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,[</span><span class="s3">&quot;appendPath&quot;</span><span class="s0">,</span><span class="s3">&quot;override&quot;</span><span class="s0">]);</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">appendPath</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">} </span><span class="s3">(</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">}</span><span class="s3">)`</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid undefined schema&quot;</span><span class="s0">),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Invalid empty array schema&quot;</span><span class="s0">),</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]));</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">;</span><span class="s2">a</span><span class="s0">++)</span><span class="s2">n</span><span class="s0">[</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">override</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">override</span><span class="s0">,</span><span class="s2">...n</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s2">...n</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">simple</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">custom</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid schema content:&quot;</span><span class="s0">,</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of t</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">simple</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">alternatives</span><span class="s0">().</span><span class="s2">try</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...t</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">regex</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">?</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">):(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)===</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">({}),</span><span class="s3">&quot;Schema can only contain plain objects&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s2">n</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,[</span><span class="s3">&quot;legacy&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">any</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">legacy</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">version</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s3">&quot;Cannot mix different versions of joi schemas:&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">),</span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">||!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">legacy</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">walk</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">l</span><span class="s0">?</span><span class="s2">l</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">root</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">walk</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">walk</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">return null</span><span class="s0">}</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">any</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">root</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">root</span><span class="s0">],</span><span class="s2">compile</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">};</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)===</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">({}),</span><span class="s3">&quot;Schema can only contain plain objects&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">walk</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}</span><span class="s1">return null</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">simple</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||[</span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s3">&quot;number&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">when</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Missing options&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)&amp;&amp;(</span><span class="s2">o</span><span class="s0">={</span><span class="s1">switch</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,[</span><span class="s3">&quot;is&quot;</span><span class="s0">,</span><span class="s3">&quot;not&quot;</span><span class="s0">,</span><span class="s3">&quot;then&quot;</span><span class="s0">,</span><span class="s3">&quot;otherwise&quot;</span><span class="s0">,</span><span class="s3">&quot;switch&quot;</span><span class="s0">,</span><span class="s3">&quot;break&quot;</span><span class="s0">]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">,</span><span class="s3">'&quot;is&quot; can not be used with a schema condition'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">not</span><span class="s0">,</span><span class="s3">'&quot;not&quot; can not be used with a schema condition'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">,</span><span class="s3">'&quot;switch&quot; can not be used with a schema condition'</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">condition</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">then</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s1">break</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">break</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Invalid condition:&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">not</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">,</span><span class="s3">'Cannot combine &quot;is&quot; with &quot;not&quot;'</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">){</span><span class="s1">let </span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">not</span><span class="s0">&amp;&amp;(</span><span class="s2">l</span><span class="s0">={</span><span class="s2">is</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">not</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">then</span><span class="s0">,</span><span class="s1">break</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">break</span><span class="s0">});</span><span class="s1">let </span><span class="s2">c</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">is</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">is</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">invalid</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">required</span><span class="s0">();</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">then</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s3">'options must have at least one of &quot;then&quot;, &quot;otherwise&quot;, or &quot;switch&quot;'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">break</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">then</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s3">&quot;Cannot specify then, otherwise, and break all together&quot;</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">)||(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">required</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">condition</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">is</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">then</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s1">break</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">break</span><span class="s0">})}</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">),</span><span class="s3">'&quot;switch&quot; must be an array'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">is</span><span class="s0">,</span><span class="s3">'Cannot combine &quot;switch&quot; with &quot;is&quot;'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">not</span><span class="s0">,</span><span class="s3">'Cannot combine &quot;switch&quot; with &quot;not&quot;'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">then</span><span class="s0">,</span><span class="s3">'Cannot combine &quot;switch&quot; with &quot;then&quot;'</span><span class="s0">);</span><span class="s1">const </span><span class="s2">l</span><span class="s0">={</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s1">switch</span><span class="s0">:[],</span><span class="s1">break</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">break</span><span class="s0">};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">?[</span><span class="s3">&quot;is&quot;</span><span class="s0">,</span><span class="s3">&quot;then&quot;</span><span class="s0">,</span><span class="s3">&quot;otherwise&quot;</span><span class="s0">]:[</span><span class="s3">&quot;is&quot;</span><span class="s0">,</span><span class="s3">&quot;then&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">is</span><span class="s0">,</span><span class="s3">'Switch statement missing &quot;is&quot;'</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">then</span><span class="s0">,</span><span class="s3">'Switch statement missing &quot;then&quot;'</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">={</span><span class="s2">is</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">is</span><span class="s0">),</span><span class="s2">then</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">then</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">is</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">is</span><span class="s0">)||(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">is</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">is</span><span class="s0">.</span><span class="s2">required</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">,</span><span class="s3">'Cannot specify &quot;otherwise&quot; inside and outside a &quot;switch&quot;'</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">break</span><span class="s0">,</span><span class="s3">&quot;Cannot specify both otherwise and break&quot;</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))}</span><span class="s2">l</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">l</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">condition</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of</span><span class="s0">[</span><span class="s3">&quot;then&quot;</span><span class="s0">,</span><span class="s3">&quot;otherwise&quot;</span><span class="s0">])</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]?</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}},</span><span class="s4">6354</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5688</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">code</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">state</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">template</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">=</span><span class="s2">s</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">label</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">label</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">value</span><span class="s0">||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">)||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">];</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">e</span><span class="s0">)}}</span><span class="s2">_setTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">template</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">.</span><span class="s2">label</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">template</span><span class="s0">,</span><span class="s3">&quot;root&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">label</span><span class="s0">=</span><span class="s2">e</span><span class="s0">)}}</span><span class="s2">toString</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">;</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">code</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">render</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">code</span><span class="s0">;</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">template</span><span class="s0">)||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">)||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">);</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s3">`Error code &quot;</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">&quot; is not defined, your custom type is missing the correct messages definition`</span><span class="s0">:(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">render</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">local</span><span class="s0">,{</span><span class="s2">errors</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">,</span><span class="s2">messages</span><span class="s0">:[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">]}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">label</span><span class="s0">||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^&quot;&quot; /</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">trim</span><span class="s0">()),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">message</span><span class="s0">)}</span><span class="s2">_template</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">template</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">code</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">)}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">):</span><span class="s2">t</span><span class="s0">+=</span><span class="s3">`[</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">}</span><span class="s3">]`</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">template</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s3">&quot;root&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s1">null</span><span class="s0">;</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">language</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">][</span><span class="s2">r</span><span class="s0">])</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">][</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">][</span><span class="s3">&quot;*&quot;</span><span class="s0">])</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">][</span><span class="s3">&quot;*&quot;</span><span class="s0">]}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">[</span><span class="s3">&quot;*&quot;</span><span class="s0">]},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">label</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">label</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">label</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">label</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">;</span><span class="s3">&quot;key&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">label</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">path</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">template</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s3">&quot;root&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">template</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;root&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)||</span><span class="s3">&quot;value&quot;</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">process</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">const</span><span class="s0">{</span><span class="s2">override</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">details</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">stack</span><span class="s0">)</span><span class="s1">return new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">Error</span><span class="s0">.</span><span class="s2">stackTraceLimit</span><span class="s0">;</span><span class="s2">Error</span><span class="s0">.</span><span class="s2">stackTraceLimit</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">Error</span><span class="s0">.</span><span class="s2">stackTraceLimit</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">l</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">details</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">override</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">override</span><span class="s0">:</span><span class="s2">n</span><span class="s0">};</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;override&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}});</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)),</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">local</span><span class="s0">})}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=[</span><span class="s2">...</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)]),{</span><span class="s2">message</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;. &quot;</span><span class="s0">),</span><span class="s2">details</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">=</span><span class="s1">class extends </span><span class="s2">Error</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">super</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_original</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">details</span><span class="s0">=</span><span class="s2">t</span><span class="s0">}</span><span class="s1">static </span><span class="s2">isError</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isJoi</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;ValidationError&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">annotate</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">error</span><span class="s0">},</span><span class="s4">8901</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6914</span><span class="s0">),</span><span class="s2">o</span><span class="s0">={};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_assign</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">t</span><span class="s0">);</span><span class="s1">delete </span><span class="s2">u</span><span class="s0">.</span><span class="s2">base</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">=</span><span class="s2">u</span><span class="s0">;</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">||{};</span><span class="s2">u</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">properties</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">);</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Invalid term override for&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">init</span><span class="s0">,</span><span class="s2">h</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}</span><span class="s2">u</span><span class="s0">.</span><span class="s2">terms</span><span class="s0">=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">args</span><span class="s0">||(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">args</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">args</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">&amp;&amp;(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">={</span><span class="s2">method</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">}),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">from</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">from</span><span class="s0">)&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">={</span><span class="s2">method</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">method</span><span class="s0">,</span><span class="s2">from</span><span class="s0">:[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">from</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">);</span><span class="s1">const </span><span class="s2">m</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid rule definition for&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}),</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Rule conflict in&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">l</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">m</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Rule conflict in&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">m</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">alias</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">alias</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s2">l</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">),</span><span class="s3">&quot;Duplicated argument name&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">().</span><span class="s2">label</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">))))}</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">=</span><span class="s2">m</span><span class="s0">;</span><span class="s1">const </span><span class="s2">d</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Rule conflict in&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid modifier definition for&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">({[</span><span class="s2">e</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">})};</span><span class="s2">l</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">d</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">modifiers</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">overrides</span><span class="s0">){</span><span class="s2">l</span><span class="s0">.</span><span class="s2">_super</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_super</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">overrides</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;Cannot override missing&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">overrides</span><span class="s0">[</span><span class="s2">e</span><span class="s0">][</span><span class="s2">a</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">parent</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_super</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">bind</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">overrides</span><span class="s0">)}</span><span class="s2">u</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">);</span><span class="s1">const </span><span class="s2">p</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">);</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">build</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">build</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">.</span><span class="s2">build</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">&amp;&amp;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">.</span><span class="s2">build</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">manifest</span><span class="s0">=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">),</span><span class="s2">c</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">build</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">(</span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">)}:</span><span class="s2">e</span><span class="s0">||</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">?{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">from</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">?[</span><span class="s2">...</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">([</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">from</span><span class="s0">,</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">])]:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">))&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">method</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">n</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">from</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">from</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">method</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}}:</span><span class="s2">e</span><span class="s0">||</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">}:</span><span class="s2">e</span><span class="s0">||</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">rebuild</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s2">t</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}:</span><span class="s2">e</span><span class="s0">||</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">&amp;&amp;(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">length</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">}:</span><span class="s2">e</span><span class="s0">||</span><span class="s2">t</span><span class="s0">}},</span><span class="s4">5107</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8652</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8901</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9708</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1152</span><span class="s0">);</span><span class="s1">let </span><span class="s2">d</span><span class="s0">;</span><span class="s1">const </span><span class="s2">p</span><span class="s0">={</span><span class="s2">types</span><span class="s0">:{</span><span class="s2">alternatives</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4946</span><span class="s0">),</span><span class="s2">any</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">array</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">546</span><span class="s0">),</span><span class="s2">boolean</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4937</span><span class="s0">),</span><span class="s2">date</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7500</span><span class="s0">),</span><span class="s1">function</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">390</span><span class="s0">),</span><span class="s2">link</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8785</span><span class="s0">),</span><span class="s2">number</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3832</span><span class="s0">),</span><span class="s2">object</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8966</span><span class="s0">),</span><span class="s2">string</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7417</span><span class="s0">),</span><span class="s2">symbol</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8826</span><span class="s0">)},</span><span class="s2">aliases</span><span class="s0">:{</span><span class="s2">alt</span><span class="s0">:</span><span class="s3">&quot;alternatives&quot;</span><span class="s0">,</span><span class="s2">bool</span><span class="s0">:</span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span><span class="s2">func</span><span class="s0">:</span><span class="s3">&quot;function&quot;</span><span class="s0">},</span><span class="s2">root</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={</span><span class="s2">_types</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">types</span><span class="s0">))};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||[</span><span class="s3">&quot;alternatives&quot;</span><span class="s0">,</span><span class="s3">&quot;link&quot;</span><span class="s0">,</span><span class="s3">&quot;object&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;The&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;type does not allow arguments&quot;</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">types</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">r</span><span class="s0">)};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of</span><span class="s0">[</span><span class="s3">&quot;allow&quot;</span><span class="s0">,</span><span class="s3">&quot;custom&quot;</span><span class="s0">,</span><span class="s3">&quot;disallow&quot;</span><span class="s0">,</span><span class="s3">&quot;equal&quot;</span><span class="s0">,</span><span class="s3">&quot;exist&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">,</span><span class="s3">&quot;invalid&quot;</span><span class="s0">,</span><span class="s3">&quot;not&quot;</span><span class="s0">,</span><span class="s3">&quot;only&quot;</span><span class="s0">,</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;options&quot;</span><span class="s0">,</span><span class="s3">&quot;prefs&quot;</span><span class="s0">,</span><span class="s3">&quot;preferences&quot;</span><span class="s0">,</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;strip&quot;</span><span class="s0">,</span><span class="s3">&quot;valid&quot;</span><span class="s0">,</span><span class="s3">&quot;when&quot;</span><span class="s0">])</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">any</span><span class="s0">()[</span><span class="s2">t</span><span class="s0">](</span><span class="s2">...arguments</span><span class="s0">)};</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">methods</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">p</span><span class="s0">.</span><span class="s2">aliases</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">aliases</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">x</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expression</span><span class="s0">,</span><span class="s2">m</span><span class="s0">.</span><span class="s2">setup</span><span class="s0">&amp;&amp;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">setup</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}};</span><span class="s2">p</span><span class="s0">.</span><span class="s2">methods</span><span class="s0">={</span><span class="s2">ValidationError</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">cache</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">provider</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">?</span><span class="s2">r</span><span class="s0">-</span><span class="s4">2</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s2">p</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">attempt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">?</span><span class="s2">r</span><span class="s0">-</span><span class="s4">2</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">u</span><span class="s0">.</span><span class="s2">build</span><span class="s0">,</span><span class="s3">&quot;Manifest functionality disabled&quot;</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">build</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">checkPreferences</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">i</span><span class="s0">.</span><span class="s2">checkPreferences</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">defaults</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;modifier must be a function&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s1">this</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of t</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]());</span><span class="s2">s</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s3">&quot;modifier must return a valid schema object&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">expression</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return new </span><span class="s2">h</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">)},</span><span class="s2">extend</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s2">i</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;extend&quot;</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">d</span><span class="s0">||</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3378</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;You need to provide at least one extension&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">d</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s1">this</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e of t</span><span class="s0">){</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">d</span><span class="s0">.</span><span class="s2">extension</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">expandExtension</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">]||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s3">&quot;Cannot override name&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">base</span><span class="s0">||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">any</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">type</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">a</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">]=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}}}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">},</span><span class="s2">isError</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">.</span><span class="s2">isError</span><span class="s0">,</span><span class="s2">isExpression</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">,</span><span class="s2">isRef</span><span class="s0">:</span><span class="s2">f</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">,</span><span class="s2">isSchema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">,</span><span class="s1">in</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">in</span><span class="s0">(</span><span class="s2">...arguments</span><span class="s0">)},</span><span class="s2">override</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">override</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">...arguments</span><span class="s0">)},</span><span class="s2">types</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">p</span><span class="s0">.</span><span class="s2">aliases</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">p</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]</span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">?</span><span class="s2">s</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">({</span><span class="s2">errors</span><span class="s0">:{</span><span class="s2">stack</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">o</span><span class="s0">||{}));</span><span class="s1">let </span><span class="s2">u</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">error</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">;</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">u</span><span class="s0">.</span><span class="s2">annotate</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">annotate</span><span class="s0">():</span><span class="s2">u</span><span class="s0">.</span><span class="s2">message</span><span class="s0">;</span><span class="s1">throw </span><span class="s2">u </span><span class="s1">instanceof </span><span class="s2">l</span><span class="s0">.</span><span class="s2">ValidationError</span><span class="s0">==</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">a</span><span class="s0">?</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">} </span><span class="s2">$</span><span class="s0">{</span><span class="s2">f</span><span class="s0">}</span><span class="s3">`</span><span class="s0">:</span><span class="s2">f</span><span class="s0">,</span><span class="s2">u</span><span class="s0">},</span><span class="s2">p</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Must be invoked on a Joi instance.&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">args</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">args</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">):</span><span class="s2">t</span><span class="s0">},</span><span class="s2">p</span><span class="s0">.</span><span class="s2">expandExtension</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of t</span><span class="s0">.</span><span class="s2">_types</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">);</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">base</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">](),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">root</span><span class="s0">()},</span><span class="s4">6914</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Cannot set single message string&quot;</span><span class="s0">),</span><span class="s1">new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Cannot set single message template&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid message options&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):{};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">){</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s3">&quot;Invalid message for&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r </span><span class="s1">in </span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]||{},</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">:(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid message for&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;in&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">][</span><span class="s2">r</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decompile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">root</span><span class="s0">=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">describe</span><span class="s0">({</span><span class="s2">compact</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r </span><span class="s1">in </span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]={},</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s3">&quot;root&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">][</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">describe</span><span class="s0">({</span><span class="s2">compact</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}):</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">root</span><span class="s0">=</span><span class="s2">e</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">)</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))</span><span class="s1">return </span><span class="s2">r</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e </span><span class="s1">in </span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">){</span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Invalid message for&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">e </span><span class="s1">in </span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]||{},</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">][</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">:(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Invalid message for&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;in&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">][</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))}}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">}},</span><span class="s4">2294</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Ids</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Ids</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">}</span><span class="s2">clone</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Ids</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">]</span><span class="s2">of e</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">())</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Schema id conflicts with existing key:&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">]</span><span class="s2">of e</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">())</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Schema key conflicts with existing id:&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s2">fork</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_collect</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">});</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">let </span><span class="s2">l</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">t</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)};</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">),</span><span class="s3">&quot;adjuster function failed to return a joi schema type&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of a</span><span class="s0">)</span><span class="s2">l</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fork</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)};</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">}</span><span class="s2">labels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:[];</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_get</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">s</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">label</span><span class="s0">||</span><span class="s2">r</span><span class="s0">],</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">labels</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)}</span><span class="s2">reach</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:[];</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_get</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Schema does not contain path&quot;</span><span class="s0">,[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">));</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">reach</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">]):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">}</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">||!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_property</span><span class="s0">(</span><span class="s3">&quot;schemaChain&quot;</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">)&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">id</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">===</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Cannot add different schemas with the same id:&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s3">&quot;Schema id conflicts with existing key:&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})}</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Schema already contains key:&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;Schema key conflicts with existing id:&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}))}</span><span class="s2">reset</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">}</span><span class="s2">_collect</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:[],</span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:[];</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_get</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;Schema does not contain path&quot;</span><span class="s0">,[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">=[</span><span class="s2">a</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">];</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">_collect</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,[</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">):</span><span class="s2">r</span><span class="s0">}</span><span class="s2">_get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_byId</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_byKey</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fork</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">each</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s1">let</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">===(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">id</span><span class="s0">||</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return </span><span class="s2">s</span><span class="s0">},</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">():</span><span class="s2">e</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],{</span><span class="s2">source</span><span class="s0">:</span><span class="s3">&quot;flags&quot;</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">s</span><span class="s0">},</span><span class="s2">t</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">args</span><span class="s0">,{</span><span class="s2">source</span><span class="s0">:</span><span class="s3">&quot;rules&quot;</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">name</span><span class="s0">},</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">n</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)===</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_singleRules</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],{</span><span class="s2">source</span><span class="s0">:</span><span class="s3">&quot;terms&quot;</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">s</span><span class="s0">},</span><span class="s2">t</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">||[];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">let </span><span class="s2">c</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;terms&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">source</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;keys&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">].</span><span class="s2">key</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">,</span><span class="s2">...l</span><span class="s0">],</span><span class="s2">n</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">c</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">each</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">...t</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">o</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;_&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">scan</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">,</span><span class="s2">...l</span><span class="s0">],</span><span class="s2">o</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">||</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">),</span><span class="s2">c</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">c</span><span class="s0">}},</span><span class="s4">6133</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">);</span><span class="s1">let </span><span class="s2">o</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">={</span><span class="s2">symbol</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;ref&quot;</span><span class="s0">),</span><span class="s2">defaults</span><span class="s0">:{</span><span class="s2">adjust</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s1">in</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">iterables</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">map</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">separator</span><span class="s0">:</span><span class="s3">&quot;.&quot;</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;value&quot;</span><span class="s0">}};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid reference key:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,[</span><span class="s3">&quot;adjust&quot;</span><span class="s0">,</span><span class="s3">&quot;ancestor&quot;</span><span class="s0">,</span><span class="s3">&quot;in&quot;</span><span class="s0">,</span><span class="s3">&quot;iterables&quot;</span><span class="s0">,</span><span class="s3">&quot;map&quot;</span><span class="s0">,</span><span class="s3">&quot;prefix&quot;</span><span class="s0">,</span><span class="s3">&quot;render&quot;</span><span class="s0">,</span><span class="s3">&quot;separator&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">prefix</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">.</span><span class="s2">prefix</span><span class="s0">,</span><span class="s3">&quot;options.prefix must be of type object&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">delete </span><span class="s2">r</span><span class="s0">.</span><span class="s2">prefix</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">context</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">prefix</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">root</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">||</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]!==</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Cannot specify relative path with root prefix&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s3">&quot;root&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">||!</span><span class="s2">e</span><span class="s0">||</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]!==</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Cannot combine prefix with ancestor option&quot;</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">const</span><span class="s0">[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;&quot;</span><span class="s0">===(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">s</span><span class="s0">))&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s2">t</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">n</span><span class="s0">?</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?[]:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">n</span><span class="s0">):[</span><span class="s2">e</span><span class="s0">],</span><span class="s1">new </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Ref</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">in</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">...r</span><span class="s0">,</span><span class="s1">in</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">e</span><span class="s0">&amp;&amp;!!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">]},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">Ref</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid reference construction&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;adjust&quot;</span><span class="s0">,</span><span class="s3">&quot;ancestor&quot;</span><span class="s0">,</span><span class="s3">&quot;in&quot;</span><span class="s0">,</span><span class="s3">&quot;iterables&quot;</span><span class="s0">,</span><span class="s3">&quot;map&quot;</span><span class="s0">,</span><span class="s3">&quot;path&quot;</span><span class="s0">,</span><span class="s3">&quot;render&quot;</span><span class="s0">,</span><span class="s3">&quot;separator&quot;</span><span class="s0">,</span><span class="s3">&quot;type&quot;</span><span class="s0">,</span><span class="s3">&quot;depth&quot;</span><span class="s0">,</span><span class="s3">&quot;key&quot;</span><span class="s0">,</span><span class="s3">&quot;root&quot;</span><span class="s0">,</span><span class="s3">&quot;display&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">([!</span><span class="s4">1</span><span class="s0">,</span><span class="s1">void </span><span class="s4">0</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">)||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">&amp;&amp;</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Invalid separator&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">adjust</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">adjust</span><span class="s0">,</span><span class="s3">&quot;options.adjust must be a function&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">map</span><span class="s0">||</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">map</span><span class="s0">),</span><span class="s3">&quot;options.map must be an array&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">map</span><span class="s0">||!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">adjust</span><span class="s0">,</span><span class="s3">&quot;Cannot set both map and adjust options&quot;</span><span class="s0">),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">,</span><span class="s3">&quot;Non-value references cannot reference ancestors&quot;</span><span class="s0">),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">)&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">depth</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">):</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">root</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">updateDisplay</span><span class="s0">()}</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">4</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">in</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">in</span><span class="s0">,</span><span class="s3">&quot;Invalid in() reference usage&quot;</span><span class="s0">),</span><span class="s3">&quot;global&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">context</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">):</span><span class="s3">&quot;local&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">?</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">):(</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">&lt;=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Invalid reference exceeds the schema root:&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s2">_resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let </span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">absolute</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,{</span><span class="s2">iterables</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">iterables</span><span class="s0">,</span><span class="s2">functions</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">adjust</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">adjust</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">}</span><span class="s2">toString</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">}</span><span class="s2">absolute</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">[</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">),</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">]}</span><span class="s2">clone</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Ref</span><span class="s0">(</span><span class="s1">this</span><span class="s0">)}</span><span class="s2">describe</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={</span><span class="s2">path</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">};</span><span class="s3">&quot;value&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s3">&quot;.&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">),</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s4">1</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">map</span><span class="s0">=[</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">map</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of</span><span class="s0">[</span><span class="s3">&quot;adjust&quot;</span><span class="s0">,</span><span class="s3">&quot;iterables&quot;</span><span class="s0">,</span><span class="s3">&quot;render&quot;</span><span class="s0">])</span><span class="s1">null</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]);</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">in</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">in</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}</span><span class="s2">updateDisplay</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">return void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:</span><span class="s2">$</span><span class="s0">{</span><span class="s1">this</span><span class="s0">.</span><span class="s2">type</span><span class="s0">}</span><span class="s3">:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">)</span><span class="s1">return void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">)</span><span class="s1">return void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:</span><span class="s2">$</span><span class="s0">{</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">)</span><span class="s1">return void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:root:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">)</span><span class="s1">return void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;..&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">+</span><span class="s4">1</span><span class="s0">).</span><span class="s2">fill</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">display</span><span class="s0">=</span><span class="s3">`ref:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">}},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">Ref</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">build</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;value&quot;</span><span class="s0">===(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s4">1</span><span class="s0">),</span><span class="s1">new </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">context</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">global</span><span class="s0">?</span><span class="s3">&quot;$&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">global</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">startsWith</span><span class="s0">(</span><span class="s2">s</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;global&quot;</span><span class="s0">};</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">local</span><span class="s0">?</span><span class="s3">&quot;#&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">local</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">startsWith</span><span class="s0">(</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;local&quot;</span><span class="s0">};</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">root</span><span class="s0">?</span><span class="s3">&quot;/&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">root</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">startsWith</span><span class="s0">(</span><span class="s2">a</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;value&quot;</span><span class="s0">,</span><span class="s2">root</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;value&quot;</span><span class="s0">}},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]!==</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]!==</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">];</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]===</span><span class="s2">t</span><span class="s0">;)++</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return</span><span class="s0">[</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">]},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toSibling</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toParent</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Manager</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">=[]}</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toParent</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">-</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">-</span><span class="s2">s</span><span class="s0">,</span><span class="s2">root</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">root</span><span class="s0">});</span><span class="s1">else </span><span class="s2">t</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">-</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">-</span><span class="s2">s</span><span class="s0">,</span><span class="s2">root</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">root</span><span class="s0">}),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">||</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">)}</span><span class="s2">get length</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">.</span><span class="s2">length</span><span class="s0">}</span><span class="s2">clone</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">Manager</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}</span><span class="s2">reset</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">=[]}</span><span class="s2">roots</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">)).</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">root</span><span class="s0">))}}},</span><span class="s4">3378</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5107</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={};</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">min</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">max</span><span class="s0">(</span><span class="s4">2</span><span class="s0">).</span><span class="s2">allow</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">allowUnknown</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">abortEarly</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">artifacts</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">cache</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">context</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">(),</span><span class="s2">convert</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">dateFormat</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;date&quot;</span><span class="s0">,</span><span class="s3">&quot;iso&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s3">&quot;time&quot;</span><span class="s0">,</span><span class="s3">&quot;utc&quot;</span><span class="s0">),</span><span class="s2">debug</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">errors</span><span class="s0">:{</span><span class="s2">escapeHtml</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">label</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;path&quot;</span><span class="s0">,</span><span class="s3">&quot;key&quot;</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">language</span><span class="s0">:[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">ref</span><span class="s0">()],</span><span class="s2">render</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">stack</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">wrap</span><span class="s0">:{</span><span class="s2">label</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">,</span><span class="s2">array</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">,</span><span class="s2">string</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">}},</span><span class="s2">externals</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">messages</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">(),</span><span class="s2">noDefaults</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">nonEnumerables</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">presence</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">),</span><span class="s2">skipFunctions</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">stripUnknown</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">arrays</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">objects</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()}).</span><span class="s2">or</span><span class="s0">(</span><span class="s3">&quot;arrays&quot;</span><span class="s0">,</span><span class="s3">&quot;objects&quot;</span><span class="s0">).</span><span class="s2">allow</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">warnings</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()}).</span><span class="s2">strict</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">=</span><span class="s5">/^[a-zA-Z0-9]\w*$/</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">alias</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">)).</span><span class="s2">single</span><span class="s0">(),</span><span class="s2">args</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">).</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alternatives</span><span class="s0">([</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">schema</span><span class="s0">()]).</span><span class="s2">conditional</span><span class="s0">(</span><span class="s3">&quot;ref&quot;</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">required</span><span class="s0">()}),</span><span class="s2">normalize</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">message</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">when</span><span class="s0">(</span><span class="s3">&quot;assert&quot;</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">then</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">required</span><span class="s0">()})})),</span><span class="s2">convert</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">manifest</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">method</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">allow</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">multi</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">validate</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">()}),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">extension</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alternatives</span><span class="s0">([</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">regex</span><span class="s0">()]).</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">args</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">cast</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">from</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">to</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">minArity</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">2</span><span class="s0">).</span><span class="s2">required</span><span class="s0">()})),</span><span class="s2">base</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">schema</span><span class="s0">().</span><span class="s2">when</span><span class="s0">(</span><span class="s3">&quot;type&quot;</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">regex</span><span class="s0">(),</span><span class="s2">then</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">forbidden</span><span class="s0">()}),</span><span class="s2">coerce</span><span class="s0">:[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">method</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">3</span><span class="s0">).</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">from</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">()).</span><span class="s2">single</span><span class="s0">()})],</span><span class="s2">flags</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">setter</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s1">default</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">any</span><span class="s0">()})),</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">arity</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)},</span><span class="s2">messages</span><span class="s0">:[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">()],</span><span class="s2">modifiers</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">minArity</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)),</span><span class="s2">overrides</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">()),</span><span class="s2">prepare</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">rebuild</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">arity</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">rules</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">),</span><span class="s2">terms</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nameRx</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">init</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">allow</span><span class="s0">(</span><span class="s1">null</span><span class="s0">).</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">manifest</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s5">/.+/</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;schema&quot;</span><span class="s0">,</span><span class="s3">&quot;single&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">mapped</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">from</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">to</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">required</span><span class="s0">()}).</span><span class="s2">required</span><span class="s0">()})])})),</span><span class="s2">validate</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">maxArity</span><span class="s0">(</span><span class="s4">3</span><span class="s0">)}).</span><span class="s2">strict</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">arity</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)).</span><span class="s2">strict</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">={</span><span class="s2">buffer</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">buffer</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">()}),</span><span class="s2">func</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s1">function</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">options</span><span class="s0">:{</span><span class="s2">literal</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}}),</span><span class="s2">override</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">,</span><span class="s3">&quot;global&quot;</span><span class="s0">,</span><span class="s3">&quot;local&quot;</span><span class="s0">),</span><span class="s2">path</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">separator</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">length</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">allow</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">number</span><span class="s0">().</span><span class="s2">min</span><span class="s0">(</span><span class="s4">0</span><span class="s0">).</span><span class="s2">integer</span><span class="s0">().</span><span class="s2">allow</span><span class="s0">(</span><span class="s3">&quot;root&quot;</span><span class="s0">),</span><span class="s2">map</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">length</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)).</span><span class="s2">min</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">adjust</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">iterables</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s1">in</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">render</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()}).</span><span class="s2">required</span><span class="s0">()}),</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">min</span><span class="s0">(</span><span class="s4">3</span><span class="s0">)}),</span><span class="s2">special</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">special</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s3">&quot;deep&quot;</span><span class="s0">).</span><span class="s2">required</span><span class="s0">()}),</span><span class="s2">template</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">template</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">options</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">()}),</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alternatives</span><span class="s0">([</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">()]).</span><span class="s2">required</span><span class="s0">()})},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alternatives</span><span class="s0">([</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">link</span><span class="s0">(</span><span class="s3">&quot;...&quot;</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">number</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">func</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">special</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">template</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">link</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">)]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">values</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">function</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">number</span><span class="s0">().</span><span class="s2">allow</span><span class="s0">(</span><span class="s4">1</span><span class="s0">/</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">/</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">allow</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">symbol</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">func</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">override</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">template</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s5">/.+/</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">template</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s5">/.+/</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">template</span><span class="s0">])]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">description</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">flags</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">cast</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s1">default</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">any</span><span class="s0">(),</span><span class="s2">description</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">empty</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">link</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">),</span><span class="s2">failover</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">,</span><span class="s2">id</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">label</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">only</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">presence</span><span class="s0">:[</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">],</span><span class="s2">result</span><span class="s0">:[</span><span class="s3">&quot;raw&quot;</span><span class="s0">,</span><span class="s3">&quot;strip&quot;</span><span class="s0">],</span><span class="s2">strip</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">unit</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">()}).</span><span class="s2">unknown</span><span class="s0">(),</span><span class="s2">preferences</span><span class="s0">:{</span><span class="s2">allowUnknown</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">abortEarly</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">artifacts</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">cache</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">convert</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">dateFormat</span><span class="s0">:[</span><span class="s3">&quot;date&quot;</span><span class="s0">,</span><span class="s3">&quot;iso&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s3">&quot;time&quot;</span><span class="s0">,</span><span class="s3">&quot;utc&quot;</span><span class="s0">],</span><span class="s2">errors</span><span class="s0">:{</span><span class="s2">escapeHtml</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">label</span><span class="s0">:[</span><span class="s3">&quot;path&quot;</span><span class="s0">,</span><span class="s3">&quot;key&quot;</span><span class="s0">],</span><span class="s2">language</span><span class="s0">:[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">],</span><span class="s2">wrap</span><span class="s0">:{</span><span class="s2">label</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">,</span><span class="s2">array</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">}},</span><span class="s2">externals</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">messages</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">,</span><span class="s2">noDefaults</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">nonEnumerables</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">presence</span><span class="s0">:[</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">],</span><span class="s2">skipFunctions</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">stripUnknown</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">({</span><span class="s2">arrays</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">objects</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()}).</span><span class="s2">or</span><span class="s0">(</span><span class="s3">&quot;arrays&quot;</span><span class="s0">,</span><span class="s3">&quot;objects&quot;</span><span class="s0">).</span><span class="s2">allow</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">warnings</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()},</span><span class="s2">allow</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">values</span><span class="s0">,</span><span class="s2">invalid</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">values</span><span class="s0">,</span><span class="s2">rules</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">min</span><span class="s0">(</span><span class="s4">1</span><span class="s0">).</span><span class="s2">items</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">().</span><span class="s2">required</span><span class="s0">(),</span><span class="s2">args</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">min</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">keep</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">(),</span><span class="s2">message</span><span class="s0">:[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">string</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">],</span><span class="s2">warn</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">boolean</span><span class="s0">()}),</span><span class="s2">keys</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">object</span><span class="s0">().</span><span class="s2">pattern</span><span class="s0">(</span><span class="s5">/.*/</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">link</span><span class="s0">(</span><span class="s3">&quot;/&quot;</span><span class="s0">)),</span><span class="s2">link</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">desc</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">}).</span><span class="s2">pattern</span><span class="s0">(</span><span class="s5">/^[a-z]\w*$/</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">any</span><span class="s0">())},</span><span class="s4">493</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">)};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">State</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">State</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">=[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">...s</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">}</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">State</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">,</span><span class="s1">this</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">&amp;&amp;[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">...r</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">],</span><span class="s2">r</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s2">shadow</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">||</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Shadow</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">snapshot</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshot</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">.</span><span class="s2">node</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">))),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">()}</span><span class="s2">restore</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">.</span><span class="s2">override</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshot</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshot</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">()}</span><span class="s2">commit</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">.</span><span class="s2">override</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshot</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshot</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">commit</span><span class="s0">()}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Shadow</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;strip&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">])</span><span class="s1">return</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">||</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">;</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">n</span><span class="s0">||(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">}</span><span class="s2">s</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">node</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">]}</span><span class="s2">node</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">iterables</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})}</span><span class="s2">override</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">iterables</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s2">t</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">):</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}}},</span><span class="s4">3328</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5277</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1447</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">u</span><span class="s0">={</span><span class="s2">symbol</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;template&quot;</span><span class="s0">),</span><span class="s2">opens</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">1e3</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\0</span><span class="s3">&quot;</span><span class="s0">),</span><span class="s2">closes</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">1e3</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s2">dateFormat</span><span class="s0">:{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toDateString</span><span class="s0">,</span><span class="s2">iso</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toISOString</span><span class="s0">,</span><span class="s2">string</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">,</span><span class="s2">time</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toTimeString</span><span class="s0">,</span><span class="s2">utc</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toUTCString</span><span class="s0">}};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Template source must be a string&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\0</span><span class="s3">&quot;</span><span class="s0">)&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s3">&quot;Template source cannot contain reserved control characters&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rendered</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">functions</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">r</span><span class="s0">).</span><span class="s2">length</span><span class="s0">?</span><span class="s2">n</span><span class="s0">(</span><span class="s2">r</span><span class="s0">):</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">).</span><span class="s2">every</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)),</span><span class="s3">&quot;Functions keys must be strings&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">values</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">).</span><span class="s2">every</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)),</span><span class="s3">&quot;Functions values must be functions&quot;</span><span class="s0">))}</span><span class="s1">else this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_parse</span><span class="s0">()}</span><span class="s2">_parse</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;{&quot;</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;{&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;}&quot;</span><span class="s0">:</span><span class="s3">&quot;}}&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">||</span><span class="s3">&quot;{&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]){</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">`{</span><span class="s2">$</span><span class="s0">{</span><span class="s2">u</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">t</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;:&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">));</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ref</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),{</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">wrapped</span><span class="s0">:</span><span class="s2">o</span><span class="s0">});</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">l</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">a</span><span class="s0">+</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">c</span><span class="s0">))}</span><span class="s2">r</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">=</span><span class="s2">s</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rendered</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s1">static </span><span class="s2">date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">dateFormat</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dateFormat</span><span class="s0">].</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">describe</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">;</span><span class="s1">const </span><span class="s2">t</span><span class="s0">={</span><span class="s2">template</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">};</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">),</span><span class="s2">t</span><span class="s0">}</span><span class="s1">static </span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return new </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">template</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">?{</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">,</span><span class="s2">functions</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">}:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">)}</span><span class="s2">isDynamic</span><span class="s0">(){</span><span class="s1">return</span><span class="s0">!!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">}</span><span class="s1">static </span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">e</span><span class="s0">&amp;&amp;!!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">template</span><span class="s0">]}</span><span class="s2">refs</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">)</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">refs</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">&amp;&amp;</span><span class="s4">1</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_part</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{}):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">render</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)}</span><span class="s2">_part</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">...r</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">formula</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s2">render</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">4</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">isDynamic</span><span class="s0">())</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">rendered</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">o of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_template</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_part</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">raw</span><span class="s0">||!</span><span class="s4">1</span><span class="s0">===(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">escapeHtml</span><span class="s0">)?</span><span class="s2">c</span><span class="s0">:</span><span class="s2">a</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">wrapped</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">.</span><span class="s2">label</span><span class="s0">))}}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s2">_ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">wrapped</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=[],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_settings</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">...e</span><span class="s0">);</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">?</span><span class="s2">r</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}};</span><span class="s1">try</span><span class="s0">{</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">?{</span><span class="s2">...u</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">,</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_functions</span><span class="s0">}:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Parser</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">reference</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">functions</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">constants</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">})}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">throw </span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s3">`Invalid template variable &quot;</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">&quot; fails due to: </span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">}</span><span class="s3">`</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">single</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;reference&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">single</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return</span><span class="s0">{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">refs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">wrapped</span><span class="s0">:</span><span class="s2">s</span><span class="s0">||</span><span class="s3">&quot;local&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;label&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">single</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">formula</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">refs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}}</span><span class="s2">toString</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">source</span><span class="s0">}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">template</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isImmutable</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\\(\{+)/g</span><span class="s0">,((</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">opens</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">))).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\\(\}+)/g</span><span class="s0">,((</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">closes</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)))},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\u0000/g</span><span class="s0">,</span><span class="s3">&quot;{&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\u0001/g</span><span class="s0">,</span><span class="s3">&quot;}&quot;</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">split</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[];</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;{&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;{&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">];)</span><span class="s2">n</span><span class="s0">+=</span><span class="s3">&quot;{&quot;</span><span class="s0">,++</span><span class="s2">s</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">}</span><span class="s1">else </span><span class="s2">r</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s3">`</span><span class="s0">:</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]}</span><span class="s3">`</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">5</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">5</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">5</span><span class="s0">]:{};</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">||{};</span><span class="s1">let </span><span class="s2">l</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">render</span><span class="s0">&amp;&amp;(</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">in</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,{</span><span class="s1">in</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">in</span><span class="s0">,</span><span class="s2">...a</span><span class="s0">})),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;null&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">arrayItems</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">string</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;number&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">||</span><span class="s3">&quot;symbol&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Template</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Map</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">[</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">]</span><span class="s2">of e</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">())</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()} </span><span class="s3">-&gt; </span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()}</span><span class="s3">`</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of e</span><span class="s0">)</span><span class="s2">f</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,{</span><span class="s2">arrayItems</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">...a</span><span class="s0">}));</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">),!</span><span class="s2">l</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">array</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">={</span><span class="s1">true</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s1">false</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s1">null</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">second</span><span class="s0">:</span><span class="s4">1e3</span><span class="s0">,</span><span class="s2">minute</span><span class="s0">:</span><span class="s4">6e4</span><span class="s0">,</span><span class="s2">hour</span><span class="s0">:</span><span class="s4">36e5</span><span class="s0">,</span><span class="s2">day</span><span class="s0">:</span><span class="s4">864e5</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">={</span><span class="s1">if</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">length</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">msg</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const</span><span class="s0">[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">messages</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">template</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)||</span><span class="s2">l</span><span class="s0">.</span><span class="s2">template</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">render</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">):</span><span class="s3">&quot;&quot;</span><span class="s0">},</span><span class="s2">number</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">:</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">():</span><span class="s1">null</span><span class="s0">}},</span><span class="s4">4946</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1687</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">u</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;alternatives&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">match</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:</span><span class="s3">&quot;any&quot;</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">matches</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[],</span><span class="s2">register</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">toSibling</span><span class="s0">}},</span><span class="s2">args</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">return </span><span class="s4">1</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">try</span><span class="s0">(</span><span class="s2">...r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">try</span><span class="s0">(</span><span class="s2">...r</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">match</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s3">`match.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s2">l</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">();</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s2">c</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">?(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">()):(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">commit</span><span class="s0">())}</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;alternatives.any&quot;</span><span class="s0">,{</span><span class="s2">details</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))})};</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;one&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">match</span><span class="s0">)</span><span class="s1">return </span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]}:{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;alternatives.one&quot;</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;alternatives.all&quot;</span><span class="s0">,{</span><span class="s2">details</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))})};</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">some</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;object&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;alternatives&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)));</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)?{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(((</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">mergeArrays</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))}:{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]}}</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s3">`match.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">();</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">commit</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">reports</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">});</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">):</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">is</span><span class="s0">?[</span><span class="s2">s</span><span class="s0">]:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">f</span><span class="s0">}=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s3">`match.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">?</span><span class="s3">&quot;.&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">}</span><span class="s3">`</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">h</span><span class="s0">}</span><span class="s3">.is`</span><span class="s0">),</span><span class="s2">i</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">h</span><span class="s0">}</span><span class="s3">.then`</span><span class="s0">),</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">h</span><span class="s0">}</span><span class="s3">.otherwise`</span><span class="s0">),</span><span class="s2">i</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">conditional</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_endedSwitch</span><span class="s0">,</span><span class="s3">&quot;Unreachable condition&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">match</span><span class="s0">,</span><span class="s3">&quot;Cannot combine match mode&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">match</span><span class="s0">,</span><span class="s3">&quot;with conditional rule&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">break</span><span class="s0">,</span><span class="s3">&quot;Cannot use break option with alternatives conditional&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">when</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">is</span><span class="s0">?[</span><span class="s2">n</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of a</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">then</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">otherwise</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;_endedSwitch&quot;</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s1">break</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}},</span><span class="s2">match</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;any&quot;</span><span class="s0">,</span><span class="s3">&quot;one&quot;</span><span class="s0">,</span><span class="s3">&quot;all&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid alternatives match mode&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;any&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s3">&quot;Cannot combine match mode&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;with conditional rules&quot;</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;match&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}},</span><span class="s1">try</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Missing alternative schemas&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;try&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_endedSwitch</span><span class="s0">,</span><span class="s3">&quot;Unreachable condition&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}}},</span><span class="s2">overrides</span><span class="s0">:{</span><span class="s2">label</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_parent</span><span class="s0">(</span><span class="s3">&quot;label&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">).</span><span class="s2">$_modify</span><span class="s0">({</span><span class="s2">each</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;</span><span class="s3">&quot;is&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">label</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})}},</span><span class="s2">rebuild</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_modify</span><span class="s0">({</span><span class="s2">each</span><span class="s0">:</span><span class="s2">t</span><span class="s0">=&gt;{</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)&amp;&amp;</span><span class="s3">&quot;array&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;_arrayItems&quot;</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})}})},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of t</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">is</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">not</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">try</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">conditional</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">not</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s1">switch</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">}):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">conditional</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,{</span><span class="s2">then</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">o</span><span class="s0">})}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;alternatives.all&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not match all of the required types&quot;</span><span class="s0">,</span><span class="s3">&quot;alternatives.any&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not match any of the allowed types&quot;</span><span class="s0">,</span><span class="s3">&quot;alternatives.match&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not match any of the allowed types&quot;</span><span class="s0">,</span><span class="s3">&quot;alternatives.one&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} matches more than one allowed type&quot;</span><span class="s0">,</span><span class="s3">&quot;alternatives.types&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be one of {{#types}}&quot;</span><span class="s0">}}),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s3">&quot;alternatives.any&quot;</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">reports</span><span class="s0">};</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">reports</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}</span><span class="s2">of e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">unmatched</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o </span><span class="s1">instanceof </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">==</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">unmatched</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">report</span><span class="s0">:</span><span class="s2">o</span><span class="s0">});</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;any.only&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">code</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of o</span><span class="s0">.</span><span class="s2">local</span><span class="s0">.</span><span class="s2">valids</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const</span><span class="s0">[</span><span class="s2">c</span><span class="s0">,</span><span class="s2">f</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">code</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s3">&quot;base&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">c</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">report</span><span class="s0">:</span><span class="s2">o</span><span class="s0">})}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">a</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">report</span><span class="s0">}:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">unmatched</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s3">&quot;alternatives.types&quot;</span><span class="s0">,{</span><span class="s2">types</span><span class="s0">:[</span><span class="s2">...n</span><span class="s0">]})}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">unmatched</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">reports</span><span class="s0">);</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">t</span><span class="s0">(</span><span class="s3">&quot;alternatives.match&quot;</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))}}},</span><span class="s4">8068</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7629</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6914</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;any&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">only</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">alterations</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">examples</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">externals</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">metas</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]},</span><span class="s2">notes</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]},</span><span class="s2">shared</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">tags</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]},</span><span class="s2">whens</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">custom</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Method must be a function&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Description must be a non-empty string&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;custom&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">method</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;any.custom&quot;</span><span class="s0">,{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})}},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;method&quot;</span><span class="s0">,</span><span class="s3">&quot;description&quot;</span><span class="s0">],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">({</span><span class="s2">messages</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})}},</span><span class="s2">shared</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s3">&quot;Schema must be a schema with an id&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">||[],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">warning</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid warning code&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;warning&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">code</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">local</span><span class="s0">:</span><span class="s2">t</span><span class="s0">},</span><span class="s2">warn</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">local</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;code&quot;</span><span class="s0">,</span><span class="s3">&quot;local&quot;</span><span class="s0">],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">modifiers</span><span class="s0">:{</span><span class="s2">keep</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keep</span><span class="s0">=</span><span class="s2">t</span><span class="s0">},</span><span class="s2">message</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">warn</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">=</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r </span><span class="s1">in </span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">([</span><span class="s3">&quot;examples&quot;</span><span class="s0">,</span><span class="s3">&quot;externals&quot;</span><span class="s0">,</span><span class="s3">&quot;metas&quot;</span><span class="s0">,</span><span class="s3">&quot;notes&quot;</span><span class="s0">,</span><span class="s3">&quot;tags&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of s</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">)](</span><span class="s2">t</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;alterations&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;whens&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;shared&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of s</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of s</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">is</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">not</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">concat</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">o</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">o</span><span class="s0">):</span><span class="s2">r</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">when</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">is</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">not</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">then</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s1">switch</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">switch</span><span class="s0">,</span><span class="s1">break</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">break</span><span class="s0">}):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">when</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">then</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">otherwise</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s1">break</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">break</span><span class="s0">})}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">const </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">target</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">adjuster</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}</span><span class="s2">of s</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">alter</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;any.custom&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} failed custom validation because {{#error.message}}&quot;</span><span class="s0">,</span><span class="s3">&quot;any.default&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} threw an error when running default method&quot;</span><span class="s0">,</span><span class="s3">&quot;any.failover&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} threw an error when running failover method&quot;</span><span class="s0">,</span><span class="s3">&quot;any.invalid&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains an invalid value&quot;</span><span class="s0">,</span><span class="s3">&quot;any.only&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} must be {if(#valids.length == 1, &quot;&quot;, &quot;one of &quot;)}{{#valids}}'</span><span class="s0">,</span><span class="s3">&quot;any.ref&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} {{#arg}} references {{:#ref}} which {{#reason}}&quot;</span><span class="s0">,</span><span class="s3">&quot;any.required&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} is required&quot;</span><span class="s0">,</span><span class="s3">&quot;any.unknown&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} is not allowed&quot;</span><span class="s0">}})},</span><span class="s4">546</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9474</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">c</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;array&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">single</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">sparse</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">items</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[],</span><span class="s2">manifest</span><span class="s0">:</span><span class="s3">&quot;schema&quot;</span><span class="s0">},</span><span class="s2">ordered</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[],</span><span class="s2">manifest</span><span class="s0">:</span><span class="s3">&quot;schema&quot;</span><span class="s0">},</span><span class="s2">_exclusions</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]},</span><span class="s2">_inclusions</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]},</span><span class="s2">_requireds</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:[]}},</span><span class="s2">coerce</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s3">&quot;object&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;sort&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">options</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">):</span><span class="s1">void </span><span class="s4">0</span><span class="s0">}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">single</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">arraySingle</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.base&quot;</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;items&quot;</span><span class="s0">)||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">()}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">has</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;has&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}});</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">state</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...s</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...s</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">t</span><span class="s0">],</span><span class="s2">o</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">label</span><span class="s0">;</span><span class="s1">return </span><span class="s2">l</span><span class="s0">?</span><span class="s2">a</span><span class="s0">(</span><span class="s3">&quot;array.hasKnown&quot;</span><span class="s0">,{</span><span class="s2">patternLabel</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}):</span><span class="s2">a</span><span class="s0">(</span><span class="s3">&quot;array.hasUnknown&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">)},</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">items</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">o</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;items&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;items&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">tryWithPath</span><span class="s0">((()=&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">])),</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">append</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">items</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">errorsArray</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_requireds</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">=[</span><span class="s2">...r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_inclusions</span><span class="s0">,</span><span class="s2">...l</span><span class="s0">],</span><span class="s2">h</span><span class="s0">=!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">arraySingle</span><span class="s0">];</span><span class="s1">delete </span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">arraySingle</span><span class="s0">];</span><span class="s1">const </span><span class="s2">m</span><span class="s0">=</span><span class="s2">i</span><span class="s0">();</span><span class="s1">let </span><span class="s2">d</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">d</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">g</span><span class="s0">=</span><span class="s2">h</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Number</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=[</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">g</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sparse</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.sparse&quot;</span><span class="s0">,{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">g</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">y</span><span class="s0">,</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">b</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_exclusions</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">a</span><span class="s0">,{</span><span class="s2">presence</span><span class="s0">:</span><span class="s3">&quot;ignore&quot;</span><span class="s0">})){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.excludes&quot;</span><span class="s0">,{</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">i</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...l</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;strip&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">)</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),--</span><span class="s2">t</span><span class="s0">,--</span><span class="s2">d</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sparse</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">value</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.sparse&quot;</span><span class="s0">,{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">g</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">y</span><span class="s0">,</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.orderedLength&quot;</span><span class="s0">,{</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">.</span><span class="s2">length</span><span class="s0">})),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">const </span><span class="s2">v</span><span class="s0">=[];</span><span class="s1">let </span><span class="s2">_</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">_</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">const </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">l</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]);</span><span class="s2">u</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">();</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">v</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">,!</span><span class="s2">f</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">commit</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),--</span><span class="s2">o</span><span class="s0">,--</span><span class="s2">_</span><span class="s0">,!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sparse</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.sparse&quot;</span><span class="s0">,{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">g</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">y</span><span class="s0">,</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">))</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s2">u</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">()}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">w</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">&amp;&amp;!!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">.</span><span class="s2">arrays</span><span class="s0">||!</span><span class="s4">1</span><span class="s0">;</span><span class="s2">_</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">u of f</span><span class="s0">){</span><span class="s1">let </span><span class="s2">f</span><span class="s0">;</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">u</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">)</span><span class="s2">f</span><span class="s0">=</span><span class="s2">v</span><span class="s0">[</span><span class="s2">h</span><span class="s0">];</span><span class="s1">else</span><span class="s0">{</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">u</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">snapshot</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),!</span><span class="s2">f</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s2">l</span><span class="s0">.</span><span class="s2">commit</span><span class="s0">(),</span><span class="s3">&quot;strip&quot;</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">?(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),--</span><span class="s2">t</span><span class="s0">,--</span><span class="s2">d</span><span class="s0">):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sparse</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">.</span><span class="s2">value</span><span class="s0">?</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">value</span><span class="s0">:(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.sparse&quot;</span><span class="s0">,{</span><span class="s2">key</span><span class="s0">:</span><span class="s2">g</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">y</span><span class="s0">,</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s2">l</span><span class="s0">.</span><span class="s2">restore</span><span class="s0">()}</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">_</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">w</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),--</span><span class="s2">t</span><span class="s0">,--</span><span class="s2">d</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...f</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">;</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_inclusions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_requireds</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)&amp;&amp;!</span><span class="s2">p</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">w</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),--</span><span class="s2">t</span><span class="s0">,--</span><span class="s2">d</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.includes&quot;</span><span class="s0">,{</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">i</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">m</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillMissedErrors</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillOrderedErrors</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillDefault</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">m</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">priority</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">manifest</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">length</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;=&quot;</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;array.&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must be a positive integer&quot;</span><span class="s0">}]},</span><span class="s2">max</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;max&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">})}},</span><span class="s2">min</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;min&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">})}},</span><span class="s2">ordered</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">o</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;ordered&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;items&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">tryWithPath</span><span class="s0">((()=&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">])),</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">append</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validateSingle</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}},</span><span class="s2">single</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||!!</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">||!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_arrayItems</span><span class="s0">,</span><span class="s3">&quot;Cannot specify single rule when array has array items&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;single&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">sort</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">o</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;by&quot;</span><span class="s0">,</span><span class="s3">&quot;order&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">={</span><span class="s2">order</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">order</span><span class="s0">||</span><span class="s3">&quot;ascending&quot;</span><span class="s0">};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">by</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">by</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">by</span><span class="s0">,{</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s4">0</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">by</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">,</span><span class="s3">&quot;Cannot sort by ancestor&quot;</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;sort&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">const</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">u</span><span class="s0">}=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]!==</span><span class="s2">l</span><span class="s0">[</span><span class="s2">t</span><span class="s0">])</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;array.sort&quot;</span><span class="s0">,{</span><span class="s2">order</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">order</span><span class="s0">,</span><span class="s2">by</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">by</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">by</span><span class="s0">.</span><span class="s2">key</span><span class="s0">:</span><span class="s3">&quot;value&quot;</span><span class="s0">});</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">sparse</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||!!</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sparse</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s1">this</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">():</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;items&quot;</span><span class="s0">)).</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;sparse&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})}},</span><span class="s2">unique</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;comparator must be a function or a string&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,[</span><span class="s3">&quot;ignoreUndefined&quot;</span><span class="s0">,</span><span class="s3">&quot;separator&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;unique&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">comparator</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">default</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">,</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">s</span><span class="s0">):[</span><span class="s2">e</span><span class="s0">]}</span><span class="s1">else </span><span class="s2">r</span><span class="s0">.</span><span class="s2">comparator</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">state</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">c</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">comparator</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">f</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">comparator</span><span class="s0">:</span><span class="s2">h</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">m</span><span class="s0">}=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">const </span><span class="s2">d</span><span class="s0">={</span><span class="s2">string</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">number</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">undefined</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">boolean</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">object</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s1">function</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s2">custom</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">},</span><span class="s2">p</span><span class="s0">=</span><span class="s2">h</span><span class="s0">||</span><span class="s2">n</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">ignoreUndefined</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">m</span><span class="s0">?</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">m</span><span class="s0">):</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">h</span><span class="s0">?</span><span class="s2">d</span><span class="s0">.</span><span class="s2">custom</span><span class="s0">:</span><span class="s2">d</span><span class="s0">[</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;Failed to find unique map container for type&quot;</span><span class="s0">,</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">),</span><span class="s2">n </span><span class="s1">instanceof </span><span class="s2">Map</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">();</span><span class="s1">let </span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;!(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">next</span><span class="s0">()).</span><span class="s2">done</span><span class="s0">;)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...o</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">t</span><span class="s0">],[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...o</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">={</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">dupePos</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">dupeValue</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]]};</span><span class="s1">return </span><span class="s2">m</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">u</span><span class="s0">),</span><span class="s2">l</span><span class="s0">(</span><span class="s3">&quot;array.unique&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">((!</span><span class="s2">g</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">)&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">={</span><span class="s2">pos</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">dupePos</span><span class="s0">:</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">dupeValue</span><span class="s0">:</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]]};</span><span class="s1">return </span><span class="s2">m</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">path</span><span class="s0">=</span><span class="s2">u</span><span class="s0">),</span><span class="s2">l</span><span class="s0">(</span><span class="s3">&quot;array.unique&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...o</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">t</span><span class="s0">],[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...o</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">]))}</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;comparator&quot;</span><span class="s0">,</span><span class="s3">&quot;options&quot;</span><span class="s0">],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">cast</span><span class="s0">:{</span><span class="s2">set</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">rebuild</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_inclusions</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_exclusions</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_requireds</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">items</span><span class="s0">)</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validateSingle</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;required&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_requireds</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_exclusions</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">_inclusions</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">)</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validateSingle</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">items</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">items</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">items</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">ordered</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;array.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be an array&quot;</span><span class="s0">,</span><span class="s3">&quot;array.excludes&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains an excluded value&quot;</span><span class="s0">,</span><span class="s3">&quot;array.hasKnown&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not contain at least one required match for type {:#patternLabel}&quot;</span><span class="s0">,</span><span class="s3">&quot;array.hasUnknown&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not contain at least one required match&quot;</span><span class="s0">,</span><span class="s3">&quot;array.includes&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not match any of the allowed types&quot;</span><span class="s0">,</span><span class="s3">&quot;array.includesRequiredBoth&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not contain {{#knownMisses}} and {{#unknownMisses}} other required value(s)&quot;</span><span class="s0">,</span><span class="s3">&quot;array.includesRequiredKnowns&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not contain {{#knownMisses}}&quot;</span><span class="s0">,</span><span class="s3">&quot;array.includesRequiredUnknowns&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} does not contain {{#unknownMisses}} required value(s)&quot;</span><span class="s0">,</span><span class="s3">&quot;array.length&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain {{#limit}} items&quot;</span><span class="s0">,</span><span class="s3">&quot;array.max&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain less than or equal to {{#limit}} items&quot;</span><span class="s0">,</span><span class="s3">&quot;array.min&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain at least {{#limit}} items&quot;</span><span class="s0">,</span><span class="s3">&quot;array.orderedLength&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain at most {{#limit}} items&quot;</span><span class="s0">,</span><span class="s3">&quot;array.sort&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be sorted in {#order} order by {{#by}}&quot;</span><span class="s0">,</span><span class="s3">&quot;array.sort.mismatching&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} cannot be sorted due to mismatching types&quot;</span><span class="s0">,</span><span class="s3">&quot;array.sort.unsupported&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} cannot be sorted due to unsupported type {#type}&quot;</span><span class="s0">,</span><span class="s3">&quot;array.sparse&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must not be a sparse array item&quot;</span><span class="s0">,</span><span class="s3">&quot;array.unique&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains a duplicate value&quot;</span><span class="s0">}}),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillMissedErrors</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=[];</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">label</span><span class="s0">;</span><span class="s2">t</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):++</span><span class="s2">o</span><span class="s0">}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">o</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;array.includesRequiredBoth&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">knownMisses</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">unknownMisses</span><span class="s0">:</span><span class="s2">o</span><span class="s0">},</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;array.includesRequiredKnowns&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">knownMisses</span><span class="s0">:</span><span class="s2">i</span><span class="s0">},</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;array.includesRequiredUnknowns&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">unknownMisses</span><span class="s0">:</span><span class="s2">o</span><span class="s0">},</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">))},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillOrderedErrors</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">)</span><span class="s3">&quot;required&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillMissedErrors</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fillDefault</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=[];</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">s</span><span class="s0">).</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s2">a</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...n</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">fastSplice</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];--</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validateSingle</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){(</span><span class="s3">&quot;array&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_arrayItems</span><span class="s0">)&amp;&amp;(</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">single</span><span class="s0">,</span><span class="s3">&quot;Cannot specify array item with single rule enabled&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;_arrayItems&quot;</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s3">&quot;ascending&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">*</span><span class="s2">a</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)=&gt;{</span><span class="s1">let </span><span class="s2">f</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">f</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">by</span><span class="s0">&amp;&amp;(</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">by</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">by</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">f</span><span class="s0">;</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s1">typeof </span><span class="s2">l</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">!==</span><span class="s1">typeof </span><span class="s2">u</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;array.sort.mismatching&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;number&quot;</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;array.sort.unsupported&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">h</span><span class="s0">},</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">return</span><span class="s3">&quot;number&quot;</span><span class="s0">===</span><span class="s2">h</span><span class="s0">?(</span><span class="s2">l</span><span class="s0">-</span><span class="s2">u</span><span class="s0">)*</span><span class="s2">a</span><span class="s0">:</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">?</span><span class="s2">i</span><span class="s0">:</span><span class="s2">o</span><span class="s0">};</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">().</span><span class="s2">sort</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)}}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">s</span><span class="s0">:</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s2">r</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}},</span><span class="s4">4937</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2036</span><span class="s0">),</span><span class="s2">o</span><span class="s0">={</span><span class="s2">isBool</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">}};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">sensitive</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">falsy</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">manifest</span><span class="s0">:</span><span class="s3">&quot;values&quot;</span><span class="s0">},</span><span class="s2">truthy</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">manifest</span><span class="s0">:</span><span class="s3">&quot;values&quot;</span><span class="s0">}},</span><span class="s2">coerce</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sensitive</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">();</span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;true&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;false&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">}</span><span class="s1">return</span><span class="s3">&quot;boolean&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sensitive</span><span class="s0">)||(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">||!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">sensitive</span><span class="s0">))&amp;&amp;</span><span class="s2">e</span><span class="s0">),{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s3">&quot;boolean.base&quot;</span><span class="s0">)}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">truthy</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">a</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;truthy&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">||</span><span class="s1">new </span><span class="s2">i</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Cannot call truthy with undefined&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}},</span><span class="s2">falsy</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">a</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;falsy&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">||</span><span class="s1">new </span><span class="s2">i</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Cannot call falsy with undefined&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}},</span><span class="s2">sensitive</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;sensitive&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}}},</span><span class="s2">cast</span><span class="s0">:{</span><span class="s2">number</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isBool</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">},</span><span class="s2">string</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isBool</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;true&quot;</span><span class="s0">:</span><span class="s3">&quot;false&quot;</span><span class="s0">}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">truthy</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">falsy</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;boolean.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a boolean&quot;</span><span class="s0">}})},</span><span class="s4">7500</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">),</span><span class="s2">o</span><span class="s0">={</span><span class="s2">isDate</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">}};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;date&quot;</span><span class="s0">,</span><span class="s2">coerce</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:[</span><span class="s3">&quot;number&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">],</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">format</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">}}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">&amp;&amp;!</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">()))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">format</span><span class="s0">;</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;date.format&quot;</span><span class="s0">,{</span><span class="s2">format</span><span class="s0">:</span><span class="s2">a</span><span class="s0">})}:{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;date.base&quot;</span><span class="s0">)}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">compare</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;now&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">?</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">():</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">();</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;date.&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">date</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;date&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">normalize</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;now&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must have a valid date format&quot;</span><span class="s0">}]},</span><span class="s2">format</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;iso&quot;</span><span class="s0">,</span><span class="s3">&quot;javascript&quot;</span><span class="s0">,</span><span class="s3">&quot;unix&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Unknown date format&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;format&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">greater</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;greater&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">})}},</span><span class="s2">iso</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">format</span><span class="s0">(</span><span class="s3">&quot;iso&quot;</span><span class="s0">)}},</span><span class="s2">less</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;less&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">})}},</span><span class="s2">max</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;max&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">})}},</span><span class="s2">min</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;min&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">date</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">})}},</span><span class="s2">timestamp</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s3">&quot;javascript&quot;</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;javascript&quot;</span><span class="s0">,</span><span class="s3">&quot;unix&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">'&quot;type&quot; must be one of &quot;javascript, unix&quot;'</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">format</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}}},</span><span class="s2">cast</span><span class="s0">:{</span><span class="s2">number</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isDate</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">()},</span><span class="s2">string</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isDate</span><span class="s0">,</span><span class="s2">to</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;date.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid date&quot;</span><span class="s0">,</span><span class="s3">&quot;date.format&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} must be in {msg(&quot;date.format.&quot; + #format) || #format} format'</span><span class="s0">,</span><span class="s3">&quot;date.greater&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be greater than {{:#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;date.less&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be less than {{:#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;date.max&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be less than or equal to {{:#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;date.min&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be greater than or equal to {{:#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;date.format.iso&quot;</span><span class="s0">:</span><span class="s3">&quot;ISO 8601 date&quot;</span><span class="s0">,</span><span class="s3">&quot;date.format.javascript&quot;</span><span class="s0">:</span><span class="s3">&quot;timestamp or number of milliseconds&quot;</span><span class="s0">,</span><span class="s3">&quot;date.format.unix&quot;</span><span class="s0">:</span><span class="s3">&quot;timestamp or number of seconds&quot;</span><span class="s0">}}),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||!</span><span class="s2">isFinite</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)))</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s5">/^\s*$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;iso&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">isIsoDate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()):</span><span class="s1">null</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s5">/^[+-]?\d+(\.\d+)?$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;javascript&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s4">1</span><span class="s0">*</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;unix&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s4">1e3</span><span class="s0">*</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">}</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">date</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">())?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}},</span><span class="s4">390</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7824</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;function&quot;</span><span class="s0">,</span><span class="s2">properties</span><span class="s0">:{</span><span class="s1">typeof</span><span class="s0">:</span><span class="s3">&quot;function&quot;</span><span class="s0">},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">arity</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;n must be a positive integer&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;arity&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;function.arity&quot;</span><span class="s0">,{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">})}},</span><span class="s1">class</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;class&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s5">/^\s*class\s/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">())?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;function.class&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">minArity</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;n must be a strict positive integer&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;minArity&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;=</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;function.minArity&quot;</span><span class="s0">,{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">})}},</span><span class="s2">maxArity</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;n must be a positive integer&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;maxArity&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;=</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;function.maxArity&quot;</span><span class="s0">,{</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">})}}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;function.arity&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must have an arity of {{#n}}&quot;</span><span class="s0">,</span><span class="s3">&quot;function.class&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a class&quot;</span><span class="s0">,</span><span class="s3">&quot;function.maxArity&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must have an arity lesser or equal to {{#n}}&quot;</span><span class="s0">,</span><span class="s3">&quot;function.minArity&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must have an arity greater or equal to {{#n}}&quot;</span><span class="s0">}})},</span><span class="s4">7824</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">978</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3652</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6133</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3328</span><span class="s0">),</span><span class="s2">m</span><span class="s0">={</span><span class="s2">renameDefaults</span><span class="s0">:{</span><span class="s2">alias</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">multiple</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;_keys&quot;</span><span class="s0">,</span><span class="s2">properties</span><span class="s0">:{</span><span class="s1">typeof</span><span class="s0">:</span><span class="s3">&quot;object&quot;</span><span class="s0">},</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">unknown</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">dependencies</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">keys</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">mapped</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s3">&quot;schema&quot;</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s3">&quot;key&quot;</span><span class="s0">}}},</span><span class="s2">patterns</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">renames</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}},</span><span class="s2">args</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">||</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_property</span><span class="s0">(</span><span class="s3">&quot;typeof&quot;</span><span class="s0">)||</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object.base&quot;</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_property</span><span class="s0">(</span><span class="s3">&quot;typeof&quot;</span><span class="s0">)})};</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">&amp;&amp;!</span><span class="s2">m</span><span class="s0">.</span><span class="s2">rename</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">i</span><span class="s0">};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">i</span><span class="s0">};</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">o</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">};</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)}</span><span class="s1">else</span><span class="s3">&quot;strip&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">?</span><span class="s1">delete </span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">size</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_hasPatternMatch</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">unknown</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">)(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">rel</span><span class="s0">](</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">code</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">context</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">t</span><span class="s0">};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">and</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;and&quot;</span><span class="s0">),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;and&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">append</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return null</span><span class="s0">==</span><span class="s2">e</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">length</span><span class="s0">?</span><span class="s1">this</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">assert</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">h</span><span class="s0">.</span><span class="s2">isTemplate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Message must be a string&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;assert&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">subject</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}});</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">subject</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">absolute</span><span class="s0">(</span><span class="s2">a</span><span class="s0">):[];</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...a</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">],</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object.assert&quot;</span><span class="s0">,{</span><span class="s2">subject</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">l</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;subject&quot;</span><span class="s0">,</span><span class="s3">&quot;schema&quot;</span><span class="s0">,</span><span class="s3">&quot;message&quot;</span><span class="s0">],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">instance</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;constructor must be a function&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;instance&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">constructor</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;object.instance&quot;</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;constructor&quot;</span><span class="s0">,</span><span class="s3">&quot;name&quot;</span><span class="s0">]},</span><span class="s2">keys</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">n</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Object schema must be a valid object&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Object schema cannot be a joi schema&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">length</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">t</span><span class="s0">=&gt;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">))):</span><span class="s1">new </span><span class="s2">m</span><span class="s0">.</span><span class="s2">Keys</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">l</span><span class="s0">.</span><span class="s2">tryWithPath</span><span class="s0">((()=&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">])})),</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s1">new </span><span class="s2">m</span><span class="s0">.</span><span class="s2">Keys</span><span class="s0">;</span><span class="s1">else </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}},</span><span class="s2">length</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;=&quot;</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;object.&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must be a positive integer&quot;</span><span class="s0">}]},</span><span class="s2">max</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;max&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">})}},</span><span class="s2">min</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;min&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">})}},</span><span class="s2">nand</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;nand&quot;</span><span class="s0">),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;nand&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">or</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;or&quot;</span><span class="s0">),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;or&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">oxor</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;oxor&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">pattern</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">;</span><span class="s2">s</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})),</span><span class="s2">n</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid rule&quot;</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,[</span><span class="s3">&quot;fallthrough&quot;</span><span class="s0">,</span><span class="s3">&quot;matches&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;g&quot;</span><span class="s0">)&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;y&quot;</span><span class="s0">),</span><span class="s3">&quot;pattern should not use global or sticky mode&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">appendPath</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">||[];</span><span class="s1">const </span><span class="s2">i</span><span class="s0">={[</span><span class="s2">s</span><span class="s0">?</span><span class="s3">&quot;regex&quot;</span><span class="s0">:</span><span class="s3">&quot;schema&quot;</span><span class="s0">]:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">rule</span><span class="s0">:</span><span class="s2">t</span><span class="s0">};</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_compile</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">),</span><span class="s3">&quot;array&quot;</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">array</span><span class="s0">().</span><span class="s2">items</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;_hasPatternMatch&quot;</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,{</span><span class="s2">clone</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">fallthrough</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fallthrough</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">}},</span><span class="s2">ref</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;ref&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">isRef</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;object.refType&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">regex</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;regex&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;object.regex&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">rename</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">||</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">,</span><span class="s3">&quot;Rename missing the from argument&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">||</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">h</span><span class="s0">,</span><span class="s3">&quot;Invalid rename to argument&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Cannot rename key to same name:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,[</span><span class="s3">&quot;alias&quot;</span><span class="s0">,</span><span class="s3">&quot;ignoreUndefined&quot;</span><span class="s0">,</span><span class="s3">&quot;override&quot;</span><span class="s0">,</span><span class="s3">&quot;multiple&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">||[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">)</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Cannot rename the same key multiple times&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">h</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_mutateRegister</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">from</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">renameDefaults</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}),</span><span class="s2">a</span><span class="s0">}},</span><span class="s2">schema</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s3">&quot;any&quot;</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;schema&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||</span><span class="s3">&quot;any&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;object.schema&quot;</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}):</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">unknown</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;unknown&quot;</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">)}},</span><span class="s1">with</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;with&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}},</span><span class="s2">without</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;without&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}},</span><span class="s2">xor</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">verifyFlat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;xor&quot;</span><span class="s0">),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;xor&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}}},</span><span class="s2">overrides</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">deepDefault</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_parent</span><span class="s0">(</span><span class="s3">&quot;default&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">rebuild</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Sorter</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">)</span><span class="s2">l</span><span class="s0">.</span><span class="s2">tryWithPath</span><span class="s0">((()=&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">after</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$_rootReferences</span><span class="s0">(),</span><span class="s2">group</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">key</span><span class="s0">})),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s1">new </span><span class="s2">m</span><span class="s0">.</span><span class="s2">Keys</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">)}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">rel</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">peers</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}</span><span class="s2">of t</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">rule</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">fallthrough</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">matches</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}</span><span class="s2">of t</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pattern</span><span class="s0">(</span><span class="s2">r</span><span class="s0">||</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,{</span><span class="s2">fallthrough</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">matches</span><span class="s0">:</span><span class="s2">i</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}</span><span class="s2">of t</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">rename</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;object.and&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains {{#presentWithLabels}} without its required peers {{#missingWithLabels}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.assert&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} is invalid because {if(#subject.key, `&quot;` + #subject.key + `&quot; failed to ` + (#message || &quot;pass the assertion test&quot;), #message || &quot;the assertion failed&quot;)}'</span><span class="s0">,</span><span class="s3">&quot;object.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be of type {{#type}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.instance&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be an instance of {{:#type}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.length&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} must have {{#limit}} key{if(#limit == 1, &quot;&quot;, &quot;s&quot;)}'</span><span class="s0">,</span><span class="s3">&quot;object.max&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} must have less than or equal to {{#limit}} key{if(#limit == 1, &quot;&quot;, &quot;s&quot;)}'</span><span class="s0">,</span><span class="s3">&quot;object.min&quot;</span><span class="s0">:</span><span class="s3">'{{#label}} must have at least {{#limit}} key{if(#limit == 1, &quot;&quot;, &quot;s&quot;)}'</span><span class="s0">,</span><span class="s3">&quot;object.missing&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain at least one of {{#peersWithLabels}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.nand&quot;</span><span class="s0">:</span><span class="s3">&quot;{{:#mainWithLabel}} must not exist simultaneously with {{#peersWithLabels}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.oxor&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains a conflict between optional exclusive peers {{#peersWithLabels}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.pattern.match&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} keys failed to match pattern requirements&quot;</span><span class="s0">,</span><span class="s3">&quot;object.refType&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a Joi reference&quot;</span><span class="s0">,</span><span class="s3">&quot;object.regex&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a RegExp object&quot;</span><span class="s0">,</span><span class="s3">&quot;object.rename.multiple&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} cannot rename {{:#from}} because multiple renames are disabled and another key was already renamed to {{:#to}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.rename.override&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} cannot rename {{:#from}} because override is disabled and target {{:#to}} exists&quot;</span><span class="s0">,</span><span class="s3">&quot;object.schema&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a Joi schema of {{#type}} type&quot;</span><span class="s0">,</span><span class="s3">&quot;object.unknown&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} is not allowed&quot;</span><span class="s0">,</span><span class="s3">&quot;object.with&quot;</span><span class="s0">:</span><span class="s3">&quot;{{:#mainWithLabel}} missing required peer {{:#peerWithLabel}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.without&quot;</span><span class="s0">:</span><span class="s3">&quot;{{:#mainWithLabel}} conflict with forbidden peer {{:#peerWithLabel}}&quot;</span><span class="s0">,</span><span class="s3">&quot;object.xor&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} contains a conflict between exclusive peers {{#peersWithLabels}}&quot;</span><span class="s0">}}),</span><span class="s2">m</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">nonEnumerables</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">shallow</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">}</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)};</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">=</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;name&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">writable</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;length&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">writable</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependency</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;key must be a strings&quot;</span><span class="s0">),</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">():{}),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,[</span><span class="s3">&quot;separator&quot;</span><span class="s0">,</span><span class="s3">&quot;isPresent&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">default</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">,</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of s</span><span class="s0">)</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;peers must be strings&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">separator</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">prefix</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}));</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">separator</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">ancestor</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">prefix</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}));</span><span class="s1">const </span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">||[],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s1">new </span><span class="s2">m</span><span class="s0">.</span><span class="s2">Dependency</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">dependencies</span><span class="s0">={</span><span class="s2">and</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=[],</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">):</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.and&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">present</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">presentWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">missing</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">missingWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}}},</span><span class="s2">nand</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.nand&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">main</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">mainWithLabel</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">peers</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">peersWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)}}},</span><span class="s2">or</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.missing&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">peers</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">,</span><span class="s2">peersWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">)}}},</span><span class="s2">oxor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">={</span><span class="s2">peers</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">,</span><span class="s2">peersWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">)};</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">present</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">presentWithLabels</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.oxor&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}},</span><span class="s1">with</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.with&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">main</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">mainWithLabel</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">key</span><span class="s0">),</span><span class="s2">peer</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">peerWithLabel</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)}}},</span><span class="s2">without</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.without&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:{</span><span class="s2">main</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">mainWithLabel</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">key</span><span class="s0">),</span><span class="s2">peer</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">peerWithLabel</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)}}},</span><span class="s2">xor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">options</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">)</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">shadow</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}))&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">={</span><span class="s2">peers</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">,</span><span class="s2">peersWithLabels</span><span class="s0">:</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">)};</span><span class="s1">return </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.missing&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}:(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">present</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">presentWithLabels</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),{</span><span class="s2">code</span><span class="s0">:</span><span class="s3">&quot;object.xor&quot;</span><span class="s0">,</span><span class="s2">context</span><span class="s0">:</span><span class="s2">o</span><span class="s0">})}},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">keysToLabels</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">t</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_mapLabels</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_mapLabels</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">rename</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">renames</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=[],</span><span class="s2">l</span><span class="s0">=</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">.</span><span class="s2">from</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">ignoreUndefined</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">to</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">from</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">from</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">to</span><span class="s0">,</span><span class="s2">match</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})}</span><span class="s1">else</span><span class="s0">!</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">from</span><span class="s0">)||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">from</span><span class="s0">]&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">ignoreUndefined</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">c of o</span><span class="s0">){</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">from</span><span class="s0">;</span><span class="s1">let </span><span class="s2">u</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">to</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u </span><span class="s1">instanceof </span><span class="s2">h</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">render</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">match</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">multiple</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;object.rename.multiple&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">pattern</span><span class="s0">:</span><span class="s2">l</span><span class="s0">},</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)&amp;&amp;!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">override</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;object.rename.override&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">pattern</span><span class="s0">:</span><span class="s2">l</span><span class="s0">},</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]?</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">],</span><span class="s2">a</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">alias</span><span class="s0">||</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]}}}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">unknown</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">){</span><span class="s1">let </span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,[]})),</span><span class="s2">l</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">u</span><span class="s0">=[</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">i</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">){</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">[</span><span class="s2">f</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s3">`pattern.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">f</span><span class="s0">}</span><span class="s3">`</span><span class="s0">,</span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;pass&quot;</span><span class="s0">:</span><span class="s3">&quot;error&quot;</span><span class="s0">),!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(!</span><span class="s2">h</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s3">`pattern.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">f</span><span class="s0">}</span><span class="s3">`</span><span class="s0">),</span><span class="s2">a</span><span class="s0">))</span><span class="s1">continue</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">const </span><span class="s2">m</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">d</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">};</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...d</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,!</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fallthrough</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">[</span><span class="s2">r</span><span class="s0">].</span><span class="s2">matches</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">,{</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s2">r</span><span class="s0">.</span><span class="s2">matches</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;object.pattern.match&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">o</span><span class="s0">};</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">size</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">patterns</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">unknown</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skipFunctions</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=!(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">||!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">stripUnknown</span><span class="s0">.</span><span class="s2">objects</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">?(</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">r</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)):</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">.</span><span class="s2">default</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">unknown</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">allowUnknown</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">localize</span><span class="s0">([</span><span class="s2">...n</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">i</span><span class="s0">],[]),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;object.unknown&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],{</span><span class="s2">child</span><span class="s0">:</span><span class="s2">i</span><span class="s0">},</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,{</span><span class="s2">flags</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">o</span><span class="s0">};</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}}},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">Dependency</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rel</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">options</span><span class="s0">=</span><span class="s2">n</span><span class="s0">}</span><span class="s2">describe</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={</span><span class="s2">rel</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rel</span><span class="s0">,</span><span class="s2">peers</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">paths</span><span class="s0">};</span><span class="s1">return null</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">key</span><span class="s0">),</span><span class="s3">&quot;.&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">separator</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">={</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">,</span><span class="s2">separator</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">peers</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">separator</span><span class="s0">}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">={</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">options</span><span class="s0">,</span><span class="s2">isPresent</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">isPresent</span><span class="s0">}),</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">m</span><span class="s0">.</span><span class="s2">Keys</span><span class="s0">=</span><span class="s1">class extends </span><span class="s2">Array</span><span class="s0">{</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">key</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]={</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">)}:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}}},</span><span class="s4">8785</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3292</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">l</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;link&quot;</span><span class="s0">,</span><span class="s2">properties</span><span class="s0">:{</span><span class="s2">schemaChain</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">link</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">manifest</span><span class="s0">:</span><span class="s3">&quot;single&quot;</span><span class="s0">,</span><span class="s2">register</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">args</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">,</span><span class="s3">&quot;Uninitialized link schema&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">ref</span><span class="s0">;</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">$_validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s3">`link:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">.</span><span class="s2">display</span><span class="s0">}</span><span class="s3">:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">}</span><span class="s3">`</span><span class="s0">),</span><span class="s2">a</span><span class="s0">)},</span><span class="s2">generate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)=&gt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">ref</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">,</span><span class="s3">&quot;Cannot reinitialize schema&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;value&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;local&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;Invalid reference type:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;local&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;Link cannot reference itself&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">=[{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}],</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">relative</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;relative&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}}},</span><span class="s2">overrides</span><span class="s0">:{</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">,</span><span class="s3">&quot;Uninitialized link schema&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isSchema</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid schema object&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;link&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;Cannot merge type link with another link&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">=[]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">concat</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_mutateRebuild</span><span class="s0">()}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">link</span><span class="s0">,</span><span class="s3">&quot;Invalid link description missing link&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">link</span><span class="s0">))}}),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">links</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">schema</span><span class="s0">;</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">link</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">ref</span><span class="s0">,{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">perspective</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;which is outside of schema boundaries&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">try</span><span class="s0">{</span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">$_reach</span><span class="s0">(</span><span class="s2">o</span><span class="s0">):</span><span class="s2">i</span><span class="s0">}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;to non-existing schema&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">(</span><span class="s3">&quot;link&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s3">&quot;which is another link&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">relative</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">links</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">schema</span><span class="s0">},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">perspective</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;local&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}</span><span class="s2">of t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">){</span><span class="s1">if</span><span class="s0">((</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">id</span><span class="s0">||</span><span class="s2">s</span><span class="s0">)===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">return</span><span class="s0">{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">shared</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">id</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">return</span><span class="s0">{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)}}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}}</span><span class="s1">return</span><span class="s3">&quot;root&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">?{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">].</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">}:{</span><span class="s2">perspective</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">]&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemas</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ancestor</span><span class="s0">].</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">path</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">path</span><span class="s0">}},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s2">e</span><span class="s0">||</span><span class="s2">s</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">`&quot;</span><span class="s2">$</span><span class="s0">{</span><span class="s2">o</span><span class="s0">.</span><span class="s2">label</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}</span><span class="s3">&quot; contains link reference &quot;</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">.</span><span class="s2">display</span><span class="s0">}</span><span class="s3">&quot; </span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">}</span><span class="s3">`</span><span class="s0">)}},</span><span class="s4">3832</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">numberRx</span><span class="s0">:</span><span class="s5">/^\s*[+-]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e([+-]?\d+))?\s*$/i</span><span class="s0">,</span><span class="s2">precisionRx</span><span class="s0">:</span><span class="s5">/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/</span><span class="s0">,</span><span class="s2">exponentialPartRegex</span><span class="s0">:</span><span class="s5">/[eE][+-]?\d+$/</span><span class="s0">,</span><span class="s2">leadingSignAndZerosRegex</span><span class="s0">:</span><span class="s5">/^[+-]?(0*)?/</span><span class="s0">,</span><span class="s2">dotRegex</span><span class="s0">:</span><span class="s5">/\./</span><span class="s0">,</span><span class="s2">trailingZerosRegex</span><span class="s0">:</span><span class="s5">/0+$/</span><span class="s0">};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;number&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">unsafe</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">coerce</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">numberRx</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">();</span><span class="s1">const </span><span class="s2">n</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s4">0</span><span class="s0">),!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">unsafe</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s5">/e/i</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">extractSignificantDigits</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">extractSignificantDigits</span><span class="s0">(</span><span class="s2">String</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;number.unsafe&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s5">/e/i</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">normalizeDecimal</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;number.unsafe&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s4">1</span><span class="s0">/</span><span class="s4">0</span><span class="s0">||</span><span class="s2">e</span><span class="s0">===-</span><span class="s4">1</span><span class="s0">/</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;number.infinity&quot;</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;number.base&quot;</span><span class="s0">)};</span><span class="s1">const </span><span class="s2">i</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;precision&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s4">10</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">round</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">*</span><span class="s2">t</span><span class="s0">)/</span><span class="s2">t</span><span class="s0">}}</span><span class="s1">return </span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s4">0</span><span class="s0">),!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">unsafe</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">MAX_SAFE_INTEGER</span><span class="s0">||</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">MIN_SAFE_INTEGER</span><span class="s0">)&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;number.unsafe&quot;</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">compare</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;number.&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isNumber</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must be a number&quot;</span><span class="s0">}]},</span><span class="s2">greater</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;greater&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">})}},</span><span class="s2">integer</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;integer&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">trunc</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)-</span><span class="s2">e</span><span class="s0">==</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;number.integer&quot;</span><span class="s0">)},</span><span class="s2">less</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;less&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">})}},</span><span class="s2">max</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;max&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">})}},</span><span class="s2">min</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;min&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;compare&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">})}},</span><span class="s2">multiple</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;multiple&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">base</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">base</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">*(</span><span class="s4">1</span><span class="s0">/</span><span class="s2">n</span><span class="s0">)%</span><span class="s4">1</span><span class="s0">==</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;number.multiple&quot;</span><span class="s0">,{</span><span class="s2">multiple</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">base</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;base&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">isFinite</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must be a positive number&quot;</span><span class="s0">}],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">negative</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s3">&quot;negative&quot;</span><span class="s0">)}},</span><span class="s2">port</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;port&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">65535</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;number.port&quot;</span><span class="s0">)},</span><span class="s2">positive</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s3">&quot;positive&quot;</span><span class="s0">)}},</span><span class="s2">precision</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;limit must be an integer&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;precision&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">().</span><span class="s2">match</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">precisionRx</span><span class="s0">);</span><span class="s1">return </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">((</span><span class="s2">n</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">n</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">length</span><span class="s0">:</span><span class="s4">0</span><span class="s0">)-(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s4">10</span><span class="s0">):</span><span class="s4">0</span><span class="s0">),</span><span class="s4">0</span><span class="s0">)&lt;=</span><span class="s2">s</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;number.precision&quot;</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">sign</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;negative&quot;</span><span class="s0">,</span><span class="s3">&quot;positive&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid sign&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;sign&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">sign</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">sign</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return</span><span class="s3">&quot;negative&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">||</span><span class="s3">&quot;positive&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">`number.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">}</span><span class="s3">`</span><span class="s0">)}},</span><span class="s2">unsafe</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;enabled must be a boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;unsafe&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}}},</span><span class="s2">cast</span><span class="s0">:{</span><span class="s2">string</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;number.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a number&quot;</span><span class="s0">,</span><span class="s3">&quot;number.greater&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be greater than {{#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;number.infinity&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} cannot be infinity&quot;</span><span class="s0">,</span><span class="s3">&quot;number.integer&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be an integer&quot;</span><span class="s0">,</span><span class="s3">&quot;number.less&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be less than {{#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;number.max&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be less than or equal to {{#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;number.min&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be greater than or equal to {{#limit}}&quot;</span><span class="s0">,</span><span class="s3">&quot;number.multiple&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a multiple of {{#multiple}}&quot;</span><span class="s0">,</span><span class="s3">&quot;number.negative&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a negative number&quot;</span><span class="s0">,</span><span class="s3">&quot;number.port&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid port&quot;</span><span class="s0">,</span><span class="s3">&quot;number.positive&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a positive number&quot;</span><span class="s0">,</span><span class="s3">&quot;number.precision&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must have no more than {{#limit}} decimal places&quot;</span><span class="s0">,</span><span class="s3">&quot;number.unsafe&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a safe number&quot;</span><span class="s0">}}),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">extractSignificantDigits</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">exponentialPartRegex</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">dotRegex</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">trailingZerosRegex</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">leadingSignAndZerosRegex</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">normalizeDecimal</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^\+/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\.0*$/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^(-?)\.([^\.]*)$/</span><span class="s0">,</span><span class="s3">&quot;$10.$2&quot;</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^(-?)0+([0-9])/</span><span class="s0">,</span><span class="s3">&quot;$1$2&quot;</span><span class="s0">)).</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">endsWith</span><span class="s0">(</span><span class="s3">&quot;0&quot;</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/0+$/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)),</span><span class="s3">&quot;-0&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;0&quot;</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}},</span><span class="s4">8966</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7824</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;object&quot;</span><span class="s0">,</span><span class="s2">cast</span><span class="s0">:{</span><span class="s2">map</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s2">to</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))}}})},</span><span class="s4">7417</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5380</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1745</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9959</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6064</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9926</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5752</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">h</span><span class="s0">={</span><span class="s2">tlds</span><span class="s0">:</span><span class="s2">l </span><span class="s1">instanceof </span><span class="s2">Set</span><span class="s0">&amp;&amp;{</span><span class="s2">tlds</span><span class="s0">:{</span><span class="s2">allow</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">deny</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}},</span><span class="s2">base64Regex</span><span class="s0">:{</span><span class="s1">true</span><span class="s0">:{</span><span class="s1">true</span><span class="s0">:</span><span class="s5">/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}==|[\w\-]{3}=)?$/</span><span class="s0">,</span><span class="s1">false</span><span class="s0">:</span><span class="s5">/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/</span><span class="s0">},</span><span class="s1">false</span><span class="s0">:{</span><span class="s1">true</span><span class="s0">:</span><span class="s5">/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}(==)?|[\w\-]{3}=?)?$/</span><span class="s0">,</span><span class="s1">false</span><span class="s0">:</span><span class="s5">/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/</span><span class="s0">}},</span><span class="s2">dataUriRegex</span><span class="s0">:</span><span class="s5">/^data:[\w+.-]+\/[\w+.-]+;((charset=[\w-]+|base64),)?(.*)$/</span><span class="s0">,</span><span class="s2">hexRegex</span><span class="s0">:</span><span class="s5">/^[a-f0-9]+$/i</span><span class="s0">,</span><span class="s2">ipRegex</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">({</span><span class="s2">cidr</span><span class="s0">:</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">}).</span><span class="s2">regex</span><span class="s0">,</span><span class="s2">isoDurationRegex</span><span class="s0">:</span><span class="s5">/^P(?!$)(\d+Y)?(\d+M)?(\d+W)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?$/</span><span class="s0">,</span><span class="s2">guidBrackets</span><span class="s0">:{</span><span class="s3">&quot;{&quot;</span><span class="s0">:</span><span class="s3">&quot;}&quot;</span><span class="s0">,</span><span class="s3">&quot;[&quot;</span><span class="s0">:</span><span class="s3">&quot;]&quot;</span><span class="s0">,</span><span class="s3">&quot;(&quot;</span><span class="s0">:</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">},</span><span class="s2">guidVersions</span><span class="s0">:{</span><span class="s2">uuidv1</span><span class="s0">:</span><span class="s3">&quot;1&quot;</span><span class="s0">,</span><span class="s2">uuidv2</span><span class="s0">:</span><span class="s3">&quot;2&quot;</span><span class="s0">,</span><span class="s2">uuidv3</span><span class="s0">:</span><span class="s3">&quot;3&quot;</span><span class="s0">,</span><span class="s2">uuidv4</span><span class="s0">:</span><span class="s3">&quot;4&quot;</span><span class="s0">,</span><span class="s2">uuidv5</span><span class="s0">:</span><span class="s3">&quot;5&quot;</span><span class="s0">,</span><span class="s2">uuidv6</span><span class="s0">:</span><span class="s3">&quot;6&quot;</span><span class="s0">,</span><span class="s2">uuidv7</span><span class="s0">:</span><span class="s3">&quot;7&quot;</span><span class="s0">,</span><span class="s2">uuidv8</span><span class="s0">:</span><span class="s3">&quot;8&quot;</span><span class="s0">},</span><span class="s2">guidSeparators</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">([</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;-&quot;</span><span class="s0">,</span><span class="s3">&quot;:&quot;</span><span class="s0">]),</span><span class="s2">normalizationForms</span><span class="s0">:[</span><span class="s3">&quot;NFC&quot;</span><span class="s0">,</span><span class="s3">&quot;NFD&quot;</span><span class="s0">,</span><span class="s3">&quot;NFKC&quot;</span><span class="s0">,</span><span class="s3">&quot;NFKD&quot;</span><span class="s0">]};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s2">flags</span><span class="s0">:{</span><span class="s2">insensitive</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">truncate</span><span class="s0">:{</span><span class="s1">default</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}},</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">replacements</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}},</span><span class="s2">coerce</span><span class="s0">:{</span><span class="s2">from</span><span class="s0">:</span><span class="s3">&quot;string&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;normalize&quot;</span><span class="s0">);</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">form</span><span class="s0">));</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;case&quot;</span><span class="s0">);</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;upper&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">direction</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLocaleUpperCase</span><span class="s0">():</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLocaleLowerCase</span><span class="s0">());</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;trim&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">enabled</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pattern</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">replacement</span><span class="s0">);</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;hex&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">byteAligned</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">%</span><span class="s4">2</span><span class="s0">!=</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s3">`0</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;isoDate&quot;</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">isoDate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;max&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),!</span><span class="s2">f</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.ref&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,{</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">arg</span><span class="s0">:</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s2">reason</span><span class="s0">:</span><span class="s3">&quot;must be a positive integer&quot;</span><span class="s0">},</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)};</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string.base&quot;</span><span class="s0">)};</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;min&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string.empty&quot;</span><span class="s0">)}}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">alphanum</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;alphanum&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s5">/^[a-zA-Z0-9]+$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.alphanum&quot;</span><span class="s0">)},</span><span class="s2">base64</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;paddingRequired&quot;</span><span class="s0">,</span><span class="s3">&quot;urlSafe&quot;</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">urlSafe</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">paddingRequired</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">},</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">paddingRequired</span><span class="s0">,</span><span class="s3">&quot;paddingRequired must be boolean&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">urlSafe</span><span class="s0">,</span><span class="s3">&quot;urlSafe must be boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;base64&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">base64Regex</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">paddingRequired</span><span class="s0">][</span><span class="s2">s</span><span class="s0">.</span><span class="s2">urlSafe</span><span class="s0">].</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.base64&quot;</span><span class="s0">)}},</span><span class="s1">case</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;lower&quot;</span><span class="s0">,</span><span class="s3">&quot;upper&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Invalid case:&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;case&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">direction</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">direction</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return</span><span class="s3">&quot;lower&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLocaleLowerCase</span><span class="s0">()||</span><span class="s3">&quot;upper&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLocaleUpperCase</span><span class="s0">()?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">`string.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">}</span><span class="s3">case`</span><span class="s0">)},</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">creditCard</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;creditCard&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">r</span><span class="s0">--;){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)*</span><span class="s2">n</span><span class="s0">;</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">-</span><span class="s4">9</span><span class="s0">*(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">9</span><span class="s0">),</span><span class="s2">n</span><span class="s0">^=</span><span class="s4">3</span><span class="s0">}</span><span class="s1">return </span><span class="s2">s</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">%</span><span class="s4">10</span><span class="s0">==</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.creditCard&quot;</span><span class="s0">)}},</span><span class="s2">dataUri</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;paddingRequired&quot;</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">paddingRequired</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">},</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">paddingRequired</span><span class="s0">,</span><span class="s3">&quot;paddingRequired must be boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;dataUri&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">dataUriRegex</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">])</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;base64&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">])</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">base64Regex</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">paddingRequired</span><span class="s0">].</span><span class="s2">false</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.dataUri&quot;</span><span class="s0">)}},</span><span class="s2">domain</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;allowFullyQualified&quot;</span><span class="s0">,</span><span class="s3">&quot;allowUnicode&quot;</span><span class="s0">,</span><span class="s3">&quot;maxDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;minDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;tlds&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">addressOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;domain&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">address</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">address</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.domain&quot;</span><span class="s0">)}},</span><span class="s2">email</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;allowFullyQualified&quot;</span><span class="s0">,</span><span class="s3">&quot;allowUnicode&quot;</span><span class="s0">,</span><span class="s3">&quot;ignoreLength&quot;</span><span class="s0">,</span><span class="s3">&quot;maxDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;minDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;multiple&quot;</span><span class="s0">,</span><span class="s3">&quot;separator&quot;</span><span class="s0">,</span><span class="s3">&quot;tlds&quot;</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiple</span><span class="s0">||</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiple</span><span class="s0">,</span><span class="s3">&quot;multiple option must be an boolean&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">addressOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">`</span><span class="s1">\\</span><span class="s3">s*[</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">?</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">):</span><span class="s3">&quot;,&quot;</span><span class="s0">}</span><span class="s3">]</span><span class="s1">\\</span><span class="s3">s*`</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;email&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">address</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">address</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">multiple</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">i</span><span class="s0">):[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of l</span><span class="s0">)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)||</span><span class="s2">c</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.email&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">invalids</span><span class="s0">:</span><span class="s2">c</span><span class="s0">}):</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">guid</span><span class="s0">:{</span><span class="s2">alias</span><span class="s0">:</span><span class="s3">&quot;uuid&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;version&quot;</span><span class="s0">,</span><span class="s3">&quot;separator&quot;</span><span class="s0">]);</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;=</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;version must have at least 1 valid version specified&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;version at position &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot; must be a string&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">guidVersions</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">()];</span><span class="s2">s</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;version at position &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot; must be one of &quot;</span><span class="s0">+</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">guidVersions</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s3">&quot;version at position &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot; must not be a duplicate&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}}</span><span class="s2">s</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">guidSeparators</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">),</span><span class="s3">'separator must be one of true, false, &quot;-&quot;, or &quot;:&quot;'</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">?</span><span class="s3">&quot;[:-]?&quot;</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">?</span><span class="s3">&quot;[:-]&quot;</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">?</span><span class="s3">&quot;[]?&quot;</span><span class="s0">:</span><span class="s3">`</span><span class="s1">\\</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">}</span><span class="s3">`</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">`^([</span><span class="s1">\\</span><span class="s3">[{</span><span class="s1">\\</span><span class="s3">(]?)[0-9A-F]{8}(</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">}</span><span class="s3">)[0-9A-F]{4}</span><span class="s1">\\</span><span class="s3">2?[</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;0-9A-F&quot;</span><span class="s0">}</span><span class="s3">][0-9A-F]{3}</span><span class="s1">\\</span><span class="s3">2?[</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;89AB&quot;</span><span class="s0">:</span><span class="s3">&quot;0-9A-F&quot;</span><span class="s0">}</span><span class="s3">][0-9A-F]{3}</span><span class="s1">\\</span><span class="s3">2?[0-9A-F]{12}([</span><span class="s1">\\</span><span class="s3">]}</span><span class="s1">\\</span><span class="s3">)]?)$`</span><span class="s0">,</span><span class="s3">&quot;i&quot;</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;guid&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">?</span><span class="s2">h</span><span class="s0">.</span><span class="s2">guidBrackets</span><span class="s0">[</span><span class="s2">a</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]]!==</span><span class="s2">a</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.guid&quot;</span><span class="s0">):</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.guid&quot;</span><span class="s0">)}},</span><span class="s2">hex</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;byteAligned&quot;</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">byteAligned</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">},</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteAligned</span><span class="s0">,</span><span class="s3">&quot;byteAligned must be boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;hex&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">hexRegex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">byteAligned</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">%</span><span class="s4">2</span><span class="s0">!=</span><span class="s4">0</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.hexAlign&quot;</span><span class="s0">):</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.hex&quot;</span><span class="s0">)}},</span><span class="s2">hostname</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;hostname&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">minDomainSegments</span><span class="s0">:</span><span class="s4">1</span><span class="s0">})||</span><span class="s2">h</span><span class="s0">.</span><span class="s2">ipRegex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.hostname&quot;</span><span class="s0">)},</span><span class="s2">insensitive</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;insensitive&quot;</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)}},</span><span class="s2">ip</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;cidr&quot;</span><span class="s0">,</span><span class="s3">&quot;version&quot;</span><span class="s0">]);</span><span class="s1">const</span><span class="s0">{</span><span class="s2">cidr</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">versions</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">?</span><span class="s2">r</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ip&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:{</span><span class="s2">cidr</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}},</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">s</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.ipVersion&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">cidr</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">}):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.ip&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">cidr</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">})}},</span><span class="s2">isoDate</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;isoDate&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">isoDate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s3">&quot;string.isoDate&quot;</span><span class="s0">)}},</span><span class="s2">isoDuration</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;isoDuration&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">isoDurationRegex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.isoDuration&quot;</span><span class="s0">)},</span><span class="s2">length</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;=&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=!</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">compare</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s2">a</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">assert</span><span class="s0">:</span><span class="s2">f</span><span class="s0">.</span><span class="s2">limit</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;must be a positive integer&quot;</span><span class="s0">},</span><span class="s3">&quot;encoding&quot;</span><span class="s0">]},</span><span class="s2">lowercase</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">case</span><span class="s0">(</span><span class="s3">&quot;lower&quot;</span><span class="s0">)}},</span><span class="s2">max</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;max&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s3">&quot;encoding&quot;</span><span class="s0">]},</span><span class="s2">min</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s3">&quot;min&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;limit&quot;</span><span class="s0">,</span><span class="s3">&quot;encoding&quot;</span><span class="s0">]},</span><span class="s2">normalize</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s3">&quot;NFC&quot;</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">normalizationForms</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;normalization form must be one of &quot;</span><span class="s0">+</span><span class="s2">h</span><span class="s0">.</span><span class="s2">normalizationForms</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;, &quot;</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;normalize&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">form</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">form</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string.normalize&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">form</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})},</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">pattern</span><span class="s0">:{</span><span class="s2">alias</span><span class="s0">:</span><span class="s3">&quot;regex&quot;</span><span class="s0">,</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">,</span><span class="s3">&quot;regex must be a RegExp&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;g&quot;</span><span class="s0">)&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;y&quot;</span><span class="s0">),</span><span class="s3">&quot;regex should not use global or sticky mode&quot;</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,[</span><span class="s3">&quot;invert&quot;</span><span class="s0">,</span><span class="s3">&quot;name&quot;</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[</span><span class="s3">&quot;string.pattern&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">invert</span><span class="s0">?</span><span class="s3">&quot;.invert&quot;</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">?</span><span class="s3">&quot;.name&quot;</span><span class="s0">:</span><span class="s3">&quot;.base&quot;</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;pattern&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">t</span><span class="s0">},</span><span class="s2">errorCode</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">errorCode</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)^</span><span class="s2">a</span><span class="s0">.</span><span class="s2">invert</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})},</span><span class="s2">args</span><span class="s0">:[</span><span class="s3">&quot;regex&quot;</span><span class="s0">,</span><span class="s3">&quot;options&quot;</span><span class="s0">],</span><span class="s2">multi</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">replace</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;g&quot;</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">,</span><span class="s3">&quot;pattern must be a RegExp&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;replacement must be a String&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">||(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">=[]),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">pattern</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">replacement</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}),</span><span class="s2">r</span><span class="s0">}},</span><span class="s2">token</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">(</span><span class="s3">&quot;token&quot;</span><span class="s0">)},</span><span class="s2">validate</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s5">/^\w+$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.token&quot;</span><span class="s0">)},</span><span class="s2">trim</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;enabled must be a boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;trim&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">enabled</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">enabled</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">()?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.trim&quot;</span><span class="s0">):</span><span class="s2">e</span><span class="s0">},</span><span class="s2">convert</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">truncate</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=!(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])||</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;enabled must be a boolean&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">$_setFlag</span><span class="s0">(</span><span class="s3">&quot;truncate&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">uppercase</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">case</span><span class="s0">(</span><span class="s3">&quot;upper&quot;</span><span class="s0">)}},</span><span class="s2">uri</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s3">&quot;allowRelative&quot;</span><span class="s0">,</span><span class="s3">&quot;allowQuerySquareBrackets&quot;</span><span class="s0">,</span><span class="s3">&quot;domain&quot;</span><span class="s0">,</span><span class="s3">&quot;relativeOnly&quot;</span><span class="s0">,</span><span class="s3">&quot;scheme&quot;</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">&amp;&amp;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">assertOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">,[</span><span class="s3">&quot;allowFullyQualified&quot;</span><span class="s0">,</span><span class="s3">&quot;allowUnicode&quot;</span><span class="s0">,</span><span class="s3">&quot;maxDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;minDomainSegments&quot;</span><span class="s0">,</span><span class="s3">&quot;tlds&quot;</span><span class="s0">]);</span><span class="s1">const</span><span class="s0">{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">scheme</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">?</span><span class="s2">h</span><span class="s0">.</span><span class="s2">addressOptions</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">):</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;uri&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">domain</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">scheme</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">options</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">domain</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">scheme</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">([</span><span class="s3">&quot;http:/&quot;</span><span class="s0">,</span><span class="s3">&quot;https:/&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.uri&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]||</span><span class="s2">c</span><span class="s0">[</span><span class="s4">2</span><span class="s0">];</span><span class="s1">return</span><span class="s0">!</span><span class="s2">o</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">allowRelative</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.domain&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">relativeOnly</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.uriRelativeOnly&quot;</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.uriCustomScheme&quot;</span><span class="s0">,{</span><span class="s2">scheme</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s3">&quot;string.uri&quot;</span><span class="s0">)}}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">pattern</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">replacement</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}</span><span class="s2">of t</span><span class="s0">.</span><span class="s2">replacements</span><span class="s0">)</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;string.alphanum&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must only contain alpha-numeric characters&quot;</span><span class="s0">,</span><span class="s3">&quot;string.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a string&quot;</span><span class="s0">,</span><span class="s3">&quot;string.base64&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid base64 string&quot;</span><span class="s0">,</span><span class="s3">&quot;string.creditCard&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a credit card&quot;</span><span class="s0">,</span><span class="s3">&quot;string.dataUri&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid dataUri string&quot;</span><span class="s0">,</span><span class="s3">&quot;string.domain&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must contain a valid domain name&quot;</span><span class="s0">,</span><span class="s3">&quot;string.email&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid email&quot;</span><span class="s0">,</span><span class="s3">&quot;string.empty&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} is not allowed to be empty&quot;</span><span class="s0">,</span><span class="s3">&quot;string.guid&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid GUID&quot;</span><span class="s0">,</span><span class="s3">&quot;string.hex&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must only contain hexadecimal characters&quot;</span><span class="s0">,</span><span class="s3">&quot;string.hexAlign&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} hex decoded representation must be byte aligned&quot;</span><span class="s0">,</span><span class="s3">&quot;string.hostname&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid hostname&quot;</span><span class="s0">,</span><span class="s3">&quot;string.ip&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid ip address with a {{#cidr}} CIDR&quot;</span><span class="s0">,</span><span class="s3">&quot;string.ipVersion&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid ip address of one of the following versions {{#version}} with a {{#cidr}} CIDR&quot;</span><span class="s0">,</span><span class="s3">&quot;string.isoDate&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be in iso format&quot;</span><span class="s0">,</span><span class="s3">&quot;string.isoDuration&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid ISO 8601 duration&quot;</span><span class="s0">,</span><span class="s3">&quot;string.length&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} length must be {{#limit}} characters long&quot;</span><span class="s0">,</span><span class="s3">&quot;string.lowercase&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must only contain lowercase characters&quot;</span><span class="s0">,</span><span class="s3">&quot;string.max&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} length must be less than or equal to {{#limit}} characters long&quot;</span><span class="s0">,</span><span class="s3">&quot;string.min&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} length must be at least {{#limit}} characters long&quot;</span><span class="s0">,</span><span class="s3">&quot;string.normalize&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be unicode normalized in the {{#form}} form&quot;</span><span class="s0">,</span><span class="s3">&quot;string.token&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must only contain alpha-numeric and underscore characters&quot;</span><span class="s0">,</span><span class="s3">&quot;string.pattern.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} with value {:[.]} fails to match the required pattern: {{#regex}}&quot;</span><span class="s0">,</span><span class="s3">&quot;string.pattern.name&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} with value {:[.]} fails to match the {{#name}} pattern&quot;</span><span class="s0">,</span><span class="s3">&quot;string.pattern.invert.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} with value {:[.]} matches the inverted pattern: {{#regex}}&quot;</span><span class="s0">,</span><span class="s3">&quot;string.pattern.invert.name&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} with value {:[.]} matches the inverted {{#name}} pattern&quot;</span><span class="s0">,</span><span class="s3">&quot;string.trim&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must not have leading or trailing whitespace&quot;</span><span class="s0">,</span><span class="s3">&quot;string.uri&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid uri&quot;</span><span class="s0">,</span><span class="s3">&quot;string.uriCustomScheme&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid uri with a scheme matching the {{#scheme}} pattern&quot;</span><span class="s0">,</span><span class="s3">&quot;string.uriRelativeOnly&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a valid relative uri&quot;</span><span class="s0">,</span><span class="s3">&quot;string.uppercase&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must only contain uppercase characters&quot;</span><span class="s0">}}),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">addressOptions</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">minDomainSegments</span><span class="s0">||</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">minDomainSegments</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">minDomainSegments</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;minDomainSegments must be a positive integer&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">maxDomainSegments</span><span class="s0">||</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isSafeInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">maxDomainSegments</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">maxDomainSegments</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;maxDomainSegments must be a positive integer&quot;</span><span class="s0">),!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">,</span><span class="s3">&quot;Built-in TLD list disabled&quot;</span><span class="s0">),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">,</span><span class="s3">&quot;tlds must be true, false, or an object&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">deny</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">tlds</span><span class="s0">:{</span><span class="s2">deny</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}})),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">deny </span><span class="s1">instanceof </span><span class="s2">Set</span><span class="s0">,</span><span class="s3">&quot;tlds.deny must be an array, Set, or boolean&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">,</span><span class="s3">&quot;Cannot specify both tlds.allow and tlds.deny lists&quot;</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">validateTlds</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">deny</span><span class="s0">,</span><span class="s3">&quot;tlds.deny&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">;</span><span class="s1">return </span><span class="s2">r</span><span class="s0">?!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">,</span><span class="s3">&quot;Built-in TLD list disabled&quot;</span><span class="s0">),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">)):(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">tlds</span><span class="s0">:{</span><span class="s2">allow</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}})),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">allow </span><span class="s1">instanceof </span><span class="s2">Set</span><span class="s0">,</span><span class="s3">&quot;tlds.allow must be an array, Set, or boolean&quot;</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">validateTlds</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">,</span><span class="s3">&quot;tlds.allow&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">):</span><span class="s2">e</span><span class="s0">},</span><span class="s2">h</span><span class="s0">.</span><span class="s2">validateTlds</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">minDomainSegments</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">maxDomainSegments</span><span class="s0">:</span><span class="s4">1</span><span class="s0">}),</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">t</span><span class="s0">} </span><span class="s3">must contain valid top level domain names`</span><span class="s0">)},</span><span class="s2">h</span><span class="s0">.</span><span class="s2">isoDate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">f</span><span class="s0">.</span><span class="s2">isIsoDate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return null</span><span class="s0">;</span><span class="s5">/.*T.*[+-]\d\d$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s3">&quot;00&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">())?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toISOString</span><span class="s0">()},</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">||!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;Invalid encoding:&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_addRule</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">method</span><span class="s0">:</span><span class="s3">&quot;length&quot;</span><span class="s0">,</span><span class="s2">args</span><span class="s0">:{</span><span class="s2">limit</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">operator</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})}},</span><span class="s4">8826</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8068</span><span class="s0">),</span><span class="s2">a</span><span class="s0">={};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">Map</span><span class="s0">=</span><span class="s1">class extends </span><span class="s2">Map</span><span class="s0">{</span><span class="s2">slice</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">Map</span><span class="s0">(</span><span class="s1">this</span><span class="s0">)}},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extend</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;symbol&quot;</span><span class="s0">,</span><span class="s2">terms</span><span class="s0">:{</span><span class="s2">map</span><span class="s0">:{</span><span class="s2">init</span><span class="s0">:</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">Map</span><span class="s0">}},</span><span class="s2">coerce</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">map</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">only</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;symbol&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;symbol.map&quot;</span><span class="s0">,{</span><span class="s2">map</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">map</span><span class="s0">})}:{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}},</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let</span><span class="s0">{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;symbol&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(</span><span class="s3">&quot;symbol.base&quot;</span><span class="s0">)}},</span><span class="s2">rules</span><span class="s0">:{</span><span class="s2">map</span><span class="s0">:{</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">&amp;&amp;!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">]&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">],</span><span class="s3">&quot;Iterable must be an iterable or object&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">[</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">iterator</span><span class="s0">],</span><span class="s3">&quot;Entry must be an iterable&quot;</span><span class="s0">);</span><span class="s1">const</span><span class="s0">[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;symbol&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Key must not be of type object, function, or Symbol&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;symbol&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;Value must be a Symbol&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">map</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">valid</span><span class="s0">(</span><span class="s2">...r</span><span class="s0">)}}},</span><span class="s2">manifest</span><span class="s0">:{</span><span class="s2">build</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">map</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">map</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">map</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">messages</span><span class="s0">:{</span><span class="s3">&quot;symbol.base&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be a symbol&quot;</span><span class="s0">,</span><span class="s3">&quot;symbol.map&quot;</span><span class="s0">:</span><span class="s3">&quot;{{#label}} must be one of {{#map}}&quot;</span><span class="s0">}})},</span><span class="s4">8863</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">738</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6354</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">493</span><span class="s0">),</span><span class="s2">u</span><span class="s0">={</span><span class="s2">result</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;result&quot;</span><span class="s0">)};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">,</span><span class="s3">&quot;Cannot override warnings preference in synchronous validation&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">,</span><span class="s3">&quot;Cannot override artifacts preference in synchronous validation&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">,</span><span class="s2">r</span><span class="s0">));</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Schema with external rules must use validateAsync()&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">error</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">error</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">error</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">warning</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">),</span><span class="s2">i</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">entryAsync</span><span class="s0">=</span><span class="s2">async </span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">,</span><span class="s2">r</span><span class="s0">));</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of a</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">){</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">path</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s3">&quot;link&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">.</span><span class="s2">type</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">links</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">):</span><span class="s1">null</span><span class="s0">;</span><span class="s1">let </span><span class="s2">m</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">g</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?[</span><span class="s2">t</span><span class="s0">]:[],</span><span class="s2">y</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">f</span><span class="s0">):</span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">m</span><span class="s0">=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">];</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of f</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">))</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">g</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">d</span><span class="s0">=</span><span class="s2">g</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s2">d</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]}</span><span class="s1">try</span><span class="s0">{</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">h</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">).</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s1">await </span><span class="s2">n</span><span class="s0">.</span><span class="s2">method</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">linked</span><span class="s0">:</span><span class="s2">h</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">original</span><span class="s0">:</span><span class="s2">y</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errorsArray</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errorsArray</span><span class="s0">,</span><span class="s2">warn</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">push</span><span class="s0">((</span><span class="s2">h</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">).</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">message</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;(</span><span class="s2">h</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">).</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;external&quot;</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">messages</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})});</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">||</span><span class="s2">i</span><span class="s0">===</span><span class="s2">p</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i </span><span class="s1">instanceof </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s3">&quot;external&quot;</span><span class="s0">,</span><span class="s3">&quot;error&quot;</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">break</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)&amp;&amp;</span><span class="s2">i</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">]){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">schema</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s3">&quot;external&quot;</span><span class="s0">,</span><span class="s3">&quot;error&quot;</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...i</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">break</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s2">d</span><span class="s0">?(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;external&quot;</span><span class="s0">),</span><span class="s2">d</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">):(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;external&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">label</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+=</span><span class="s3">` (</span><span class="s2">$</span><span class="s0">{</span><span class="s2">n</span><span class="s0">.</span><span class="s2">label</span><span class="s0">}</span><span class="s3">)`</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">process</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">error</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">&amp;&amp;!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">&amp;&amp;!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">warning</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">details</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">),</span><span class="s2">c</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Mainstay</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">=[],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">=[],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">links</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshots</span><span class="s0">=[]}</span><span class="s2">snapshot</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshots</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">externals</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(),</span><span class="s2">warnings</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">()})}</span><span class="s2">restore</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshots</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">}</span><span class="s2">commit</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_snapshots</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">()}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">tracer</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">cleanup</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">?[]:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">?</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Mainstay</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_ids</span><span class="s0">.</span><span class="s2">_schemaChain</span><span class="s0">?[{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}]:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s1">new </span><span class="s2">c</span><span class="s0">([],[],{</span><span class="s2">mainstay</span><span class="s0">:</span><span class="s2">f</span><span class="s0">,</span><span class="s2">schemas</span><span class="s0">:</span><span class="s2">h</span><span class="s0">}),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">untrace</span><span class="s0">();</span><span class="s1">const </span><span class="s2">p</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">process</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">d</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">p</span><span class="s0">,</span><span class="s2">mainstay</span><span class="s0">:</span><span class="s2">f</span><span class="s0">}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">?{</span><span class="s2">tracer</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">_tracer</span><span class="s0">.</span><span class="s2">_register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">?(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">trace</span><span class="s0">,</span><span class="s3">&quot;Debug mode not supported&quot;</span><span class="s0">),{</span><span class="s2">tracer</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">$_root</span><span class="s0">.</span><span class="s2">trace</span><span class="s0">().</span><span class="s2">_register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">cleanup</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}):{</span><span class="s2">tracer</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ignore</span><span class="s0">}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">4</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">whens</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_generate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">schema</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;validate&quot;</span><span class="s0">,</span><span class="s3">&quot;cached&quot;</span><span class="s0">,!!</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">}</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)=&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">||</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">original</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">errorsArray</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errorsArray</span><span class="s0">,</span><span class="s2">warn</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)=&gt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">message</span><span class="s0">:(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)=&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;custom&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">messages</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})};</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">entry</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;prepare&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">i</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">&amp;&amp;(!</span><span class="s2">l</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">from</span><span class="s0">||</span><span class="s2">l</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">from</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">))){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">coerce</span><span class="s0">.</span><span class="s2">method</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;coerced&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">i</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}}</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">empty</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">$_match</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nest</span><span class="s0">(</span><span class="s2">c</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">)&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;empty&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s1">void </span><span class="s4">0</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">);</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">_endedSwitch</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">presence</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;required&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.required&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)],</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;optional&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">default</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">deepDefault</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;default&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{}),</span><span class="s2">e</span><span class="s0">={}}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.unknown&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)],</span><span class="s2">i</span><span class="s0">);</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">insensitive</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;valids&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;valid&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">only</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.only&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">valids</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_valids</span><span class="s0">.</span><span class="s2">values</span><span class="s0">({</span><span class="s2">display</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">i</span><span class="s0">);</span><span class="s2">h</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">insensitive</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;invalid&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.invalid&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">invalids</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_invalids</span><span class="s0">.</span><span class="s2">values</span><span class="s0">({</span><span class="s2">display</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">i</span><span class="s0">);</span><span class="s2">h</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;base&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">))</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">i</span><span class="s0">):</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">i of s</span><span class="s0">.</span><span class="s2">_rules</span><span class="s0">){</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">rules</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">method</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s3">&quot;full&quot;</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">let </span><span class="s2">c</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">args</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s2">f</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">f</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of i</span><span class="s0">.</span><span class="s2">_resolve</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">argsByName</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s2">i</span><span class="s0">):</span><span class="s2">i</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">validateArg</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">){</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">&quot;any.ref&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,{</span><span class="s2">arg</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">f</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">reason</span><span class="s0">:</span><span class="s2">h</span><span class="s0">},</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s1">break</span><span class="s0">}</span><span class="s2">f</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">}}</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">||</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s3">&quot;error&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">warnings</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">);</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">abortEarly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...h</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s3">&quot;pass&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">rule</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">?(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),{</span><span class="s2">errors</span><span class="s0">:[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">value</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}):</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">]?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">))),{</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}):{</span><span class="s2">errors</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">error</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_setTemplate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">),</span><span class="s2">e</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finalize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||[];</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">default</span><span class="s0">(</span><span class="s3">&quot;failover&quot;</span><span class="s0">,</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;failover&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=[])}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">error</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">error</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)||(</span><span class="s2">t</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">||</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">l</span><span class="s0">.</span><span class="s2">Report</span><span class="s0">,</span><span class="s3">&quot;error() must return an Error object&quot;</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">t</span><span class="s0">=[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">error</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">default</span><span class="s0">(</span><span class="s3">&quot;default&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;default&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_definition</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">to</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;cast&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">cast</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_externals</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">{</span><span class="s2">method</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}</span><span class="s2">of n</span><span class="s0">.</span><span class="s2">$_terms</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">externals</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">method</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">label</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">label</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)});</span><span class="s1">const </span><span class="s2">o</span><span class="s0">={</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">errors</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s1">null</span><span class="s0">};</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s3">&quot;strip&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">?</span><span class="s1">void </span><span class="s4">0</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">original</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">value</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">shadow</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">result</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">&amp;&amp;!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_cache</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">original</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">artifact</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">||</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">artifact</span><span class="s0">)||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">artifact</span><span class="s0">,[]),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">artifacts</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">.</span><span class="s2">artifact</span><span class="s0">).</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">path</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">defaults</span><span class="s0">;</span><span class="s1">return </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">]?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">]:(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">preferences</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">),</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_preferences</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">prefs</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">default</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">schema</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">prefs</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">_flags</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">noDefaults</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">mainstay</span><span class="s0">.</span><span class="s2">tracer</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;rule&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;full&quot;</span><span class="s0">),!</span><span class="s2">c</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">c</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?[</span><span class="s2">n</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ancestors</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">]:[];</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return void </span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">$_createError</span><span class="s0">(</span><span class="s3">`any.</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">error</span><span class="s0">:</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">,</span><span class="s2">l</span><span class="s0">))}}</span><span class="s1">return</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">c</span><span class="s0">?</span><span class="s2">c</span><span class="s0">:</span><span class="s2">c</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">literal</span><span class="s0">]?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">literal</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">l</span><span class="s0">):</span><span class="s2">n</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">$_getRule</span><span class="s0">(</span><span class="s3">&quot;trim&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">args</span><span class="s0">.</span><span class="s2">enabled</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">trim</span><span class="s0">():</span><span class="s2">e</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ignore</span><span class="s0">={</span><span class="s2">active</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">debug</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">entry</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">filter</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">log</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">resolve</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">errorsArray</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">return </span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}},</span><span class="s4">2036</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9474</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8160</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_lowercase</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">lowercases</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">}</span><span class="s2">get length</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">.</span><span class="s2">size</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">size</span><span class="s0">}</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">register</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_lowercase</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">))}</span><span class="s1">static </span><span class="s2">merge</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of</span><span class="s0">[</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">...t</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">])</span><span class="s2">e</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of</span><span class="s0">[</span><span class="s2">...r</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">...r</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">])</span><span class="s2">e</span><span class="s0">.</span><span class="s2">remove</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}</span><span class="s2">remove</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isResolvable</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_lowercase</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">()))}</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)}</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">};</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_lowercase</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">());</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">size</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">a of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">resolve</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,{</span><span class="s1">in</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">in</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">?</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">i</span><span class="s0">):[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of o</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">()===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">())</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">ref</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s2">override</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}</span><span class="s2">values</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">display</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of</span><span class="s0">[</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">])</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">return </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">from</span><span class="s0">([</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">])}</span><span class="s2">clone</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">,</span><span class="s3">&quot;Cannot concat override set of values&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">([</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">],[</span><span class="s2">...</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">,</span><span class="s2">...e</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}</span><span class="s2">describe</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_override</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">override</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_values</span><span class="s0">.</span><span class="s2">values</span><span class="s0">())</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?{</span><span class="s2">value</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}:</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_refs</span><span class="s0">.</span><span class="s2">values</span><span class="s0">())</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">describe</span><span class="s0">());</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">.</span><span class="s2">values</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Values</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">lowercases</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}},</span><span class="s4">978</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1687</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">o</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid defaults value: must be an object&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">||!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid source value: must be true, falsy or an object&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;Invalid options: must be an object&quot;</span><span class="s0">),!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">shallow</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">applyToDefaultsWithShallow</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nullOverride</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nullOverride</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">nullOverride</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">mergeArrays</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">applyToDefaultsWithShallow</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">shallow</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s3">&quot;Invalid keys&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r of l</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)?</span><span class="s2">r</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">u</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)||</span><span class="s2">s</span><span class="s0">):</span><span class="s2">u</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">const </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{},</span><span class="s2">c</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">f</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of u</span><span class="s0">)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reachCopy</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nullOverride</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nullOverride</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">nullOverride</span><span class="s0">:</span><span class="s2">h</span><span class="s0">,</span><span class="s2">mergeArrays</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reachCopy</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">e </span><span class="s1">in </span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">}</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;&amp;(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]={}),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]}</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]]=</span><span class="s2">s</span><span class="s0">}},</span><span class="s4">375</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7916</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]</span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">throw new </span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}}},</span><span class="s4">8571</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9621</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4277</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7043</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">needsProtoHack</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">([</span><span class="s2">n</span><span class="s0">.</span><span class="s2">set</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">map</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">weakSet</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">weakMap</span><span class="s0">])};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{},</span><span class="s2">r</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shallow</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shallow</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">cloneWithShallow</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">e</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">else </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getInternalProto</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">date</span><span class="s0">)</span><span class="s1">return new </span><span class="s2">Date</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTime</span><span class="s0">());</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">)</span><span class="s1">return new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">base</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">set</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of e</span><span class="s0">)</span><span class="s2">c</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">));</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">map</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">[</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">]</span><span class="s2">of e</span><span class="s0">)</span><span class="s2">c</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">));</span><span class="s1">const </span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of u</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;__proto__&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">array</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;length&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">continue</span><span class="s0">}</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getOwnPropertyDescriptor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">a</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">get</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">set</span><span class="s0">?</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">enumerable</span><span class="s0">?</span><span class="s2">c</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">):</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">enumerable</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">writable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">configurable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)}):</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">enumerable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">writable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">configurable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)})}</span><span class="s1">return </span><span class="s2">c</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cloneWithShallow</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shallow</span><span class="s0">;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">t</span><span class="s0">)).</span><span class="s2">shallow</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of r</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">base</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">needsProtoHack</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s1">new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructor</span><span class="s0">:</span><span class="s2">t</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">array</span><span class="s0">?[]:{};</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">isImmutable</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">array</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">return </span><span class="s2">s</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">setPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">needsProtoHack</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">s</span><span class="s0">.</span><span class="s2">constructor</span><span class="s0">;</span><span class="s1">return </span><span class="s2">s</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">setPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}},</span><span class="s4">9474</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4277</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={</span><span class="s2">mismatched</span><span class="s0">:</span><span class="s1">null</span><span class="s0">};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({</span><span class="s2">prototype</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">r</span><span class="s0">),!!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isDeepEqual</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,[])},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isDeepEqual</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">||</span><span class="s4">1</span><span class="s0">/</span><span class="s2">e</span><span class="s0">==</span><span class="s4">1</span><span class="s0">/</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">!==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">deepFunction</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">())</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">!=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getSharedType</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">);</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">o</span><span class="s0">){</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">:</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">promise</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">t</span><span class="s0">;</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">:</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">();</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">mismatched</span><span class="s0">:</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">].</span><span class="s2">isSame</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s1">new </span><span class="s2">n</span><span class="s0">.</span><span class="s2">SeenEntry</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">));</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return</span><span class="s0">!!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isDeepEqualObj</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">finally</span><span class="s0">{</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pop</span><span class="s0">()}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getSharedType</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)!==</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getPrototypeOf</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mismatched</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getInternalProto</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getInternalProto</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getInternalProto</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mismatched</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">valueOf</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">valueOf</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">hasOwnEnumerableProperty</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">propertyIsEnumerable</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSetSimpleEqual</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of Set</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">Set</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">has</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isDeepEqualObj</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">const</span><span class="s0">{</span><span class="s2">isDeepEqual</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">valueOf</span><span class="s0">:</span><span class="s2">l</span><span class="s0">,</span><span class="s2">hasOwnEnumerableProperty</span><span class="s0">:</span><span class="s2">c</span><span class="s0">}=</span><span class="s2">n</span><span class="s0">,{</span><span class="s2">keys</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">getOwnPropertySymbols</span><span class="s0">:</span><span class="s2">f</span><span class="s0">}=</span><span class="s2">Object</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">array</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">part</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of r</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">set</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">size</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">size</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isSetSimpleEqual</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">Set</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of Set</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">map</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">size</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">size</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const</span><span class="s0">[</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">]</span><span class="s2">of Map</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">entries</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;!</span><span class="s2">Map</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">has</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">Map</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">get</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">error</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">message</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">h</span><span class="s0">=</span><span class="s2">l</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">l</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">((</span><span class="s2">t</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">||</span><span class="s2">r</span><span class="s0">!==</span><span class="s2">m</span><span class="s0">)&amp;&amp;!</span><span class="s2">o</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">d</span><span class="s0">=</span><span class="s2">u</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">part</span><span class="s0">&amp;&amp;</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">(</span><span class="s2">r</span><span class="s0">).</span><span class="s2">length</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skip</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">let </span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of d</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skip</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skip</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&amp;&amp;++</span><span class="s2">p</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">part</span><span class="s0">&amp;&amp;</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s2">p</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">(</span><span class="s2">r</span><span class="s0">).</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">f</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skip</span><span class="s0">||!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">skip</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">))</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of s</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">SeenEntry</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">obj</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">=</span><span class="s2">t</span><span class="s0">}</span><span class="s2">isSame</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">obj</span><span class="s0">===</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ref</span><span class="s0">===</span><span class="s2">t</span><span class="s0">}}},</span><span class="s4">7916</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8761</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">class extends </span><span class="s2">Error</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">super</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">:</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot; &quot;</span><span class="s0">)||</span><span class="s3">&quot;Unknown error&quot;</span><span class="s0">),</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">Error</span><span class="s0">.</span><span class="s2">captureStackTrace</span><span class="s0">&amp;&amp;</span><span class="s2">Error</span><span class="s0">.</span><span class="s2">captureStackTrace</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">assert</span><span class="s0">)}}},</span><span class="s4">5277</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">t</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isSafe</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)?</span><span class="s2">r</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]:</span><span class="s2">r</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">escapeHtmlChar</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">escapeHtmlChar</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">namedHtml</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||(</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">256</span><span class="s0">?</span><span class="s3">&quot;&amp;#&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot;;&quot;</span><span class="s0">:</span><span class="s3">`&amp;#x</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">).</span><span class="s2">padStart</span><span class="s0">(</span><span class="s4">2</span><span class="s0">,</span><span class="s3">&quot;0&quot;</span><span class="s0">)}</span><span class="s3">;`</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isSafe</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">safeCharCodes</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">namedHtml</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">([[</span><span class="s4">38</span><span class="s0">,</span><span class="s3">&quot;&amp;amp;&quot;</span><span class="s0">],[</span><span class="s4">60</span><span class="s0">,</span><span class="s3">&quot;&amp;lt;&quot;</span><span class="s0">],[</span><span class="s4">62</span><span class="s0">,</span><span class="s3">&quot;&amp;gt;&quot;</span><span class="s0">],[</span><span class="s4">34</span><span class="s0">,</span><span class="s3">&quot;&amp;quot;&quot;</span><span class="s0">],[</span><span class="s4">160</span><span class="s0">,</span><span class="s3">&quot;&amp;nbsp;&quot;</span><span class="s0">],[</span><span class="s4">162</span><span class="s0">,</span><span class="s3">&quot;&amp;cent;&quot;</span><span class="s0">],[</span><span class="s4">163</span><span class="s0">,</span><span class="s3">&quot;&amp;pound;&quot;</span><span class="s0">],[</span><span class="s4">164</span><span class="s0">,</span><span class="s3">&quot;&amp;curren;&quot;</span><span class="s0">],[</span><span class="s4">169</span><span class="s0">,</span><span class="s3">&quot;&amp;copy;&quot;</span><span class="s0">],[</span><span class="s4">174</span><span class="s0">,</span><span class="s3">&quot;&amp;reg;&quot;</span><span class="s0">]]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">safeCharCodes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">32</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">123</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)(</span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s4">97</span><span class="s0">||</span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s4">65</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">90</span><span class="s0">||</span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s4">48</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">57</span><span class="s0">||</span><span class="s4">32</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">46</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">44</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">45</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">58</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">95</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}()},</span><span class="s4">6064</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g</span><span class="s0">,</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">$&amp;&quot;</span><span class="s0">)}},</span><span class="s4">738</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){}},</span><span class="s4">1687</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8571</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7043</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;Invalid target value: must be an object&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">null</span><span class="s0">==</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;Invalid source value: must be null, undefined, or an object&quot;</span><span class="s0">),!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({</span><span class="s2">nullOverride</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">mergeArrays</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">r</span><span class="s0">),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;Cannot merge array onto an object&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mergeArrays</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],{</span><span class="s2">symbols</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">}));</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;__proto__&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">||!</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">propertyIsEnumerable</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">))</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">l</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]===</span><span class="s2">l</span><span class="s0">)</span><span class="s1">continue</span><span class="s0">;!</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]||</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]||</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])!==</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)||</span><span class="s2">l </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">||</span><span class="s2">l </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">?</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,{</span><span class="s2">symbols</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">symbols</span><span class="s0">}):</span><span class="s2">i</span><span class="s0">.</span><span class="s2">merge</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">l</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">l</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">nullOverride</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">l</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s4">9621</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s1">null</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{})&amp;&amp;(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">separator</span><span class="s0">:</span><span class="s2">r</span><span class="s0">});</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">||!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">,</span><span class="s3">&quot;Separator option is not valid for array-based chain&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">separator</span><span class="s0">||</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">iterables</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">iterables</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)||</span><span class="s3">&quot;set&quot;</span><span class="s0">===</span><span class="s2">l</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">Number</span><span class="s0">(</span><span class="s2">a</span><span class="s0">);</span><span class="s2">Number</span><span class="s0">.</span><span class="s2">isInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">&amp;&amp;!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">||!</span><span class="s2">l</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]){</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">||</span><span class="s2">e</span><span class="s0">+</span><span class="s4">1</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s3">&quot;Missing segment&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;in reach path &quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">||!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">||</span><span class="s3">&quot;function&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">,</span><span class="s3">&quot;Invalid segment&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;in reach path &quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">default</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s2">o</span><span class="s0">=</span><span class="s2">l</span><span class="s0">?</span><span class="s3">&quot;set&quot;</span><span class="s0">===</span><span class="s2">l</span><span class="s0">?[</span><span class="s2">...o</span><span class="s0">][</span><span class="s2">a</span><span class="s0">]:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">a</span><span class="s0">):</span><span class="s2">o</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]}</span><span class="s1">return </span><span class="s2">o</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">iterables</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Set</span><span class="s0">?</span><span class="s3">&quot;set&quot;</span><span class="s0">:</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Map</span><span class="s0">?</span><span class="s3">&quot;map&quot;</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">}},</span><span class="s4">8761</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return </span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">...arguments</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;[Cannot display object: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">+</span><span class="s3">&quot;]&quot;</span><span class="s0">}}},</span><span class="s4">4277</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">={};</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={</span><span class="s2">array</span><span class="s0">:</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">buffer</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">date</span><span class="s0">:</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">Error</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">generic</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">map</span><span class="s0">:</span><span class="s2">Map</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">promise</span><span class="s0">:</span><span class="s2">Promise</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">RegExp</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">set</span><span class="s0">:</span><span class="s2">Set</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">weakMap</span><span class="s0">:</span><span class="s2">WeakMap</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">,</span><span class="s2">weakSet</span><span class="s0">:</span><span class="s2">WeakSet</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">typeMap</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Map</span><span class="s0">([[</span><span class="s3">&quot;[object Error]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">],[</span><span class="s3">&quot;[object Map]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">map</span><span class="s0">],[</span><span class="s3">&quot;[object Promise]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">promise</span><span class="s0">],[</span><span class="s3">&quot;[object Set]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">set</span><span class="s0">],[</span><span class="s3">&quot;[object WeakMap]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">weakMap</span><span class="s0">],[</span><span class="s3">&quot;[object WeakSet]&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">weakSet</span><span class="s0">]]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInternalProto</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">array</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Date</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">date</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Error</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">error</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">typeMap</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generic</span><span class="s0">}},</span><span class="s4">7043</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">!==(</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{}).</span><span class="s2">symbols</span><span class="s0">?</span><span class="s2">Reflect</span><span class="s0">.</span><span class="s2">ownKeys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">getOwnPropertyNames</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s4">3652</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Sorter</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">=[],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">=[]}</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">((</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">before</span><span class="s0">||[]),</span><span class="s2">n</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">after</span><span class="s0">||[]),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">group</span><span class="s0">||</span><span class="s3">&quot;?&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">||</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s3">`Item cannot come before itself: </span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">`</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;?&quot;</span><span class="s0">),</span><span class="s3">&quot;Item cannot come before unassociated items&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s3">`Item cannot come after itself: </span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">`</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;?&quot;</span><span class="s0">),</span><span class="s3">&quot;Item cannot come after unassociated items&quot;</span><span class="s0">),</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||(</span><span class="s2">e</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={</span><span class="s2">seq</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">sort</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">before</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">after</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">group</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">node</span><span class="s0">:</span><span class="s2">t</span><span class="s0">};</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">manual</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_sort</span><span class="s0">();</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;item&quot;</span><span class="s0">,</span><span class="s3">&quot;?&quot;</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">?</span><span class="s3">`added into group </span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">`</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s3">&quot;created a dependencies error&quot;</span><span class="s0">)}</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">}</span><span class="s2">merge</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||(</span><span class="s2">e</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of t</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({},</span><span class="s2">e</span><span class="s0">));</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mergeSort</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">seq</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_sort</span><span class="s0">();</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;merge created a dependencies error&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">}</span><span class="s2">sort</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_sort</span><span class="s0">();</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;sort created a dependencies error&quot;</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">}</span><span class="s2">_sort</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={},</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">seq</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">group</span><span class="s0">;</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]||[],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">before</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of s</span><span class="s0">.</span><span class="s2">after</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]||[],</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n </span><span class="s1">in </span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">][</span><span class="s2">n</span><span class="s0">];</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]||[],</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])}</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">s </span><span class="s1">in </span><span class="s2">t</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">])</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">n of r</span><span class="s0">[</span><span class="s2">s</span><span class="s0">])</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">...t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]);</span><span class="s1">const </span><span class="s2">s</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t </span><span class="s1">in </span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]||[],</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">const </span><span class="s2">n</span><span class="s0">={},</span><span class="s2">a</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]){</span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">])</span><span class="s1">continue</span><span class="s0">;</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]||(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=[]);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">length</span><span class="s0">;</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">][</span><span class="s2">t</span><span class="s0">]]&amp;&amp;++</span><span class="s2">a</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">===</span><span class="s2">r</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}}</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">i</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of </span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">seq</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">=[],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of a</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">this</span><span class="s0">.</span><span class="s2">nodes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">node</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_items</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">mergeSort</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sort</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">1</span><span class="s0">},</span><span class="s4">5380</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">443</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2178</span><span class="s0">),</span><span class="s2">a</span><span class="s0">={</span><span class="s2">minDomainSegments</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">nonAsciiRx</span><span class="s0">:</span><span class="s5">/[^\x00-\x7f]/</span><span class="s0">,</span><span class="s2">domainControlRx</span><span class="s0">:</span><span class="s5">/[\x00-\x20@\:\/\\#!\$&amp;\'\(\)\*\+,;=\?]/</span><span class="s0">,</span><span class="s2">tldSegmentRx</span><span class="s0">:</span><span class="s5">/^[a-zA-Z](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/</span><span class="s0">,</span><span class="s2">domainSegmentRx</span><span class="s0">:</span><span class="s5">/^[a-zA-Z0-9](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/</span><span class="s0">,</span><span class="s2">URL</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">URL</span><span class="s0">||</span><span class="s2">URL</span><span class="s0">};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">analyze</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_NON_EMPTY_STRING&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid input: domain must be a string&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">256</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_TOO_LONG&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">nonAsciiRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">allowUnicode</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_INVALID_UNICODE_CHARS&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s3">&quot;NFC&quot;</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">domainControlRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_INVALID_CHARS&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">punycode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">allowFullyQualified</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;.&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">));</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">minDomainSegments</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">minDomainSegments</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_SEGMENTS_COUNT&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">maxDomainSegments</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">maxDomainSegments</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_SEGMENTS_COUNT_MAX&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tlds</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">].</span><span class="s2">toLowerCase</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">deny</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">deny</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">&amp;&amp;!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">allow</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_FORBIDDEN_TLDS&quot;</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_EMPTY_SEGMENT&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">63</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_LONG_SEGMENT&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">domainSegmentRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_INVALID_CHARS&quot;</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tldSegmentRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;DOMAIN_INVALID_TLDS_CHARS&quot;</span><span class="s0">)}</span><span class="s1">return null</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">analyze</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">punycode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s3">&quot;%&quot;</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/%/g</span><span class="s0">,</span><span class="s3">&quot;%25&quot;</span><span class="s0">));</span><span class="s1">try</span><span class="s0">{</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">URL</span><span class="s0">(</span><span class="s3">`http://</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">).</span><span class="s2">host</span><span class="s0">}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}}},</span><span class="s4">1745</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9848</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5380</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2178</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">nonAsciiRx</span><span class="s0">:</span><span class="s5">/[^\x00-\x7f]/</span><span class="s0">,</span><span class="s2">encoder</span><span class="s0">:</span><span class="s1">new</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">TextEncoder</span><span class="s0">||</span><span class="s2">TextEncoder</span><span class="s0">)};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">analyze</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">email</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isValid</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">email</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">email</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid input: email must be a string&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;EMPTY_STRING&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">nonAsciiRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">allowUnicode</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;FORBIDDEN_UNICODE&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">normalize</span><span class="s0">(</span><span class="s3">&quot;NFC&quot;</span><span class="s0">)}</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;@&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;MULTIPLE_AT_CHAR&quot;</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;MISSING_AT_CHAR&quot;</span><span class="s0">);</span><span class="s1">const</span><span class="s0">[</span><span class="s2">o</span><span class="s0">,</span><span class="s2">l</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;EMPTY_LOCAL&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ignoreLength</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">254</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;ADDRESS_TOO_LONG&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encoder</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">o</span><span class="s0">).</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">64</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;LOCAL_TOO_LONG&quot;</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">local</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">analyze</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">local</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;EMPTY_LOCAL_SEGMENT&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">atextRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;INVALID_LOCAL_CHARS&quot;</span><span class="s0">)}</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">atextRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">atomRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">code</span><span class="s0">(</span><span class="s3">&quot;INVALID_LOCAL_CHARS&quot;</span><span class="s0">)}}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Array</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encoder</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">atextRx</span><span class="s0">=</span><span class="s5">/^[\w!#\$%&amp;'\*\+\-/=\?\^`\{\|\}~]+$/</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">atomRx</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">([</span><span class="s3">&quot;(?:[</span><span class="s1">\\</span><span class="s3">xc2-</span><span class="s1">\\</span><span class="s3">xdf][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf])&quot;</span><span class="s0">,</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">xe0[</span><span class="s1">\\</span><span class="s3">xa0-</span><span class="s1">\\</span><span class="s3">xbf][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf])|(?:[</span><span class="s1">\\</span><span class="s3">xe1-</span><span class="s1">\\</span><span class="s3">xec][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf]{2})|(?:</span><span class="s1">\\</span><span class="s3">xed[</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">x9f][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf])|(?:[</span><span class="s1">\\</span><span class="s3">xee-</span><span class="s1">\\</span><span class="s3">xef][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf]{2})&quot;</span><span class="s0">,</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">xf0[</span><span class="s1">\\</span><span class="s3">x90-</span><span class="s1">\\</span><span class="s3">xbf][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf]{2})|(?:[</span><span class="s1">\\</span><span class="s3">xf1-</span><span class="s1">\\</span><span class="s3">xf3][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf]{3})|(?:</span><span class="s1">\\</span><span class="s3">xf4[</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">x8f][</span><span class="s1">\\</span><span class="s3">x80-</span><span class="s1">\\</span><span class="s3">xbf]{2})&quot;</span><span class="s0">].</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;|&quot;</span><span class="s0">))},</span><span class="s4">2178</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">codes</span><span class="s0">={</span><span class="s2">EMPTY_STRING</span><span class="s0">:</span><span class="s3">&quot;Address must be a non-empty string&quot;</span><span class="s0">,</span><span class="s2">FORBIDDEN_UNICODE</span><span class="s0">:</span><span class="s3">&quot;Address contains forbidden Unicode characters&quot;</span><span class="s0">,</span><span class="s2">MULTIPLE_AT_CHAR</span><span class="s0">:</span><span class="s3">&quot;Address cannot contain more than one @ character&quot;</span><span class="s0">,</span><span class="s2">MISSING_AT_CHAR</span><span class="s0">:</span><span class="s3">&quot;Address must contain one @ character&quot;</span><span class="s0">,</span><span class="s2">EMPTY_LOCAL</span><span class="s0">:</span><span class="s3">&quot;Address local part cannot be empty&quot;</span><span class="s0">,</span><span class="s2">ADDRESS_TOO_LONG</span><span class="s0">:</span><span class="s3">&quot;Address too long&quot;</span><span class="s0">,</span><span class="s2">LOCAL_TOO_LONG</span><span class="s0">:</span><span class="s3">&quot;Address local part too long&quot;</span><span class="s0">,</span><span class="s2">EMPTY_LOCAL_SEGMENT</span><span class="s0">:</span><span class="s3">&quot;Address local part contains empty dot-separated segment&quot;</span><span class="s0">,</span><span class="s2">INVALID_LOCAL_CHARS</span><span class="s0">:</span><span class="s3">&quot;Address local part contains invalid character&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_NON_EMPTY_STRING</span><span class="s0">:</span><span class="s3">&quot;Domain must be a non-empty string&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_TOO_LONG</span><span class="s0">:</span><span class="s3">&quot;Domain too long&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_INVALID_UNICODE_CHARS</span><span class="s0">:</span><span class="s3">&quot;Domain contains forbidden Unicode characters&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_INVALID_CHARS</span><span class="s0">:</span><span class="s3">&quot;Domain contains invalid character&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_INVALID_TLDS_CHARS</span><span class="s0">:</span><span class="s3">&quot;Domain contains invalid tld character&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_SEGMENTS_COUNT</span><span class="s0">:</span><span class="s3">&quot;Domain lacks the minimum required number of segments&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_SEGMENTS_COUNT_MAX</span><span class="s0">:</span><span class="s3">&quot;Domain contains too many segments&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_FORBIDDEN_TLDS</span><span class="s0">:</span><span class="s3">&quot;Domain uses forbidden TLD&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_EMPTY_SEGMENT</span><span class="s0">:</span><span class="s3">&quot;Domain contains empty dot-separated segment&quot;</span><span class="s0">,</span><span class="s2">DOMAIN_LONG_SEGMENT</span><span class="s0">:</span><span class="s3">&quot;Domain contains dot-separated segment that is too long&quot;</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">code</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">{</span><span class="s2">code</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">codes</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}}},</span><span class="s4">9959</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5752</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">,</span><span class="s3">&quot;options.cidr must be a string&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cidr</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">():</span><span class="s3">&quot;optional&quot;</span><span class="s0">;</span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;required&quot;</span><span class="s0">,</span><span class="s3">&quot;optional&quot;</span><span class="s0">,</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;options.cidr must be one of required, optional, forbidden&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">||</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">),</span><span class="s3">&quot;options.version must be a string or an array of string&quot;</span><span class="s0">);</span><span class="s1">let </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">||[</span><span class="s3">&quot;ipv4&quot;</span><span class="s0">,</span><span class="s3">&quot;ipv6&quot;</span><span class="s0">,</span><span class="s3">&quot;ipvfuture&quot;</span><span class="s0">];</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)||(</span><span class="s2">r</span><span class="s0">=[</span><span class="s2">r</span><span class="s0">]),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;=</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;options.version must have at least 1 version specified&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s3">&quot;options.version must only contain strings&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">toLowerCase</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">([</span><span class="s3">&quot;ipv4&quot;</span><span class="s0">,</span><span class="s3">&quot;ipv6&quot;</span><span class="s0">,</span><span class="s3">&quot;ipvfuture&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]),</span><span class="s3">&quot;options.version contains unknown version &quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]+</span><span class="s3">&quot; - must be one of ipv4, ipv6, ipvfuture&quot;</span><span class="s0">);</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s1">new </span><span class="s2">Set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s3">`(?:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;forbidden&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s3">`</span><span class="s1">\\</span><span class="s3">/</span><span class="s2">$</span><span class="s0">{</span><span class="s3">&quot;ipv4&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">.</span><span class="s2">v4Cidr</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">.</span><span class="s2">v6Cidr</span><span class="s0">}</span><span class="s3">`</span><span class="s0">;</span><span class="s1">return</span><span class="s3">&quot;required&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">}</span><span class="s3">`</span><span class="s0">:</span><span class="s3">`</span><span class="s2">$</span><span class="s0">{</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s3">(?:</span><span class="s2">$</span><span class="s0">{</span><span class="s2">r</span><span class="s0">}</span><span class="s3">)?`</span><span class="s0">})).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;|&quot;</span><span class="s0">)}</span><span class="s3">)`</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">`^</span><span class="s2">$</span><span class="s0">{</span><span class="s2">a</span><span class="s0">}</span><span class="s3">$`</span><span class="s0">);</span><span class="s1">return</span><span class="s0">{</span><span class="s2">cidr</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">versions</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">regex</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">a</span><span class="s0">}}},</span><span class="s4">5752</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">375</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6064</span><span class="s0">),</span><span class="s2">a</span><span class="s0">={</span><span class="s2">generate</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">={},</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">dA-Fa-f&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s3">&quot;]&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">w-</span><span class="s1">\\</span><span class="s3">.~&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;!</span><span class="s1">\\</span><span class="s3">$&amp;'</span><span class="s1">\\</span><span class="s3">(</span><span class="s1">\\</span><span class="s3">)</span><span class="s1">\\</span><span class="s3">*</span><span class="s1">\\</span><span class="s3">+,;=&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s3">&quot;%&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">+</span><span class="s2">a</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;:@&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;]&quot;</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s3">&quot;(?:0{0,2}</span><span class="s1">\\</span><span class="s3">d|0?[1-9]</span><span class="s1">\\</span><span class="s3">d|1</span><span class="s1">\\</span><span class="s3">d</span><span class="s1">\\</span><span class="s3">d|2[0-4]</span><span class="s1">\\</span><span class="s3">d|25[0-5])&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv4address</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">l</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">.){3}&quot;</span><span class="s0">+</span><span class="s2">l</span><span class="s0">;</span><span class="s1">const </span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">+</span><span class="s3">&quot;{1,4}&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv4address</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){6}&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s3">&quot;::(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){5}&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){4}&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,1}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){3}&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,2}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){2}&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,3}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,4}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::&quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,</span><span class="s2">b</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,5}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s3">&quot;(?:(?:&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;:){0,6}&quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot;)?::&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv4Cidr</span><span class="s0">=</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">d|[1-2]</span><span class="s1">\\</span><span class="s3">d|3[0-2])&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv6Cidr</span><span class="s0">=</span><span class="s3">&quot;(?:0{0,2}</span><span class="s1">\\</span><span class="s3">d|0?[1-9]</span><span class="s1">\\</span><span class="s3">d|1[01]</span><span class="s1">\\</span><span class="s3">d|12[0-8])&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv6address</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">f</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">h</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">m</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">d</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">p</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">g</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">y</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">b</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">v</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipvFuture</span><span class="s0">=</span><span class="s3">&quot;v&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">+</span><span class="s3">&quot;+</span><span class="s1">\\</span><span class="s3">.[&quot;</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;:]+&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">=</span><span class="s3">&quot;[a-zA-Z][a-zA-Z</span><span class="s1">\\</span><span class="s3">d+-</span><span class="s1">\\</span><span class="s3">.]*&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">schemeRegex</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">);</span><span class="s1">const </span><span class="s2">_</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s2">a</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;:]*&quot;</span><span class="s0">,</span><span class="s2">w</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s2">a</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;]{1,255}&quot;</span><span class="s0">,</span><span class="s2">$</span><span class="s0">=</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">[(?:&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv6address</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipvFuture</span><span class="s0">+</span><span class="s3">&quot;)</span><span class="s1">\\</span><span class="s3">]|&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">ipv4address</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">w</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">x</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">_</span><span class="s0">+</span><span class="s3">&quot;@)?&quot;</span><span class="s0">+</span><span class="s2">$</span><span class="s0">+</span><span class="s3">&quot;(?::</span><span class="s1">\\</span><span class="s3">d*)?&quot;</span><span class="s0">,</span><span class="s2">j</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">_</span><span class="s0">+</span><span class="s3">&quot;@)?(&quot;</span><span class="s0">+</span><span class="s2">$</span><span class="s0">+</span><span class="s3">&quot;)(?::</span><span class="s1">\\</span><span class="s3">d*)?&quot;</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;*&quot;</span><span class="s0">,</span><span class="s2">R</span><span class="s0">=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;+&quot;</span><span class="s0">,</span><span class="s2">A</span><span class="s0">=</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">k</span><span class="s0">+</span><span class="s3">&quot;)*&quot;</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/(?:&quot;</span><span class="s0">+</span><span class="s2">R</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)?&quot;</span><span class="s0">,</span><span class="s2">O</span><span class="s0">=</span><span class="s2">R</span><span class="s0">+</span><span class="s2">A</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s2">a</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;@]+&quot;</span><span class="s0">+</span><span class="s2">A</span><span class="s0">,</span><span class="s2">D</span><span class="s0">=</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">k</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">hierPart</span><span class="s0">=</span><span class="s3">&quot;(?:(?:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">x</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)|&quot;</span><span class="s0">+</span><span class="s2">S</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">O</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">D</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hierPartCapture</span><span class="s0">=</span><span class="s3">&quot;(?:(?:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">j</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)|&quot;</span><span class="s0">+</span><span class="s2">S</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">O</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">relativeRef</span><span class="s0">=</span><span class="s3">&quot;(?:(?:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">x</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)|&quot;</span><span class="s0">+</span><span class="s2">S</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">E</span><span class="s0">+</span><span class="s3">&quot;|)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">relativeRefCapture</span><span class="s0">=</span><span class="s3">&quot;(?:(?:</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">/&quot;</span><span class="s0">+</span><span class="s2">j</span><span class="s0">+</span><span class="s2">A</span><span class="s0">+</span><span class="s3">&quot;)|&quot;</span><span class="s0">+</span><span class="s2">S</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">E</span><span class="s0">+</span><span class="s3">&quot;|)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">query</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]*(?=#|$)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">queryWithSquareBrackets</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">[</span><span class="s1">\\</span><span class="s3">]</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]*(?=#|$)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\\</span><span class="s3">/</span><span class="s1">\\</span><span class="s3">?]*&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">}};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">={</span><span class="s2">v4Cidr</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">.</span><span class="s2">ipv4Cidr</span><span class="s0">,</span><span class="s2">v6Cidr</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">.</span><span class="s2">ipv6Cidr</span><span class="s0">,</span><span class="s2">ipv4</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">.</span><span class="s2">ipv4address</span><span class="s0">,</span><span class="s2">ipv6</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">.</span><span class="s2">ipv6address</span><span class="s0">,</span><span class="s2">ipvfuture</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">.</span><span class="s2">ipvFuture</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">createRegex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rfc3986</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;(?:</span><span class="s1">\\</span><span class="s3">?&quot;</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">allowQuerySquareBrackets</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">queryWithSquareBrackets</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">query</span><span class="s0">)+</span><span class="s3">&quot;)?(?:#&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">+</span><span class="s3">&quot;)?&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">relativeRefCapture</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">relativeRef</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">relativeOnly</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+</span><span class="s2">r</span><span class="s0">);</span><span class="s1">let </span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">||</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">),</span><span class="s3">&quot;scheme must be a RegExp, String, or Array&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=[].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">);</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;=</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;scheme must have at least 1 scheme specified&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s2">s</span><span class="s0">(</span><span class="s2">i </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;scheme at position &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot; must be a RegExp or String&quot;</span><span class="s0">),</span><span class="s2">i </span><span class="s1">instanceof </span><span class="s2">RegExp</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">source</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">()):(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">schemeRegex</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s3">&quot;scheme at position &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s3">&quot; must be a valid scheme&quot;</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)))}</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;|&quot;</span><span class="s0">)}</span><span class="s1">const </span><span class="s2">l</span><span class="s0">=</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+(</span><span class="s2">o</span><span class="s0">?</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">)+</span><span class="s3">&quot;:&quot;</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hierPartCapture</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hierPart</span><span class="s0">)+</span><span class="s3">&quot;)&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">allowRelative</span><span class="s0">?</span><span class="s3">&quot;(?:&quot;</span><span class="s0">+</span><span class="s2">l</span><span class="s0">+</span><span class="s3">&quot;|&quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">&quot;)&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">(</span><span class="s2">c</span><span class="s0">+</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">wrap</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return</span><span class="s0">{</span><span class="s2">raw</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=</span><span class="s3">`(?=.)(?!https?:/(?:$|[^/]))(?!https?:///)(?!https?:[^/])</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">,</span><span class="s2">regex</span><span class="s0">:</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">`^</span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">$`</span><span class="s0">),</span><span class="s2">scheme</span><span class="s0">:</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">uriRegex</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">createRegex</span><span class="s0">({}),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">regex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">let </span><span class="s2">e</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:{};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">scheme</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">allowRelative</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">relativeOnly</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">allowQuerySquareBrackets</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">domain</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">createRegex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">uriRegex</span><span class="s0">}},</span><span class="s4">1447</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">={</span><span class="s2">operators</span><span class="s0">:[</span><span class="s3">&quot;!&quot;</span><span class="s0">,</span><span class="s3">&quot;^&quot;</span><span class="s0">,</span><span class="s3">&quot;*&quot;</span><span class="s0">,</span><span class="s3">&quot;/&quot;</span><span class="s0">,</span><span class="s3">&quot;%&quot;</span><span class="s0">,</span><span class="s3">&quot;+&quot;</span><span class="s0">,</span><span class="s3">&quot;-&quot;</span><span class="s0">,</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">,</span><span class="s3">&quot;==&quot;</span><span class="s0">,</span><span class="s3">&quot;!=&quot;</span><span class="s0">,</span><span class="s3">&quot;&amp;&amp;&quot;</span><span class="s0">,</span><span class="s3">&quot;||&quot;</span><span class="s0">,</span><span class="s3">&quot;??&quot;</span><span class="s0">],</span><span class="s2">operatorCharacters</span><span class="s0">:[</span><span class="s3">&quot;!&quot;</span><span class="s0">,</span><span class="s3">&quot;^&quot;</span><span class="s0">,</span><span class="s3">&quot;*&quot;</span><span class="s0">,</span><span class="s3">&quot;/&quot;</span><span class="s0">,</span><span class="s3">&quot;%&quot;</span><span class="s0">,</span><span class="s3">&quot;+&quot;</span><span class="s0">,</span><span class="s3">&quot;-&quot;</span><span class="s0">,</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">,</span><span class="s3">&quot;=&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&amp;&quot;</span><span class="s0">,</span><span class="s3">&quot;|&quot;</span><span class="s0">,</span><span class="s3">&quot;?&quot;</span><span class="s0">],</span><span class="s2">operatorsOrder</span><span class="s0">:[[</span><span class="s3">&quot;^&quot;</span><span class="s0">],[</span><span class="s3">&quot;*&quot;</span><span class="s0">,</span><span class="s3">&quot;/&quot;</span><span class="s0">,</span><span class="s3">&quot;%&quot;</span><span class="s0">],[</span><span class="s3">&quot;+&quot;</span><span class="s0">,</span><span class="s3">&quot;-&quot;</span><span class="s0">],[</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">,</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">],[</span><span class="s3">&quot;==&quot;</span><span class="s0">,</span><span class="s3">&quot;!=&quot;</span><span class="s0">],[</span><span class="s3">&quot;&amp;&amp;&quot;</span><span class="s0">],[</span><span class="s3">&quot;||&quot;</span><span class="s0">,</span><span class="s3">&quot;??&quot;</span><span class="s0">]],</span><span class="s2">operatorsPrefix</span><span class="s0">:[</span><span class="s3">&quot;!&quot;</span><span class="s0">,</span><span class="s3">&quot;n&quot;</span><span class="s0">],</span><span class="s2">literals</span><span class="s0">:{</span><span class="s3">'&quot;'</span><span class="s0">:</span><span class="s3">'&quot;'</span><span class="s0">,</span><span class="s3">&quot;`&quot;</span><span class="s0">:</span><span class="s3">&quot;`&quot;</span><span class="s0">,</span><span class="s3">&quot;'&quot;</span><span class="s0">:</span><span class="s3">&quot;'&quot;</span><span class="s0">,</span><span class="s3">&quot;[&quot;</span><span class="s0">:</span><span class="s3">&quot;]&quot;</span><span class="s0">},</span><span class="s2">numberRx</span><span class="s0">:</span><span class="s5">/^(?:[0-9]*(\.[0-9]*)?){1}$/</span><span class="s0">,</span><span class="s2">tokenRx</span><span class="s0">:</span><span class="s5">/^[\w\$\#\.\@\:\{\}]+$/</span><span class="s0">,</span><span class="s2">symbol</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;formula&quot;</span><span class="s0">),</span><span class="s2">settings</span><span class="s0">:</span><span class="s2">Symbol</span><span class="s0">(</span><span class="s3">&quot;settings&quot;</span><span class="s0">)};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Parser</span><span class="s0">=</span><span class="s1">class</span><span class="s0">{</span><span class="s2">constructor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]:{};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">]&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e </span><span class="s1">in </span><span class="s2">t</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">){</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">[</span><span class="s2">e</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;![</span><span class="s3">&quot;boolean&quot;</span><span class="s0">,</span><span class="s3">&quot;number&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula constant </span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">} </span><span class="s3">contains invalid </span><span class="s2">$</span><span class="s0">{</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">} </span><span class="s3">value type`</span><span class="s0">)}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">:</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">assign</span><span class="s0">({[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">]:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constants</span><span class="s0">:{},</span><span class="s2">functions</span><span class="s0">:{}},</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">single</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_parts</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_parse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s2">_parse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Formula missing closing parenthesis&quot;</span><span class="s0">);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">s</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">||</span><span class="s2">n</span><span class="s0">||</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;reference&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;)&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s3">&quot;function&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_subFormula</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s1">void</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;)&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">Parser</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;segment&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">})}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;]&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;reference&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}),</span><span class="s1">void</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;literal&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">operatorCharacters</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">))</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;operator&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">operators</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">+</span><span class="s2">n</span><span class="s0">)?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;operator&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">});</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">numberRx</span><span class="s0">))</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;constant&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)});</span><span class="s1">else if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;constant&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]});</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">tokenRx</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula contains invalid token: </span><span class="s2">$</span><span class="s0">{</span><span class="s2">n</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;reference&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">})}</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">}};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">t of e</span><span class="s0">)</span><span class="s2">i</span><span class="s0">?</span><span class="s2">t</span><span class="s0">===</span><span class="s2">i</span><span class="s0">?(</span><span class="s2">o</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">):</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">:</span><span class="s2">a</span><span class="s0">?</span><span class="s3">&quot;(&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">,++</span><span class="s2">a</span><span class="s0">):</span><span class="s3">&quot;)&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?(--</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">?</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)):</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">:</span><span class="s2">t </span><span class="s1">in </span><span class="s2">r</span><span class="s0">.</span><span class="s2">literals</span><span class="s0">?</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">literals</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]:</span><span class="s3">&quot;(&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">o</span><span class="s0">(),++</span><span class="s2">a</span><span class="s0">):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">operatorCharacters</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?(</span><span class="s2">o</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">()):</span><span class="s3">&quot; &quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">:</span><span class="s2">o</span><span class="s0">();</span><span class="s2">o</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">map</span><span class="s0">(((</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)=&gt;</span><span class="s3">&quot;operator&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;-&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">||</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;operator&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">[</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">].</span><span class="s2">type</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;operator&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s3">&quot;n&quot;</span><span class="s0">}));</span><span class="s1">let </span><span class="s2">l</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">e of s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;operator&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">operatorsPrefix</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">))</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Formula contains an operator in invalid position&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">operators</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula contains an unknown operator </span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s3">`</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Formula missing expected operator&quot;</span><span class="s0">);</span><span class="s2">l</span><span class="s0">=!</span><span class="s2">l</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">l</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Formula contains invalid trailing operator&quot;</span><span class="s0">);</span><span class="s4">1</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;[</span><span class="s3">&quot;reference&quot;</span><span class="s0">,</span><span class="s3">&quot;literal&quot;</span><span class="s0">,</span><span class="s3">&quot;constant&quot;</span><span class="s0">].</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">type</span><span class="s0">)&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">single</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;reference&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">type</span><span class="s0">?</span><span class="s3">&quot;reference&quot;</span><span class="s0">:</span><span class="s3">&quot;value&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">}),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_parts</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;operator&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">operatorsPrefix</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)?</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;reference&quot;</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">tokenRx</span><span class="s0">&amp;&amp;!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">tokenRx</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula contains invalid reference </span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">reference</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">reference</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">reference</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}))}</span><span class="s2">_subFormula</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">.</span><span class="s2">functions</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula contains unknown function </span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s1">let </span><span class="s2">a</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">let </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=()=&gt;{</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">`Formula contains function </span><span class="s2">$</span><span class="s0">{</span><span class="s2">s</span><span class="s0">} </span><span class="s3">with invalid arguments </span><span class="s2">$</span><span class="s0">{</span><span class="s2">e</span><span class="s0">}</span><span class="s3">`</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s2">i</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">===</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">)):</span><span class="s2">a </span><span class="s1">in </span><span class="s2">r</span><span class="s0">.</span><span class="s2">literals</span><span class="s0">&amp;&amp;!</span><span class="s2">n</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">literals</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]):</span><span class="s3">&quot;,&quot;</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">||</span><span class="s2">n</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;(&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">?++</span><span class="s2">n</span><span class="s0">:</span><span class="s3">&quot;)&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">&amp;&amp;--</span><span class="s2">n</span><span class="s0">):</span><span class="s2">o</span><span class="s0">()}</span><span class="s2">o</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">map</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=&gt;</span><span class="s1">new </span><span class="s2">t</span><span class="s0">.</span><span class="s2">Parser</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">settings</span><span class="s0">))),</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">const </span><span class="s2">r of a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">...t</span><span class="s0">)}}</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">const </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_parts</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">2</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">s</span><span class="s0">){</span><span class="s1">const </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;operator&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">const </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">);</span><span class="s1">const </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">single</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">operatorsOrder</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">((</span><span class="s2">s</span><span class="s0">=&gt;{</span><span class="s1">for</span><span class="s0">(</span><span class="s1">let </span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">includes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])){</span><span class="s1">const </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s4">1</span><span class="s0">],</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s4">2</span><span class="s0">);</span><span class="s1">const </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">calculate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s2">o</span><span class="s0">}</span><span class="s1">else </span><span class="s2">n</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">})),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">Parser</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">symbol</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">reference</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">}},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">symbol</span><span class="s0">]?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">evaluate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">e</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">single</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;!&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s2">t</span><span class="s0">;</span><span class="s1">const </span><span class="s2">r</span><span class="s0">=-</span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s2">r</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">calculate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;??&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">exists</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">:</span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;+&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">exists</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">)+(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">exists</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)?</span><span class="s2">s</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s1">else switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;^&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">case</span><span class="s3">&quot;*&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">*</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;/&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">/</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;%&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">%</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;+&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">+</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;-&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">-</span><span class="s2">s</span><span class="s0">}</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;&lt;&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&lt;=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&gt;&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&gt;</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&gt;=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;==&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">===</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;!=&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;&amp;&amp;&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;||&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">t</span><span class="s0">||</span><span class="s2">s</span><span class="s0">}</span><span class="s1">return null</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">exists</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return null</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">}},</span><span class="s4">9926</span><span class="s0">:()=&gt;{},</span><span class="s4">5688</span><span class="s0">:()=&gt;{},</span><span class="s4">9708</span><span class="s0">:()=&gt;{},</span><span class="s4">1152</span><span class="s0">:()=&gt;{},</span><span class="s4">443</span><span class="s0">:()=&gt;{},</span><span class="s4">9848</span><span class="s0">:()=&gt;{},</span><span class="s4">5934</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=&gt;{</span><span class="s3">&quot;use strict&quot;</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s3">'{&quot;version&quot;:&quot;17.11.0&quot;}'</span><span class="s0">)}},</span><span class="s2">t</span><span class="s0">={},</span><span class="s1">function </span><span class="s2">r</span><span class="s0">(</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">;</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]={</span><span class="s2">exports</span><span class="s0">:{}};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">[</span><span class="s2">s</span><span class="s0">](</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">}(</span><span class="s4">5107</span><span class="s0">);</span><span class="s1">var </span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}));</span></pre>
</body>
</html>