<html>
<head>
<title>build.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #cf8e6d;}
.s4 { color: #7a7e85;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #2aacb8;}
.s7 { color: #42c3d4;}
.s8 { color: #67a37c; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
build.js</font>
</center></td></tr></table>
<pre><span class="s0">'use strict'</span><span class="s1">;</span>

<span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">exports</span><span class="s1">, </span><span class="s0">'__esModule'</span><span class="s1">, { </span><span class="s2">value</span><span class="s1">: </span><span class="s3">true </span><span class="s1">});</span>

<span class="s3">var </span><span class="s2">deindent </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'de-indent'</span><span class="s1">);</span>
<span class="s3">var </span><span class="s2">he </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'he'</span><span class="s1">);</span>

<span class="s3">function </span><span class="s2">_interopDefaultLegacy </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) { </span><span class="s3">return </span><span class="s2">e </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">e </span><span class="s1">=== </span><span class="s0">'object' </span><span class="s1">&amp;&amp; </span><span class="s0">'default' </span><span class="s3">in </span><span class="s2">e </span><span class="s1">? </span><span class="s2">e </span><span class="s1">: { </span><span class="s0">'default'</span><span class="s1">: </span><span class="s2">e </span><span class="s1">}; }</span>

<span class="s3">var </span><span class="s2">deindent__default </span><span class="s1">= </span><span class="s4">/*#__PURE__*/</span><span class="s2">_interopDefaultLegacy</span><span class="s1">(</span><span class="s2">deindent</span><span class="s1">);</span>
<span class="s3">var </span><span class="s2">he__default </span><span class="s1">= </span><span class="s4">/*#__PURE__*/</span><span class="s2">_interopDefaultLegacy</span><span class="s1">(</span><span class="s2">he</span><span class="s1">);</span>

<span class="s3">const </span><span class="s2">emptyObject </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">freeze</span><span class="s1">({});</span>
<span class="s3">const </span><span class="s2">isArray </span><span class="s1">= </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">;</span>
<span class="s4">// These helpers produce better VM code in JS engines due to their</span>
<span class="s4">// explicitness and function inlining.</span>
<span class="s3">function </span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">v</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">v </span><span class="s1">=== </span><span class="s2">undefined </span><span class="s1">|| </span><span class="s2">v </span><span class="s1">=== </span><span class="s3">null</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">v</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">v </span><span class="s1">!== </span><span class="s2">undefined </span><span class="s1">&amp;&amp; </span><span class="s2">v </span><span class="s1">!== </span><span class="s3">null</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">v</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">v </span><span class="s1">=== </span><span class="s3">true</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isFalse</span><span class="s1">(</span><span class="s2">v</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">v </span><span class="s1">=== </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Check if value is primitive.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'string' </span><span class="s1">||</span>
        <span class="s3">typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'number' </span><span class="s1">||</span>
        <span class="s4">// $flow-disable-line</span>
        <span class="s3">typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'symbol' </span><span class="s1">||</span>
        <span class="s3">typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'boolean'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">return typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'function'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Quick object check - this is primarily used to tell</span>
 <span class="s5">* objects from primitive values when we know the value</span>
 <span class="s5">* is a JSON-compliant type.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">obj </span><span class="s1">!== </span><span class="s3">null </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">obj </span><span class="s1">=== </span><span class="s0">'object'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Get the raw type string of a value, e.g., [object Object].</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">_toString </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">toRawType</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">_toString</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">value</span><span class="s1">).</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">8</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Strict object type check. Only returns true</span>
 <span class="s5">* for plain JavaScript objects.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">_toString</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) === </span><span class="s0">'[object Object]'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Check if val is a valid array index.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">isValidArrayIndex</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">n </span><span class="s1">= </span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">String</span><span class="s1">(</span><span class="s2">val</span><span class="s1">));</span>
    <span class="s3">return </span><span class="s2">n </span><span class="s1">&gt;= </span><span class="s6">0 </span><span class="s1">&amp;&amp; </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">floor</span><span class="s1">(</span><span class="s2">n</span><span class="s1">) === </span><span class="s2">n </span><span class="s1">&amp;&amp; </span><span class="s2">isFinite</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isPromise</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) &amp;&amp;</span>
        <span class="s3">typeof </span><span class="s2">val</span><span class="s1">.</span><span class="s2">then </span><span class="s1">=== </span><span class="s0">'function' </span><span class="s1">&amp;&amp;</span>
        <span class="s3">typeof </span><span class="s2">val</span><span class="s1">.</span><span class="s2">catch </span><span class="s1">=== </span><span class="s0">'function'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Convert a value to a string that is actually rendered.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">toString</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">val </span><span class="s1">== </span><span class="s3">null</span>
        <span class="s1">? </span><span class="s0">''</span>
        <span class="s1">: </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) || (</span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) &amp;&amp; </span><span class="s2">val</span><span class="s1">.</span><span class="s2">toString </span><span class="s1">=== </span><span class="s2">_toString</span><span class="s1">)</span>
            <span class="s1">? </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s6">2</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s2">String</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Convert an input value to a number for persistence.</span>
 <span class="s5">* If the conversion fails, return original string.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">toNumber</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">n </span><span class="s1">= </span><span class="s2">parseFloat</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">isNaN</span><span class="s1">(</span><span class="s2">n</span><span class="s1">) ? </span><span class="s2">val </span><span class="s1">: </span><span class="s2">n</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Make a map and return a function for checking if a key</span>
 <span class="s5">* is in that map.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s2">str</span><span class="s1">, </span><span class="s2">expectsLowerCase</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">map </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">list </span><span class="s1">= </span><span class="s2">str</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">','</span><span class="s1">);</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">list</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">map</span><span class="s1">[</span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]] = </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">expectsLowerCase </span><span class="s1">? </span><span class="s2">val </span><span class="s1">=&gt; </span><span class="s2">map</span><span class="s1">[</span><span class="s2">val</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">()] : </span><span class="s2">val </span><span class="s1">=&gt; </span><span class="s2">map</span><span class="s1">[</span><span class="s2">val</span><span class="s1">];</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Check if a tag is a built-in tag.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">isBuiltInTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'slot,component'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s5">/**</span>
 <span class="s5">* Check if an attribute is a reserved attribute.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">isReservedAttribute </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'key,ref,slot,slot-scope,is'</span><span class="s1">);</span>
<span class="s5">/**</span>
 <span class="s5">* Check whether an object has the property.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">hasOwnProperty </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">.</span><span class="s2">hasOwnProperty</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">hasOwnProperty</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Create a cached version of a pure function.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">cached</span><span class="s1">(</span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">cache </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
    <span class="s3">return function </span><span class="s2">cachedFn</span><span class="s1">(</span><span class="s2">str</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">hit </span><span class="s1">= </span><span class="s2">cache</span><span class="s1">[</span><span class="s2">str</span><span class="s1">];</span>
        <span class="s3">return </span><span class="s2">hit </span><span class="s1">|| (</span><span class="s2">cache</span><span class="s1">[</span><span class="s2">str</span><span class="s1">] = </span><span class="s2">fn</span><span class="s1">(</span><span class="s2">str</span><span class="s1">));</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Camelize a hyphen-delimited string.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">camelizeRE </span><span class="s1">= </span><span class="s7">/-(\w)/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">camelize </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">((</span><span class="s2">str</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s2">str</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">camelizeRE</span><span class="s1">, (</span><span class="s2">_</span><span class="s1">, </span><span class="s2">c</span><span class="s1">) =&gt; (</span><span class="s2">c </span><span class="s1">? </span><span class="s2">c</span><span class="s1">.</span><span class="s2">toUpperCase</span><span class="s1">() : </span><span class="s0">''</span><span class="s1">));</span>
<span class="s1">});</span>
<span class="s5">/**</span>
 <span class="s5">* Capitalize a string.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">capitalize </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">((</span><span class="s2">str</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s2">str</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s6">0</span><span class="s1">).</span><span class="s2">toUpperCase</span><span class="s1">() + </span><span class="s2">str</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">);</span>
<span class="s1">});</span>
<span class="s5">/**</span>
 <span class="s5">* Hyphenate a camelCase string.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">hyphenateRE </span><span class="s1">= </span><span class="s7">/\B([A-Z])/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">hyphenate </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">((</span><span class="s2">str</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s2">str</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">hyphenateRE</span><span class="s1">, </span><span class="s0">'-$1'</span><span class="s1">).</span><span class="s2">toLowerCase</span><span class="s1">();</span>
<span class="s1">});</span>
<span class="s5">/**</span>
 <span class="s5">* Mix properties into target object.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">extend</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">_from</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">_from</span><span class="s1">) {</span>
        <span class="s2">to</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">_from</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">to</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Merge an Array of Objects into a single Object.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">toObject</span><span class="s1">(</span><span class="s2">arr</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">arr</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">arr</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]) {</span>
            <span class="s2">extend</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">arr</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">/* eslint-disable no-unused-vars */</span>
<span class="s5">/**</span>
 <span class="s5">* Perform no operation.</span>
 <span class="s5">* Stubbing args to make Flow happy without leaving useless transpiled code</span>
 <span class="s5">* with ...rest (https://flow.org/blog/2017/05/07/Strict-Function-Call-Arity/).</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">noop</span><span class="s1">(</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">) { }</span>
<span class="s5">/**</span>
 <span class="s5">* Always return false.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">no </span><span class="s1">= (</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">) =&gt; </span><span class="s3">false</span><span class="s1">;</span>
<span class="s4">/* eslint-enable no-unused-vars */</span>
<span class="s5">/**</span>
 <span class="s5">* Return the same value.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">identity </span><span class="s1">= (</span><span class="s2">_</span><span class="s1">) =&gt; </span><span class="s2">_</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* Generate a string containing static keys from compiler modules.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">genStaticKeys$1</span><span class="s1">(</span><span class="s2">modules</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">modules</span>
        <span class="s1">.</span><span class="s2">reduce</span><span class="s1">((</span><span class="s2">keys</span><span class="s1">, </span><span class="s2">m</span><span class="s1">) =&gt; {</span>
        <span class="s3">return </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">m</span><span class="s1">.</span><span class="s2">staticKeys </span><span class="s1">|| []);</span>
    <span class="s1">}, [])</span>
        <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Check if two values are loosely equal - that is,</span>
 <span class="s5">* if they are plain objects, do they have the same shape?</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">looseEqual</span><span class="s1">(</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">a </span><span class="s1">=== </span><span class="s2">b</span><span class="s1">)</span>
        <span class="s3">return true</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">isObjectA </span><span class="s1">= </span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">isObjectB </span><span class="s1">= </span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">b</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isObjectA </span><span class="s1">&amp;&amp; </span><span class="s2">isObjectB</span><span class="s1">) {</span>
        <span class="s3">try </span><span class="s1">{</span>
            <span class="s3">const </span><span class="s2">isArrayA </span><span class="s1">= </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span>
            <span class="s3">const </span><span class="s2">isArrayB </span><span class="s1">= </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">b</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isArrayA </span><span class="s1">&amp;&amp; </span><span class="s2">isArrayB</span><span class="s1">) {</span>
                <span class="s3">return </span><span class="s1">(</span><span class="s2">a</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s2">b</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">a</span><span class="s1">.</span><span class="s2">every</span><span class="s1">((</span><span class="s2">e</span><span class="s1">, </span><span class="s2">i</span><span class="s1">) =&gt; {</span>
                        <span class="s3">return </span><span class="s2">looseEqual</span><span class="s1">(</span><span class="s2">e</span><span class="s1">, </span><span class="s2">b</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
                    <span class="s1">}));</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">a </span><span class="s3">instanceof </span><span class="s2">Date </span><span class="s1">&amp;&amp; </span><span class="s2">b </span><span class="s3">instanceof </span><span class="s2">Date</span><span class="s1">) {</span>
                <span class="s3">return </span><span class="s2">a</span><span class="s1">.</span><span class="s2">getTime</span><span class="s1">() === </span><span class="s2">b</span><span class="s1">.</span><span class="s2">getTime</span><span class="s1">();</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(!</span><span class="s2">isArrayA </span><span class="s1">&amp;&amp; !</span><span class="s2">isArrayB</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">keysA </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">a</span><span class="s1">);</span>
                <span class="s3">const </span><span class="s2">keysB </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">b</span><span class="s1">);</span>
                <span class="s3">return </span><span class="s1">(</span><span class="s2">keysA</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s2">keysB</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">keysA</span><span class="s1">.</span><span class="s2">every</span><span class="s1">(</span><span class="s2">key </span><span class="s1">=&gt; {</span>
                        <span class="s3">return </span><span class="s2">looseEqual</span><span class="s1">(</span><span class="s2">a</span><span class="s1">[</span><span class="s2">key</span><span class="s1">], </span><span class="s2">b</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]);</span>
                    <span class="s1">}));</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s4">/* istanbul ignore next */</span>
                <span class="s3">return false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
            <span class="s4">/* istanbul ignore next */</span>
            <span class="s3">return false</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(!</span><span class="s2">isObjectA </span><span class="s1">&amp;&amp; !</span><span class="s2">isObjectB</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">String</span><span class="s1">(</span><span class="s2">a</span><span class="s1">) === </span><span class="s2">String</span><span class="s1">(</span><span class="s2">b</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return false</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Return the first index at which a loosely equal value can be</span>
 <span class="s5">* found in the array (if value is a plain object, the array must</span>
 <span class="s5">* contain an object of the same shape), or -1 if it is not present.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">looseIndexOf</span><span class="s1">(</span><span class="s2">arr</span><span class="s1">, </span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">arr</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">looseEqual</span><span class="s1">(</span><span class="s2">arr</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">val</span><span class="s1">))</span>
            <span class="s3">return </span><span class="s2">i</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">-</span><span class="s6">1</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#polyfill</span>
<span class="s3">function </span><span class="s2">hasChanged</span><span class="s1">(</span><span class="s2">x</span><span class="s1">, </span><span class="s2">y</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">x </span><span class="s1">=== </span><span class="s2">y</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">x </span><span class="s1">=== </span><span class="s6">0 </span><span class="s1">&amp;&amp; </span><span class="s6">1 </span><span class="s1">/ </span><span class="s2">x </span><span class="s1">!== </span><span class="s6">1 </span><span class="s1">/ </span><span class="s2">y</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">x </span><span class="s1">=== </span><span class="s2">x </span><span class="s1">|| </span><span class="s2">y </span><span class="s1">=== </span><span class="s2">y</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">isUnaryTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'area,base,br,col,embed,frame,hr,img,input,isindex,keygen,' </span><span class="s1">+</span>
    <span class="s0">'link,meta,param,source,track,wbr'</span><span class="s1">);</span>
<span class="s4">// Elements that you can, intentionally, leave open</span>
<span class="s4">// (and which close themselves)</span>
<span class="s3">const </span><span class="s2">canBeLeftOpenTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source'</span><span class="s1">);</span>
<span class="s4">// HTML5 tags https://html.spec.whatwg.org/multipage/indices.html#elements-3</span>
<span class="s4">// Phrasing Content https://html.spec.whatwg.org/multipage/dom.html#phrasing-content</span>
<span class="s3">const </span><span class="s2">isNonPhrasingTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'address,article,aside,base,blockquote,body,caption,col,colgroup,dd,' </span><span class="s1">+</span>
    <span class="s0">'details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,' </span><span class="s1">+</span>
    <span class="s0">'h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,' </span><span class="s1">+</span>
    <span class="s0">'optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,' </span><span class="s1">+</span>
    <span class="s0">'title,tr,track'</span><span class="s1">);</span>

<span class="s5">/**</span>
 <span class="s5">* unicode letters used for parsing html tags, component names and property paths.</span>
 <span class="s5">* using https://www.w3.org/TR/html53/semantics-scripting.html#potentialcustomelementname</span>
 <span class="s5">* skipping \u10000-\uEFFFF due to it freezing up PhantomJS</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">unicodeRegExp </span><span class="s1">= </span><span class="s7">/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* Define a property.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">def</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">val</span><span class="s1">, </span><span class="s2">enumerable</span><span class="s1">) {</span>
    <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, {</span>
        <span class="s2">value</span><span class="s1">: </span><span class="s2">val</span><span class="s1">,</span>
        <span class="s2">enumerable</span><span class="s1">: !!</span><span class="s2">enumerable</span><span class="s1">,</span>
        <span class="s2">writable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">configurable</span><span class="s1">: </span><span class="s3">true</span>
    <span class="s1">});</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Not type-checking this file because it's mostly vendor code.</span>
 <span class="s5">*/</span>
<span class="s4">// Regular Expressions for parsing tags and attributes</span>
<span class="s3">const </span><span class="s2">attribute </span><span class="s1">= </span><span class="s7">/^\s*([^\s&quot;'&lt;&gt;\/=]+)(?:\s*(=)\s*(?:&quot;([^&quot;]*)&quot;+|'([^']*)'+|([^\s&quot;'=&lt;&gt;`]+)))?/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">dynamicArgAttribute </span><span class="s1">= </span><span class="s7">/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+?\][^\s&quot;'&lt;&gt;\/=]*)(?:\s*(=)\s*(?:&quot;([^&quot;]*)&quot;+|'([^']*)'+|([^\s&quot;'=&lt;&gt;`]+)))?/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">ncname </span><span class="s1">= </span><span class="s0">`[a-zA-Z_][</span><span class="s3">\\</span><span class="s0">-</span><span class="s3">\\</span><span class="s0">.0-9_a-zA-Z</span><span class="s2">$</span><span class="s1">{</span><span class="s2">unicodeRegExp</span><span class="s1">.</span><span class="s2">source</span><span class="s1">}</span><span class="s0">]*`</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">qnameCapture </span><span class="s1">= </span><span class="s0">`((?:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ncname</span><span class="s1">}</span><span class="s3">\\</span><span class="s0">:)?</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ncname</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">startTagOpen </span><span class="s1">= </span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">qnameCapture</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">startTagClose </span><span class="s1">= </span><span class="s7">/^\s*(\/?)&gt;/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">endTag </span><span class="s1">= </span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^&lt;</span><span class="s3">\\</span><span class="s0">/</span><span class="s2">$</span><span class="s1">{</span><span class="s2">qnameCapture</span><span class="s1">}</span><span class="s0">[^&gt;]*&gt;`</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">doctype </span><span class="s1">= </span><span class="s7">/^&lt;!DOCTYPE [^&gt;]+&gt;/i</span><span class="s1">;</span>
<span class="s4">// #7298: escape - to avoid being passed as HTML comment when inlined in page</span>
<span class="s3">const </span><span class="s2">comment </span><span class="s1">= </span><span class="s7">/^&lt;!\--/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">conditionalComment </span><span class="s1">= </span><span class="s7">/^&lt;!\[/</span><span class="s1">;</span>
<span class="s4">// Special Elements (can contain anything)</span>
<span class="s3">const </span><span class="s2">isPlainTextElement </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'script,style,textarea'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">reCache </span><span class="s1">= {};</span>
<span class="s3">const </span><span class="s2">decodingMap </span><span class="s1">= {</span>
    <span class="s0">'&amp;lt;'</span><span class="s1">: </span><span class="s0">'&lt;'</span><span class="s1">,</span>
    <span class="s0">'&amp;gt;'</span><span class="s1">: </span><span class="s0">'&gt;'</span><span class="s1">,</span>
    <span class="s0">'&amp;quot;'</span><span class="s1">: </span><span class="s0">'&quot;'</span><span class="s1">,</span>
    <span class="s0">'&amp;amp;'</span><span class="s1">: </span><span class="s0">'&amp;'</span><span class="s1">,</span>
    <span class="s0">'&amp;#10;'</span><span class="s1">: </span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">,</span>
    <span class="s0">'&amp;#9;'</span><span class="s1">: </span><span class="s0">'</span><span class="s3">\t</span><span class="s0">'</span><span class="s1">,</span>
    <span class="s0">'&amp;#39;'</span><span class="s1">: </span><span class="s0">&quot;'&quot;</span>
<span class="s1">};</span>
<span class="s3">const </span><span class="s2">encodedAttr </span><span class="s1">= </span><span class="s7">/&amp;(?:lt|gt|quot|amp|#39);/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">encodedAttrWithNewLines </span><span class="s1">= </span><span class="s7">/&amp;(?:lt|gt|quot|amp|#39|#10|#9);/g</span><span class="s1">;</span>
<span class="s4">// #5992</span>
<span class="s3">const </span><span class="s2">isIgnoreNewlineTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'pre,textarea'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">shouldIgnoreFirstNewline </span><span class="s1">= (</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">html</span><span class="s1">) =&gt; </span><span class="s2">tag </span><span class="s1">&amp;&amp; </span><span class="s2">isIgnoreNewlineTag</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">) &amp;&amp; </span><span class="s2">html</span><span class="s1">[</span><span class="s6">0</span><span class="s1">] === </span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">decodeAttr</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">shouldDecodeNewlines</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">re </span><span class="s1">= </span><span class="s2">shouldDecodeNewlines </span><span class="s1">? </span><span class="s2">encodedAttrWithNewLines </span><span class="s1">: </span><span class="s2">encodedAttr</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">value</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">re</span><span class="s1">, </span><span class="s2">match </span><span class="s1">=&gt; </span><span class="s2">decodingMap</span><span class="s1">[</span><span class="s2">match</span><span class="s1">]);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">parseHTML</span><span class="s1">(</span><span class="s2">html</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">stack </span><span class="s1">= [];</span>
    <span class="s3">const </span><span class="s2">expectHTML </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">expectHTML</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">isUnaryTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isUnaryTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">canBeLeftOpenTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">canBeLeftOpenTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">index </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">last</span><span class="s1">, </span><span class="s2">lastTag</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">html</span><span class="s1">) {</span>
        <span class="s2">last </span><span class="s1">= </span><span class="s2">html</span><span class="s1">;</span>
        <span class="s4">// Make sure we're not in a plaintext content element like script/style</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">lastTag </span><span class="s1">|| !</span><span class="s2">isPlainTextElement</span><span class="s1">(</span><span class="s2">lastTag</span><span class="s1">)) {</span>
            <span class="s3">let </span><span class="s2">textEnd </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'&lt;'</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">textEnd </span><span class="s1">=== </span><span class="s6">0</span><span class="s1">) {</span>
                <span class="s4">// Comment:</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">comment</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">html</span><span class="s1">)) {</span>
                    <span class="s3">const </span><span class="s2">commentEnd </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'--&gt;'</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">commentEnd </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">) {</span>
                        <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">shouldKeepComment </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">comment</span><span class="s1">) {</span>
                            <span class="s2">options</span><span class="s1">.</span><span class="s2">comment</span><span class="s1">(</span><span class="s2">html</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s6">4</span><span class="s1">, </span><span class="s2">commentEnd</span><span class="s1">), </span><span class="s2">index</span><span class="s1">, </span><span class="s2">index </span><span class="s1">+ </span><span class="s2">commentEnd </span><span class="s1">+ </span><span class="s6">3</span><span class="s1">);</span>
                        <span class="s1">}</span>
                        <span class="s2">advance</span><span class="s1">(</span><span class="s2">commentEnd </span><span class="s1">+ </span><span class="s6">3</span><span class="s1">);</span>
                        <span class="s3">continue</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s4">// http://en.wikipedia.org/wiki/Conditional_comment#Downlevel-revealed_conditional_comment</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">conditionalComment</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">html</span><span class="s1">)) {</span>
                    <span class="s3">const </span><span class="s2">conditionalEnd </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">']&gt;'</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">conditionalEnd </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">) {</span>
                        <span class="s2">advance</span><span class="s1">(</span><span class="s2">conditionalEnd </span><span class="s1">+ </span><span class="s6">2</span><span class="s1">);</span>
                        <span class="s3">continue</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s4">// Doctype:</span>
                <span class="s3">const </span><span class="s2">doctypeMatch </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">doctype</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">doctypeMatch</span><span class="s1">) {</span>
                    <span class="s2">advance</span><span class="s1">(</span><span class="s2">doctypeMatch</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">);</span>
                    <span class="s3">continue</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s4">// End tag:</span>
                <span class="s3">const </span><span class="s2">endTagMatch </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">endTag</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">endTagMatch</span><span class="s1">) {</span>
                    <span class="s3">const </span><span class="s2">curIndex </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
                    <span class="s2">advance</span><span class="s1">(</span><span class="s2">endTagMatch</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">);</span>
                    <span class="s2">parseEndTag</span><span class="s1">(</span><span class="s2">endTagMatch</span><span class="s1">[</span><span class="s6">1</span><span class="s1">], </span><span class="s2">curIndex</span><span class="s1">, </span><span class="s2">index</span><span class="s1">);</span>
                    <span class="s3">continue</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s4">// Start tag:</span>
                <span class="s3">const </span><span class="s2">startTagMatch </span><span class="s1">= </span><span class="s2">parseStartTag</span><span class="s1">();</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">startTagMatch</span><span class="s1">) {</span>
                    <span class="s2">handleStartTag</span><span class="s1">(</span><span class="s2">startTagMatch</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">shouldIgnoreFirstNewline</span><span class="s1">(</span><span class="s2">startTagMatch</span><span class="s1">.</span><span class="s2">tagName</span><span class="s1">, </span><span class="s2">html</span><span class="s1">)) {</span>
                        <span class="s2">advance</span><span class="s1">(</span><span class="s6">1</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">continue</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">let </span><span class="s2">text</span><span class="s1">, </span><span class="s2">rest</span><span class="s1">, </span><span class="s2">next</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">textEnd </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">) {</span>
                <span class="s2">rest </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">textEnd</span><span class="s1">);</span>
                <span class="s3">while </span><span class="s1">(!</span><span class="s2">endTag</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">rest</span><span class="s1">) &amp;&amp;</span>
                    <span class="s1">!</span><span class="s2">startTagOpen</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">rest</span><span class="s1">) &amp;&amp;</span>
                    <span class="s1">!</span><span class="s2">comment</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">rest</span><span class="s1">) &amp;&amp;</span>
                    <span class="s1">!</span><span class="s2">conditionalComment</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">rest</span><span class="s1">)) {</span>
                    <span class="s4">// &lt; in plain text, be forgiving and treat it as text</span>
                    <span class="s2">next </span><span class="s1">= </span><span class="s2">rest</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'&lt;'</span><span class="s1">, </span><span class="s6">1</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">next </span><span class="s1">&lt; </span><span class="s6">0</span><span class="s1">)</span>
                        <span class="s3">break</span><span class="s1">;</span>
                    <span class="s2">textEnd </span><span class="s1">+= </span><span class="s2">next</span><span class="s1">;</span>
                    <span class="s2">rest </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">textEnd</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">textEnd</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">textEnd </span><span class="s1">&lt; </span><span class="s6">0</span><span class="s1">) {</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">html</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">text</span><span class="s1">) {</span>
                <span class="s2">advance</span><span class="s1">(</span><span class="s2">text</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">chars </span><span class="s1">&amp;&amp; </span><span class="s2">text</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">chars</span><span class="s1">(</span><span class="s2">text</span><span class="s1">, </span><span class="s2">index </span><span class="s1">- </span><span class="s2">text</span><span class="s1">.</span><span class="s2">length</span><span class="s1">, </span><span class="s2">index</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">let </span><span class="s2">endTagLength </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">stackedTag </span><span class="s1">= </span><span class="s2">lastTag</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
            <span class="s3">const </span><span class="s2">reStackedTag </span><span class="s1">= </span><span class="s2">reCache</span><span class="s1">[</span><span class="s2">stackedTag</span><span class="s1">] ||</span>
                <span class="s1">(</span><span class="s2">reCache</span><span class="s1">[</span><span class="s2">stackedTag</span><span class="s1">] = </span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">'([</span><span class="s3">\\</span><span class="s0">s</span><span class="s3">\\</span><span class="s0">S]*?)(&lt;/' </span><span class="s1">+ </span><span class="s2">stackedTag </span><span class="s1">+ </span><span class="s0">'[^&gt;]*&gt;)'</span><span class="s1">, </span><span class="s0">'i'</span><span class="s1">));</span>
            <span class="s3">const </span><span class="s2">rest </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">reStackedTag</span><span class="s1">, </span><span class="s3">function </span><span class="s1">(</span><span class="s2">all</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">endTag</span><span class="s1">) {</span>
                <span class="s2">endTagLength </span><span class="s1">= </span><span class="s2">endTag</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(!</span><span class="s2">isPlainTextElement</span><span class="s1">(</span><span class="s2">stackedTag</span><span class="s1">) &amp;&amp; </span><span class="s2">stackedTag </span><span class="s1">!== </span><span class="s0">'noscript'</span><span class="s1">) {</span>
                    <span class="s2">text </span><span class="s1">= </span><span class="s2">text</span>
                        <span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/&lt;!\--([\s\S]*?)--&gt;/g</span><span class="s1">, </span><span class="s0">'$1'</span><span class="s1">) </span><span class="s4">// #7298</span>
                        <span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/&lt;!\[CDATA\[([\s\S]*?)]]&gt;/g</span><span class="s1">, </span><span class="s0">'$1'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">shouldIgnoreFirstNewline</span><span class="s1">(</span><span class="s2">stackedTag</span><span class="s1">, </span><span class="s2">text</span><span class="s1">)) {</span>
                    <span class="s2">text </span><span class="s1">= </span><span class="s2">text</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">chars</span><span class="s1">) {</span>
                    <span class="s2">options</span><span class="s1">.</span><span class="s2">chars</span><span class="s1">(</span><span class="s2">text</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">return </span><span class="s0">''</span><span class="s1">;</span>
            <span class="s1">});</span>
            <span class="s2">index </span><span class="s1">+= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s2">rest</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
            <span class="s2">html </span><span class="s1">= </span><span class="s2">rest</span><span class="s1">;</span>
            <span class="s2">parseEndTag</span><span class="s1">(</span><span class="s2">stackedTag</span><span class="s1">, </span><span class="s2">index </span><span class="s1">- </span><span class="s2">endTagLength</span><span class="s1">, </span><span class="s2">index</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">html </span><span class="s1">=== </span><span class="s2">last</span><span class="s1">) {</span>
            <span class="s2">options</span><span class="s1">.</span><span class="s2">chars </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">chars</span><span class="s1">(</span><span class="s2">html</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; !</span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">`Mal-formatted tag at end of template: &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">html</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, {</span>
                    <span class="s2">start</span><span class="s1">: </span><span class="s2">index </span><span class="s1">+ </span><span class="s2">html</span><span class="s1">.</span><span class="s2">length</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// Clean up any remaining tags</span>
    <span class="s2">parseEndTag</span><span class="s1">();</span>
    <span class="s3">function </span><span class="s2">advance</span><span class="s1">(</span><span class="s2">n</span><span class="s1">) {</span>
        <span class="s2">index </span><span class="s1">+= </span><span class="s2">n</span><span class="s1">;</span>
        <span class="s2">html </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s2">n</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">parseStartTag</span><span class="s1">() {</span>
        <span class="s3">const </span><span class="s2">start </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">startTagOpen</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">start</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">match </span><span class="s1">= {</span>
                <span class="s2">tagName</span><span class="s1">: </span><span class="s2">start</span><span class="s1">[</span><span class="s6">1</span><span class="s1">],</span>
                <span class="s2">attrs</span><span class="s1">: [],</span>
                <span class="s2">start</span><span class="s1">: </span><span class="s2">index</span>
            <span class="s1">};</span>
            <span class="s2">advance</span><span class="s1">(</span><span class="s2">start</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">);</span>
            <span class="s3">let </span><span class="s2">end</span><span class="s1">, </span><span class="s2">attr</span><span class="s1">;</span>
            <span class="s3">while </span><span class="s1">(!(</span><span class="s2">end </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">startTagClose</span><span class="s1">)) &amp;&amp;</span>
                <span class="s1">(</span><span class="s2">attr </span><span class="s1">= </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">dynamicArgAttribute</span><span class="s1">) || </span><span class="s2">html</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">attribute</span><span class="s1">))) {</span>
                <span class="s2">attr</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
                <span class="s2">advance</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">);</span>
                <span class="s2">attr</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
                <span class="s2">match</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">end</span><span class="s1">) {</span>
                <span class="s2">match</span><span class="s1">.</span><span class="s2">unarySlash </span><span class="s1">= </span><span class="s2">end</span><span class="s1">[</span><span class="s6">1</span><span class="s1">];</span>
                <span class="s2">advance</span><span class="s1">(</span><span class="s2">end</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">);</span>
                <span class="s2">match</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
                <span class="s3">return </span><span class="s2">match</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">handleStartTag</span><span class="s1">(</span><span class="s2">match</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">tagName </span><span class="s1">= </span><span class="s2">match</span><span class="s1">.</span><span class="s2">tagName</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">unarySlash </span><span class="s1">= </span><span class="s2">match</span><span class="s1">.</span><span class="s2">unarySlash</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">expectHTML</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">lastTag </span><span class="s1">=== </span><span class="s0">'p' </span><span class="s1">&amp;&amp; </span><span class="s2">isNonPhrasingTag</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">)) {</span>
                <span class="s2">parseEndTag</span><span class="s1">(</span><span class="s2">lastTag</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">canBeLeftOpenTag</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">) &amp;&amp; </span><span class="s2">lastTag </span><span class="s1">=== </span><span class="s2">tagName</span><span class="s1">) {</span>
                <span class="s2">parseEndTag</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">const </span><span class="s2">unary </span><span class="s1">= </span><span class="s2">isUnaryTag</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">) || !!</span><span class="s2">unarySlash</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">l </span><span class="s1">= </span><span class="s2">match</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">attrs </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">l</span><span class="s1">);</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">args </span><span class="s1">= </span><span class="s2">match</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">args</span><span class="s1">[</span><span class="s6">3</span><span class="s1">] || </span><span class="s2">args</span><span class="s1">[</span><span class="s6">4</span><span class="s1">] || </span><span class="s2">args</span><span class="s1">[</span><span class="s6">5</span><span class="s1">] || </span><span class="s0">''</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">shouldDecodeNewlines </span><span class="s1">= </span><span class="s2">tagName </span><span class="s1">=== </span><span class="s0">'a' </span><span class="s1">&amp;&amp; </span><span class="s2">args</span><span class="s1">[</span><span class="s6">1</span><span class="s1">] === </span><span class="s0">'href'</span>
                <span class="s1">? </span><span class="s2">options</span><span class="s1">.</span><span class="s2">shouldDecodeNewlinesForHref</span>
                <span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">shouldDecodeNewlines</span><span class="s1">;</span>
            <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = {</span>
                <span class="s2">name</span><span class="s1">: </span><span class="s2">args</span><span class="s1">[</span><span class="s6">1</span><span class="s1">],</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s2">decodeAttr</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">shouldDecodeNewlines</span><span class="s1">)</span>
            <span class="s1">};</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">start </span><span class="s1">= </span><span class="s2">args</span><span class="s1">.</span><span class="s2">start </span><span class="s1">+ </span><span class="s2">args</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">match</span><span class="s1">(</span><span class="s7">/^\s*/</span><span class="s1">).</span><span class="s2">length</span><span class="s1">;</span>
                <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">end </span><span class="s1">= </span><span class="s2">args</span><span class="s1">.</span><span class="s2">end</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">unary</span><span class="s1">) {</span>
            <span class="s2">stack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span>
                <span class="s2">tag</span><span class="s1">: </span><span class="s2">tagName</span><span class="s1">,</span>
                <span class="s2">lowerCasedTag</span><span class="s1">: </span><span class="s2">tagName</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">(),</span>
                <span class="s2">attrs</span><span class="s1">: </span><span class="s2">attrs</span><span class="s1">,</span>
                <span class="s2">start</span><span class="s1">: </span><span class="s2">match</span><span class="s1">.</span><span class="s2">start</span><span class="s1">,</span>
                <span class="s2">end</span><span class="s1">: </span><span class="s2">match</span><span class="s1">.</span><span class="s2">end</span>
            <span class="s1">});</span>
            <span class="s2">lastTag </span><span class="s1">= </span><span class="s2">tagName</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">) {</span>
            <span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">unary</span><span class="s1">, </span><span class="s2">match</span><span class="s1">.</span><span class="s2">start</span><span class="s1">, </span><span class="s2">match</span><span class="s1">.</span><span class="s2">end</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">parseEndTag</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
        <span class="s3">let </span><span class="s2">pos</span><span class="s1">, </span><span class="s2">lowerCasedTagName</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">start </span><span class="s1">== </span><span class="s3">null</span><span class="s1">)</span>
            <span class="s2">start </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">end </span><span class="s1">== </span><span class="s3">null</span><span class="s1">)</span>
            <span class="s2">end </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
        <span class="s4">// Find the closest opened tag of the same type</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">) {</span>
            <span class="s2">lowerCasedTagName </span><span class="s1">= </span><span class="s2">tagName</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s2">pos </span><span class="s1">= </span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">; </span><span class="s2">pos </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">pos</span><span class="s1">--) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">stack</span><span class="s1">[</span><span class="s2">pos</span><span class="s1">].</span><span class="s2">lowerCasedTag </span><span class="s1">=== </span><span class="s2">lowerCasedTagName</span><span class="s1">) {</span>
                    <span class="s3">break</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// If no tag name is provided, clean shop</span>
            <span class="s2">pos </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">pos </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">) {</span>
            <span class="s4">// Close all the open elements, up the stack</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&gt;= </span><span class="s2">pos</span><span class="s1">; </span><span class="s2">i</span><span class="s1">--) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; (</span><span class="s2">i </span><span class="s1">&gt; </span><span class="s2">pos </span><span class="s1">|| !</span><span class="s2">tagName</span><span class="s1">) &amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">) {</span>
                    <span class="s2">options</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">`tag &lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">stack</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt; has no matching end tag.`</span><span class="s1">, {</span>
                        <span class="s2">start</span><span class="s1">: </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">start</span><span class="s1">,</span>
                        <span class="s2">end</span><span class="s1">: </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">end</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">end</span><span class="s1">) {</span>
                    <span class="s2">options</span><span class="s1">.</span><span class="s2">end</span><span class="s1">(</span><span class="s2">stack</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s4">// Remove the open elements from the stack</span>
            <span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">= </span><span class="s2">pos</span><span class="s1">;</span>
            <span class="s2">lastTag </span><span class="s1">= </span><span class="s2">pos </span><span class="s1">&amp;&amp; </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">pos </span><span class="s1">- </span><span class="s6">1</span><span class="s1">].</span><span class="s2">tag</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">lowerCasedTagName </span><span class="s1">=== </span><span class="s0">'br'</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">, [], </span><span class="s3">true</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">lowerCasedTagName </span><span class="s1">=== </span><span class="s0">'p'</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">start</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">, [], </span><span class="s3">false</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">end</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">end</span><span class="s1">(</span><span class="s2">tagName</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">DEFAULT_FILENAME </span><span class="s1">= </span><span class="s0">'anonymous.vue'</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">splitRE </span><span class="s1">= </span><span class="s7">/\r?\n/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">replaceRE </span><span class="s1">= </span><span class="s7">/./g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">isSpecialTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'script,style,template'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s5">/**</span>
 <span class="s5">* Parse a single-file component (*.vue) file into an SFC Descriptor Object.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">parseComponent</span><span class="s1">(</span><span class="s2">source</span><span class="s1">, </span><span class="s2">options </span><span class="s1">= {}) {</span>
    <span class="s3">const </span><span class="s2">sfc </span><span class="s1">= {</span>
        <span class="s2">source</span><span class="s1">,</span>
        <span class="s2">filename</span><span class="s1">: </span><span class="s2">DEFAULT_FILENAME</span><span class="s1">,</span>
        <span class="s2">template</span><span class="s1">: </span><span class="s3">null</span><span class="s1">,</span>
        <span class="s2">script</span><span class="s1">: </span><span class="s3">null</span><span class="s1">,</span>
        <span class="s2">scriptSetup</span><span class="s1">: </span><span class="s3">null</span><span class="s1">,</span>
        <span class="s2">styles</span><span class="s1">: [],</span>
        <span class="s2">customBlocks</span><span class="s1">: [],</span>
        <span class="s2">cssVars</span><span class="s1">: [],</span>
        <span class="s2">errors</span><span class="s1">: [],</span>
        <span class="s2">shouldForceReload</span><span class="s1">: </span><span class="s3">null </span><span class="s4">// attached in parse() by compiler-sfc</span>
    <span class="s1">};</span>
    <span class="s3">let </span><span class="s2">depth </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">currentBlock </span><span class="s1">= </span><span class="s3">null</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">warn </span><span class="s1">= </span><span class="s2">msg </span><span class="s1">=&gt; {</span>
        <span class="s2">sfc</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">);</span>
    <span class="s1">};</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
        <span class="s2">warn </span><span class="s1">= (</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) =&gt; {</span>
            <span class="s3">const </span><span class="s2">data </span><span class="s1">= { </span><span class="s2">msg </span><span class="s1">};</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">start </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
                <span class="s2">data</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">start</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">end </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
                <span class="s2">data</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">end</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">sfc</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">start</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">unary</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">depth </span><span class="s1">=== </span><span class="s6">0</span><span class="s1">) {</span>
            <span class="s2">currentBlock </span><span class="s1">= {</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s2">tag</span><span class="s1">,</span>
                <span class="s2">content</span><span class="s1">: </span><span class="s0">''</span><span class="s1">,</span>
                <span class="s2">start</span><span class="s1">: </span><span class="s2">end</span><span class="s1">,</span>
                <span class="s2">end</span><span class="s1">: </span><span class="s6">0</span><span class="s1">,</span>
                <span class="s2">attrs</span><span class="s1">: </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">reduce</span><span class="s1">((</span><span class="s2">cumulated</span><span class="s1">, { </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value </span><span class="s1">}) =&gt; {</span>
                    <span class="s2">cumulated</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">value </span><span class="s1">|| </span><span class="s3">true</span><span class="s1">;</span>
                    <span class="s3">return </span><span class="s2">cumulated</span><span class="s1">;</span>
                <span class="s1">}, {})</span>
            <span class="s1">};</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">src </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
                <span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">src </span><span class="s1">= </span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">src</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isSpecialTag</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">)) {</span>
                <span class="s2">checkAttrs</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'script'</span><span class="s1">) {</span>
                    <span class="s3">const </span><span class="s2">block </span><span class="s1">= </span><span class="s2">currentBlock</span><span class="s1">;</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">block</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">setup</span><span class="s1">) {</span>
                        <span class="s2">block</span><span class="s1">.</span><span class="s2">setup </span><span class="s1">= </span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">setup</span><span class="s1">;</span>
                        <span class="s2">sfc</span><span class="s1">.</span><span class="s2">scriptSetup </span><span class="s1">= </span><span class="s2">block</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s3">else </span><span class="s1">{</span>
                        <span class="s2">sfc</span><span class="s1">.</span><span class="s2">script </span><span class="s1">= </span><span class="s2">block</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s3">else if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'style'</span><span class="s1">) {</span>
                    <span class="s2">sfc</span><span class="s1">.</span><span class="s2">styles</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">sfc</span><span class="s1">[</span><span class="s2">tag</span><span class="s1">] = </span><span class="s2">currentBlock</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s4">// custom blocks</span>
                <span class="s2">sfc</span><span class="s1">.</span><span class="s2">customBlocks</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">unary</span><span class="s1">) {</span>
            <span class="s2">depth</span><span class="s1">++;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">checkAttrs</span><span class="s1">(</span><span class="s2">block</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">attr </span><span class="s1">= </span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'lang'</span><span class="s1">) {</span>
                <span class="s2">block</span><span class="s1">.</span><span class="s2">lang </span><span class="s1">= </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'scoped'</span><span class="s1">) {</span>
                <span class="s2">block</span><span class="s1">.</span><span class="s2">scoped </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'module'</span><span class="s1">) {</span>
                <span class="s2">block</span><span class="s1">.</span><span class="s2">module </span><span class="s1">= </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">value </span><span class="s1">|| </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">end</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">start</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">depth </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp; </span><span class="s2">currentBlock</span><span class="s1">) {</span>
            <span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">start</span><span class="s1">;</span>
            <span class="s3">let </span><span class="s2">text </span><span class="s1">= </span><span class="s2">source</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">start</span><span class="s1">, </span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">end</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">deindent </span><span class="s1">=== </span><span class="s3">true </span><span class="s1">||</span>
                <span class="s4">// by default, deindent unless it's script with default lang or (j/t)sx?</span>
                <span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">deindent </span><span class="s1">!== </span><span class="s3">false </span><span class="s1">&amp;&amp;</span>
                    <span class="s1">!(</span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'script' </span><span class="s1">&amp;&amp;</span>
                        <span class="s1">(!</span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">lang </span><span class="s1">|| </span><span class="s7">/^(j|t)sx?$/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">lang</span><span class="s1">))))) {</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">deindent__default</span><span class="s1">[</span><span class="s0">&quot;default&quot;</span><span class="s1">](</span><span class="s2">text</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s4">// pad content so that linters and pre-processors can output correct</span>
            <span class="s4">// line numbers in errors and warnings</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">type </span><span class="s1">!== </span><span class="s0">'template' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">pad</span><span class="s1">) {</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">padContent</span><span class="s1">(</span><span class="s2">currentBlock</span><span class="s1">, </span><span class="s2">options</span><span class="s1">.</span><span class="s2">pad</span><span class="s1">) + </span><span class="s2">text</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">currentBlock</span><span class="s1">.</span><span class="s2">content </span><span class="s1">= </span><span class="s2">text</span><span class="s1">;</span>
            <span class="s2">currentBlock </span><span class="s1">= </span><span class="s3">null</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">depth</span><span class="s1">--;</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">padContent</span><span class="s1">(</span><span class="s2">block</span><span class="s1">, </span><span class="s2">pad</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">pad </span><span class="s1">=== </span><span class="s0">'space'</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">source</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">block</span><span class="s1">.</span><span class="s2">start</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">replaceRE</span><span class="s1">, </span><span class="s0">' '</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">const </span><span class="s2">offset </span><span class="s1">= </span><span class="s2">source</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">block</span><span class="s1">.</span><span class="s2">start</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s2">splitRE</span><span class="s1">).</span><span class="s2">length</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">padChar </span><span class="s1">= </span><span class="s2">block</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'script' </span><span class="s1">&amp;&amp; !</span><span class="s2">block</span><span class="s1">.</span><span class="s2">lang </span><span class="s1">? </span><span class="s0">'//</span><span class="s3">\n</span><span class="s0">' </span><span class="s1">: </span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">;</span>
            <span class="s3">return </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">offset</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s2">padChar</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">parseHTML</span><span class="s1">(</span><span class="s2">source</span><span class="s1">, {</span>
        <span class="s2">warn</span><span class="s1">,</span>
        <span class="s2">start</span><span class="s1">,</span>
        <span class="s2">end</span><span class="s1">,</span>
        <span class="s2">outputSourceRange</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span>
    <span class="s1">});</span>
    <span class="s3">return </span><span class="s2">sfc</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s4">// can we use __proto__?</span>
<span class="s3">const </span><span class="s2">hasProto </span><span class="s1">= </span><span class="s0">'__proto__' </span><span class="s3">in </span><span class="s1">{};</span>
<span class="s4">// Browser environment sniffing</span>
<span class="s3">const </span><span class="s2">inBrowser </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">window </span><span class="s1">!== </span><span class="s0">'undefined'</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">UA </span><span class="s1">= </span><span class="s2">inBrowser </span><span class="s1">&amp;&amp; </span><span class="s2">window</span><span class="s1">.</span><span class="s2">navigator</span><span class="s1">.</span><span class="s2">userAgent</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
<span class="s3">const </span><span class="s2">isIE </span><span class="s1">= </span><span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s7">/msie|trident/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">UA</span><span class="s1">);</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s2">UA</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'msie 9.0'</span><span class="s1">) &gt; </span><span class="s6">0</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">isEdge </span><span class="s1">= </span><span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s2">UA</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'edge/'</span><span class="s1">) &gt; </span><span class="s6">0</span><span class="s1">;</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s2">UA</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'android'</span><span class="s1">) &gt; </span><span class="s6">0</span><span class="s1">;</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s7">/iphone|ipad|ipod|ios/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">UA</span><span class="s1">);</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s7">/chrome\/\d+/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">UA</span><span class="s1">) &amp;&amp; !</span><span class="s2">isEdge</span><span class="s1">;</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s7">/phantomjs/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">UA</span><span class="s1">);</span>
<span class="s2">UA </span><span class="s1">&amp;&amp; </span><span class="s2">UA</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s7">/firefox\/(\d+)/</span><span class="s1">);</span>
<span class="s4">// Firefox has a &quot;watch&quot; function on Object.prototype...</span>
<span class="s4">// @ts-expect-error firebox support</span>
<span class="s3">const </span><span class="s2">nativeWatch </span><span class="s1">= {}.</span><span class="s2">watch</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">supportsPassive </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s3">if </span><span class="s1">(</span><span class="s2">inBrowser</span><span class="s1">) {</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s3">const </span><span class="s2">opts </span><span class="s1">= {};</span>
        <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">opts</span><span class="s1">, </span><span class="s0">'passive'</span><span class="s1">, {</span>
            <span class="s2">get</span><span class="s1">() {</span>
                <span class="s4">/* istanbul ignore next */</span>
                <span class="s2">supportsPassive </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}); </span><span class="s4">// https://github.com/facebook/flow/issues/285</span>
        <span class="s2">window</span><span class="s1">.</span><span class="s2">addEventListener</span><span class="s1">(</span><span class="s0">'test-passive'</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s2">opts</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) { }</span>
<span class="s1">}</span>
<span class="s4">// this needs to be lazy-evaled because vue may be required before</span>
<span class="s4">// vue-server-renderer can set VUE_ENV</span>
<span class="s3">let </span><span class="s2">_isServer</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">isServerRendering </span><span class="s1">= () =&gt; {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">_isServer </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">) {</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">inBrowser </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">global </span><span class="s1">!== </span><span class="s0">'undefined'</span><span class="s1">) {</span>
            <span class="s4">// detect presence of vue-server-renderer and avoid</span>
            <span class="s4">// Webpack shimming the process</span>
            <span class="s2">_isServer </span><span class="s1">=</span>
                <span class="s2">global</span><span class="s1">[</span><span class="s0">'process'</span><span class="s1">] &amp;&amp; </span><span class="s2">global</span><span class="s1">[</span><span class="s0">'process'</span><span class="s1">].</span><span class="s2">env</span><span class="s1">.</span><span class="s2">VUE_ENV </span><span class="s1">=== </span><span class="s0">'server'</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">_isServer </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">_isServer</span><span class="s1">;</span>
<span class="s1">};</span>
<span class="s4">/* istanbul ignore next */</span>
<span class="s3">function </span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">) {</span>
    <span class="s3">return typeof </span><span class="s2">Ctor </span><span class="s1">=== </span><span class="s0">'function' </span><span class="s1">&amp;&amp; </span><span class="s7">/native code/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">());</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">hasSymbol </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">Symbol </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp;</span>
    <span class="s2">isNative</span><span class="s1">(</span><span class="s2">Symbol</span><span class="s1">) &amp;&amp;</span>
    <span class="s3">typeof </span><span class="s2">Reflect </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp;</span>
    <span class="s2">isNative</span><span class="s1">(</span><span class="s2">Reflect</span><span class="s1">.</span><span class="s2">ownKeys</span><span class="s1">);</span>
<span class="s3">let </span><span class="s2">_Set</span><span class="s1">; </span><span class="s4">// $flow-disable-line</span>
<span class="s4">/* istanbul ignore if */ </span><span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">Set </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">Set</span><span class="s1">)) {</span>
    <span class="s4">// use native Set when available.</span>
    <span class="s2">_Set </span><span class="s1">= </span><span class="s2">Set</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">else </span><span class="s1">{</span>
    <span class="s4">// a non-standard Set polyfill that only works with primitive keys.</span>
    <span class="s2">_Set </span><span class="s1">= </span><span class="s3">class </span><span class="s2">Set </span><span class="s1">{</span>
        <span class="s2">constructor</span><span class="s1">() {</span>
            <span class="s3">this</span><span class="s1">.</span><span class="s2">set </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">has</span><span class="s1">(</span><span class="s2">key</span><span class="s1">) {</span>
            <span class="s3">return this</span><span class="s1">.</span><span class="s2">set</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] === </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">add</span><span class="s1">(</span><span class="s2">key</span><span class="s1">) {</span>
            <span class="s3">this</span><span class="s1">.</span><span class="s2">set</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">clear</span><span class="s1">() {</span>
            <span class="s3">this</span><span class="s1">.</span><span class="s2">set </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">ASSET_TYPES </span><span class="s1">= [</span><span class="s0">'component'</span><span class="s1">, </span><span class="s0">'directive'</span><span class="s1">, </span><span class="s0">'filter'</span><span class="s1">];</span>
<span class="s3">const </span><span class="s2">LIFECYCLE_HOOKS </span><span class="s1">= [</span>
    <span class="s0">'beforeCreate'</span><span class="s1">,</span>
    <span class="s0">'created'</span><span class="s1">,</span>
    <span class="s0">'beforeMount'</span><span class="s1">,</span>
    <span class="s0">'mounted'</span><span class="s1">,</span>
    <span class="s0">'beforeUpdate'</span><span class="s1">,</span>
    <span class="s0">'updated'</span><span class="s1">,</span>
    <span class="s0">'beforeDestroy'</span><span class="s1">,</span>
    <span class="s0">'destroyed'</span><span class="s1">,</span>
    <span class="s0">'activated'</span><span class="s1">,</span>
    <span class="s0">'deactivated'</span><span class="s1">,</span>
    <span class="s0">'errorCaptured'</span><span class="s1">,</span>
    <span class="s0">'serverPrefetch'</span><span class="s1">,</span>
    <span class="s0">'renderTracked'</span><span class="s1">,</span>
    <span class="s0">'renderTriggered'</span>
<span class="s1">];</span>

<span class="s3">var </span><span class="s2">config </span><span class="s1">= {</span>
    <span class="s5">/**</span>
     <span class="s5">* Option merge strategies (used in core/util/options)</span>
     <span class="s5">*/</span>
    <span class="s4">// $flow-disable-line</span>
    <span class="s2">optionMergeStrategies</span><span class="s1">: </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">),</span>
    <span class="s5">/**</span>
     <span class="s5">* Whether to suppress warnings.</span>
     <span class="s5">*/</span>
    <span class="s2">silent</span><span class="s1">: </span><span class="s3">false</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Show production mode tip message on boot?</span>
     <span class="s5">*/</span>
    <span class="s2">productionTip</span><span class="s1">: </span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Whether to enable devtools</span>
     <span class="s5">*/</span>
    <span class="s2">devtools</span><span class="s1">: </span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Whether to record perf</span>
     <span class="s5">*/</span>
    <span class="s2">performance</span><span class="s1">: </span><span class="s3">false</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Error handler for watcher errors</span>
     <span class="s5">*/</span>
    <span class="s2">errorHandler</span><span class="s1">: </span><span class="s3">null</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Warn handler for watcher warns</span>
     <span class="s5">*/</span>
    <span class="s2">warnHandler</span><span class="s1">: </span><span class="s3">null</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Ignore certain custom elements</span>
     <span class="s5">*/</span>
    <span class="s2">ignoredElements</span><span class="s1">: [],</span>
    <span class="s5">/**</span>
     <span class="s5">* Custom user key aliases for v-on</span>
     <span class="s5">*/</span>
    <span class="s4">// $flow-disable-line</span>
    <span class="s2">keyCodes</span><span class="s1">: </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">),</span>
    <span class="s5">/**</span>
     <span class="s5">* Check if a tag is reserved so that it cannot be registered as a</span>
     <span class="s5">* component. This is platform-dependent and may be overwritten.</span>
     <span class="s5">*/</span>
    <span class="s2">isReservedTag</span><span class="s1">: </span><span class="s2">no</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Check if an attribute is reserved so that it cannot be used as a component</span>
     <span class="s5">* prop. This is platform-dependent and may be overwritten.</span>
     <span class="s5">*/</span>
    <span class="s2">isReservedAttr</span><span class="s1">: </span><span class="s2">no</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Check if a tag is an unknown element.</span>
     <span class="s5">* Platform-dependent.</span>
     <span class="s5">*/</span>
    <span class="s2">isUnknownElement</span><span class="s1">: </span><span class="s2">no</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Get the namespace of an element</span>
     <span class="s5">*/</span>
    <span class="s2">getTagNamespace</span><span class="s1">: </span><span class="s2">noop</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Parse the real tag name for the specific platform.</span>
     <span class="s5">*/</span>
    <span class="s2">parsePlatformTagName</span><span class="s1">: </span><span class="s2">identity</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Check if an attribute must be bound using property, e.g. value</span>
     <span class="s5">* Platform-dependent.</span>
     <span class="s5">*/</span>
    <span class="s2">mustUseProp</span><span class="s1">: </span><span class="s2">no</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Perform updates asynchronously. Intended to be used by Vue Test Utils</span>
     <span class="s5">* This will significantly reduce performance if set to false.</span>
     <span class="s5">*/</span>
    <span class="s2">async</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
    <span class="s5">/**</span>
     <span class="s5">* Exposed for legacy reasons</span>
     <span class="s5">*/</span>
    <span class="s2">_lifecycleHooks</span><span class="s1">: </span><span class="s2">LIFECYCLE_HOOKS</span>
<span class="s1">};</span>

<span class="s3">let </span><span class="s2">currentInstance </span><span class="s1">= </span><span class="s3">null</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* </span><span class="s8">@internal</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">setCurrentInstance</span><span class="s1">(</span><span class="s2">vm </span><span class="s1">= </span><span class="s3">null</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">vm</span><span class="s1">)</span>
        <span class="s2">currentInstance </span><span class="s1">&amp;&amp; </span><span class="s2">currentInstance</span><span class="s1">.</span><span class="s2">_scope</span><span class="s1">.</span><span class="s2">off</span><span class="s1">();</span>
    <span class="s2">currentInstance </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">;</span>
    <span class="s2">vm </span><span class="s1">&amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_scope</span><span class="s1">.</span><span class="s2">on</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* </span><span class="s8">@internal</span>
 <span class="s5">*/</span>
<span class="s3">class </span><span class="s2">VNode </span><span class="s1">{</span>
    <span class="s2">constructor</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">elm</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">componentOptions</span><span class="s1">, </span><span class="s2">asyncFactory</span><span class="s1">) {</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">= </span><span class="s2">tag</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">data </span><span class="s1">= </span><span class="s2">data</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= </span><span class="s2">children</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">text </span><span class="s1">= </span><span class="s2">text</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">elm </span><span class="s1">= </span><span class="s2">elm</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">ns </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">context </span><span class="s1">= </span><span class="s2">context</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">fnContext </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">fnOptions </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">fnScopeId </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">key </span><span class="s1">= </span><span class="s2">data </span><span class="s1">&amp;&amp; </span><span class="s2">data</span><span class="s1">.</span><span class="s2">key</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">componentOptions </span><span class="s1">= </span><span class="s2">componentOptions</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">componentInstance </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">raw </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isStatic </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isRootInsert </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isCloned </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isOnce </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">asyncFactory </span><span class="s1">= </span><span class="s2">asyncFactory</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">asyncMeta </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">isAsyncPlaceholder </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// DEPRECATED: alias for componentInstance for backwards compat.</span>
    <span class="s4">/* istanbul ignore next */</span>
    <span class="s2">get child</span><span class="s1">() {</span>
        <span class="s3">return this</span><span class="s1">.</span><span class="s2">componentInstance</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">createEmptyVNode </span><span class="s1">= (</span><span class="s2">text </span><span class="s1">= </span><span class="s0">''</span><span class="s1">) =&gt; {</span>
    <span class="s3">const </span><span class="s2">node </span><span class="s1">= </span><span class="s3">new </span><span class="s2">VNode</span><span class="s1">();</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">text </span><span class="s1">= </span><span class="s2">text</span><span class="s1">;</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">node</span><span class="s1">;</span>
<span class="s1">};</span>
<span class="s3">function </span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">return new </span><span class="s2">VNode</span><span class="s1">(</span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">String</span><span class="s1">(</span><span class="s2">val</span><span class="s1">));</span>
<span class="s1">}</span>
<span class="s4">// optimized shallow clone</span>
<span class="s4">// used for static nodes and slot nodes because they may be reused across</span>
<span class="s4">// multiple renders, cloning them avoids errors when DOM manipulations rely</span>
<span class="s4">// on their elm reference.</span>
<span class="s3">function </span><span class="s2">cloneVNode</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">cloned </span><span class="s1">= </span><span class="s3">new </span><span class="s2">VNode</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">, </span>
    <span class="s4">// #7975</span>
    <span class="s4">// clone children array to avoid mutating original in case of cloning</span>
    <span class="s4">// a child.</span>
    <span class="s2">vnode</span><span class="s1">.</span><span class="s2">children </span><span class="s1">&amp;&amp; </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(), </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">text</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">elm</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">context</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentOptions</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">asyncFactory</span><span class="s1">);</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">ns </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">ns</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">isStatic </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">isStatic</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">key </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">key</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">isComment</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">fnContext </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">fnContext</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">fnOptions </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">fnOptions</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">fnScopeId </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">fnScopeId</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">asyncMeta </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">asyncMeta</span><span class="s1">;</span>
    <span class="s2">cloned</span><span class="s1">.</span><span class="s2">isCloned </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">cloned</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s4">/* not type checking this file because flow doesn't play well with Proxy */</span>
<span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
    <span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'Infinity,undefined,NaN,isFinite,isNaN,' </span><span class="s1">+</span>
        <span class="s0">'parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,' </span><span class="s1">+</span>
        <span class="s0">'Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,' </span><span class="s1">+</span>
        <span class="s0">'require' </span><span class="s4">// for Webpack/Browserify</span>
    <span class="s1">);</span>
    <span class="s3">const </span><span class="s2">hasProxy </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">Proxy </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">Proxy</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasProxy</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">isBuiltInModifier </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'stop,prevent,self,ctrl,shift,alt,meta,exact'</span><span class="s1">);</span>
        <span class="s2">config</span><span class="s1">.</span><span class="s2">keyCodes </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Proxy</span><span class="s1">(</span><span class="s2">config</span><span class="s1">.</span><span class="s2">keyCodes</span><span class="s1">, {</span>
            <span class="s2">set</span><span class="s1">(</span><span class="s2">target</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">value</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">isBuiltInModifier</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)) {</span>
                    <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Avoid overwriting built-in modifier in config.keyCodes: .</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
                    <span class="s3">return false</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">target</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">value</span><span class="s1">;</span>
                    <span class="s3">return true</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">let </span><span class="s2">uid </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* A dep is an observable that can have multiple</span>
 <span class="s5">* directives subscribing to it.</span>
 <span class="s5">* </span><span class="s8">@internal</span>
 <span class="s5">*/</span>
<span class="s3">class </span><span class="s2">Dep </span><span class="s1">{</span>
    <span class="s2">constructor</span><span class="s1">() {</span>
        <span class="s4">// pending subs cleanup</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">_pending </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">id </span><span class="s1">= </span><span class="s2">uid</span><span class="s1">++;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">subs </span><span class="s1">= [];</span>
    <span class="s1">}</span>
    <span class="s2">addSub</span><span class="s1">(</span><span class="s2">sub</span><span class="s1">) {</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">subs</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">sub</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">removeSub</span><span class="s1">(</span><span class="s2">sub</span><span class="s1">) {</span>
        <span class="s4">// #12696 deps with massive amount of subscribers are extremely slow to</span>
        <span class="s4">// clean up in Chromium</span>
        <span class="s4">// to workaround this, we unset the sub for now, and clear them on</span>
        <span class="s4">// next scheduler flush.</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">subs</span><span class="s1">[</span><span class="s3">this</span><span class="s1">.</span><span class="s2">subs</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">sub</span><span class="s1">)] = </span><span class="s3">null</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">_pending</span><span class="s1">) {</span>
            <span class="s3">this</span><span class="s1">.</span><span class="s2">_pending </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">depend</span><span class="s1">(</span><span class="s2">info</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">Dep</span><span class="s1">.</span><span class="s2">target</span><span class="s1">) {</span>
            <span class="s2">Dep</span><span class="s1">.</span><span class="s2">target</span><span class="s1">.</span><span class="s2">addDep</span><span class="s1">(</span><span class="s3">this</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">info </span><span class="s1">&amp;&amp; </span><span class="s2">Dep</span><span class="s1">.</span><span class="s2">target</span><span class="s1">.</span><span class="s2">onTrack</span><span class="s1">) {</span>
                <span class="s2">Dep</span><span class="s1">.</span><span class="s2">target</span><span class="s1">.</span><span class="s2">onTrack</span><span class="s1">(</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">assign</span><span class="s1">({ </span><span class="s2">effect</span><span class="s1">: </span><span class="s2">Dep</span><span class="s1">.</span><span class="s2">target </span><span class="s1">}, </span><span class="s2">info</span><span class="s1">));</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">notify</span><span class="s1">(</span><span class="s2">info</span><span class="s1">) {</span>
        <span class="s4">// stabilize the subscriber list first</span>
        <span class="s3">const </span><span class="s2">subs </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">subs</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">(</span><span class="s2">s </span><span class="s1">=&gt; </span><span class="s2">s</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; !</span><span class="s2">config</span><span class="s1">.</span><span class="s2">async</span><span class="s1">) {</span>
            <span class="s4">// subs aren't sorted in scheduler if not running async</span>
            <span class="s4">// we need to sort them now to make sure they fire in correct</span>
            <span class="s4">// order</span>
            <span class="s2">subs</span><span class="s1">.</span><span class="s2">sort</span><span class="s1">((</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">) =&gt; </span><span class="s2">a</span><span class="s1">.</span><span class="s2">id </span><span class="s1">- </span><span class="s2">b</span><span class="s1">.</span><span class="s2">id</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">subs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">sub </span><span class="s1">= </span><span class="s2">subs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">info</span><span class="s1">) {</span>
                <span class="s2">sub</span><span class="s1">.</span><span class="s2">onTrigger </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">sub</span><span class="s1">.</span><span class="s2">onTrigger</span><span class="s1">(</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">assign</span><span class="s1">({ </span><span class="s2">effect</span><span class="s1">: </span><span class="s2">subs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] }, </span><span class="s2">info</span><span class="s1">));</span>
            <span class="s1">}</span>
            <span class="s2">sub</span><span class="s1">.</span><span class="s2">update</span><span class="s1">();</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// The current target watcher being evaluated.</span>
<span class="s4">// This is globally unique because only one watcher</span>
<span class="s4">// can be evaluated at a time.</span>
<span class="s2">Dep</span><span class="s1">.</span><span class="s2">target </span><span class="s1">= </span><span class="s3">null</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">targetStack </span><span class="s1">= [];</span>
<span class="s3">function </span><span class="s2">pushTarget</span><span class="s1">(</span><span class="s2">target</span><span class="s1">) {</span>
    <span class="s2">targetStack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">target</span><span class="s1">);</span>
    <span class="s2">Dep</span><span class="s1">.</span><span class="s2">target </span><span class="s1">= </span><span class="s2">target</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">popTarget</span><span class="s1">() {</span>
    <span class="s2">targetStack</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span>
    <span class="s2">Dep</span><span class="s1">.</span><span class="s2">target </span><span class="s1">= </span><span class="s2">targetStack</span><span class="s1">[</span><span class="s2">targetStack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">];</span>
<span class="s1">}</span>

<span class="s4">/* 
 * not type checking this file because flow doesn't play well with 
 * dynamically accessing methods on Array prototype 
 */</span>
<span class="s3">const </span><span class="s2">arrayProto </span><span class="s1">= </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">arrayMethods </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">arrayProto</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">methodsToPatch </span><span class="s1">= [</span>
    <span class="s0">'push'</span><span class="s1">,</span>
    <span class="s0">'pop'</span><span class="s1">,</span>
    <span class="s0">'shift'</span><span class="s1">,</span>
    <span class="s0">'unshift'</span><span class="s1">,</span>
    <span class="s0">'splice'</span><span class="s1">,</span>
    <span class="s0">'sort'</span><span class="s1">,</span>
    <span class="s0">'reverse'</span>
<span class="s1">];</span>
<span class="s5">/**</span>
 <span class="s5">* Intercept mutating methods and emit events</span>
 <span class="s5">*/</span>
<span class="s2">methodsToPatch</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">method</span><span class="s1">) {</span>
    <span class="s4">// cache original method</span>
    <span class="s3">const </span><span class="s2">original </span><span class="s1">= </span><span class="s2">arrayProto</span><span class="s1">[</span><span class="s2">method</span><span class="s1">];</span>
    <span class="s2">def</span><span class="s1">(</span><span class="s2">arrayMethods</span><span class="s1">, </span><span class="s2">method</span><span class="s1">, </span><span class="s3">function </span><span class="s2">mutator</span><span class="s1">(</span><span class="s2">...args</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">result </span><span class="s1">= </span><span class="s2">original</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s2">args</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">ob </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">;</span>
        <span class="s3">let </span><span class="s2">inserted</span><span class="s1">;</span>
        <span class="s3">switch </span><span class="s1">(</span><span class="s2">method</span><span class="s1">) {</span>
            <span class="s3">case </span><span class="s0">'push'</span><span class="s1">:</span>
            <span class="s3">case </span><span class="s0">'unshift'</span><span class="s1">:</span>
                <span class="s2">inserted </span><span class="s1">= </span><span class="s2">args</span><span class="s1">;</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s3">case </span><span class="s0">'splice'</span><span class="s1">:</span>
                <span class="s2">inserted </span><span class="s1">= </span><span class="s2">args</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">2</span><span class="s1">);</span>
                <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">inserted</span><span class="s1">)</span>
            <span class="s2">ob</span><span class="s1">.</span><span class="s2">observeArray</span><span class="s1">(</span><span class="s2">inserted</span><span class="s1">);</span>
        <span class="s4">// notify change</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s2">ob</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">({</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s0">&quot;array mutation&quot; </span><span class="s4">/* TriggerOpTypes.ARRAY_MUTATION */</span><span class="s1">,</span>
                <span class="s2">target</span><span class="s1">: </span><span class="s3">this</span><span class="s1">,</span>
                <span class="s2">key</span><span class="s1">: </span><span class="s2">method</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">ob</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">();</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">result</span><span class="s1">;</span>
    <span class="s1">});</span>
<span class="s1">});</span>

<span class="s3">const </span><span class="s2">arrayKeys </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">getOwnPropertyNames</span><span class="s1">(</span><span class="s2">arrayMethods</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">NO_INIITIAL_VALUE </span><span class="s1">= {};</span>
<span class="s5">/**</span>
 <span class="s5">* In some cases we may want to disable observation inside a component's</span>
 <span class="s5">* update computation.</span>
 <span class="s5">*/</span>
<span class="s3">let </span><span class="s2">shouldObserve </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">toggleObserving</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s2">shouldObserve </span><span class="s1">= </span><span class="s2">value</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// ssr mock dep</span>
<span class="s3">const </span><span class="s2">mockDep </span><span class="s1">= {</span>
    <span class="s2">notify</span><span class="s1">: </span><span class="s2">noop</span><span class="s1">,</span>
    <span class="s2">depend</span><span class="s1">: </span><span class="s2">noop</span><span class="s1">,</span>
    <span class="s2">addSub</span><span class="s1">: </span><span class="s2">noop</span><span class="s1">,</span>
    <span class="s2">removeSub</span><span class="s1">: </span><span class="s2">noop</span>
<span class="s1">};</span>
<span class="s5">/**</span>
 <span class="s5">* Observer class that is attached to each observed</span>
 <span class="s5">* object. Once attached, the observer converts the target</span>
 <span class="s5">* object's property keys into getter/setters that</span>
 <span class="s5">* collect dependencies and dispatch updates.</span>
 <span class="s5">*/</span>
<span class="s3">class </span><span class="s2">Observer </span><span class="s1">{</span>
    <span class="s2">constructor</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">shallow </span><span class="s1">= </span><span class="s3">false</span><span class="s1">, </span><span class="s2">mock </span><span class="s1">= </span><span class="s3">false</span><span class="s1">) {</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">value </span><span class="s1">= </span><span class="s2">value</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">shallow </span><span class="s1">= </span><span class="s2">shallow</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">mock </span><span class="s1">= </span><span class="s2">mock</span><span class="s1">;</span>
        <span class="s4">// this.value = value</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">dep </span><span class="s1">= </span><span class="s2">mock </span><span class="s1">? </span><span class="s2">mockDep </span><span class="s1">: </span><span class="s3">new </span><span class="s2">Dep</span><span class="s1">();</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">vmCount </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
        <span class="s2">def</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">'__ob__'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">mock</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">hasProto</span><span class="s1">) {</span>
                    <span class="s2">value</span><span class="s1">.</span><span class="s2">__proto__ </span><span class="s1">= </span><span class="s2">arrayMethods</span><span class="s1">;</span>
                    <span class="s4">/* eslint-enable no-proto */</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">arrayKeys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                        <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">arrayKeys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
                        <span class="s2">def</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">arrayMethods</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">shallow</span><span class="s1">) {</span>
                <span class="s3">this</span><span class="s1">.</span><span class="s2">observeArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s5">/**</span>
             <span class="s5">* Walk through all properties and convert them into</span>
             <span class="s5">* getter/setters. This method should only be called when</span>
             <span class="s5">* value type is Object.</span>
             <span class="s5">*/</span>
            <span class="s3">const </span><span class="s2">keys </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
                <span class="s2">defineReactive</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">NO_INIITIAL_VALUE</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">shallow</span><span class="s1">, </span><span class="s2">mock</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s5">/**</span>
     <span class="s5">* Observe a list of Array items.</span>
     <span class="s5">*/</span>
    <span class="s2">observeArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">value</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">observe</span><span class="s1">(</span><span class="s2">value</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s3">false</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">mock</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// helpers</span>
<span class="s5">/**</span>
 <span class="s5">* Attempt to create an observer instance for a value,</span>
 <span class="s5">* returns the new observer if successfully observed,</span>
 <span class="s5">* or the existing observer if the value already has one.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">observe</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">shallow</span><span class="s1">, </span><span class="s2">ssrMockReactivity</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">value </span><span class="s1">&amp;&amp; </span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">'__ob__'</span><span class="s1">) &amp;&amp; </span><span class="s2">value</span><span class="s1">.</span><span class="s2">__ob__ </span><span class="s3">instanceof </span><span class="s2">Observer</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">value</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">shouldObserve </span><span class="s1">&amp;&amp;</span>
        <span class="s1">(</span><span class="s2">ssrMockReactivity </span><span class="s1">|| !</span><span class="s2">isServerRendering</span><span class="s1">()) &amp;&amp;</span>
        <span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) || </span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) &amp;&amp;</span>
        <span class="s2">Object</span><span class="s1">.</span><span class="s2">isExtensible</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) &amp;&amp;</span>
        <span class="s1">!</span><span class="s2">value</span><span class="s1">.</span><span class="s2">__v_skip </span><span class="s4">/* ReactiveFlags.SKIP */ </span><span class="s1">&amp;&amp;</span>
        <span class="s1">!</span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) &amp;&amp;</span>
        <span class="s1">!(</span><span class="s2">value </span><span class="s3">instanceof </span><span class="s2">VNode</span><span class="s1">)) {</span>
        <span class="s3">return new </span><span class="s2">Observer</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">shallow</span><span class="s1">, </span><span class="s2">ssrMockReactivity</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Define a reactive property on an Object.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">defineReactive</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">val</span><span class="s1">, </span><span class="s2">customSetter</span><span class="s1">, </span><span class="s2">shallow</span><span class="s1">, </span><span class="s2">mock</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">dep </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Dep</span><span class="s1">();</span>
    <span class="s3">const </span><span class="s2">property </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">getOwnPropertyDescriptor</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">property </span><span class="s1">&amp;&amp; </span><span class="s2">property</span><span class="s1">.</span><span class="s2">configurable </span><span class="s1">=== </span><span class="s3">false</span><span class="s1">) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// cater for pre-defined getter/setters</span>
    <span class="s3">const </span><span class="s2">getter </span><span class="s1">= </span><span class="s2">property </span><span class="s1">&amp;&amp; </span><span class="s2">property</span><span class="s1">.</span><span class="s2">get</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">setter </span><span class="s1">= </span><span class="s2">property </span><span class="s1">&amp;&amp; </span><span class="s2">property</span><span class="s1">.</span><span class="s2">set</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">((!</span><span class="s2">getter </span><span class="s1">|| </span><span class="s2">setter</span><span class="s1">) &amp;&amp;</span>
        <span class="s1">(</span><span class="s2">val </span><span class="s1">=== </span><span class="s2">NO_INIITIAL_VALUE </span><span class="s1">|| </span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">2</span><span class="s1">)) {</span>
        <span class="s2">val </span><span class="s1">= </span><span class="s2">obj</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">let </span><span class="s2">childOb </span><span class="s1">= !</span><span class="s2">shallow </span><span class="s1">&amp;&amp; </span><span class="s2">observe</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">mock</span><span class="s1">);</span>
    <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, {</span>
        <span class="s2">enumerable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">configurable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">get</span><span class="s1">: </span><span class="s3">function </span><span class="s2">reactiveGetter</span><span class="s1">() {</span>
            <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">getter </span><span class="s1">? </span><span class="s2">getter</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) : </span><span class="s2">val</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">Dep</span><span class="s1">.</span><span class="s2">target</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s2">dep</span><span class="s1">.</span><span class="s2">depend</span><span class="s1">({</span>
                        <span class="s2">target</span><span class="s1">: </span><span class="s2">obj</span><span class="s1">,</span>
                        <span class="s2">type</span><span class="s1">: </span><span class="s0">&quot;get&quot; </span><span class="s4">/* TrackOpTypes.GET */</span><span class="s1">,</span>
                        <span class="s2">key</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">dep</span><span class="s1">.</span><span class="s2">depend</span><span class="s1">();</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">childOb</span><span class="s1">) {</span>
                    <span class="s2">childOb</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">depend</span><span class="s1">();</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
                        <span class="s2">dependArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">return </span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) &amp;&amp; !</span><span class="s2">shallow </span><span class="s1">? </span><span class="s2">value</span><span class="s1">.</span><span class="s2">value </span><span class="s1">: </span><span class="s2">value</span><span class="s1">;</span>
        <span class="s1">},</span>
        <span class="s2">set</span><span class="s1">: </span><span class="s3">function </span><span class="s2">reactiveSetter</span><span class="s1">(</span><span class="s2">newVal</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">getter </span><span class="s1">? </span><span class="s2">getter</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) : </span><span class="s2">val</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">hasChanged</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">newVal</span><span class="s1">)) {</span>
                <span class="s3">return</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">customSetter</span><span class="s1">) {</span>
                <span class="s2">customSetter</span><span class="s1">();</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">setter</span><span class="s1">) {</span>
                <span class="s2">setter</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">, </span><span class="s2">newVal</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">getter</span><span class="s1">) {</span>
                <span class="s4">// #7981: for accessor properties without setter</span>
                <span class="s3">return</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(!</span><span class="s2">shallow </span><span class="s1">&amp;&amp; </span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) &amp;&amp; !</span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">newVal</span><span class="s1">)) {</span>
                <span class="s2">value</span><span class="s1">.</span><span class="s2">value </span><span class="s1">= </span><span class="s2">newVal</span><span class="s1">;</span>
                <span class="s3">return</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">val </span><span class="s1">= </span><span class="s2">newVal</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">childOb </span><span class="s1">= !</span><span class="s2">shallow </span><span class="s1">&amp;&amp; </span><span class="s2">observe</span><span class="s1">(</span><span class="s2">newVal</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">mock</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">({</span>
                    <span class="s2">type</span><span class="s1">: </span><span class="s0">&quot;set&quot; </span><span class="s4">/* TriggerOpTypes.SET */</span><span class="s1">,</span>
                    <span class="s2">target</span><span class="s1">: </span><span class="s2">obj</span><span class="s1">,</span>
                    <span class="s2">key</span><span class="s1">,</span>
                    <span class="s2">newValue</span><span class="s1">: </span><span class="s2">newVal</span><span class="s1">,</span>
                    <span class="s2">oldValue</span><span class="s1">: </span><span class="s2">value</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">();</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
    <span class="s3">return </span><span class="s2">dep</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">set</span><span class="s1">(</span><span class="s2">target</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; (</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">target</span><span class="s1">) || </span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">target</span><span class="s1">))) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Cannot set reactive property on undefined, null, or primitive value: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">target</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isReadonly</span><span class="s1">(</span><span class="s2">target</span><span class="s1">)) {</span>
        <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Set operation on key &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">&quot; failed: target is readonly.`</span><span class="s1">);</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">ob </span><span class="s1">= </span><span class="s2">target</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">target</span><span class="s1">) &amp;&amp; </span><span class="s2">isValidArrayIndex</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)) {</span>
        <span class="s2">target</span><span class="s1">.</span><span class="s2">length </span><span class="s1">= </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">max</span><span class="s1">(</span><span class="s2">target</span><span class="s1">.</span><span class="s2">length</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
        <span class="s2">target</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s6">1</span><span class="s1">, </span><span class="s2">val</span><span class="s1">);</span>
        <span class="s4">// when mocking for SSR, array methods are not hijacked</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">ob </span><span class="s1">&amp;&amp; !</span><span class="s2">ob</span><span class="s1">.</span><span class="s2">shallow </span><span class="s1">&amp;&amp; </span><span class="s2">ob</span><span class="s1">.</span><span class="s2">mock</span><span class="s1">) {</span>
            <span class="s2">observe</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">target </span><span class="s1">&amp;&amp; !(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">)) {</span>
        <span class="s2">target</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">val</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">target</span><span class="s1">.</span><span class="s2">_isVue </span><span class="s1">|| (</span><span class="s2">ob </span><span class="s1">&amp;&amp; </span><span class="s2">ob</span><span class="s1">.</span><span class="s2">vmCount</span><span class="s1">)) {</span>
        <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Avoid adding reactive properties to a Vue instance or its root $data ' </span><span class="s1">+</span>
                <span class="s0">'at runtime - declare it upfront in the data option.'</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">ob</span><span class="s1">) {</span>
        <span class="s2">target</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">val</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">defineReactive</span><span class="s1">(</span><span class="s2">ob</span><span class="s1">.</span><span class="s2">value</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">val</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">ob</span><span class="s1">.</span><span class="s2">shallow</span><span class="s1">, </span><span class="s2">ob</span><span class="s1">.</span><span class="s2">mock</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">ob</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">({</span>
            <span class="s2">type</span><span class="s1">: </span><span class="s0">&quot;add&quot; </span><span class="s4">/* TriggerOpTypes.ADD */</span><span class="s1">,</span>
            <span class="s2">target</span><span class="s1">: </span><span class="s2">target</span><span class="s1">,</span>
            <span class="s2">key</span><span class="s1">,</span>
            <span class="s2">newValue</span><span class="s1">: </span><span class="s2">val</span><span class="s1">,</span>
            <span class="s2">oldValue</span><span class="s1">: </span><span class="s2">undefined</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">ob</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">notify</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Collect dependencies on array elements when the array is touched, since</span>
 <span class="s5">* we cannot intercept array element access like property getters.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">dependArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">e</span><span class="s1">, </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">value</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">e </span><span class="s1">= </span><span class="s2">value</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">e </span><span class="s1">&amp;&amp; </span><span class="s2">e</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">) {</span>
            <span class="s2">e</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">depend</span><span class="s1">();</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">e</span><span class="s1">)) {</span>
            <span class="s2">dependArray</span><span class="s1">(</span><span class="s2">e</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">isReadonly</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">!!(</span><span class="s2">value </span><span class="s1">&amp;&amp; </span><span class="s2">value</span><span class="s1">.</span><span class="s2">__v_isReadonly</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">r</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">!!(</span><span class="s2">r </span><span class="s1">&amp;&amp; </span><span class="s2">r</span><span class="s1">.</span><span class="s2">__v_isRef </span><span class="s1">=== </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) ;</span>

<span class="s3">const </span><span class="s2">normalizeEvent </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">((</span><span class="s2">name</span><span class="s1">) =&gt; {</span>
    <span class="s3">const </span><span class="s2">passive </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s6">0</span><span class="s1">) === </span><span class="s0">'&amp;'</span><span class="s1">;</span>
    <span class="s2">name </span><span class="s1">= </span><span class="s2">passive </span><span class="s1">? </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">) : </span><span class="s2">name</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">once </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s6">0</span><span class="s1">) === </span><span class="s0">'~'</span><span class="s1">; </span><span class="s4">// Prefixed last, checked first</span>
    <span class="s2">name </span><span class="s1">= </span><span class="s2">once </span><span class="s1">? </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">) : </span><span class="s2">name</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">capture </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s6">0</span><span class="s1">) === </span><span class="s0">'!'</span><span class="s1">;</span>
    <span class="s2">name </span><span class="s1">= </span><span class="s2">capture </span><span class="s1">? </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">) : </span><span class="s2">name</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">name</span><span class="s1">,</span>
        <span class="s2">once</span><span class="s1">,</span>
        <span class="s2">capture</span><span class="s1">,</span>
        <span class="s2">passive</span>
    <span class="s1">};</span>
<span class="s1">});</span>
<span class="s3">function </span><span class="s2">createFnInvoker</span><span class="s1">(</span><span class="s2">fns</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">function </span><span class="s2">invoker</span><span class="s1">() {</span>
        <span class="s3">const </span><span class="s2">fns </span><span class="s1">= </span><span class="s2">invoker</span><span class="s1">.</span><span class="s2">fns</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">fns</span><span class="s1">)) {</span>
            <span class="s3">const </span><span class="s2">cloned </span><span class="s1">= </span><span class="s2">fns</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">();</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">cloned</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">invokeWithErrorHandling</span><span class="s1">(</span><span class="s2">cloned</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s3">null</span><span class="s1">, </span><span class="s2">arguments</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s0">`v-on handler`</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// return handler return value for single handlers</span>
            <span class="s3">return </span><span class="s2">invokeWithErrorHandling</span><span class="s1">(</span><span class="s2">fns</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s2">arguments</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s0">`v-on handler`</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">invoker</span><span class="s1">.</span><span class="s2">fns </span><span class="s1">= </span><span class="s2">fns</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">invoker</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">updateListeners</span><span class="s1">(</span><span class="s2">on</span><span class="s1">, </span><span class="s2">oldOn</span><span class="s1">, </span><span class="s2">add</span><span class="s1">, </span><span class="s2">remove</span><span class="s1">, </span><span class="s2">createOnceHandler</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">name</span><span class="s1">, </span><span class="s2">cur</span><span class="s1">, </span><span class="s2">old</span><span class="s1">, </span><span class="s2">event</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">name </span><span class="s3">in </span><span class="s2">on</span><span class="s1">) {</span>
        <span class="s2">cur </span><span class="s1">= </span><span class="s2">on</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
        <span class="s2">old </span><span class="s1">= </span><span class="s2">oldOn</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
        <span class="s2">event </span><span class="s1">= </span><span class="s2">normalizeEvent</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">)) {</span>
            <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid handler for event &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">event</span><span class="s1">.</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;: got ` </span><span class="s1">+ </span><span class="s2">String</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">), </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">old</span><span class="s1">)) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">.</span><span class="s2">fns</span><span class="s1">)) {</span>
                <span class="s2">cur </span><span class="s1">= </span><span class="s2">on</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">createFnInvoker</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">event</span><span class="s1">.</span><span class="s2">once</span><span class="s1">)) {</span>
                <span class="s2">cur </span><span class="s1">= </span><span class="s2">on</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">createOnceHandler</span><span class="s1">(</span><span class="s2">event</span><span class="s1">.</span><span class="s2">name</span><span class="s1">, </span><span class="s2">cur</span><span class="s1">, </span><span class="s2">event</span><span class="s1">.</span><span class="s2">capture</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">add</span><span class="s1">(</span><span class="s2">event</span><span class="s1">.</span><span class="s2">name</span><span class="s1">, </span><span class="s2">cur</span><span class="s1">, </span><span class="s2">event</span><span class="s1">.</span><span class="s2">capture</span><span class="s1">, </span><span class="s2">event</span><span class="s1">.</span><span class="s2">passive</span><span class="s1">, </span><span class="s2">event</span><span class="s1">.</span><span class="s2">params</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">cur </span><span class="s1">!== </span><span class="s2">old</span><span class="s1">) {</span>
            <span class="s2">old</span><span class="s1">.</span><span class="s2">fns </span><span class="s1">= </span><span class="s2">cur</span><span class="s1">;</span>
            <span class="s2">on</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">old</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">name </span><span class="s3">in </span><span class="s2">oldOn</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">on</span><span class="s1">[</span><span class="s2">name</span><span class="s1">])) {</span>
            <span class="s2">event </span><span class="s1">= </span><span class="s2">normalizeEvent</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
            <span class="s2">remove</span><span class="s1">(</span><span class="s2">event</span><span class="s1">.</span><span class="s2">name</span><span class="s1">, </span><span class="s2">oldOn</span><span class="s1">[</span><span class="s2">name</span><span class="s1">], </span><span class="s2">event</span><span class="s1">.</span><span class="s2">capture</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">extractPropsFromVNodeData</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">) {</span>
    <span class="s4">// we are only extracting raw values here.</span>
    <span class="s4">// validation and default values are handled in the child</span>
    <span class="s4">// component itself.</span>
    <span class="s3">const </span><span class="s2">propOptions </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">props</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">propOptions</span><span class="s1">)) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
    <span class="s3">const </span><span class="s1">{ </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">props </span><span class="s1">} = </span><span class="s2">data</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">) || </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">props</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">propOptions</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">altKey </span><span class="s1">= </span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">keyInLowerCase </span><span class="s1">= </span><span class="s2">key</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">!== </span><span class="s2">keyInLowerCase </span><span class="s1">&amp;&amp; </span><span class="s2">attrs </span><span class="s1">&amp;&amp; </span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">keyInLowerCase</span><span class="s1">)) {</span>
                    <span class="s2">tip</span><span class="s1">(</span><span class="s0">`Prop &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keyInLowerCase</span><span class="s1">}</span><span class="s0">&quot; is passed to component ` </span><span class="s1">+</span>
                        <span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">formatComponentName</span><span class="s1">(</span>
                        <span class="s4">// @ts-expect-error tag is string</span>
                        <span class="s2">tag </span><span class="s1">|| </span><span class="s2">Ctor</span><span class="s1">)}</span><span class="s0">, but the declared prop name is` </span><span class="s1">+</span>
                        <span class="s0">` &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">&quot;. ` </span><span class="s1">+</span>
                        <span class="s0">`Note that HTML attributes are case-insensitive and camelCased ` </span><span class="s1">+</span>
                        <span class="s0">`props need to use their kebab-case equivalents when using in-DOM ` </span><span class="s1">+</span>
                        <span class="s0">`templates. You should probably use &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">altKey</span><span class="s1">}</span><span class="s0">&quot; instead of &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">&quot;.`</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">checkProp</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">props</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">altKey</span><span class="s1">, </span><span class="s3">true</span><span class="s1">) ||</span>
                <span class="s2">checkProp</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">altKey</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkProp</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">hash</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">altKey</span><span class="s1">, </span><span class="s2">preserve</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">, </span><span class="s2">key</span><span class="s1">)) {</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">hash</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">preserve</span><span class="s1">) {</span>
                <span class="s3">delete </span><span class="s2">hash</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s1">}</span>
            <span class="s3">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">, </span><span class="s2">altKey</span><span class="s1">)) {</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">hash</span><span class="s1">[</span><span class="s2">altKey</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">preserve</span><span class="s1">) {</span>
                <span class="s3">delete </span><span class="s2">hash</span><span class="s1">[</span><span class="s2">altKey</span><span class="s1">];</span>
            <span class="s1">}</span>
            <span class="s3">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s4">// The template compiler attempts to minimize the need for normalization by</span>
<span class="s4">// statically analyzing the template at compile time.</span>
<span class="s4">//</span>
<span class="s4">// For plain HTML markup, normalization can be completely skipped because the</span>
<span class="s4">// generated render function is guaranteed to return Array&lt;VNode&gt;. There are</span>
<span class="s4">// two cases where extra normalization is needed:</span>
<span class="s4">// 1. When the children contains components - because a functional component</span>
<span class="s4">// may return an Array instead of a single root. In this case, just a simple</span>
<span class="s4">// normalization is needed - if any child is an Array, we flatten the whole</span>
<span class="s4">// thing with Array.prototype.concat. It is guaranteed to be only 1-level deep</span>
<span class="s4">// because functional components already normalize their own children.</span>
<span class="s3">function </span><span class="s2">simpleNormalizeChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">])) {</span>
            <span class="s3">return </span><span class="s2">Array</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">([], </span><span class="s2">children</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">children</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// 2. When the children contains constructs that always generated nested Arrays,</span>
<span class="s4">// e.g. &lt;template&gt;, &lt;slot&gt;, v-for, or when the children is provided by user</span>
<span class="s4">// with hand-written render functions / JSX. In such cases a full normalization</span>
<span class="s4">// is needed to cater to all possible types of children values.</span>
<span class="s3">function </span><span class="s2">normalizeChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">children</span><span class="s1">)</span>
        <span class="s1">? [</span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">children</span><span class="s1">)]</span>
        <span class="s1">: </span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">children</span><span class="s1">)</span>
            <span class="s1">? </span><span class="s2">normalizeArrayChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s2">undefined</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">text</span><span class="s1">) &amp;&amp; </span><span class="s2">isFalse</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">isComment</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">normalizeArrayChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">nestedIndex</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= [];</span>
    <span class="s3">let </span><span class="s2">i</span><span class="s1">, </span><span class="s2">c</span><span class="s1">, </span><span class="s2">lastIndex</span><span class="s1">, </span><span class="s2">last</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">c </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">c</span><span class="s1">) || </span><span class="s3">typeof </span><span class="s2">c </span><span class="s1">=== </span><span class="s0">'boolean'</span><span class="s1">)</span>
            <span class="s3">continue</span><span class="s1">;</span>
        <span class="s2">lastIndex </span><span class="s1">= </span><span class="s2">res</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">;</span>
        <span class="s2">last </span><span class="s1">= </span><span class="s2">res</span><span class="s1">[</span><span class="s2">lastIndex</span><span class="s1">];</span>
        <span class="s4">//  nested</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&gt; </span><span class="s6">0</span><span class="s1">) {</span>
                <span class="s2">c </span><span class="s1">= </span><span class="s2">normalizeArrayChildren</span><span class="s1">(</span><span class="s2">c</span><span class="s1">, </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">nestedIndex </span><span class="s1">|| </span><span class="s0">''</span><span class="s1">}</span><span class="s0">_</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
                <span class="s4">// merge adjacent text nodes</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">c</span><span class="s1">[</span><span class="s6">0</span><span class="s1">]) &amp;&amp; </span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">)) {</span>
                    <span class="s2">res</span><span class="s1">[</span><span class="s2">lastIndex</span><span class="s1">] = </span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">.</span><span class="s2">text </span><span class="s1">+ </span><span class="s2">c</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">text</span><span class="s1">);</span>
                    <span class="s2">c</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span>
                <span class="s1">}</span>
                <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">c</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">c</span><span class="s1">)) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">)) {</span>
                <span class="s4">// merge adjacent text nodes</span>
                <span class="s4">// this is necessary for SSR hydration because text nodes are</span>
                <span class="s4">// essentially merged when rendered to HTML strings</span>
                <span class="s2">res</span><span class="s1">[</span><span class="s2">lastIndex</span><span class="s1">] = </span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">.</span><span class="s2">text </span><span class="s1">+ </span><span class="s2">c</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">!== </span><span class="s0">''</span><span class="s1">) {</span>
                <span class="s4">// convert primitive to vnode</span>
                <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">c</span><span class="s1">));</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">c</span><span class="s1">) &amp;&amp; </span><span class="s2">isTextNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">)) {</span>
                <span class="s4">// merge adjacent text nodes</span>
                <span class="s2">res</span><span class="s1">[</span><span class="s2">lastIndex</span><span class="s1">] = </span><span class="s2">createTextVNode</span><span class="s1">(</span><span class="s2">last</span><span class="s1">.</span><span class="s2">text </span><span class="s1">+ </span><span class="s2">c</span><span class="s1">.</span><span class="s2">text</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s4">// default key for nested array children (likely generated by v-for)</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">children</span><span class="s1">.</span><span class="s2">_isVList</span><span class="s1">) &amp;&amp;</span>
                    <span class="s2">isDef</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) &amp;&amp;</span>
                    <span class="s2">isUndef</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">key</span><span class="s1">) &amp;&amp;</span>
                    <span class="s2">isDef</span><span class="s1">(</span><span class="s2">nestedIndex</span><span class="s1">)) {</span>
                    <span class="s2">c</span><span class="s1">.</span><span class="s2">key </span><span class="s1">= </span><span class="s0">`__vlist</span><span class="s2">$</span><span class="s1">{</span><span class="s2">nestedIndex</span><span class="s1">}</span><span class="s0">_</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">}</span><span class="s0">__`</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">c</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">SIMPLE_NORMALIZE </span><span class="s1">= </span><span class="s6">1</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">ALWAYS_NORMALIZE </span><span class="s1">= </span><span class="s6">2</span><span class="s1">;</span>
<span class="s4">// wrapper function for providing a more flexible interface</span>
<span class="s4">// without getting yelled at by flow</span>
<span class="s3">function </span><span class="s2">createElement</span><span class="s1">(</span><span class="s2">context</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">normalizationType</span><span class="s1">, </span><span class="s2">alwaysNormalize</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) || </span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">data</span><span class="s1">)) {</span>
        <span class="s2">normalizationType </span><span class="s1">= </span><span class="s2">children</span><span class="s1">;</span>
        <span class="s2">children </span><span class="s1">= </span><span class="s2">data</span><span class="s1">;</span>
        <span class="s2">data </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">alwaysNormalize</span><span class="s1">)) {</span>
        <span class="s2">normalizationType </span><span class="s1">= </span><span class="s2">ALWAYS_NORMALIZE</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">_createElement</span><span class="s1">(</span><span class="s2">context</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">normalizationType</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">_createElement</span><span class="s1">(</span><span class="s2">context</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">normalizationType</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">)) {</span>
        <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Avoid using observed data object as vnode data: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">data</span><span class="s1">)}</span><span class="s3">\n</span><span class="s0">` </span><span class="s1">+ </span><span class="s0">'Always create fresh vnode data objects in each render!'</span><span class="s1">, </span><span class="s2">context</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s2">createEmptyVNode</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s4">// object syntax in v-bind</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">is</span><span class="s1">)) {</span>
        <span class="s2">tag </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">is</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">tag</span><span class="s1">) {</span>
        <span class="s4">// in case of component :is set to falsy value</span>
        <span class="s3">return </span><span class="s2">createEmptyVNode</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s4">// warn against non-primitive key</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">key</span><span class="s1">) &amp;&amp; !</span><span class="s2">isPrimitive</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">key</span><span class="s1">)) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Avoid using non-primitive value as key, ' </span><span class="s1">+</span>
            <span class="s0">'use string/number value instead.'</span><span class="s1">, </span><span class="s2">context</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// support single function children as default scoped slot</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">children</span><span class="s1">) &amp;&amp; </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">children</span><span class="s1">[</span><span class="s6">0</span><span class="s1">])) {</span>
        <span class="s2">data </span><span class="s1">= </span><span class="s2">data </span><span class="s1">|| {};</span>
        <span class="s2">data</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">= { </span><span class="s3">default</span><span class="s1">: </span><span class="s2">children</span><span class="s1">[</span><span class="s6">0</span><span class="s1">] };</span>
        <span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">normalizationType </span><span class="s1">=== </span><span class="s2">ALWAYS_NORMALIZE</span><span class="s1">) {</span>
        <span class="s2">children </span><span class="s1">= </span><span class="s2">normalizeChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">normalizationType </span><span class="s1">=== </span><span class="s2">SIMPLE_NORMALIZE</span><span class="s1">) {</span>
        <span class="s2">children </span><span class="s1">= </span><span class="s2">simpleNormalizeChildren</span><span class="s1">(</span><span class="s2">children</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">let </span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">ns</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
        <span class="s3">let </span><span class="s2">Ctor</span><span class="s1">;</span>
        <span class="s2">ns </span><span class="s1">= (</span><span class="s2">context</span><span class="s1">.</span><span class="s2">$vnode </span><span class="s1">&amp;&amp; </span><span class="s2">context</span><span class="s1">.</span><span class="s2">$vnode</span><span class="s1">.</span><span class="s2">ns</span><span class="s1">) || </span><span class="s2">config</span><span class="s1">.</span><span class="s2">getTagNamespace</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">((!</span><span class="s2">data </span><span class="s1">|| !</span><span class="s2">data</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) &amp;&amp;</span>
            <span class="s2">isDef</span><span class="s1">((</span><span class="s2">Ctor </span><span class="s1">= </span><span class="s2">resolveAsset</span><span class="s1">(</span><span class="s2">context</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">, </span><span class="s0">'components'</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">)))) {</span>
            <span class="s4">// component</span>
            <span class="s2">vnode </span><span class="s1">= </span><span class="s2">createComponent</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// unknown or unlisted namespaced elements</span>
            <span class="s4">// check at runtime because it may get assigned a namespace when its</span>
            <span class="s4">// parent normalizes children</span>
            <span class="s2">vnode </span><span class="s1">= </span><span class="s3">new </span><span class="s2">VNode</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">context</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s4">// direct component options / constructor</span>
        <span class="s2">vnode </span><span class="s1">= </span><span class="s2">createComponent</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">vnode</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">ns</span><span class="s1">))</span>
            <span class="s2">applyNS</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">ns</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">))</span>
            <span class="s2">registerDeepBindings</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s2">vnode</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">createEmptyVNode</span><span class="s1">();</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">applyNS</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">ns</span><span class="s1">, </span><span class="s2">force</span><span class="s1">) {</span>
    <span class="s2">vnode</span><span class="s1">.</span><span class="s2">ns </span><span class="s1">= </span><span class="s2">ns</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'foreignObject'</span><span class="s1">) {</span>
        <span class="s4">// use default namespace inside foreignObject</span>
        <span class="s2">ns </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
        <span class="s2">force </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">children</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">child </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) &amp;&amp;</span>
                <span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">ns</span><span class="s1">) || (</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">force</span><span class="s1">) &amp;&amp; </span><span class="s2">child</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'svg'</span><span class="s1">))) {</span>
                <span class="s2">applyNS</span><span class="s1">(</span><span class="s2">child</span><span class="s1">, </span><span class="s2">ns</span><span class="s1">, </span><span class="s2">force</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// ref #5318</span>
<span class="s4">// necessary to ensure parent re-render when deep bindings like :style and</span>
<span class="s4">// :class are used on slot nodes</span>
<span class="s3">function </span><span class="s2">registerDeepBindings</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">style</span><span class="s1">)) {</span>
        <span class="s2">traverse</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">style</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">class</span><span class="s1">)) {</span>
        <span class="s2">traverse</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">class</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for rendering v-for lists.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">renderList</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s2">render</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">ret </span><span class="s1">= </span><span class="s3">null</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">l</span><span class="s1">, </span><span class="s2">keys</span><span class="s1">, </span><span class="s2">key</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) || </span><span class="s3">typeof </span><span class="s2">val </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
        <span class="s2">ret </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">val</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">ret</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">render</span><span class="s1">(</span><span class="s2">val</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">i</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">val </span><span class="s1">=== </span><span class="s0">'number'</span><span class="s1">) {</span>
        <span class="s2">ret </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">val</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">ret</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">render</span><span class="s1">(</span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">, </span><span class="s2">i</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">val</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">hasSymbol </span><span class="s1">&amp;&amp; </span><span class="s2">val</span><span class="s1">[</span><span class="s2">Symbol</span><span class="s1">.</span><span class="s2">iterator</span><span class="s1">]) {</span>
            <span class="s2">ret </span><span class="s1">= [];</span>
            <span class="s3">const </span><span class="s2">iterator </span><span class="s1">= </span><span class="s2">val</span><span class="s1">[</span><span class="s2">Symbol</span><span class="s1">.</span><span class="s2">iterator</span><span class="s1">]();</span>
            <span class="s3">let </span><span class="s2">result </span><span class="s1">= </span><span class="s2">iterator</span><span class="s1">.</span><span class="s2">next</span><span class="s1">();</span>
            <span class="s3">while </span><span class="s1">(!</span><span class="s2">result</span><span class="s1">.</span><span class="s2">done</span><span class="s1">) {</span>
                <span class="s2">ret</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">render</span><span class="s1">(</span><span class="s2">result</span><span class="s1">.</span><span class="s2">value</span><span class="s1">, </span><span class="s2">ret</span><span class="s1">.</span><span class="s2">length</span><span class="s1">));</span>
                <span class="s2">result </span><span class="s1">= </span><span class="s2">iterator</span><span class="s1">.</span><span class="s2">next</span><span class="s1">();</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">keys </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
            <span class="s2">ret </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">key </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
                <span class="s2">ret</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">render</span><span class="s1">(</span><span class="s2">val</span><span class="s1">[</span><span class="s2">key</span><span class="s1">], </span><span class="s2">key</span><span class="s1">, </span><span class="s2">i</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">)) {</span>
        <span class="s2">ret </span><span class="s1">= [];</span>
    <span class="s1">}</span>
    <span class="s2">ret</span><span class="s1">.</span><span class="s2">_isVList </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for rendering &lt;slot&gt;</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">renderSlot</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">fallbackRender</span><span class="s1">, </span><span class="s2">props</span><span class="s1">, </span><span class="s2">bindObject</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">scopedSlotFn </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">$scopedSlots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
    <span class="s3">let </span><span class="s2">nodes</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">scopedSlotFn</span><span class="s1">) {</span>
        <span class="s4">// scoped slot</span>
        <span class="s2">props </span><span class="s1">= </span><span class="s2">props </span><span class="s1">|| {};</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">bindObject</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; !</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">bindObject</span><span class="s1">)) {</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'slot v-bind without argument expects an Object'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">props </span><span class="s1">= </span><span class="s2">extend</span><span class="s1">(</span><span class="s2">extend</span><span class="s1">({}, </span><span class="s2">bindObject</span><span class="s1">), </span><span class="s2">props</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">nodes </span><span class="s1">=</span>
            <span class="s2">scopedSlotFn</span><span class="s1">(</span><span class="s2">props</span><span class="s1">) ||</span>
                <span class="s1">(</span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">fallbackRender</span><span class="s1">) ? </span><span class="s2">fallbackRender</span><span class="s1">() : </span><span class="s2">fallbackRender</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">nodes </span><span class="s1">=</span>
            <span class="s3">this</span><span class="s1">.</span><span class="s2">$slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] ||</span>
                <span class="s1">(</span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">fallbackRender</span><span class="s1">) ? </span><span class="s2">fallbackRender</span><span class="s1">() : </span><span class="s2">fallbackRender</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">target </span><span class="s1">= </span><span class="s2">props </span><span class="s1">&amp;&amp; </span><span class="s2">props</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">target</span><span class="s1">) {</span>
        <span class="s3">return this</span><span class="s1">.</span><span class="s2">$createElement</span><span class="s1">(</span><span class="s0">'template'</span><span class="s1">, { </span><span class="s2">slot</span><span class="s1">: </span><span class="s2">target </span><span class="s1">}, </span><span class="s2">nodes</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">nodes</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for resolving filters</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">resolveFilter</span><span class="s1">(</span><span class="s2">id</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">resolveAsset</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">, </span><span class="s0">'filters'</span><span class="s1">, </span><span class="s2">id</span><span class="s1">, </span><span class="s3">true</span><span class="s1">) || </span><span class="s2">identity</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">isKeyNotMatch</span><span class="s1">(</span><span class="s2">expect</span><span class="s1">, </span><span class="s2">actual</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">expect</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">expect</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">actual</span><span class="s1">) === -</span><span class="s6">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">expect </span><span class="s1">!== </span><span class="s2">actual</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Runtime helper for checking keyCodes from config.</span>
 <span class="s5">* exposed as Vue.prototype._k</span>
 <span class="s5">* passing in eventKeyName as last argument separately for backwards compat</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">checkKeyCodes</span><span class="s1">(</span><span class="s2">eventKeyCode</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">builtInKeyCode</span><span class="s1">, </span><span class="s2">eventKeyName</span><span class="s1">, </span><span class="s2">builtInKeyName</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">mappedKeyCode </span><span class="s1">= </span><span class="s2">config</span><span class="s1">.</span><span class="s2">keyCodes</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] || </span><span class="s2">builtInKeyCode</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">builtInKeyName </span><span class="s1">&amp;&amp; </span><span class="s2">eventKeyName </span><span class="s1">&amp;&amp; !</span><span class="s2">config</span><span class="s1">.</span><span class="s2">keyCodes</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
        <span class="s3">return </span><span class="s2">isKeyNotMatch</span><span class="s1">(</span><span class="s2">builtInKeyName</span><span class="s1">, </span><span class="s2">eventKeyName</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">mappedKeyCode</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">isKeyNotMatch</span><span class="s1">(</span><span class="s2">mappedKeyCode</span><span class="s1">, </span><span class="s2">eventKeyCode</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">eventKeyName</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">eventKeyName</span><span class="s1">) !== </span><span class="s2">key</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">eventKeyCode </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for merging v-bind=&quot;object&quot; into a VNode's data.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">bindObjectProps</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">asProp</span><span class="s1">, </span><span class="s2">isSync</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
            <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'v-bind without argument expects an Object or Array value'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
                <span class="s2">value </span><span class="s1">= </span><span class="s2">toObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">let </span><span class="s2">hash</span><span class="s1">;</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">value</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'class' </span><span class="s1">|| </span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'style' </span><span class="s1">|| </span><span class="s2">isReservedAttribute</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)) {</span>
                    <span class="s2">hash </span><span class="s1">= </span><span class="s2">data</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s3">const </span><span class="s2">type </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">&amp;&amp; </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">type</span><span class="s1">;</span>
                    <span class="s2">hash </span><span class="s1">=</span>
                        <span class="s2">asProp </span><span class="s1">|| </span><span class="s2">config</span><span class="s1">.</span><span class="s2">mustUseProp</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">type</span><span class="s1">, </span><span class="s2">key</span><span class="s1">)</span>
                            <span class="s1">? </span><span class="s2">data</span><span class="s1">.</span><span class="s2">domProps </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">domProps </span><span class="s1">= {})</span>
                            <span class="s1">: </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">= {});</span>
                <span class="s1">}</span>
                <span class="s3">const </span><span class="s2">camelizedKey </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
                <span class="s3">const </span><span class="s2">hyphenatedKey </span><span class="s1">= </span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(!(</span><span class="s2">camelizedKey </span><span class="s3">in </span><span class="s2">hash</span><span class="s1">) &amp;&amp; !(</span><span class="s2">hyphenatedKey </span><span class="s3">in </span><span class="s2">hash</span><span class="s1">)) {</span>
                    <span class="s2">hash</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">value</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">isSync</span><span class="s1">) {</span>
                        <span class="s3">const </span><span class="s2">on </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">= {});</span>
                        <span class="s2">on</span><span class="s1">[</span><span class="s0">`update:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">`</span><span class="s1">] = </span><span class="s3">function </span><span class="s1">(</span><span class="s2">$event</span><span class="s1">) {</span>
                            <span class="s2">value</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">$event</span><span class="s1">;</span>
                        <span class="s1">};</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">data</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for rendering static trees.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">renderStatic</span><span class="s1">(</span><span class="s2">index</span><span class="s1">, </span><span class="s2">isInFor</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">cached </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">_staticTrees </span><span class="s1">|| (</span><span class="s3">this</span><span class="s1">.</span><span class="s2">_staticTrees </span><span class="s1">= []);</span>
    <span class="s3">let </span><span class="s2">tree </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">[</span><span class="s2">index</span><span class="s1">];</span>
    <span class="s4">// if has already-rendered static tree and not inside v-for,</span>
    <span class="s4">// we can reuse the same tree.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">tree </span><span class="s1">&amp;&amp; !</span><span class="s2">isInFor</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">tree</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// otherwise, render a fresh tree.</span>
    <span class="s2">tree </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">[</span><span class="s2">index</span><span class="s1">] = </span><span class="s3">this</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">staticRenderFns</span><span class="s1">[</span><span class="s2">index</span><span class="s1">].</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">_renderProxy</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">_c</span><span class="s1">, </span><span class="s3">this </span><span class="s4">// for render fns generated for functional component templates</span>
    <span class="s1">);</span>
    <span class="s2">markStatic$1</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">, </span><span class="s0">`__static__</span><span class="s2">$</span><span class="s1">{</span><span class="s2">index</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">tree</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Runtime helper for v-once.</span>
 <span class="s5">* Effectively it means marking the node as static with a unique key.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">markOnce</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">, </span><span class="s2">index</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s2">markStatic$1</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">, </span><span class="s0">`__once__</span><span class="s2">$</span><span class="s1">{</span><span class="s2">index</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key </span><span class="s1">? </span><span class="s0">`_</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">``</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">tree</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">markStatic$1</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">isOnce</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">tree</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">tree</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] &amp;&amp; </span><span class="s3">typeof </span><span class="s2">tree</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] !== </span><span class="s0">'string'</span><span class="s1">) {</span>
                <span class="s2">markStaticNode</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">_</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">isOnce</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">markStaticNode</span><span class="s1">(</span><span class="s2">tree</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">isOnce</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">markStaticNode</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">isOnce</span><span class="s1">) {</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">isStatic </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">key </span><span class="s1">= </span><span class="s2">key</span><span class="s1">;</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">isOnce </span><span class="s1">= </span><span class="s2">isOnce</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">bindObjectListeners</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
            <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'v-on without argument expects an Object value'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">const </span><span class="s2">on </span><span class="s1">= (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">? </span><span class="s2">extend</span><span class="s1">({}, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on</span><span class="s1">) : {});</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">value</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">existing </span><span class="s1">= </span><span class="s2">on</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
                <span class="s3">const </span><span class="s2">ours </span><span class="s1">= </span><span class="s2">value</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
                <span class="s2">on</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">existing </span><span class="s1">? [].</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">existing</span><span class="s1">, </span><span class="s2">ours</span><span class="s1">) : </span><span class="s2">ours</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">data</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">resolveScopedSlots</span><span class="s1">(</span><span class="s2">fns</span><span class="s1">, </span><span class="s2">res</span><span class="s1">, </span>
<span class="s4">// the following are added in 2.6</span>
<span class="s2">hasDynamicKeys</span><span class="s1">, </span><span class="s2">contentHashKey</span><span class="s1">) {</span>
    <span class="s2">res </span><span class="s1">= </span><span class="s2">res </span><span class="s1">|| { </span><span class="s2">$stable</span><span class="s1">: !</span><span class="s2">hasDynamicKeys </span><span class="s1">};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">fns</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">slot </span><span class="s1">= </span><span class="s2">fns</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">slot</span><span class="s1">)) {</span>
            <span class="s2">resolveScopedSlots</span><span class="s1">(</span><span class="s2">slot</span><span class="s1">, </span><span class="s2">res</span><span class="s1">, </span><span class="s2">hasDynamicKeys</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">slot</span><span class="s1">) {</span>
            <span class="s4">// marker for reverse proxying v-slot without scope on this.$slots</span>
            <span class="s4">// @ts-expect-error</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">slot</span><span class="s1">.</span><span class="s2">proxy</span><span class="s1">) {</span>
                <span class="s4">// @ts-expect-error</span>
                <span class="s2">slot</span><span class="s1">.</span><span class="s2">fn</span><span class="s1">.</span><span class="s2">proxy </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">slot</span><span class="s1">.</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">slot</span><span class="s1">.</span><span class="s2">fn</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">contentHashKey</span><span class="s1">) {</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">$key </span><span class="s1">= </span><span class="s2">contentHashKey</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s4">// helper to process dynamic keys for dynamic arguments in v-bind and v-on.</span>
<span class="s3">function </span><span class="s2">bindDynamicKeys</span><span class="s1">(</span><span class="s2">baseObj</span><span class="s1">, </span><span class="s2">values</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">values</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">+= </span><span class="s6">2</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">values</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'string' </span><span class="s1">&amp;&amp; </span><span class="s2">key</span><span class="s1">) {</span>
            <span class="s2">baseObj</span><span class="s1">[</span><span class="s2">values</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]] = </span><span class="s2">values</span><span class="s1">[</span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">key </span><span class="s1">!== </span><span class="s0">'' </span><span class="s1">&amp;&amp; </span><span class="s2">key </span><span class="s1">!== </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s4">// null is a special value for explicitly removing a binding</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid value for dynamic directive argument (expected string or null): </span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s3">this</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">baseObj</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// helper to dynamically append modifier runtime markers to event names.</span>
<span class="s4">// ensure only append when value is already string, otherwise it will be cast</span>
<span class="s4">// to string and cause the type check to miss.</span>
<span class="s3">function </span><span class="s2">prependModifier</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">symbol</span><span class="s1">) {</span>
    <span class="s3">return typeof </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'string' </span><span class="s1">? </span><span class="s2">symbol </span><span class="s1">+ </span><span class="s2">value </span><span class="s1">: </span><span class="s2">value</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">installRenderHelpers</span><span class="s1">(</span><span class="s2">target</span><span class="s1">) {</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_o </span><span class="s1">= </span><span class="s2">markOnce</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_n </span><span class="s1">= </span><span class="s2">toNumber</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_s </span><span class="s1">= </span><span class="s2">toString</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_l </span><span class="s1">= </span><span class="s2">renderList</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_t </span><span class="s1">= </span><span class="s2">renderSlot</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_q </span><span class="s1">= </span><span class="s2">looseEqual</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_i </span><span class="s1">= </span><span class="s2">looseIndexOf</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_m </span><span class="s1">= </span><span class="s2">renderStatic</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_f </span><span class="s1">= </span><span class="s2">resolveFilter</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_k </span><span class="s1">= </span><span class="s2">checkKeyCodes</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_b </span><span class="s1">= </span><span class="s2">bindObjectProps</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_v </span><span class="s1">= </span><span class="s2">createTextVNode</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_e </span><span class="s1">= </span><span class="s2">createEmptyVNode</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_u </span><span class="s1">= </span><span class="s2">resolveScopedSlots</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_g </span><span class="s1">= </span><span class="s2">bindObjectListeners</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_d </span><span class="s1">= </span><span class="s2">bindDynamicKeys</span><span class="s1">;</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">_p </span><span class="s1">= </span><span class="s2">prependModifier</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Runtime helper for resolving raw children VNodes into a slot object.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">resolveSlots</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">context</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">children </span><span class="s1">|| !</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s1">{};</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">slots </span><span class="s1">= {};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">child </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">data </span><span class="s1">= </span><span class="s2">child</span><span class="s1">.</span><span class="s2">data</span><span class="s1">;</span>
        <span class="s4">// remove slot attribute if the node is resolved as a Vue slot node</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">data </span><span class="s1">&amp;&amp; </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">&amp;&amp; </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">) {</span>
            <span class="s3">delete </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s4">// named slots should only be respected if the vnode was rendered in the</span>
        <span class="s4">// same context.</span>
        <span class="s3">if </span><span class="s1">((</span><span class="s2">child</span><span class="s1">.</span><span class="s2">context </span><span class="s1">=== </span><span class="s2">context </span><span class="s1">|| </span><span class="s2">child</span><span class="s1">.</span><span class="s2">fnContext </span><span class="s1">=== </span><span class="s2">context</span><span class="s1">) &amp;&amp;</span>
            <span class="s2">data </span><span class="s1">&amp;&amp;</span>
            <span class="s2">data</span><span class="s1">.</span><span class="s2">slot </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">name </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">slot </span><span class="s1">= </span><span class="s2">slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] || (</span><span class="s2">slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = []);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
                <span class="s2">slot</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">slot</span><span class="s1">, </span><span class="s2">child</span><span class="s1">.</span><span class="s2">children </span><span class="s1">|| []);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">slot</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s1">(</span><span class="s2">slots</span><span class="s1">.</span><span class="s2">default </span><span class="s1">|| (</span><span class="s2">slots</span><span class="s1">.</span><span class="s2">default </span><span class="s1">= [])).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// ignore slots that contains only whitespace</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">name </span><span class="s3">in </span><span class="s2">slots</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">].</span><span class="s2">every</span><span class="s1">(</span><span class="s2">isWhitespace</span><span class="s1">)) {</span>
            <span class="s3">delete </span><span class="s2">slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">slots</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isWhitespace</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">&amp;&amp; !</span><span class="s2">node</span><span class="s1">.</span><span class="s2">asyncFactory</span><span class="s1">) || </span><span class="s2">node</span><span class="s1">.</span><span class="s2">text </span><span class="s1">=== </span><span class="s0">' '</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">isAsyncPlaceholder</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s4">// @ts-expect-error not really boolean type</span>
    <span class="s3">return </span><span class="s2">node</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">&amp;&amp; </span><span class="s2">node</span><span class="s1">.</span><span class="s2">asyncFactory</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">normalizeScopedSlots</span><span class="s1">(</span><span class="s2">ownerVm</span><span class="s1">, </span><span class="s2">scopedSlots</span><span class="s1">, </span><span class="s2">normalSlots</span><span class="s1">, </span><span class="s2">prevScopedSlots</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">hasNormalSlots </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">normalSlots</span><span class="s1">).</span><span class="s2">length </span><span class="s1">&gt; </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">isStable </span><span class="s1">= </span><span class="s2">scopedSlots </span><span class="s1">? !!</span><span class="s2">scopedSlots</span><span class="s1">.</span><span class="s2">$stable </span><span class="s1">: !</span><span class="s2">hasNormalSlots</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">scopedSlots </span><span class="s1">&amp;&amp; </span><span class="s2">scopedSlots</span><span class="s1">.</span><span class="s2">$key</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">scopedSlots</span><span class="s1">) {</span>
        <span class="s2">res </span><span class="s1">= {};</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">scopedSlots</span><span class="s1">.</span><span class="s2">_normalized</span><span class="s1">) {</span>
        <span class="s4">// fast path 1: child component re-render only, parent did not change</span>
        <span class="s3">return </span><span class="s2">scopedSlots</span><span class="s1">.</span><span class="s2">_normalized</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isStable </span><span class="s1">&amp;&amp;</span>
        <span class="s2">prevScopedSlots </span><span class="s1">&amp;&amp;</span>
        <span class="s2">prevScopedSlots </span><span class="s1">!== </span><span class="s2">emptyObject </span><span class="s1">&amp;&amp;</span>
        <span class="s2">key </span><span class="s1">=== </span><span class="s2">prevScopedSlots</span><span class="s1">.</span><span class="s2">$key </span><span class="s1">&amp;&amp;</span>
        <span class="s1">!</span><span class="s2">hasNormalSlots </span><span class="s1">&amp;&amp;</span>
        <span class="s1">!</span><span class="s2">prevScopedSlots</span><span class="s1">.</span><span class="s2">$hasNormal</span><span class="s1">) {</span>
        <span class="s4">// fast path 2: stable scoped slots w/ no normal slots to proxy,</span>
        <span class="s4">// only need to normalize once</span>
        <span class="s3">return </span><span class="s2">prevScopedSlots</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">res </span><span class="s1">= {};</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">scopedSlots</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">scopedSlots</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] &amp;&amp; </span><span class="s2">key</span><span class="s1">[</span><span class="s6">0</span><span class="s1">] !== </span><span class="s0">'$'</span><span class="s1">) {</span>
                <span class="s2">res</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">normalizeScopedSlot</span><span class="s1">(</span><span class="s2">ownerVm</span><span class="s1">, </span><span class="s2">normalSlots</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">scopedSlots</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// expose normal slots on scopedSlots</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">normalSlots</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">res</span><span class="s1">)) {</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">proxyNormalSlot</span><span class="s1">(</span><span class="s2">normalSlots</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// avoriaz seems to mock a non-extensible $scopedSlots object</span>
    <span class="s4">// and when that is passed down this would cause an error</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">scopedSlots </span><span class="s1">&amp;&amp; </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">isExtensible</span><span class="s1">(</span><span class="s2">scopedSlots</span><span class="s1">)) {</span>
        <span class="s2">scopedSlots</span><span class="s1">.</span><span class="s2">_normalized </span><span class="s1">= </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">def</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s0">'$stable'</span><span class="s1">, </span><span class="s2">isStable</span><span class="s1">);</span>
    <span class="s2">def</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s0">'$key'</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
    <span class="s2">def</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s0">'$hasNormal'</span><span class="s1">, </span><span class="s2">hasNormalSlots</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">normalizeScopedSlot</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">normalSlots</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">normalized </span><span class="s1">= </span><span class="s3">function </span><span class="s1">() {</span>
        <span class="s3">const </span><span class="s2">cur </span><span class="s1">= </span><span class="s2">currentInstance</span><span class="s1">;</span>
        <span class="s2">setCurrentInstance</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s3">let </span><span class="s2">res </span><span class="s1">= </span><span class="s2">arguments</span><span class="s1">.</span><span class="s2">length </span><span class="s1">? </span><span class="s2">fn</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">null</span><span class="s1">, </span><span class="s2">arguments</span><span class="s1">) : </span><span class="s2">fn</span><span class="s1">({});</span>
        <span class="s2">res </span><span class="s1">=</span>
            <span class="s2">res </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">res </span><span class="s1">=== </span><span class="s0">'object' </span><span class="s1">&amp;&amp; !</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">res</span><span class="s1">)</span>
                <span class="s1">? [</span><span class="s2">res</span><span class="s1">] </span><span class="s4">// single vnode</span>
                <span class="s1">: </span><span class="s2">normalizeChildren</span><span class="s1">(</span><span class="s2">res</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">vnode </span><span class="s1">= </span><span class="s2">res </span><span class="s1">&amp;&amp; </span><span class="s2">res</span><span class="s1">[</span><span class="s6">0</span><span class="s1">];</span>
        <span class="s2">setCurrentInstance</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s2">res </span><span class="s1">&amp;&amp;</span>
            <span class="s1">(!</span><span class="s2">vnode </span><span class="s1">||</span>
                <span class="s1">(</span><span class="s2">res</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp; </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">isComment </span><span class="s1">&amp;&amp; !</span><span class="s2">isAsyncPlaceholder</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">))) </span><span class="s4">// #9658, #10391</span>
            <span class="s1">? </span><span class="s2">undefined</span>
            <span class="s1">: </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s1">};</span>
    <span class="s4">// this is a slot using the new v-slot syntax without scope. although it is</span>
    <span class="s4">// compiled as a scoped slot, render fn users would expect it to be present</span>
    <span class="s4">// on this.$slots because the usage is semantically a normal slot.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">fn</span><span class="s1">.</span><span class="s2">proxy</span><span class="s1">) {</span>
        <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">normalSlots</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, {</span>
            <span class="s2">get</span><span class="s1">: </span><span class="s2">normalized</span><span class="s1">,</span>
            <span class="s2">enumerable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
            <span class="s2">configurable</span><span class="s1">: </span><span class="s3">true</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">normalized</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">proxyNormalSlot</span><span class="s1">(</span><span class="s2">slots</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">() =&gt; </span><span class="s2">slots</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">syncSetupProxy</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">from</span><span class="s1">, </span><span class="s2">prev</span><span class="s1">, </span><span class="s2">instance</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">changed </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">from</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">to</span><span class="s1">)) {</span>
            <span class="s2">changed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s2">defineProxyAttr</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">instance</span><span class="s1">, </span><span class="s2">type</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">from</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] !== </span><span class="s2">prev</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
            <span class="s2">changed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">to</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">from</span><span class="s1">)) {</span>
            <span class="s2">changed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s3">delete </span><span class="s2">to</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">changed</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">defineProxyAttr</span><span class="s1">(</span><span class="s2">proxy</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">instance</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) {</span>
    <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s2">proxy</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, {</span>
        <span class="s2">enumerable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">configurable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">get</span><span class="s1">() {</span>
            <span class="s3">return </span><span class="s2">instance</span><span class="s1">[</span><span class="s2">type</span><span class="s1">][</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">createAsyncPlaceholder</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">node </span><span class="s1">= </span><span class="s2">createEmptyVNode</span><span class="s1">();</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">asyncFactory </span><span class="s1">= </span><span class="s2">factory</span><span class="s1">;</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">asyncMeta </span><span class="s1">= { </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">tag </span><span class="s1">};</span>
    <span class="s3">return </span><span class="s2">node</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">resolveAsyncComponent</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">, </span><span class="s2">baseCtor</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">.</span><span class="s2">error</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">.</span><span class="s2">errorComp</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">factory</span><span class="s1">.</span><span class="s2">errorComp</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">.</span><span class="s2">resolved</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">factory</span><span class="s1">.</span><span class="s2">resolved</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">.</span><span class="s2">loading</span><span class="s1">) &amp;&amp; </span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">factory</span><span class="s1">.</span><span class="s2">loadingComp</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">factory</span><span class="s1">.</span><span class="s2">loadingComp</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">let </span><span class="s2">target</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">add</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">$on</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">remove</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s2">target</span><span class="s1">.</span><span class="s2">$off</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">createOnceHandler</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">_target </span><span class="s1">= </span><span class="s2">target</span><span class="s1">;</span>
    <span class="s3">return function </span><span class="s2">onceHandler</span><span class="s1">() {</span>
        <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">fn</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">null</span><span class="s1">, </span><span class="s2">arguments</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">res </span><span class="s1">!== </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s2">_target</span><span class="s1">.</span><span class="s2">$off</span><span class="s1">(</span><span class="s2">event</span><span class="s1">, </span><span class="s2">onceHandler</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">updateComponentListeners</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">oldListeners</span><span class="s1">) {</span>
    <span class="s2">target </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">;</span>
    <span class="s2">updateListeners</span><span class="s1">(</span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">oldListeners </span><span class="s1">|| {}, </span><span class="s2">add</span><span class="s1">, </span><span class="s2">remove</span><span class="s1">, </span><span class="s2">createOnceHandler</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s2">target </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">let </span><span class="s2">activeInstance </span><span class="s1">= </span><span class="s3">null</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">updateChildComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">parentVnode</span><span class="s1">, </span><span class="s2">renderChildren</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) ;</span>
    <span class="s4">// determine whether component has slot children</span>
    <span class="s4">// we need to do this before overwriting $options._renderChildren.</span>
    <span class="s4">// check if there are dynamic scopedSlots (hand-written or compiled but with</span>
    <span class="s4">// dynamic slot names). Static scoped slots compiled from template has the</span>
    <span class="s4">// &quot;$stable&quot; marker.</span>
    <span class="s3">const </span><span class="s2">newScopedSlots </span><span class="s1">= </span><span class="s2">parentVnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">oldScopedSlots </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$scopedSlots</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">hasDynamicScopedSlot </span><span class="s1">= !!((</span><span class="s2">newScopedSlots </span><span class="s1">&amp;&amp; !</span><span class="s2">newScopedSlots</span><span class="s1">.</span><span class="s2">$stable</span><span class="s1">) ||</span>
        <span class="s1">(</span><span class="s2">oldScopedSlots </span><span class="s1">!== </span><span class="s2">emptyObject </span><span class="s1">&amp;&amp; !</span><span class="s2">oldScopedSlots</span><span class="s1">.</span><span class="s2">$stable</span><span class="s1">) ||</span>
        <span class="s1">(</span><span class="s2">newScopedSlots </span><span class="s1">&amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$scopedSlots</span><span class="s1">.</span><span class="s2">$key </span><span class="s1">!== </span><span class="s2">newScopedSlots</span><span class="s1">.</span><span class="s2">$key</span><span class="s1">) ||</span>
        <span class="s1">(!</span><span class="s2">newScopedSlots </span><span class="s1">&amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$scopedSlots</span><span class="s1">.</span><span class="s2">$key</span><span class="s1">));</span>
    <span class="s4">// Any static slot children from the parent may have changed during parent's</span>
    <span class="s4">// update. Dynamic scoped slots may also have changed. In such cases, a forced</span>
    <span class="s4">// update is necessary to ensure correctness.</span>
    <span class="s3">let </span><span class="s2">needsForceUpdate </span><span class="s1">= !!(</span><span class="s2">renderChildren </span><span class="s1">|| </span><span class="s4">// has new static slots</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_renderChildren </span><span class="s1">|| </span><span class="s4">// has old static slots</span>
        <span class="s2">hasDynamicScopedSlot</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">prevVNode </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$vnode</span><span class="s1">;</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_parentVnode </span><span class="s1">= </span><span class="s2">parentVnode</span><span class="s1">;</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">$vnode </span><span class="s1">= </span><span class="s2">parentVnode</span><span class="s1">; </span><span class="s4">// update vm's placeholder node without re-render</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_vnode</span><span class="s1">) {</span>
        <span class="s4">// update child tree's parent</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_vnode</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">= </span><span class="s2">parentVnode</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_renderChildren </span><span class="s1">= </span><span class="s2">renderChildren</span><span class="s1">;</span>
    <span class="s4">// update $attrs and $listeners hash</span>
    <span class="s4">// these are also reactive so they may trigger child update if the child</span>
    <span class="s4">// used them during render</span>
    <span class="s3">const </span><span class="s2">attrs </span><span class="s1">= </span><span class="s2">parentVnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_attrsProxy</span><span class="s1">) {</span>
        <span class="s4">// force update if attrs are accessed and has changed since it may be</span>
        <span class="s4">// passed to a child component.</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">syncSetupProxy</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_attrsProxy</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, (</span><span class="s2">prevVNode</span><span class="s1">.</span><span class="s2">data </span><span class="s1">&amp;&amp; </span><span class="s2">prevVNode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">) || </span><span class="s2">emptyObject</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s0">'$attrs'</span><span class="s1">)) {</span>
            <span class="s2">needsForceUpdate </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">$attrs </span><span class="s1">= </span><span class="s2">attrs</span><span class="s1">;</span>
    <span class="s4">// update listeners</span>
    <span class="s2">listeners </span><span class="s1">= </span><span class="s2">listeners </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">prevListeners </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_parentListeners</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_listenersProxy</span><span class="s1">) {</span>
        <span class="s2">syncSetupProxy</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_listenersProxy</span><span class="s1">, </span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">prevListeners </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s0">'$listeners'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">$listeners </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_parentListeners </span><span class="s1">= </span><span class="s2">listeners</span><span class="s1">;</span>
    <span class="s2">updateComponentListeners</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">prevListeners</span><span class="s1">);</span>
    <span class="s4">// update props</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">propsData </span><span class="s1">&amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">props</span><span class="s1">) {</span>
        <span class="s2">toggleObserving</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">props </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_props</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">propKeys </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_propKeys </span><span class="s1">|| [];</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">propKeys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">propKeys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">const </span><span class="s2">propOptions </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">props</span><span class="s1">; </span><span class="s4">// wtf flow?</span>
            <span class="s2">props</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">validateProp</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">propOptions</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">toggleObserving</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span>
        <span class="s4">// keep a copy of raw propsData</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">propsData </span><span class="s1">= </span><span class="s2">propsData</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// resolve slots + force update if has children</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">needsForceUpdate</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$slots </span><span class="s1">= </span><span class="s2">resolveSlots</span><span class="s1">(</span><span class="s2">renderChildren</span><span class="s1">, </span><span class="s2">parentVnode</span><span class="s1">.</span><span class="s2">context</span><span class="s1">);</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$forceUpdate</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) ;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isInInactiveTree</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">vm </span><span class="s1">&amp;&amp; (</span><span class="s2">vm </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$parent</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive</span><span class="s1">)</span>
            <span class="s3">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">activateChildComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">direct</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">direct</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_directInactive </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isInInactiveTree</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)) {</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_directInactive</span><span class="s1">) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive </span><span class="s1">|| </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive </span><span class="s1">=== </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">activateChildComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
        <span class="s2">callHook</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s0">'activated'</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">deactivateChildComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">direct</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">direct</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_directInactive </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isInInactiveTree</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)) {</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">deactivateChildComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
        <span class="s2">callHook</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s0">'deactivated'</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">callHook</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">hook</span><span class="s1">, </span><span class="s2">args</span><span class="s1">, </span><span class="s2">setContext </span><span class="s1">= </span><span class="s3">true</span><span class="s1">) {</span>
    <span class="s4">// #7573 disable dep collection when invoking lifecycle hooks</span>
    <span class="s2">pushTarget</span><span class="s1">();</span>
    <span class="s3">const </span><span class="s2">prev </span><span class="s1">= </span><span class="s2">currentInstance</span><span class="s1">;</span>
    <span class="s2">setContext </span><span class="s1">&amp;&amp; </span><span class="s2">setCurrentInstance</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">handlers </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">[</span><span class="s2">hook</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">info </span><span class="s1">= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">hook</span><span class="s1">} </span><span class="s0">hook`</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">handlers</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">j </span><span class="s1">= </span><span class="s2">handlers</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">j</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">invokeWithErrorHandling</span><span class="s1">(</span><span class="s2">handlers</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">args </span><span class="s1">|| </span><span class="s3">null</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_hasHookEvent</span><span class="s1">) {</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$emit</span><span class="s1">(</span><span class="s0">'hook:' </span><span class="s1">+ </span><span class="s2">hook</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">setContext </span><span class="s1">&amp;&amp; </span><span class="s2">setCurrentInstance</span><span class="s1">(</span><span class="s2">prev</span><span class="s1">);</span>
    <span class="s2">popTarget</span><span class="s1">();</span>
<span class="s1">}</span>

<span class="s4">// Async edge case fix requires storing an event listener's attach timestamp.</span>
<span class="s3">let </span><span class="s2">getNow </span><span class="s1">= </span><span class="s2">Date</span><span class="s1">.</span><span class="s2">now</span><span class="s1">;</span>
<span class="s4">// Determine what event timestamp the browser is using. Annoyingly, the</span>
<span class="s4">// timestamp can either be hi-res (relative to page load) or low-res</span>
<span class="s4">// (relative to UNIX epoch), so in order to compare time we have to use the</span>
<span class="s4">// same timestamp type when saving the flush timestamp.</span>
<span class="s4">// All IE versions use low-res event timestamps, and have problematic clock</span>
<span class="s4">// implementations (#9632)</span>
<span class="s3">if </span><span class="s1">(</span><span class="s2">inBrowser </span><span class="s1">&amp;&amp; !</span><span class="s2">isIE</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">performance </span><span class="s1">= </span><span class="s2">window</span><span class="s1">.</span><span class="s2">performance</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">performance </span><span class="s1">&amp;&amp;</span>
        <span class="s3">typeof </span><span class="s2">performance</span><span class="s1">.</span><span class="s2">now </span><span class="s1">=== </span><span class="s0">'function' </span><span class="s1">&amp;&amp;</span>
        <span class="s2">getNow</span><span class="s1">() &gt; </span><span class="s2">document</span><span class="s1">.</span><span class="s2">createEvent</span><span class="s1">(</span><span class="s0">'Event'</span><span class="s1">).</span><span class="s2">timeStamp</span><span class="s1">) {</span>
        <span class="s4">// if the event timestamp, although evaluated AFTER the Date.now(), is</span>
        <span class="s4">// smaller than it, it means the event is using a hi-res timestamp,</span>
        <span class="s4">// and we need to use the hi-res version for event listener timestamps as</span>
        <span class="s4">// well.</span>
        <span class="s2">getNow </span><span class="s1">= () =&gt; </span><span class="s2">performance</span><span class="s1">.</span><span class="s2">now</span><span class="s1">();</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Queue a kept-alive component that was activated during patch.</span>
 <span class="s5">* The queue will be processed after the entire tree has been patched.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">queueActivatedComponent</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s4">// setting _inactive to false here so that a render function can</span>
    <span class="s4">// rely on checking whether it's in an inactive tree (e.g. router-view)</span>
    <span class="s2">vm</span><span class="s1">.</span><span class="s2">_inactive </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">handleError</span><span class="s1">(</span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">) {</span>
    <span class="s4">// Deactivate deps tracking while processing error handler to avoid possible infinite rendering.</span>
    <span class="s4">// See: https://github.com/vuejs/vuex/issues/1505</span>
    <span class="s2">pushTarget</span><span class="s1">();</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) {</span>
            <span class="s3">let </span><span class="s2">cur </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">;</span>
            <span class="s3">while </span><span class="s1">((</span><span class="s2">cur </span><span class="s1">= </span><span class="s2">cur</span><span class="s1">.</span><span class="s2">$parent</span><span class="s1">)) {</span>
                <span class="s3">const </span><span class="s2">hooks </span><span class="s1">= </span><span class="s2">cur</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">errorCaptured</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">hooks</span><span class="s1">) {</span>
                    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                        <span class="s3">try </span><span class="s1">{</span>
                            <span class="s3">const </span><span class="s2">capture </span><span class="s1">= </span><span class="s2">hooks</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">call</span><span class="s1">(</span><span class="s2">cur</span><span class="s1">, </span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">) === </span><span class="s3">false</span><span class="s1">;</span>
                            <span class="s3">if </span><span class="s1">(</span><span class="s2">capture</span><span class="s1">)</span>
                                <span class="s3">return</span><span class="s1">;</span>
                        <span class="s1">}</span>
                        <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
                            <span class="s2">globalHandleError</span><span class="s1">(</span><span class="s2">e</span><span class="s1">, </span><span class="s2">cur</span><span class="s1">, </span><span class="s0">'errorCaptured hook'</span><span class="s1">);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">globalHandleError</span><span class="s1">(</span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">finally </span><span class="s1">{</span>
        <span class="s2">popTarget</span><span class="s1">();</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">invokeWithErrorHandling</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">args</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s2">res </span><span class="s1">= </span><span class="s2">args </span><span class="s1">? </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">context</span><span class="s1">, </span><span class="s2">args</span><span class="s1">) : </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">context</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">res </span><span class="s1">&amp;&amp; !</span><span class="s2">res</span><span class="s1">.</span><span class="s2">_isVue </span><span class="s1">&amp;&amp; </span><span class="s2">isPromise</span><span class="s1">(</span><span class="s2">res</span><span class="s1">) &amp;&amp; !</span><span class="s2">res</span><span class="s1">.</span><span class="s2">_handled</span><span class="s1">) {</span>
            <span class="s2">res</span><span class="s1">.</span><span class="s2">catch</span><span class="s1">(</span><span class="s2">e </span><span class="s1">=&gt; </span><span class="s2">handleError</span><span class="s1">(</span><span class="s2">e</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info </span><span class="s1">+ </span><span class="s0">` (Promise/async)`</span><span class="s1">));</span>
            <span class="s2">res</span><span class="s1">.</span><span class="s2">_handled </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
        <span class="s2">handleError</span><span class="s1">(</span><span class="s2">e</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">globalHandleError</span><span class="s1">(</span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">) {</span>
    <span class="s2">logError</span><span class="s1">(</span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">logError</span><span class="s1">(</span><span class="s2">err</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">info</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Error in </span><span class="s2">$</span><span class="s1">{</span><span class="s2">info</span><span class="s1">}</span><span class="s0">: &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">err</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">/* istanbul ignore else */</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">inBrowser </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">console </span><span class="s1">!== </span><span class="s0">'undefined'</span><span class="s1">) {</span>
        <span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s2">err</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">throw </span><span class="s2">err</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s4">/* globals MutationObserver */</span>
<span class="s3">const </span><span class="s2">callbacks </span><span class="s1">= [];</span>
<span class="s3">function </span><span class="s2">flushCallbacks</span><span class="s1">() {</span>
    <span class="s3">const </span><span class="s2">copies </span><span class="s1">= </span><span class="s2">callbacks</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">);</span>
    <span class="s2">callbacks</span><span class="s1">.</span><span class="s2">length </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">copies</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">copies</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]();</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// The nextTick behavior leverages the microtask queue, which can be accessed</span>
<span class="s4">// via either native Promise.then or MutationObserver.</span>
<span class="s4">// MutationObserver has wider support, however it is seriously bugged in</span>
<span class="s4">// UIWebView in iOS &gt;= 9.3.3 when triggered in touch event handlers. It</span>
<span class="s4">// completely stops working after triggering a few times... so, if native</span>
<span class="s4">// Promise is available, we will use it:</span>
<span class="s4">/* istanbul ignore next, $flow-disable-line */</span>
<span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">Promise </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">Promise</span><span class="s1">)) {</span>
    <span class="s2">Promise</span><span class="s1">.</span><span class="s2">resolve</span><span class="s1">();</span>
<span class="s1">}</span>
<span class="s3">else if </span><span class="s1">(!</span><span class="s2">isIE </span><span class="s1">&amp;&amp;</span>
    <span class="s3">typeof </span><span class="s2">MutationObserver </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp;</span>
    <span class="s1">(</span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">MutationObserver</span><span class="s1">) ||</span>
        <span class="s4">// PhantomJS and iOS 7.x</span>
        <span class="s2">MutationObserver</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">() === </span><span class="s0">'[object MutationObserverConstructor]'</span><span class="s1">)) {</span>
    <span class="s4">// Use MutationObserver where native Promise is not available,</span>
    <span class="s4">// e.g. PhantomJS, iOS7, Android 4.4</span>
    <span class="s4">// (#6466 MutationObserver is unreliable in IE11)</span>
    <span class="s3">let </span><span class="s2">counter </span><span class="s1">= </span><span class="s6">1</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">observer </span><span class="s1">= </span><span class="s3">new </span><span class="s2">MutationObserver</span><span class="s1">(</span><span class="s2">flushCallbacks</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">textNode </span><span class="s1">= </span><span class="s2">document</span><span class="s1">.</span><span class="s2">createTextNode</span><span class="s1">(</span><span class="s2">String</span><span class="s1">(</span><span class="s2">counter</span><span class="s1">));</span>
    <span class="s2">observer</span><span class="s1">.</span><span class="s2">observe</span><span class="s1">(</span><span class="s2">textNode</span><span class="s1">, {</span>
        <span class="s2">characterData</span><span class="s1">: </span><span class="s3">true</span>
    <span class="s1">});</span>
<span class="s1">}</span>
<span class="s3">else if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">setImmediate </span><span class="s1">!== </span><span class="s0">'undefined' </span><span class="s1">&amp;&amp; </span><span class="s2">isNative</span><span class="s1">(</span><span class="s2">setImmediate</span><span class="s1">)) ;</span>
<span class="s3">else </span><span class="s1">;</span>

<span class="s3">const </span><span class="s2">seenObjects </span><span class="s1">= </span><span class="s3">new </span><span class="s2">_Set</span><span class="s1">();</span>
<span class="s5">/**</span>
 <span class="s5">* Recursively traverse an object to evoke all converted</span>
 <span class="s5">* getters, so that every nested property inside the object</span>
 <span class="s5">* is collected as a &quot;deep&quot; dependency.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s2">_traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s2">seenObjects</span><span class="s1">);</span>
    <span class="s2">seenObjects</span><span class="s1">.</span><span class="s2">clear</span><span class="s1">();</span>
    <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">_traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">, </span><span class="s2">seen</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">i</span><span class="s1">, </span><span class="s2">keys</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">isA </span><span class="s1">= </span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">((!</span><span class="s2">isA </span><span class="s1">&amp;&amp; !</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">val</span><span class="s1">)) ||</span>
        <span class="s2">val</span><span class="s1">.</span><span class="s2">__v_skip </span><span class="s4">/* ReactiveFlags.SKIP */ </span><span class="s1">||</span>
        <span class="s2">Object</span><span class="s1">.</span><span class="s2">isFrozen</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) ||</span>
        <span class="s2">val </span><span class="s3">instanceof </span><span class="s2">VNode</span><span class="s1">) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">val</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">depId </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">__ob__</span><span class="s1">.</span><span class="s2">dep</span><span class="s1">.</span><span class="s2">id</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">seen</span><span class="s1">.</span><span class="s2">has</span><span class="s1">(</span><span class="s2">depId</span><span class="s1">)) {</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">seen</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s2">depId</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isA</span><span class="s1">) {</span>
        <span class="s2">i </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">--)</span>
            <span class="s2">_traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">seen</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isRef</span><span class="s1">(</span><span class="s2">val</span><span class="s1">)) {</span>
        <span class="s2">_traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">.</span><span class="s2">value</span><span class="s1">, </span><span class="s2">seen</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">keys </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
        <span class="s2">i </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">--)</span>
            <span class="s2">_traverse</span><span class="s1">(</span><span class="s2">val</span><span class="s1">[</span><span class="s2">keys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]], </span><span class="s2">seen</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">resolveInject</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">inject</span><span class="s1">) {</span>
        <span class="s4">// inject is :any because flow is not smart enough to figure out cached</span>
        <span class="s3">const </span><span class="s2">result </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">keys </span><span class="s1">= </span><span class="s2">hasSymbol </span><span class="s1">? </span><span class="s2">Reflect</span><span class="s1">.</span><span class="s2">ownKeys</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">) : </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">);</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s4">// #6574 in case the inject object is observed...</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'__ob__'</span><span class="s1">)</span>
                <span class="s3">continue</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">provideKey </span><span class="s1">= </span><span class="s2">inject</span><span class="s1">[</span><span class="s2">key</span><span class="s1">].</span><span class="s2">from</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">provideKey </span><span class="s3">in </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_provided</span><span class="s1">) {</span>
                <span class="s2">result</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_provided</span><span class="s1">[</span><span class="s2">provideKey</span><span class="s1">];</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s0">'default' </span><span class="s3">in </span><span class="s2">inject</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
                <span class="s3">const </span><span class="s2">provideDefault </span><span class="s1">= </span><span class="s2">inject</span><span class="s1">[</span><span class="s2">key</span><span class="s1">].</span><span class="s2">default</span><span class="s1">;</span>
                <span class="s2">result</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">provideDefault</span><span class="s1">)</span>
                    <span class="s1">? </span><span class="s2">provideDefault</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)</span>
                    <span class="s1">: </span><span class="s2">provideDefault</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Injection &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">&quot; not found`</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">result</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">resolveConstructorOptions</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">options </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">super</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">superOptions </span><span class="s1">= </span><span class="s2">resolveConstructorOptions</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">super</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">cachedSuperOptions </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">superOptions</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">superOptions </span><span class="s1">!== </span><span class="s2">cachedSuperOptions</span><span class="s1">) {</span>
            <span class="s4">// super option changed,</span>
            <span class="s4">// need to resolve new options.</span>
            <span class="s2">Ctor</span><span class="s1">.</span><span class="s2">superOptions </span><span class="s1">= </span><span class="s2">superOptions</span><span class="s1">;</span>
            <span class="s4">// check if there are any late-modified/attached options (#4976)</span>
            <span class="s3">const </span><span class="s2">modifiedOptions </span><span class="s1">= </span><span class="s2">resolveModifiedOptions</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">);</span>
            <span class="s4">// update base extend options</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiedOptions</span><span class="s1">) {</span>
                <span class="s2">extend</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">extendOptions</span><span class="s1">, </span><span class="s2">modifiedOptions</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">options </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options </span><span class="s1">= </span><span class="s2">mergeOptions</span><span class="s1">(</span><span class="s2">superOptions</span><span class="s1">, </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">extendOptions</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">name</span><span class="s1">) {</span>
                <span class="s2">options</span><span class="s1">.</span><span class="s2">components</span><span class="s1">[</span><span class="s2">options</span><span class="s1">.</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">Ctor</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">options</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">resolveModifiedOptions</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">modified</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">latest </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">sealed </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">sealedOptions</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">latest</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">latest</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] !== </span><span class="s2">sealed</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">modified</span><span class="s1">)</span>
                <span class="s2">modified </span><span class="s1">= {};</span>
            <span class="s2">modified</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">latest</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">modified</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">FunctionalRenderContext</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">props</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">, </span><span class="s2">Ctor</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">options </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s4">// ensure the createElement function in functional components</span>
    <span class="s4">// gets a unique context - this is necessary for correct named slot check</span>
    <span class="s3">let </span><span class="s2">contextVm</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s0">'_uid'</span><span class="s1">)) {</span>
        <span class="s2">contextVm </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">);</span>
        <span class="s2">contextVm</span><span class="s1">.</span><span class="s2">_original </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s4">// the context vm passed in is a functional context as well.</span>
        <span class="s4">// in this case we want to make sure we are able to get a hold to the</span>
        <span class="s4">// real context instance.</span>
        <span class="s2">contextVm </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s4">// @ts-ignore</span>
        <span class="s2">parent </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">_original</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">isCompiled </span><span class="s1">= </span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">_compiled</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">needNormalization </span><span class="s1">= !</span><span class="s2">isCompiled</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">data </span><span class="s1">= </span><span class="s2">data</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">props </span><span class="s1">= </span><span class="s2">props</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= </span><span class="s2">children</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">listeners </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">;</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">injections </span><span class="s1">= </span><span class="s2">resolveInject</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">inject</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">);</span>
    <span class="s3">this</span><span class="s1">.</span><span class="s2">slots </span><span class="s1">= () =&gt; {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">$slots</span><span class="s1">) {</span>
            <span class="s2">normalizeScopedSlots</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">, (</span><span class="s3">this</span><span class="s1">.</span><span class="s2">$slots </span><span class="s1">= </span><span class="s2">resolveSlots</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">)));</span>
        <span class="s1">}</span>
        <span class="s3">return this</span><span class="s1">.</span><span class="s2">$slots</span><span class="s1">;</span>
    <span class="s1">};</span>
    <span class="s2">Object</span><span class="s1">.</span><span class="s2">defineProperty</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s0">'scopedSlots'</span><span class="s1">, {</span>
        <span class="s2">enumerable</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">get</span><span class="s1">() {</span>
            <span class="s3">return </span><span class="s2">normalizeScopedSlots</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">slots</span><span class="s1">());</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
    <span class="s4">// support for compiled functional template</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isCompiled</span><span class="s1">) {</span>
        <span class="s4">// exposing $options for renderStatic()</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">$options </span><span class="s1">= </span><span class="s2">options</span><span class="s1">;</span>
        <span class="s4">// pre-resolve slots for renderSlot()</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">$slots </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">slots</span><span class="s1">();</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">$scopedSlots </span><span class="s1">= </span><span class="s2">normalizeScopedSlots</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">$slots</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">_scopeId</span><span class="s1">) {</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">_c </span><span class="s1">= (</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">, </span><span class="s2">d</span><span class="s1">) =&gt; {</span>
            <span class="s3">const </span><span class="s2">vnode </span><span class="s1">= </span><span class="s2">createElement</span><span class="s1">(</span><span class="s2">contextVm</span><span class="s1">, </span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">, </span><span class="s2">d</span><span class="s1">, </span><span class="s2">needNormalization</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">vnode </span><span class="s1">&amp;&amp; !</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">)) {</span>
                <span class="s2">vnode</span><span class="s1">.</span><span class="s2">fnScopeId </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">_scopeId</span><span class="s1">;</span>
                <span class="s2">vnode</span><span class="s1">.</span><span class="s2">fnContext </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">return </span><span class="s2">vnode</span><span class="s1">;</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">_c </span><span class="s1">= (</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">, </span><span class="s2">d</span><span class="s1">) =&gt; </span><span class="s2">createElement</span><span class="s1">(</span><span class="s2">contextVm</span><span class="s1">, </span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">, </span><span class="s2">c</span><span class="s1">, </span><span class="s2">d</span><span class="s1">, </span><span class="s2">needNormalization</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">installRenderHelpers</span><span class="s1">(</span><span class="s2">FunctionalRenderContext</span><span class="s1">.</span><span class="s2">prototype</span><span class="s1">);</span>
<span class="s3">function </span><span class="s2">createFunctionalComponent</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">contextVm</span><span class="s1">, </span><span class="s2">children</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">options </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">props </span><span class="s1">= {};</span>
    <span class="s3">const </span><span class="s2">propOptions </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">props</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">propOptions</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">propOptions</span><span class="s1">) {</span>
            <span class="s2">props</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">validateProp</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">propOptions</span><span class="s1">, </span><span class="s2">propsData </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">))</span>
            <span class="s2">mergeProps</span><span class="s1">(</span><span class="s2">props</span><span class="s1">, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">props</span><span class="s1">))</span>
            <span class="s2">mergeProps</span><span class="s1">(</span><span class="s2">props</span><span class="s1">, </span><span class="s2">data</span><span class="s1">.</span><span class="s2">props</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">renderContext </span><span class="s1">= </span><span class="s3">new </span><span class="s2">FunctionalRenderContext</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">props</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">contextVm</span><span class="s1">, </span><span class="s2">Ctor</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">vnode </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">render</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">null</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">.</span><span class="s2">_c</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vnode </span><span class="s3">instanceof </span><span class="s2">VNode</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">cloneAndMarkFunctionalResult</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">)) {</span>
        <span class="s3">const </span><span class="s2">vnodes </span><span class="s1">= </span><span class="s2">normalizeChildren</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">) || [];</span>
        <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">vnodes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">);</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">vnodes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">cloneAndMarkFunctionalResult</span><span class="s1">(</span><span class="s2">vnodes</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">data</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">cloneAndMarkFunctionalResult</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">contextVm</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s2">renderContext</span><span class="s1">) {</span>
    <span class="s4">// #7817 clone node before setting fnContext, otherwise if the node is reused</span>
    <span class="s4">// (e.g. it was from a cached normal slot) the fnContext causes named slots</span>
    <span class="s4">// that should not be matched to match.</span>
    <span class="s3">const </span><span class="s2">clone </span><span class="s1">= </span><span class="s2">cloneVNode</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">);</span>
    <span class="s2">clone</span><span class="s1">.</span><span class="s2">fnContext </span><span class="s1">= </span><span class="s2">contextVm</span><span class="s1">;</span>
    <span class="s2">clone</span><span class="s1">.</span><span class="s2">fnOptions </span><span class="s1">= </span><span class="s2">options</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s1">(</span><span class="s2">clone</span><span class="s1">.</span><span class="s2">devtoolsMeta </span><span class="s1">= </span><span class="s2">clone</span><span class="s1">.</span><span class="s2">devtoolsMeta </span><span class="s1">|| {}).</span><span class="s2">renderContext </span><span class="s1">=</span>
            <span class="s2">renderContext</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">) {</span>
        <span class="s1">(</span><span class="s2">clone</span><span class="s1">.</span><span class="s2">data </span><span class="s1">|| (</span><span class="s2">clone</span><span class="s1">.</span><span class="s2">data </span><span class="s1">= {})).</span><span class="s2">slot </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">clone</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">mergeProps</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">from</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">from</span><span class="s1">) {</span>
        <span class="s2">to</span><span class="s1">[</span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)] = </span><span class="s2">from</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">getComponentName</span><span class="s1">(</span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">options</span><span class="s1">.</span><span class="s2">name </span><span class="s1">|| </span><span class="s2">options</span><span class="s1">.</span><span class="s2">__name </span><span class="s1">|| </span><span class="s2">options</span><span class="s1">.</span><span class="s2">_componentTag</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// inline hooks to be invoked on component VNodes during patch</span>
<span class="s3">const </span><span class="s2">componentVNodeHooks </span><span class="s1">= {</span>
    <span class="s2">init</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">hydrating</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentInstance </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentInstance</span><span class="s1">.</span><span class="s2">_isDestroyed </span><span class="s1">&amp;&amp;</span>
            <span class="s2">vnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">keepAlive</span><span class="s1">) {</span>
            <span class="s4">// kept-alive components, treat as a patch</span>
            <span class="s3">const </span><span class="s2">mountedNode </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">; </span><span class="s4">// work around flow</span>
            <span class="s2">componentVNodeHooks</span><span class="s1">.</span><span class="s2">prepatch</span><span class="s1">(</span><span class="s2">mountedNode</span><span class="s1">, </span><span class="s2">mountedNode</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">const </span><span class="s2">child </span><span class="s1">= (</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentInstance </span><span class="s1">= </span><span class="s2">createComponentInstanceForVnode</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">, </span><span class="s2">activeInstance</span><span class="s1">));</span>
            <span class="s2">child</span><span class="s1">.</span><span class="s2">$mount</span><span class="s1">(</span><span class="s2">hydrating </span><span class="s1">? </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">elm </span><span class="s1">: </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">hydrating</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">},</span>
    <span class="s2">prepatch</span><span class="s1">(</span><span class="s2">oldVnode</span><span class="s1">, </span><span class="s2">vnode</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">options </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentOptions</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">child </span><span class="s1">= (</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentInstance </span><span class="s1">= </span><span class="s2">oldVnode</span><span class="s1">.</span><span class="s2">componentInstance</span><span class="s1">);</span>
        <span class="s2">updateChildComponent</span><span class="s1">(</span><span class="s2">child</span><span class="s1">, </span><span class="s2">options</span><span class="s1">.</span><span class="s2">propsData</span><span class="s1">, </span><span class="s4">// updated props</span>
        <span class="s2">options</span><span class="s1">.</span><span class="s2">listeners</span><span class="s1">, </span><span class="s4">// updated listeners</span>
        <span class="s2">vnode</span><span class="s1">, </span><span class="s4">// new parent vnode</span>
        <span class="s2">options</span><span class="s1">.</span><span class="s2">children </span><span class="s4">// new children</span>
        <span class="s1">);</span>
    <span class="s1">},</span>
    <span class="s2">insert</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s1">{ </span><span class="s2">context</span><span class="s1">, </span><span class="s2">componentInstance </span><span class="s1">} = </span><span class="s2">vnode</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">componentInstance</span><span class="s1">.</span><span class="s2">_isMounted</span><span class="s1">) {</span>
            <span class="s2">componentInstance</span><span class="s1">.</span><span class="s2">_isMounted </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s2">callHook</span><span class="s1">(</span><span class="s2">componentInstance</span><span class="s1">, </span><span class="s0">'mounted'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">keepAlive</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">context</span><span class="s1">.</span><span class="s2">_isMounted</span><span class="s1">) {</span>
                <span class="s4">// vue-router#1212</span>
                <span class="s4">// During updates, a kept-alive component's child components may</span>
                <span class="s4">// change, so directly walking the tree here may call activated hooks</span>
                <span class="s4">// on incorrect children. Instead we push them into a queue which will</span>
                <span class="s4">// be processed after the whole patch process ended.</span>
                <span class="s2">queueActivatedComponent</span><span class="s1">(</span><span class="s2">componentInstance</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">activateChildComponent</span><span class="s1">(</span><span class="s2">componentInstance</span><span class="s1">, </span><span class="s3">true </span><span class="s4">/* direct */</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">},</span>
    <span class="s2">destroy</span><span class="s1">(</span><span class="s2">vnode</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s1">{ </span><span class="s2">componentInstance </span><span class="s1">} = </span><span class="s2">vnode</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">componentInstance</span><span class="s1">.</span><span class="s2">_isDestroyed</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">keepAlive</span><span class="s1">) {</span>
                <span class="s2">componentInstance</span><span class="s1">.</span><span class="s2">$destroy</span><span class="s1">();</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">deactivateChildComponent</span><span class="s1">(</span><span class="s2">componentInstance</span><span class="s1">, </span><span class="s3">true </span><span class="s4">/* direct */</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">};</span>
<span class="s3">const </span><span class="s2">hooksToMerge </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">componentVNodeHooks</span><span class="s1">);</span>
<span class="s3">function </span><span class="s2">createComponent</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">)) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">baseCtor </span><span class="s1">= </span><span class="s2">context</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">_base</span><span class="s1">;</span>
    <span class="s4">// plain options object: turn it into a constructor</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">)) {</span>
        <span class="s2">Ctor </span><span class="s1">= </span><span class="s2">baseCtor</span><span class="s1">.</span><span class="s2">extend</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// if at this stage it's not a constructor or an async component factory,</span>
    <span class="s4">// reject.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">Ctor </span><span class="s1">!== </span><span class="s0">'function'</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid Component definition: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">String</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">context</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// async component</span>
    <span class="s3">let </span><span class="s2">asyncFactory</span><span class="s1">;</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isUndef</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">cid</span><span class="s1">)) {</span>
        <span class="s2">asyncFactory </span><span class="s1">= </span><span class="s2">Ctor</span><span class="s1">;</span>
        <span class="s2">Ctor </span><span class="s1">= </span><span class="s2">resolveAsyncComponent</span><span class="s1">(</span><span class="s2">asyncFactory</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">Ctor </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">) {</span>
            <span class="s4">// return a placeholder node for async component, which is rendered</span>
            <span class="s4">// as a comment node but preserves all the raw information for the node.</span>
            <span class="s4">// the information will be used for async server-rendering and hydration.</span>
            <span class="s3">return </span><span class="s2">createAsyncPlaceholder</span><span class="s1">(</span><span class="s2">asyncFactory</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">data </span><span class="s1">= </span><span class="s2">data </span><span class="s1">|| {};</span>
    <span class="s4">// resolve constructor options in case global mixins are applied after</span>
    <span class="s4">// component constructor creation</span>
    <span class="s2">resolveConstructorOptions</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">);</span>
    <span class="s4">// transform component v-model data into props &amp; events</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">model</span><span class="s1">)) {</span>
        <span class="s4">// @ts-expect-error</span>
        <span class="s2">transformModel</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">, </span><span class="s2">data</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// extract props</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s3">const </span><span class="s2">propsData </span><span class="s1">= </span><span class="s2">extractPropsFromVNodeData</span><span class="s1">(</span><span class="s2">data</span><span class="s1">, </span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">);</span>
    <span class="s4">// functional component</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">functional</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">createFunctionalComponent</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">children</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// extract listeners, since these needs to be treated as</span>
    <span class="s4">// child component listeners instead of DOM listeners</span>
    <span class="s3">const </span><span class="s2">listeners </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on</span><span class="s1">;</span>
    <span class="s4">// replace with listeners with .native modifier</span>
    <span class="s4">// so it gets processed during parent component patch.</span>
    <span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">nativeOn</span><span class="s1">;</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isTrue</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">abstract</span><span class="s1">)) {</span>
        <span class="s4">// abstract components do not keep anything</span>
        <span class="s4">// other than props &amp; listeners &amp; slot</span>
        <span class="s4">// work around flow</span>
        <span class="s3">const </span><span class="s2">slot </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">slot</span><span class="s1">;</span>
        <span class="s2">data </span><span class="s1">= {};</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">slot</span><span class="s1">) {</span>
            <span class="s2">data</span><span class="s1">.</span><span class="s2">slot </span><span class="s1">= </span><span class="s2">slot</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// install component management hooks onto the placeholder node</span>
    <span class="s2">installComponentHooks</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
    <span class="s4">// return a placeholder vnode</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s3">const </span><span class="s2">name </span><span class="s1">= </span><span class="s2">getComponentName</span><span class="s1">(</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">options</span><span class="s1">) || </span><span class="s2">tag</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">vnode </span><span class="s1">= </span><span class="s3">new </span><span class="s2">VNode</span><span class="s1">(</span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s0">`vue-component-</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Ctor</span><span class="s1">.</span><span class="s2">cid</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name </span><span class="s1">? </span><span class="s0">`-</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">data</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span>
    <span class="s4">// @ts-expect-error</span>
    <span class="s1">{ </span><span class="s2">Ctor</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">listeners</span><span class="s1">, </span><span class="s2">tag</span><span class="s1">, </span><span class="s2">children </span><span class="s1">}, </span><span class="s2">asyncFactory</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">vnode</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">createComponentInstanceForVnode</span><span class="s1">(</span>
<span class="s4">// we know it's MountedComponentVNode but flow doesn't</span>
<span class="s2">vnode</span><span class="s1">, </span>
<span class="s4">// activeInstance in lifecycle state</span>
<span class="s2">parent</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">options </span><span class="s1">= {</span>
        <span class="s2">_isComponent</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
        <span class="s2">_parentVnode</span><span class="s1">: </span><span class="s2">vnode</span><span class="s1">,</span>
        <span class="s2">parent</span>
    <span class="s1">};</span>
    <span class="s4">// check inline-template render functions</span>
    <span class="s3">const </span><span class="s2">inlineTemplate </span><span class="s1">= </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">data</span><span class="s1">.</span><span class="s2">inlineTemplate</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">inlineTemplate</span><span class="s1">)) {</span>
        <span class="s2">options</span><span class="s1">.</span><span class="s2">render </span><span class="s1">= </span><span class="s2">inlineTemplate</span><span class="s1">.</span><span class="s2">render</span><span class="s1">;</span>
        <span class="s2">options</span><span class="s1">.</span><span class="s2">staticRenderFns </span><span class="s1">= </span><span class="s2">inlineTemplate</span><span class="s1">.</span><span class="s2">staticRenderFns</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return new </span><span class="s2">vnode</span><span class="s1">.</span><span class="s2">componentOptions</span><span class="s1">.</span><span class="s2">Ctor</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">installComponentHooks</span><span class="s1">(</span><span class="s2">data</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">hooks </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">hook </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">hook </span><span class="s1">= {});</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">hooksToMerge</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">hooksToMerge</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">existing </span><span class="s1">= </span><span class="s2">hooks</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">toMerge </span><span class="s1">= </span><span class="s2">componentVNodeHooks</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s4">// @ts-expect-error</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">existing </span><span class="s1">!== </span><span class="s2">toMerge </span><span class="s1">&amp;&amp; !(</span><span class="s2">existing </span><span class="s1">&amp;&amp; </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">_merged</span><span class="s1">)) {</span>
            <span class="s2">hooks</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">existing </span><span class="s1">? </span><span class="s2">mergeHook</span><span class="s1">(</span><span class="s2">toMerge</span><span class="s1">, </span><span class="s2">existing</span><span class="s1">) : </span><span class="s2">toMerge</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">mergeHook</span><span class="s1">(</span><span class="s2">f1</span><span class="s1">, </span><span class="s2">f2</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">merged </span><span class="s1">= (</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">) =&gt; {</span>
        <span class="s4">// flow complains about extra args which is why we use any</span>
        <span class="s2">f1</span><span class="s1">(</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">);</span>
        <span class="s2">f2</span><span class="s1">(</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">);</span>
    <span class="s1">};</span>
    <span class="s2">merged</span><span class="s1">.</span><span class="s2">_merged </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">merged</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// transform component v-model info (value and callback) into</span>
<span class="s4">// prop and event handler respectively.</span>
<span class="s3">function </span><span class="s2">transformModel</span><span class="s1">(</span><span class="s2">options</span><span class="s1">, </span><span class="s2">data</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">prop </span><span class="s1">= (</span><span class="s2">options</span><span class="s1">.</span><span class="s2">model </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">prop</span><span class="s1">) || </span><span class="s0">'value'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">event </span><span class="s1">= (</span><span class="s2">options</span><span class="s1">.</span><span class="s2">model </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">event</span><span class="s1">) || </span><span class="s0">'input'</span><span class="s1">;</span>
    <span class="s1">(</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">= {}))[</span><span class="s2">prop</span><span class="s1">] = </span><span class="s2">data</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">on </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">|| (</span><span class="s2">data</span><span class="s1">.</span><span class="s2">on </span><span class="s1">= {});</span>
    <span class="s3">const </span><span class="s2">existing </span><span class="s1">= </span><span class="s2">on</span><span class="s1">[</span><span class="s2">event</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">callback </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">callback</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDef</span><span class="s1">(</span><span class="s2">existing</span><span class="s1">)) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">existing</span><span class="s1">)</span>
            <span class="s1">? </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">callback</span><span class="s1">) === -</span><span class="s6">1</span>
            <span class="s1">: </span><span class="s2">existing </span><span class="s1">!== </span><span class="s2">callback</span><span class="s1">) {</span>
            <span class="s2">on</span><span class="s1">[</span><span class="s2">event</span><span class="s1">] = [</span><span class="s2">callback</span><span class="s1">].</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">existing</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">on</span><span class="s1">[</span><span class="s2">event</span><span class="s1">] = </span><span class="s2">callback</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">let </span><span class="s2">warn$2 </span><span class="s1">= </span><span class="s2">noop</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">tip </span><span class="s1">= </span><span class="s2">noop</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">generateComponentTrace</span><span class="s1">; </span><span class="s4">// work around flow check</span>
<span class="s3">let </span><span class="s2">formatComponentName</span><span class="s1">;</span>
<span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">hasConsole </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">console </span><span class="s1">!== </span><span class="s0">'undefined'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">classifyRE </span><span class="s1">= </span><span class="s7">/(?:^|[-_])(\w)/g</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">classify </span><span class="s1">= </span><span class="s2">str </span><span class="s1">=&gt; </span><span class="s2">str</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">classifyRE</span><span class="s1">, </span><span class="s2">c </span><span class="s1">=&gt; </span><span class="s2">c</span><span class="s1">.</span><span class="s2">toUpperCase</span><span class="s1">()).</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/[-_]/g</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s2">warn$2 </span><span class="s1">= (</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">vm </span><span class="s1">= </span><span class="s2">currentInstance</span><span class="s1">) =&gt; {</span>
        <span class="s3">const </span><span class="s2">trace </span><span class="s1">= </span><span class="s2">vm </span><span class="s1">? </span><span class="s2">generateComponentTrace</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) : </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">hasConsole </span><span class="s1">&amp;&amp; !</span><span class="s2">config</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">) {</span>
            <span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s0">`[Vue warn]: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">msg</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">trace</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
    <span class="s2">tip </span><span class="s1">= (</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">hasConsole </span><span class="s1">&amp;&amp; !</span><span class="s2">config</span><span class="s1">.</span><span class="s2">silent</span><span class="s1">) {</span>
            <span class="s2">console</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">`[Vue tip]: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">msg</span><span class="s1">}</span><span class="s0">` </span><span class="s1">+ (</span><span class="s2">vm </span><span class="s1">? </span><span class="s2">generateComponentTrace</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) : </span><span class="s0">''</span><span class="s1">));</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
    <span class="s2">formatComponentName </span><span class="s1">= (</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">includeFile</span><span class="s1">) =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$root </span><span class="s1">=== </span><span class="s2">vm</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s0">'&lt;Root&gt;'</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">const </span><span class="s2">options </span><span class="s1">= </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) &amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">cid </span><span class="s1">!= </span><span class="s3">null</span>
            <span class="s1">? </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">options</span>
            <span class="s1">: </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_isVue</span>
                <span class="s1">? </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$options </span><span class="s1">|| </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">constructor</span><span class="s1">.</span><span class="s2">options</span>
                <span class="s1">: </span><span class="s2">vm</span><span class="s1">;</span>
        <span class="s3">let </span><span class="s2">name </span><span class="s1">= </span><span class="s2">getComponentName</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">file </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">__file</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">name </span><span class="s1">&amp;&amp; </span><span class="s2">file</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">match </span><span class="s1">= </span><span class="s2">file</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s7">/([^/\\]+)\.vue$/</span><span class="s1">);</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s2">match </span><span class="s1">&amp;&amp; </span><span class="s2">match</span><span class="s1">[</span><span class="s6">1</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s1">((</span><span class="s2">name </span><span class="s1">? </span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">classify</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)}</span><span class="s0">&gt;` </span><span class="s1">: </span><span class="s0">`&lt;Anonymous&gt;`</span><span class="s1">) +</span>
            <span class="s1">(</span><span class="s2">file </span><span class="s1">&amp;&amp; </span><span class="s2">includeFile </span><span class="s1">!== </span><span class="s3">false </span><span class="s1">? </span><span class="s0">` at </span><span class="s2">$</span><span class="s1">{</span><span class="s2">file</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">));</span>
    <span class="s1">};</span>
    <span class="s3">const </span><span class="s2">repeat </span><span class="s1">= (</span><span class="s2">str</span><span class="s1">, </span><span class="s2">n</span><span class="s1">) =&gt; {</span>
        <span class="s3">let </span><span class="s2">res </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">n</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">n </span><span class="s1">% </span><span class="s6">2 </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">)</span>
                <span class="s2">res </span><span class="s1">+= </span><span class="s2">str</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">n </span><span class="s1">&gt; </span><span class="s6">1</span><span class="s1">)</span>
                <span class="s2">str </span><span class="s1">+= </span><span class="s2">str</span><span class="s1">;</span>
            <span class="s2">n </span><span class="s1">&gt;&gt;= </span><span class="s6">1</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s1">};</span>
    <span class="s2">generateComponentTrace </span><span class="s1">= (</span><span class="s2">vm</span><span class="s1">) =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_isVue </span><span class="s1">&amp;&amp; </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$parent</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">tree </span><span class="s1">= [];</span>
            <span class="s3">let </span><span class="s2">currentRecursiveSequence </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
            <span class="s3">while </span><span class="s1">(</span><span class="s2">vm</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">tree</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&gt; </span><span class="s6">0</span><span class="s1">) {</span>
                    <span class="s3">const </span><span class="s2">last </span><span class="s1">= </span><span class="s2">tree</span><span class="s1">[</span><span class="s2">tree</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">];</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">last</span><span class="s1">.</span><span class="s2">constructor </span><span class="s1">=== </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">constructor</span><span class="s1">) {</span>
                        <span class="s2">currentRecursiveSequence</span><span class="s1">++;</span>
                        <span class="s2">vm </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$parent</span><span class="s1">;</span>
                        <span class="s3">continue</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s3">else if </span><span class="s1">(</span><span class="s2">currentRecursiveSequence </span><span class="s1">&gt; </span><span class="s6">0</span><span class="s1">) {</span>
                        <span class="s2">tree</span><span class="s1">[</span><span class="s2">tree</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">] = [</span><span class="s2">last</span><span class="s1">, </span><span class="s2">currentRecursiveSequence</span><span class="s1">];</span>
                        <span class="s2">currentRecursiveSequence </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s2">tree</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">);</span>
                <span class="s2">vm </span><span class="s1">= </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">$parent</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">return </span><span class="s1">(</span><span class="s0">'</span><span class="s3">\n\n</span><span class="s0">found in</span><span class="s3">\n\n</span><span class="s0">' </span><span class="s1">+</span>
                <span class="s2">tree</span>
                    <span class="s1">.</span><span class="s2">map</span><span class="s1">((</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">i</span><span class="s1">) =&gt; </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">i </span><span class="s1">=== </span><span class="s6">0 </span><span class="s1">? </span><span class="s0">'---&gt; ' </span><span class="s1">: </span><span class="s2">repeat</span><span class="s1">(</span><span class="s0">' '</span><span class="s1">, </span><span class="s6">5 </span><span class="s1">+ </span><span class="s2">i </span><span class="s1">* </span><span class="s6">2</span><span class="s1">)}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)</span>
                    <span class="s1">? </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">formatComponentName</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">[</span><span class="s6">0</span><span class="s1">])}</span><span class="s0">... (</span><span class="s2">$</span><span class="s1">{</span><span class="s2">vm</span><span class="s1">[</span><span class="s6">1</span><span class="s1">]} </span><span class="s0">recursive calls)`</span>
                    <span class="s1">: </span><span class="s2">formatComponentName</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">)</span>
                    <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">));</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">return </span><span class="s0">`</span><span class="s3">\n\n</span><span class="s0">(found in </span><span class="s2">$</span><span class="s1">{</span><span class="s2">formatComponentName</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)}</span><span class="s0">)`</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Option overwriting strategies are functions that handle</span>
 <span class="s5">* how to merge a parent option value and a child option</span>
 <span class="s5">* value into the final value.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">strats </span><span class="s1">= </span><span class="s2">config</span><span class="s1">.</span><span class="s2">optionMergeStrategies</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* Options with restrictions</span>
 <span class="s5">*/</span>
<span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
    <span class="s2">strats</span><span class="s1">.</span><span class="s2">el </span><span class="s1">= </span><span class="s2">strats</span><span class="s1">.</span><span class="s2">propsData </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">child</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">vm</span><span class="s1">) {</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`option &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">&quot; can only be used during instance ` </span><span class="s1">+</span>
                <span class="s0">'creation with the `new` keyword.'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">defaultStrat</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">child</span><span class="s1">);</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Helper that recursively merges two data objects together.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">mergeData</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">from</span><span class="s1">, </span><span class="s2">recursive </span><span class="s1">= </span><span class="s3">true</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">from</span><span class="s1">)</span>
        <span class="s3">return </span><span class="s2">to</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">key</span><span class="s1">, </span><span class="s2">toVal</span><span class="s1">, </span><span class="s2">fromVal</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">keys </span><span class="s1">= </span><span class="s2">hasSymbol</span>
        <span class="s1">? </span><span class="s2">Reflect</span><span class="s1">.</span><span class="s2">ownKeys</span><span class="s1">(</span><span class="s2">from</span><span class="s1">)</span>
        <span class="s1">: </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">from</span><span class="s1">);</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">key </span><span class="s1">= </span><span class="s2">keys</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s4">// in case the object is already observed...</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'__ob__'</span><span class="s1">)</span>
            <span class="s3">continue</span><span class="s1">;</span>
        <span class="s2">toVal </span><span class="s1">= </span><span class="s2">to</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s2">fromVal </span><span class="s1">= </span><span class="s2">from</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">recursive </span><span class="s1">|| !</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">key</span><span class="s1">)) {</span>
            <span class="s2">set</span><span class="s1">(</span><span class="s2">to</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">fromVal</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">toVal </span><span class="s1">!== </span><span class="s2">fromVal </span><span class="s1">&amp;&amp;</span>
            <span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">toVal</span><span class="s1">) &amp;&amp;</span>
            <span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">fromVal</span><span class="s1">)) {</span>
            <span class="s2">mergeData</span><span class="s1">(</span><span class="s2">toVal</span><span class="s1">, </span><span class="s2">fromVal</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">to</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Data</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">mergeDataOrFn</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">vm</span><span class="s1">) {</span>
        <span class="s4">// in a Vue.extend merge, both should be functions</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">childVal</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">parentVal</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">parentVal</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">childVal</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s4">// when parentVal &amp; childVal are both present,</span>
        <span class="s4">// we need to return a function that returns the</span>
        <span class="s4">// merged result of both functions... no need to</span>
        <span class="s4">// check if parentVal is a function here because</span>
        <span class="s4">// it has to be a function to pass previous merges.</span>
        <span class="s3">return function </span><span class="s2">mergedDataFn</span><span class="s1">() {</span>
            <span class="s3">return </span><span class="s2">mergeData</span><span class="s1">(</span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">) ? </span><span class="s2">childVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s3">this</span><span class="s1">) : </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">) ? </span><span class="s2">parentVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s3">this</span><span class="s1">) : </span><span class="s2">parentVal</span><span class="s1">);</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return function </span><span class="s2">mergedInstanceDataFn</span><span class="s1">() {</span>
            <span class="s4">// instance merge</span>
            <span class="s3">const </span><span class="s2">instanceData </span><span class="s1">= </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">)</span>
                <span class="s1">? </span><span class="s2">childVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">)</span>
                <span class="s1">: </span><span class="s2">childVal</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">defaultData </span><span class="s1">= </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">)</span>
                <span class="s1">? </span><span class="s2">parentVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">)</span>
                <span class="s1">: </span><span class="s2">parentVal</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">instanceData</span><span class="s1">) {</span>
                <span class="s3">return </span><span class="s2">mergeData</span><span class="s1">(</span><span class="s2">instanceData</span><span class="s1">, </span><span class="s2">defaultData</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s3">return </span><span class="s2">defaultData</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">strats</span><span class="s1">.</span><span class="s2">data </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">vm</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal </span><span class="s1">&amp;&amp; </span><span class="s3">typeof </span><span class="s2">childVal </span><span class="s1">!== </span><span class="s0">'function'</span><span class="s1">) {</span>
            <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'The &quot;data&quot; option should be a function ' </span><span class="s1">+</span>
                    <span class="s0">'that returns a per-instance value in component ' </span><span class="s1">+</span>
                    <span class="s0">'definitions.'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s3">return </span><span class="s2">parentVal</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">mergeDataOrFn</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">mergeDataOrFn</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
<span class="s1">};</span>
<span class="s5">/**</span>
 <span class="s5">* Hooks and props are merged as arrays.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">mergeLifecycleHook</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">childVal</span>
        <span class="s1">? </span><span class="s2">parentVal</span>
            <span class="s1">? </span><span class="s2">parentVal</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">)</span>
                <span class="s1">? </span><span class="s2">childVal</span>
                <span class="s1">: [</span><span class="s2">childVal</span><span class="s1">]</span>
        <span class="s1">: </span><span class="s2">parentVal</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s2">res </span><span class="s1">? </span><span class="s2">dedupeHooks</span><span class="s1">(</span><span class="s2">res</span><span class="s1">) : </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">dedupeHooks</span><span class="s1">(</span><span class="s2">hooks</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= [];</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">hooks</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s2">hooks</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]) === -</span><span class="s6">1</span><span class="s1">) {</span>
            <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">hooks</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s2">LIFECYCLE_HOOKS</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">hook </span><span class="s1">=&gt; {</span>
    <span class="s2">strats</span><span class="s1">[</span><span class="s2">hook</span><span class="s1">] = </span><span class="s2">mergeLifecycleHook</span><span class="s1">;</span>
<span class="s1">});</span>
<span class="s5">/**</span>
 <span class="s5">* Assets</span>
 <span class="s5">*</span>
 <span class="s5">* When a vm is present (instance creation), we need to do</span>
 <span class="s5">* a three-way merge between constructor options, instance</span>
 <span class="s5">* options and parent options.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">mergeAssets</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">parentVal </span><span class="s1">|| </span><span class="s3">null</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">) {</span>
        <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">assertObjectType</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s2">extend</span><span class="s1">(</span><span class="s2">res</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">ASSET_TYPES</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">type</span><span class="s1">) {</span>
    <span class="s2">strats</span><span class="s1">[</span><span class="s2">type </span><span class="s1">+ </span><span class="s0">'s'</span><span class="s1">] = </span><span class="s2">mergeAssets</span><span class="s1">;</span>
<span class="s1">});</span>
<span class="s5">/**</span>
 <span class="s5">* Watchers.</span>
 <span class="s5">*</span>
 <span class="s5">* Watchers hashes should not overwrite one</span>
 <span class="s5">* another, so we merge them as arrays.</span>
 <span class="s5">*/</span>
<span class="s2">strats</span><span class="s1">.</span><span class="s2">watch </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s4">// work around Firefox's Object.prototype.watch...</span>
    <span class="s4">//@ts-expect-error work around</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">parentVal </span><span class="s1">=== </span><span class="s2">nativeWatch</span><span class="s1">)</span>
        <span class="s2">parentVal </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
    <span class="s4">//@ts-expect-error work around</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal </span><span class="s1">=== </span><span class="s2">nativeWatch</span><span class="s1">)</span>
        <span class="s2">childVal </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
    <span class="s4">/* istanbul ignore if */</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">childVal</span><span class="s1">)</span>
        <span class="s3">return </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">parentVal </span><span class="s1">|| </span><span class="s3">null</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">assertObjectType</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">parentVal</span><span class="s1">)</span>
        <span class="s3">return </span><span class="s2">childVal</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">ret </span><span class="s1">= {};</span>
    <span class="s2">extend</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">, </span><span class="s2">parentVal</span><span class="s1">);</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">childVal</span><span class="s1">) {</span>
        <span class="s3">let </span><span class="s2">parent </span><span class="s1">= </span><span class="s2">ret</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">child </span><span class="s1">= </span><span class="s2">childVal</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">parent </span><span class="s1">&amp;&amp; !</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">)) {</span>
            <span class="s2">parent </span><span class="s1">= [</span><span class="s2">parent</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s2">ret</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">parent </span><span class="s1">? </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">child</span><span class="s1">) : </span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">child</span><span class="s1">) ? </span><span class="s2">child </span><span class="s1">: [</span><span class="s2">child</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
<span class="s1">};</span>
<span class="s5">/**</span>
 <span class="s5">* Other object hashes.</span>
 <span class="s5">*/</span>
<span class="s2">strats</span><span class="s1">.</span><span class="s2">props </span><span class="s1">=</span>
    <span class="s2">strats</span><span class="s1">.</span><span class="s2">methods </span><span class="s1">=</span>
        <span class="s2">strats</span><span class="s1">.</span><span class="s2">inject </span><span class="s1">=</span>
            <span class="s2">strats</span><span class="s1">.</span><span class="s2">computed </span><span class="s1">=</span>
                <span class="s3">function </span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal </span><span class="s1">&amp;&amp; </span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                        <span class="s2">assertObjectType</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(!</span><span class="s2">parentVal</span><span class="s1">)</span>
                        <span class="s3">return </span><span class="s2">childVal</span><span class="s1">;</span>
                    <span class="s3">const </span><span class="s2">ret </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
                    <span class="s2">extend</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">, </span><span class="s2">parentVal</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">)</span>
                        <span class="s2">extend</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">);</span>
                    <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
                <span class="s1">};</span>
<span class="s2">strats</span><span class="s1">.</span><span class="s2">provide </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">parentVal</span><span class="s1">)</span>
        <span class="s3">return </span><span class="s2">childVal</span><span class="s1">;</span>
    <span class="s3">return function </span><span class="s1">() {</span>
        <span class="s3">const </span><span class="s2">ret </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
        <span class="s2">mergeData</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">, </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">) ? </span><span class="s2">parentVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">) : </span><span class="s2">parentVal</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">) {</span>
            <span class="s2">mergeData</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">, </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">childVal</span><span class="s1">) ? </span><span class="s2">childVal</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">) : </span><span class="s2">childVal</span><span class="s1">, </span><span class="s3">false </span><span class="s4">// non-recursive</span>
            <span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
    <span class="s1">};</span>
<span class="s1">};</span>
<span class="s5">/**</span>
 <span class="s5">* Default strategy.</span>
 <span class="s5">*/</span>
<span class="s3">const </span><span class="s2">defaultStrat </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">parentVal</span><span class="s1">, </span><span class="s2">childVal</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">childVal </span><span class="s1">=== </span><span class="s2">undefined </span><span class="s1">? </span><span class="s2">parentVal </span><span class="s1">: </span><span class="s2">childVal</span><span class="s1">;</span>
<span class="s1">};</span>
<span class="s5">/**</span>
 <span class="s5">* Validate component names</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">checkComponents</span><span class="s1">(</span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">options</span><span class="s1">.</span><span class="s2">components</span><span class="s1">) {</span>
        <span class="s2">validateComponentName</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">validateComponentName</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">`^[a-zA-Z][</span><span class="s3">\\</span><span class="s0">-</span><span class="s3">\\</span><span class="s0">.0-9_</span><span class="s2">$</span><span class="s1">{</span><span class="s2">unicodeRegExp</span><span class="s1">.</span><span class="s2">source</span><span class="s1">}</span><span class="s0">]*$`</span><span class="s1">).</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Invalid component name: &quot;' </span><span class="s1">+</span>
            <span class="s2">name </span><span class="s1">+</span>
            <span class="s0">'&quot;. Component names ' </span><span class="s1">+</span>
            <span class="s0">'should conform to valid custom element name in html5 specification.'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isBuiltInTag</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) || </span><span class="s2">config</span><span class="s1">.</span><span class="s2">isReservedTag</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Do not use built-in or reserved HTML elements as component ' </span><span class="s1">+</span>
            <span class="s0">'id: ' </span><span class="s1">+</span>
            <span class="s2">name</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Ensure all props option syntax are normalized into the</span>
 <span class="s5">* Object-based format.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">normalizeProps</span><span class="s1">(</span><span class="s2">options</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">props </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">props</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">props</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
    <span class="s3">let </span><span class="s2">i</span><span class="s1">, </span><span class="s2">val</span><span class="s1">, </span><span class="s2">name</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">props</span><span class="s1">)) {</span>
        <span class="s2">i </span><span class="s1">= </span><span class="s2">props</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">--) {</span>
            <span class="s2">val </span><span class="s1">= </span><span class="s2">props</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">val </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
                <span class="s2">name </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">val</span><span class="s1">);</span>
                <span class="s2">res</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = { </span><span class="s2">type</span><span class="s1">: </span><span class="s3">null </span><span class="s1">};</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'props must be strings when using array syntax.'</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">props</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">props</span><span class="s1">) {</span>
            <span class="s2">val </span><span class="s1">= </span><span class="s2">props</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
            <span class="s2">res</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) ? </span><span class="s2">val </span><span class="s1">: { </span><span class="s2">type</span><span class="s1">: </span><span class="s2">val </span><span class="s1">};</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid value for option &quot;props&quot;: expected an Array or an Object, ` </span><span class="s1">+</span>
            <span class="s0">`but got </span><span class="s2">$</span><span class="s1">{</span><span class="s2">toRawType</span><span class="s1">(</span><span class="s2">props</span><span class="s1">)}</span><span class="s0">.`</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">options</span><span class="s1">.</span><span class="s2">props </span><span class="s1">= </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Normalize all injections into Object-based format</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">normalizeInject</span><span class="s1">(</span><span class="s2">options</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">inject </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">inject</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">inject</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">normalized </span><span class="s1">= (</span><span class="s2">options</span><span class="s1">.</span><span class="s2">inject </span><span class="s1">= {});</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">inject</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">normalized</span><span class="s1">[</span><span class="s2">inject</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]] = { </span><span class="s2">from</span><span class="s1">: </span><span class="s2">inject</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] };</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">)) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">inject</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">val </span><span class="s1">= </span><span class="s2">inject</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s2">normalized</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">val</span><span class="s1">)</span>
                <span class="s1">? </span><span class="s2">extend</span><span class="s1">({ </span><span class="s2">from</span><span class="s1">: </span><span class="s2">key </span><span class="s1">}, </span><span class="s2">val</span><span class="s1">)</span>
                <span class="s1">: { </span><span class="s2">from</span><span class="s1">: </span><span class="s2">val </span><span class="s1">};</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid value for option &quot;inject&quot;: expected an Array or an Object, ` </span><span class="s1">+</span>
            <span class="s0">`but got </span><span class="s2">$</span><span class="s1">{</span><span class="s2">toRawType</span><span class="s1">(</span><span class="s2">inject</span><span class="s1">)}</span><span class="s0">.`</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Normalize raw function directives into object format.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">normalizeDirectives</span><span class="s1">(</span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">dirs </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dirs</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">dirs</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">def </span><span class="s1">= </span><span class="s2">dirs</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">def</span><span class="s1">)) {</span>
                <span class="s2">dirs</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = { </span><span class="s2">bind</span><span class="s1">: </span><span class="s2">def</span><span class="s1">, </span><span class="s2">update</span><span class="s1">: </span><span class="s2">def </span><span class="s1">};</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">assertObjectType</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`Invalid value for option &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;: expected an Object, ` </span><span class="s1">+</span>
            <span class="s0">`but got </span><span class="s2">$</span><span class="s1">{</span><span class="s2">toRawType</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)}</span><span class="s0">.`</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Merge two option objects into a new one.</span>
 <span class="s5">* Core utility used in both instantiation and inheritance.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">mergeOptions</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">child</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">checkComponents</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">child</span><span class="s1">)) {</span>
        <span class="s4">// @ts-expect-error</span>
        <span class="s2">child </span><span class="s1">= </span><span class="s2">child</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">normalizeProps</span><span class="s1">(</span><span class="s2">child</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s2">normalizeInject</span><span class="s1">(</span><span class="s2">child</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s2">normalizeDirectives</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
    <span class="s4">// Apply extends and mixins on the child options,</span>
    <span class="s4">// but only if it is a raw options object that isn't</span>
    <span class="s4">// the result of another mergeOptions call.</span>
    <span class="s4">// Only merged options has the _base property.</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">child</span><span class="s1">.</span><span class="s2">_base</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">extends</span><span class="s1">) {</span>
            <span class="s2">parent </span><span class="s1">= </span><span class="s2">mergeOptions</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">child</span><span class="s1">.</span><span class="s2">extends</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">mixins</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">child</span><span class="s1">.</span><span class="s2">mixins</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">parent </span><span class="s1">= </span><span class="s2">mergeOptions</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">child</span><span class="s1">.</span><span class="s2">mixins</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">options </span><span class="s1">= {};</span>
    <span class="s3">let </span><span class="s2">key</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">parent</span><span class="s1">) {</span>
        <span class="s2">mergeField</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">key </span><span class="s3">in </span><span class="s2">child</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">key</span><span class="s1">)) {</span>
            <span class="s2">mergeField</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">mergeField</span><span class="s1">(</span><span class="s2">key</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">strat </span><span class="s1">= </span><span class="s2">strats</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] || </span><span class="s2">defaultStrat</span><span class="s1">;</span>
        <span class="s2">options</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">strat</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">[</span><span class="s2">key</span><span class="s1">], </span><span class="s2">child</span><span class="s1">[</span><span class="s2">key</span><span class="s1">], </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">options</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Resolve an asset.</span>
 <span class="s5">* This function is used because child instances need access</span>
 <span class="s5">* to assets defined in its ancestor chain.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">resolveAsset</span><span class="s1">(</span><span class="s2">options</span><span class="s1">, </span><span class="s2">type</span><span class="s1">, </span><span class="s2">id</span><span class="s1">, </span><span class="s2">warnMissing</span><span class="s1">) {</span>
    <span class="s4">/* istanbul ignore if */</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">id </span><span class="s1">!== </span><span class="s0">'string'</span><span class="s1">) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">assets </span><span class="s1">= </span><span class="s2">options</span><span class="s1">[</span><span class="s2">type</span><span class="s1">];</span>
    <span class="s4">// check local registration variations first</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">assets</span><span class="s1">, </span><span class="s2">id</span><span class="s1">))</span>
        <span class="s3">return </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">id</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">camelizedId </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">id</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">assets</span><span class="s1">, </span><span class="s2">camelizedId</span><span class="s1">))</span>
        <span class="s3">return </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">camelizedId</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">PascalCaseId </span><span class="s1">= </span><span class="s2">capitalize</span><span class="s1">(</span><span class="s2">camelizedId</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">assets</span><span class="s1">, </span><span class="s2">PascalCaseId</span><span class="s1">))</span>
        <span class="s3">return </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">PascalCaseId</span><span class="s1">];</span>
    <span class="s4">// fallback to prototype chain</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">id</span><span class="s1">] || </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">camelizedId</span><span class="s1">] || </span><span class="s2">assets</span><span class="s1">[</span><span class="s2">PascalCaseId</span><span class="s1">];</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">warnMissing </span><span class="s1">&amp;&amp; !</span><span class="s2">res</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Failed to resolve ' </span><span class="s1">+ </span><span class="s2">type</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">) + </span><span class="s0">': ' </span><span class="s1">+ </span><span class="s2">id</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">validateProp</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s2">propOptions</span><span class="s1">, </span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">prop </span><span class="s1">= </span><span class="s2">propOptions</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">absent </span><span class="s1">= !</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">propsData</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
    <span class="s3">let </span><span class="s2">value </span><span class="s1">= </span><span class="s2">propsData</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s4">// boolean casting</span>
    <span class="s3">const </span><span class="s2">booleanIndex </span><span class="s1">= </span><span class="s2">getTypeIndex</span><span class="s1">(</span><span class="s2">Boolean</span><span class="s1">, </span><span class="s2">prop</span><span class="s1">.</span><span class="s2">type</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">booleanIndex </span><span class="s1">&gt; -</span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">absent </span><span class="s1">&amp;&amp; !</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">, </span><span class="s0">'default'</span><span class="s1">)) {</span>
            <span class="s2">value </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'' </span><span class="s1">|| </span><span class="s2">value </span><span class="s1">=== </span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)) {</span>
            <span class="s4">// only cast empty string / same name to boolean if</span>
            <span class="s4">// boolean has higher priority</span>
            <span class="s3">const </span><span class="s2">stringIndex </span><span class="s1">= </span><span class="s2">getTypeIndex</span><span class="s1">(</span><span class="s2">String</span><span class="s1">, </span><span class="s2">prop</span><span class="s1">.</span><span class="s2">type</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">stringIndex </span><span class="s1">&lt; </span><span class="s6">0 </span><span class="s1">|| </span><span class="s2">booleanIndex </span><span class="s1">&lt; </span><span class="s2">stringIndex</span><span class="s1">) {</span>
                <span class="s2">value </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// check default value</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">value </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">) {</span>
        <span class="s2">value </span><span class="s1">= </span><span class="s2">getPropDefaultValue</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">prop</span><span class="s1">, </span><span class="s2">key</span><span class="s1">);</span>
        <span class="s4">// since the default value is a fresh copy,</span>
        <span class="s4">// make sure to observe it.</span>
        <span class="s3">const </span><span class="s2">prevShouldObserve </span><span class="s1">= </span><span class="s2">shouldObserve</span><span class="s1">;</span>
        <span class="s2">toggleObserving</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span>
        <span class="s2">observe</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
        <span class="s2">toggleObserving</span><span class="s1">(</span><span class="s2">prevShouldObserve</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">assertProp</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">, </span><span class="s2">key</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">absent</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">value</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Get the default value of a prop.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">getPropDefaultValue</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">, </span><span class="s2">prop</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s4">// no default, return undefined</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">hasOwn</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">, </span><span class="s0">'default'</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">undefined</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">def </span><span class="s1">= </span><span class="s2">prop</span><span class="s1">.</span><span class="s2">default</span><span class="s1">;</span>
    <span class="s4">// warn against non-factory defaults for Object &amp; Array</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">isObject</span><span class="s1">(</span><span class="s2">def</span><span class="s1">)) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Invalid default value for prop &quot;' </span><span class="s1">+</span>
            <span class="s2">key </span><span class="s1">+</span>
            <span class="s0">'&quot;: ' </span><span class="s1">+</span>
            <span class="s0">'Props with type Object/Array must use a factory function ' </span><span class="s1">+</span>
            <span class="s0">'to return the default value.'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// the raw prop value was also undefined from previous render,</span>
    <span class="s4">// return previous default value to avoid unnecessary watcher trigger</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">vm </span><span class="s1">&amp;&amp;</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">propsData </span><span class="s1">&amp;&amp;</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">$options</span><span class="s1">.</span><span class="s2">propsData</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] === </span><span class="s2">undefined </span><span class="s1">&amp;&amp;</span>
        <span class="s2">vm</span><span class="s1">.</span><span class="s2">_props</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] !== </span><span class="s2">undefined</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">vm</span><span class="s1">.</span><span class="s2">_props</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s4">// call factory function for non-Function types</span>
    <span class="s4">// a value is Function if its prototype is function even across different execution context</span>
    <span class="s3">return </span><span class="s2">isFunction</span><span class="s1">(</span><span class="s2">def</span><span class="s1">) &amp;&amp; </span><span class="s2">getType</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">type</span><span class="s1">) !== </span><span class="s0">'Function'</span>
        <span class="s1">? </span><span class="s2">def</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s2">vm</span><span class="s1">)</span>
        <span class="s1">: </span><span class="s2">def</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Assert whether a prop is valid.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">assertProp</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">, </span><span class="s2">absent</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">required </span><span class="s1">&amp;&amp; </span><span class="s2">absent</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Missing required prop: &quot;' </span><span class="s1">+ </span><span class="s2">name </span><span class="s1">+ </span><span class="s0">'&quot;'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">value </span><span class="s1">== </span><span class="s3">null </span><span class="s1">&amp;&amp; !</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">required</span><span class="s1">) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">let </span><span class="s2">type </span><span class="s1">= </span><span class="s2">prop</span><span class="s1">.</span><span class="s2">type</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">valid </span><span class="s1">= !</span><span class="s2">type </span><span class="s1">|| </span><span class="s2">type </span><span class="s1">=== </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">expectedTypes </span><span class="s1">= [];</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">type</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">type</span><span class="s1">)) {</span>
            <span class="s2">type </span><span class="s1">= [</span><span class="s2">type</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">type</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp; !</span><span class="s2">valid</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">assertedType </span><span class="s1">= </span><span class="s2">assertType</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">type</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s2">expectedTypes</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">assertedType</span><span class="s1">.</span><span class="s2">expectedType </span><span class="s1">|| </span><span class="s0">''</span><span class="s1">);</span>
            <span class="s2">valid </span><span class="s1">= </span><span class="s2">assertedType</span><span class="s1">.</span><span class="s2">valid</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">haveExpectedTypes </span><span class="s1">= </span><span class="s2">expectedTypes</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">t </span><span class="s1">=&gt; </span><span class="s2">t</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">valid </span><span class="s1">&amp;&amp; </span><span class="s2">haveExpectedTypes</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s2">getInvalidTypeMessage</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">expectedTypes</span><span class="s1">), </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">validator </span><span class="s1">= </span><span class="s2">prop</span><span class="s1">.</span><span class="s2">validator</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">validator</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">validator</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Invalid prop: custom validator check failed for prop &quot;' </span><span class="s1">+ </span><span class="s2">name </span><span class="s1">+ </span><span class="s0">'&quot;.'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">simpleCheckRE </span><span class="s1">= </span><span class="s7">/^(String|Number|Boolean|Function|Symbol|BigInt)$/</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">assertType</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">type</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">valid</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">expectedType </span><span class="s1">= </span><span class="s2">getType</span><span class="s1">(</span><span class="s2">type</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">simpleCheckRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">expectedType</span><span class="s1">)) {</span>
        <span class="s3">const </span><span class="s2">t </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">value</span><span class="s1">;</span>
        <span class="s2">valid </span><span class="s1">= </span><span class="s2">t </span><span class="s1">=== </span><span class="s2">expectedType</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
        <span class="s4">// for primitive wrapper objects</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">valid </span><span class="s1">&amp;&amp; </span><span class="s2">t </span><span class="s1">=== </span><span class="s0">'object'</span><span class="s1">) {</span>
            <span class="s2">valid </span><span class="s1">= </span><span class="s2">value </span><span class="s3">instanceof </span><span class="s2">type</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">expectedType </span><span class="s1">=== </span><span class="s0">'Object'</span><span class="s1">) {</span>
        <span class="s2">valid </span><span class="s1">= </span><span class="s2">isPlainObject</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">expectedType </span><span class="s1">=== </span><span class="s0">'Array'</span><span class="s1">) {</span>
        <span class="s2">valid </span><span class="s1">= </span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">try </span><span class="s1">{</span>
            <span class="s2">valid </span><span class="s1">= </span><span class="s2">value </span><span class="s3">instanceof </span><span class="s2">type</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
            <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">'Invalid prop type: &quot;' </span><span class="s1">+ </span><span class="s2">String</span><span class="s1">(</span><span class="s2">type</span><span class="s1">) + </span><span class="s0">'&quot; is not a constructor'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s2">valid </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">valid</span><span class="s1">,</span>
        <span class="s2">expectedType</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">functionTypeCheckRE </span><span class="s1">= </span><span class="s7">/^\s*function (\w+)/</span><span class="s1">;</span>
<span class="s5">/**</span>
 <span class="s5">* Use function string name to check built-in types,</span>
 <span class="s5">* because a simple equality check will fail when running</span>
 <span class="s5">* across different vms / iframes.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">getType</span><span class="s1">(</span><span class="s2">fn</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">match </span><span class="s1">= </span><span class="s2">fn </span><span class="s1">&amp;&amp; </span><span class="s2">fn</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">().</span><span class="s2">match</span><span class="s1">(</span><span class="s2">functionTypeCheckRE</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">match </span><span class="s1">? </span><span class="s2">match</span><span class="s1">[</span><span class="s6">1</span><span class="s1">] : </span><span class="s0">''</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isSameType</span><span class="s1">(</span><span class="s2">a</span><span class="s1">, </span><span class="s2">b</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">getType</span><span class="s1">(</span><span class="s2">a</span><span class="s1">) === </span><span class="s2">getType</span><span class="s1">(</span><span class="s2">b</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getTypeIndex</span><span class="s1">(</span><span class="s2">type</span><span class="s1">, </span><span class="s2">expectedTypes</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">expectedTypes</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s2">isSameType</span><span class="s1">(</span><span class="s2">expectedTypes</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) ? </span><span class="s6">0 </span><span class="s1">: -</span><span class="s6">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">len </span><span class="s1">= </span><span class="s2">expectedTypes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isSameType</span><span class="s1">(</span><span class="s2">expectedTypes</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">type</span><span class="s1">)) {</span>
            <span class="s3">return </span><span class="s2">i</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">-</span><span class="s6">1</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getInvalidTypeMessage</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">expectedTypes</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">message </span><span class="s1">= </span><span class="s0">`Invalid prop: type check failed for prop &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;.` </span><span class="s1">+</span>
        <span class="s0">` Expected </span><span class="s2">$</span><span class="s1">{</span><span class="s2">expectedTypes</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">capitalize</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">', '</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">expectedType </span><span class="s1">= </span><span class="s2">expectedTypes</span><span class="s1">[</span><span class="s6">0</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">receivedType </span><span class="s1">= </span><span class="s2">toRawType</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s4">// check if we need to specify expected value</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">expectedTypes</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp;</span>
        <span class="s2">isExplicable</span><span class="s1">(</span><span class="s2">expectedType</span><span class="s1">) &amp;&amp;</span>
        <span class="s2">isExplicable</span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">value</span><span class="s1">) &amp;&amp;</span>
        <span class="s1">!</span><span class="s2">isBoolean</span><span class="s1">(</span><span class="s2">expectedType</span><span class="s1">, </span><span class="s2">receivedType</span><span class="s1">)) {</span>
        <span class="s2">message </span><span class="s1">+= </span><span class="s0">` with value </span><span class="s2">$</span><span class="s1">{</span><span class="s2">styleValue</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">expectedType</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">message </span><span class="s1">+= </span><span class="s0">`, got </span><span class="s2">$</span><span class="s1">{</span><span class="s2">receivedType</span><span class="s1">} </span><span class="s0">`</span><span class="s1">;</span>
    <span class="s4">// check if we need to specify received value</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isExplicable</span><span class="s1">(</span><span class="s2">receivedType</span><span class="s1">)) {</span>
        <span class="s2">message </span><span class="s1">+= </span><span class="s0">`with value </span><span class="s2">$</span><span class="s1">{</span><span class="s2">styleValue</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">receivedType</span><span class="s1">)}</span><span class="s0">.`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">message</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">styleValue</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'String'</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'Number'</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">Number</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">EXPLICABLE_TYPES </span><span class="s1">= [</span><span class="s0">'string'</span><span class="s1">, </span><span class="s0">'number'</span><span class="s1">, </span><span class="s0">'boolean'</span><span class="s1">];</span>
<span class="s3">function </span><span class="s2">isExplicable</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">EXPLICABLE_TYPES</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">elem </span><span class="s1">=&gt; </span><span class="s2">value</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">() === </span><span class="s2">elem</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isBoolean</span><span class="s1">(</span><span class="s2">...args</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">args</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">elem </span><span class="s1">=&gt; </span><span class="s2">elem</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">() === </span><span class="s0">'boolean'</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s4">// these are reserved for web because they are directly compiled away</span>
<span class="s4">// during template compilation</span>
<span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'style,class'</span><span class="s1">);</span>
<span class="s4">// attributes that should be using props for binding</span>
<span class="s3">const </span><span class="s2">acceptValue </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'input,textarea,option,select,progress'</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">mustUseProp </span><span class="s1">= (</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">type</span><span class="s1">, </span><span class="s2">attr</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s1">((</span><span class="s2">attr </span><span class="s1">=== </span><span class="s0">'value' </span><span class="s1">&amp;&amp; </span><span class="s2">acceptValue</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">) &amp;&amp; </span><span class="s2">type </span><span class="s1">!== </span><span class="s0">'button'</span><span class="s1">) ||</span>
        <span class="s1">(</span><span class="s2">attr </span><span class="s1">=== </span><span class="s0">'selected' </span><span class="s1">&amp;&amp; </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'option'</span><span class="s1">) ||</span>
        <span class="s1">(</span><span class="s2">attr </span><span class="s1">=== </span><span class="s0">'checked' </span><span class="s1">&amp;&amp; </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input'</span><span class="s1">) ||</span>
        <span class="s1">(</span><span class="s2">attr </span><span class="s1">=== </span><span class="s0">'muted' </span><span class="s1">&amp;&amp; </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'video'</span><span class="s1">));</span>
<span class="s1">};</span>
<span class="s3">const </span><span class="s2">isEnumeratedAttr </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'contenteditable,draggable,spellcheck'</span><span class="s1">);</span>
<span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'events,caret,typing,plaintext-only'</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">isBooleanAttr </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,' </span><span class="s1">+</span>
    <span class="s0">'default,defaultchecked,defaultmuted,defaultselected,defer,disabled,' </span><span class="s1">+</span>
    <span class="s0">'enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,' </span><span class="s1">+</span>
    <span class="s0">'muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,' </span><span class="s1">+</span>
    <span class="s0">'required,reversed,scoped,seamless,selected,sortable,' </span><span class="s1">+</span>
    <span class="s0">'truespeed,typemustmatch,visible'</span><span class="s1">);</span>

<span class="s3">const </span><span class="s2">isHTMLTag </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'html,body,base,head,link,meta,style,title,' </span><span class="s1">+</span>
    <span class="s0">'address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,' </span><span class="s1">+</span>
    <span class="s0">'div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,' </span><span class="s1">+</span>
    <span class="s0">'a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,' </span><span class="s1">+</span>
    <span class="s0">'s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,' </span><span class="s1">+</span>
    <span class="s0">'embed,object,param,source,canvas,script,noscript,del,ins,' </span><span class="s1">+</span>
    <span class="s0">'caption,col,colgroup,table,thead,tbody,td,th,tr,' </span><span class="s1">+</span>
    <span class="s0">'button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,' </span><span class="s1">+</span>
    <span class="s0">'output,progress,select,textarea,' </span><span class="s1">+</span>
    <span class="s0">'details,dialog,menu,menuitem,summary,' </span><span class="s1">+</span>
    <span class="s0">'content,element,shadow,template,blockquote,iframe,tfoot'</span><span class="s1">);</span>
<span class="s4">// this map is intentionally selective, only covering SVG elements that may</span>
<span class="s4">// contain child elements.</span>
<span class="s3">const </span><span class="s2">isSVG </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,' </span><span class="s1">+</span>
    <span class="s0">'foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,' </span><span class="s1">+</span>
    <span class="s0">'polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">isPreTag </span><span class="s1">= (</span><span class="s2">tag</span><span class="s1">) =&gt; </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'pre'</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">isReservedTag </span><span class="s1">= (</span><span class="s2">tag</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s2">isHTMLTag</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">) || </span><span class="s2">isSVG</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">);</span>
<span class="s1">};</span>
<span class="s3">function </span><span class="s2">getTagNamespace</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isSVG</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s0">'svg'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// basic support for MathML</span>
    <span class="s4">// note it doesn't support other MathML elements being component roots</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'math'</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">'math'</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'text,number,password,search,email,tel,url'</span><span class="s1">);</span>

<span class="s3">const </span><span class="s2">validDivisionCharRE </span><span class="s1">= </span><span class="s7">/[\w).+\-_$\]]/</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">parseFilters</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">inSingle </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">inDouble </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">inTemplateString </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">inRegex </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">curly </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">square </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">paren </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">lastFilterIndex </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">c</span><span class="s1">, </span><span class="s2">prev</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">expression</span><span class="s1">, </span><span class="s2">filters</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">prev </span><span class="s1">= </span><span class="s2">c</span><span class="s1">;</span>
        <span class="s2">c </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(</span><span class="s2">i</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">inSingle</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x27 </span><span class="s1">&amp;&amp; </span><span class="s2">prev </span><span class="s1">!== </span><span class="s6">0x5c</span><span class="s1">)</span>
                <span class="s2">inSingle </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">inDouble</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x22 </span><span class="s1">&amp;&amp; </span><span class="s2">prev </span><span class="s1">!== </span><span class="s6">0x5c</span><span class="s1">)</span>
                <span class="s2">inDouble </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">inTemplateString</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x60 </span><span class="s1">&amp;&amp; </span><span class="s2">prev </span><span class="s1">!== </span><span class="s6">0x5c</span><span class="s1">)</span>
                <span class="s2">inTemplateString </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">inRegex</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x2f </span><span class="s1">&amp;&amp; </span><span class="s2">prev </span><span class="s1">!== </span><span class="s6">0x5c</span><span class="s1">)</span>
                <span class="s2">inRegex </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x7c </span><span class="s1">&amp;&amp; </span><span class="s4">// pipe</span>
            <span class="s2">exp</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(</span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">) !== </span><span class="s6">0x7c </span><span class="s1">&amp;&amp;</span>
            <span class="s2">exp</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(</span><span class="s2">i </span><span class="s1">- </span><span class="s6">1</span><span class="s1">) !== </span><span class="s6">0x7c </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!</span><span class="s2">curly </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!</span><span class="s2">square </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!</span><span class="s2">paren</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">expression </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">) {</span>
                <span class="s4">// first filter, end of expression</span>
                <span class="s2">lastFilterIndex </span><span class="s1">= </span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">;</span>
                <span class="s2">expression </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">i</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">();</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">pushFilter</span><span class="s1">();</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">switch </span><span class="s1">(</span><span class="s2">c</span><span class="s1">) {</span>
                <span class="s3">case </span><span class="s6">0x22</span><span class="s1">:</span>
                    <span class="s2">inDouble </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// &quot;</span>
                <span class="s3">case </span><span class="s6">0x27</span><span class="s1">:</span>
                    <span class="s2">inSingle </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// '</span>
                <span class="s3">case </span><span class="s6">0x60</span><span class="s1">:</span>
                    <span class="s2">inTemplateString </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// `</span>
                <span class="s3">case </span><span class="s6">0x28</span><span class="s1">:</span>
                    <span class="s2">paren</span><span class="s1">++;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// (</span>
                <span class="s3">case </span><span class="s6">0x29</span><span class="s1">:</span>
                    <span class="s2">paren</span><span class="s1">--;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// )</span>
                <span class="s3">case </span><span class="s6">0x5b</span><span class="s1">:</span>
                    <span class="s2">square</span><span class="s1">++;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// [</span>
                <span class="s3">case </span><span class="s6">0x5d</span><span class="s1">:</span>
                    <span class="s2">square</span><span class="s1">--;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// ]</span>
                <span class="s3">case </span><span class="s6">0x7b</span><span class="s1">:</span>
                    <span class="s2">curly</span><span class="s1">++;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// {</span>
                <span class="s3">case </span><span class="s6">0x7d</span><span class="s1">:</span>
                    <span class="s2">curly</span><span class="s1">--;</span>
                    <span class="s3">break</span><span class="s1">; </span><span class="s4">// }</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c </span><span class="s1">=== </span><span class="s6">0x2f</span><span class="s1">) {</span>
                <span class="s4">// /</span>
                <span class="s3">let </span><span class="s2">j </span><span class="s1">= </span><span class="s2">i </span><span class="s1">- </span><span class="s6">1</span><span class="s1">;</span>
                <span class="s3">let </span><span class="s2">p</span><span class="s1">;</span>
                <span class="s4">// find first non-whitespace prev char</span>
                <span class="s3">for </span><span class="s1">(; </span><span class="s2">j </span><span class="s1">&gt;= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">j</span><span class="s1">--) {</span>
                    <span class="s2">p </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s2">j</span><span class="s1">);</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">p </span><span class="s1">!== </span><span class="s0">' '</span><span class="s1">)</span>
                        <span class="s3">break</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(!</span><span class="s2">p </span><span class="s1">|| !</span><span class="s2">validDivisionCharRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">p</span><span class="s1">)) {</span>
                    <span class="s2">inRegex </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">expression </span><span class="s1">=== </span><span class="s2">undefined</span><span class="s1">) {</span>
        <span class="s2">expression </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">i</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">lastFilterIndex </span><span class="s1">!== </span><span class="s6">0</span><span class="s1">) {</span>
        <span class="s2">pushFilter</span><span class="s1">();</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">pushFilter</span><span class="s1">() {</span>
        <span class="s1">(</span><span class="s2">filters </span><span class="s1">|| (</span><span class="s2">filters </span><span class="s1">= [])).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">lastFilterIndex</span><span class="s1">, </span><span class="s2">i</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">());</span>
        <span class="s2">lastFilterIndex </span><span class="s1">= </span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">filters</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">filters</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">expression </span><span class="s1">= </span><span class="s2">wrapFilter</span><span class="s1">(</span><span class="s2">expression</span><span class="s1">, </span><span class="s2">filters</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">expression</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">wrapFilter</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s2">filter</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">i </span><span class="s1">= </span><span class="s2">filter</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'('</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">i </span><span class="s1">&lt; </span><span class="s6">0</span><span class="s1">) {</span>
        <span class="s4">// _f: resolveFilter</span>
        <span class="s3">return </span><span class="s0">`_f(&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">filter</span><span class="s1">}</span><span class="s0">&quot;)(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">const </span><span class="s2">name </span><span class="s1">= </span><span class="s2">filter</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">i</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">args </span><span class="s1">= </span><span class="s2">filter</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">i </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s0">`_f(&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;)(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">args </span><span class="s1">!== </span><span class="s0">')' </span><span class="s1">? </span><span class="s0">',' </span><span class="s1">+ </span><span class="s2">args </span><span class="s1">: </span><span class="s2">args</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">defaultTagRE </span><span class="s1">= </span><span class="s7">/\{\{((?:.|\r?\n)+?)\}\}/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">regexEscapeRE </span><span class="s1">= </span><span class="s7">/[-.*+?^${}()|[\]\/\\]/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">buildRegex </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">(</span><span class="s2">delimiters </span><span class="s1">=&gt; {</span>
    <span class="s3">const </span><span class="s2">open </span><span class="s1">= </span><span class="s2">delimiters</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">regexEscapeRE</span><span class="s1">, </span><span class="s0">'</span><span class="s3">\\</span><span class="s0">$&amp;'</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">close </span><span class="s1">= </span><span class="s2">delimiters</span><span class="s1">[</span><span class="s6">1</span><span class="s1">].</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">regexEscapeRE</span><span class="s1">, </span><span class="s0">'</span><span class="s3">\\</span><span class="s0">$&amp;'</span><span class="s1">);</span>
    <span class="s3">return new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s2">open </span><span class="s1">+ </span><span class="s0">'((?:.|</span><span class="s3">\\</span><span class="s0">n)+?)' </span><span class="s1">+ </span><span class="s2">close</span><span class="s1">, </span><span class="s0">'g'</span><span class="s1">);</span>
<span class="s1">});</span>
<span class="s3">function </span><span class="s2">parseText</span><span class="s1">(</span><span class="s2">text</span><span class="s1">, </span><span class="s2">delimiters</span><span class="s1">) {</span>
    <span class="s4">//@ts-expect-error</span>
    <span class="s3">const </span><span class="s2">tagRE </span><span class="s1">= </span><span class="s2">delimiters </span><span class="s1">? </span><span class="s2">buildRegex</span><span class="s1">(</span><span class="s2">delimiters</span><span class="s1">) : </span><span class="s2">defaultTagRE</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">tagRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">text</span><span class="s1">)) {</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">tokens </span><span class="s1">= [];</span>
    <span class="s3">const </span><span class="s2">rawTokens </span><span class="s1">= [];</span>
    <span class="s3">let </span><span class="s2">lastIndex </span><span class="s1">= (</span><span class="s2">tagRE</span><span class="s1">.</span><span class="s2">lastIndex </span><span class="s1">= </span><span class="s6">0</span><span class="s1">);</span>
    <span class="s3">let </span><span class="s2">match</span><span class="s1">, </span><span class="s2">index</span><span class="s1">, </span><span class="s2">tokenValue</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">((</span><span class="s2">match </span><span class="s1">= </span><span class="s2">tagRE</span><span class="s1">.</span><span class="s2">exec</span><span class="s1">(</span><span class="s2">text</span><span class="s1">))) {</span>
        <span class="s2">index </span><span class="s1">= </span><span class="s2">match</span><span class="s1">.</span><span class="s2">index</span><span class="s1">;</span>
        <span class="s4">// push text token</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">index </span><span class="s1">&gt; </span><span class="s2">lastIndex</span><span class="s1">) {</span>
            <span class="s2">rawTokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">((</span><span class="s2">tokenValue </span><span class="s1">= </span><span class="s2">text</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">lastIndex</span><span class="s1">, </span><span class="s2">index</span><span class="s1">)));</span>
            <span class="s2">tokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">tokenValue</span><span class="s1">));</span>
        <span class="s1">}</span>
        <span class="s4">// tag token</span>
        <span class="s3">const </span><span class="s2">exp </span><span class="s1">= </span><span class="s2">parseFilters</span><span class="s1">(</span><span class="s2">match</span><span class="s1">[</span><span class="s6">1</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">());</span>
        <span class="s2">tokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">);</span>
        <span class="s2">rawTokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s0">'@binding'</span><span class="s1">: </span><span class="s2">exp </span><span class="s1">});</span>
        <span class="s2">lastIndex </span><span class="s1">= </span><span class="s2">index </span><span class="s1">+ </span><span class="s2">match</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">lastIndex </span><span class="s1">&lt; </span><span class="s2">text</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
        <span class="s2">rawTokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">((</span><span class="s2">tokenValue </span><span class="s1">= </span><span class="s2">text</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">lastIndex</span><span class="s1">)));</span>
        <span class="s2">tokens</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">tokenValue</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">expression</span><span class="s1">: </span><span class="s2">tokens</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'+'</span><span class="s1">),</span>
        <span class="s2">tokens</span><span class="s1">: </span><span class="s2">rawTokens</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s4">/* eslint-disable no-unused-vars */</span>
<span class="s3">function </span><span class="s2">baseWarn</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s2">console</span><span class="s1">.</span><span class="s2">error</span><span class="s1">(</span><span class="s0">`[Vue compiler]: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">msg</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s4">/* eslint-enable no-unused-vars */</span>
<span class="s3">function </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">modules</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">modules </span><span class="s1">? </span><span class="s2">modules</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">m </span><span class="s1">=&gt; </span><span class="s2">m</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]).</span><span class="s2">filter</span><span class="s1">(</span><span class="s2">_ </span><span class="s1">=&gt; </span><span class="s2">_</span><span class="s1">) : [];</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">range</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">) {</span>
    <span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props </span><span class="s1">= [])).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">rangeSetItem</span><span class="s1">({ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">dynamic </span><span class="s1">}, </span><span class="s2">range</span><span class="s1">));</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">addAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">range</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">attrs </span><span class="s1">= </span><span class="s2">dynamic</span>
        <span class="s1">? </span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs </span><span class="s1">= [])</span>
        <span class="s1">: </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">= []);</span>
    <span class="s2">attrs</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">rangeSetItem</span><span class="s1">({ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">dynamic </span><span class="s1">}, </span><span class="s2">range</span><span class="s1">));</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// add a raw attr (use this in preTransforms)</span>
<span class="s3">function </span><span class="s2">addRawAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">value</span><span class="s1">;</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">rangeSetItem</span><span class="s1">({ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value </span><span class="s1">}, </span><span class="s2">range</span><span class="s1">));</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">addDirective</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">rawName</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">arg</span><span class="s1">, </span><span class="s2">isDynamicArg</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">= [])).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">rangeSetItem</span><span class="s1">({</span>
        <span class="s2">name</span><span class="s1">,</span>
        <span class="s2">rawName</span><span class="s1">,</span>
        <span class="s2">value</span><span class="s1">,</span>
        <span class="s2">arg</span><span class="s1">,</span>
        <span class="s2">isDynamicArg</span><span class="s1">,</span>
        <span class="s2">modifiers</span>
    <span class="s1">}, </span><span class="s2">range</span><span class="s1">));</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">prependModifierMarker</span><span class="s1">(</span><span class="s2">symbol</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">dynamic </span><span class="s1">? </span><span class="s0">`_p(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">,&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">symbol</span><span class="s1">}</span><span class="s0">&quot;)` </span><span class="s1">: </span><span class="s2">symbol </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">; </span><span class="s4">// mark the event as captured</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">, </span><span class="s2">important</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">) {</span>
    <span class="s2">modifiers </span><span class="s1">= </span><span class="s2">modifiers </span><span class="s1">|| </span><span class="s2">emptyObject</span><span class="s1">;</span>
    <span class="s4">// warn prevent and passive modifier</span>
    <span class="s4">/* istanbul ignore if */</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">warn </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">prevent </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">passive</span><span class="s1">) {</span>
        <span class="s2">warn</span><span class="s1">(</span><span class="s0">&quot;passive and prevent can't be used together. &quot; </span><span class="s1">+</span>
            <span class="s0">&quot;Passive handler can't prevent default event.&quot;</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// normalize click.right and click.middle since they don't actually fire</span>
    <span class="s4">// this is technically browser-specific, but at least for now browsers are</span>
    <span class="s4">// the only target envs that have right/middle clicks.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">right</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamic</span><span class="s1">) {</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">)==='click'?'contextmenu':(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'click'</span><span class="s1">) {</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s0">'contextmenu'</span><span class="s1">;</span>
            <span class="s3">delete </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">right</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">middle</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamic</span><span class="s1">) {</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">)==='click'?'mouseup':(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'click'</span><span class="s1">) {</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s0">'mouseup'</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// check capture modifier</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">capture</span><span class="s1">) {</span>
        <span class="s3">delete </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">capture</span><span class="s1">;</span>
        <span class="s2">name </span><span class="s1">= </span><span class="s2">prependModifierMarker</span><span class="s1">(</span><span class="s0">'!'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">once</span><span class="s1">) {</span>
        <span class="s3">delete </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">once</span><span class="s1">;</span>
        <span class="s2">name </span><span class="s1">= </span><span class="s2">prependModifierMarker</span><span class="s1">(</span><span class="s0">'~'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">/* istanbul ignore if */</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">passive</span><span class="s1">) {</span>
        <span class="s3">delete </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">passive</span><span class="s1">;</span>
        <span class="s2">name </span><span class="s1">= </span><span class="s2">prependModifierMarker</span><span class="s1">(</span><span class="s0">'&amp;'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">let </span><span class="s2">events</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">native</span><span class="s1">) {</span>
        <span class="s3">delete </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">native</span><span class="s1">;</span>
        <span class="s2">events </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">nativeEvents </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">nativeEvents </span><span class="s1">= {});</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">events </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">events </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">events </span><span class="s1">= {});</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">newHandler </span><span class="s1">= </span><span class="s2">rangeSetItem</span><span class="s1">({ </span><span class="s2">value</span><span class="s1">: </span><span class="s2">value</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">(), </span><span class="s2">dynamic </span><span class="s1">}, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers </span><span class="s1">!== </span><span class="s2">emptyObject</span><span class="s1">) {</span>
        <span class="s2">newHandler</span><span class="s1">.</span><span class="s2">modifiers </span><span class="s1">= </span><span class="s2">modifiers</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">handlers </span><span class="s1">= </span><span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
    <span class="s4">/* istanbul ignore if */</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">handlers</span><span class="s1">)) {</span>
        <span class="s2">important </span><span class="s1">? </span><span class="s2">handlers</span><span class="s1">.</span><span class="s2">unshift</span><span class="s1">(</span><span class="s2">newHandler</span><span class="s1">) : </span><span class="s2">handlers</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">newHandler</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">handlers</span><span class="s1">) {</span>
        <span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">important </span><span class="s1">? [</span><span class="s2">newHandler</span><span class="s1">, </span><span class="s2">handlers</span><span class="s1">] : [</span><span class="s2">handlers</span><span class="s1">, </span><span class="s2">newHandler</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">newHandler</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getRawBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">':' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">] ||</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-bind:' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">] ||</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">]);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">getStatic</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">dynamicValue </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">':' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">) || </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-bind:' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamicValue </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">parseFilters</span><span class="s1">(</span><span class="s2">dynamicValue</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">getStatic </span><span class="s1">!== </span><span class="s3">false</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">staticValue </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">staticValue </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">staticValue</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// note: this only removes the attr from the Array (attrsList) so that it</span>
<span class="s4">// doesn't get processed by processAttrs.</span>
<span class="s4">// By default it does NOT remove it from the map (attrsMap) because the map is</span>
<span class="s4">// needed during codegen.</span>
<span class="s3">function </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">removeFromMap</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">val </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">]) != </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">list </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">;</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">list</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name </span><span class="s1">=== </span><span class="s2">name</span><span class="s1">) {</span>
                <span class="s2">list</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">i</span><span class="s1">, </span><span class="s6">1</span><span class="s1">);</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">removeFromMap</span><span class="s1">) {</span>
        <span class="s3">delete </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">val</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getAndRemoveAttrByRegex</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">list </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">list</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">attr </span><span class="s1">= </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">name</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)) {</span>
            <span class="s2">list</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s2">i</span><span class="s1">, </span><span class="s6">1</span><span class="s1">);</span>
            <span class="s3">return </span><span class="s2">attr</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">rangeSetItem</span><span class="s1">(</span><span class="s2">item</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">start </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s2">item</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">start</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">end </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s2">item</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">end</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">item</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">transformNode$1</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">warn </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">|| </span><span class="s2">baseWarn</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">staticClass </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'class'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">staticClass</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseText</span><span class="s1">(</span><span class="s2">staticClass</span><span class="s1">, </span><span class="s2">options</span><span class="s1">.</span><span class="s2">delimiters</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">) {</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`class=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticClass</span><span class="s1">}</span><span class="s0">&quot;: ` </span><span class="s1">+</span>
                <span class="s0">'Interpolation inside attributes has been removed. ' </span><span class="s1">+</span>
                <span class="s0">'Use v-bind or the colon shorthand instead. For example, ' </span><span class="s1">+</span>
                <span class="s0">'instead of &lt;div class=&quot;{{ val }}&quot;&gt;, use &lt;div :class=&quot;val&quot;&gt;.'</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'class'</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">staticClass</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">staticClass </span><span class="s1">= </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">staticClass</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/\s+/g</span><span class="s1">, </span><span class="s0">' '</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">());</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">classBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'class'</span><span class="s1">, </span><span class="s3">false </span><span class="s4">/* getStatic */</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">classBinding</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">classBinding </span><span class="s1">= </span><span class="s2">classBinding</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genData$2</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">data </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticClass</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`staticClass:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticClass</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">classBinding</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`class:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">classBinding</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">data</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">var </span><span class="s2">klass </span><span class="s1">= {</span>
    <span class="s2">staticKeys</span><span class="s1">: [</span><span class="s0">'staticClass'</span><span class="s1">],</span>
    <span class="s2">transformNode</span><span class="s1">: </span><span class="s2">transformNode$1</span><span class="s1">,</span>
    <span class="s2">genData</span><span class="s1">: </span><span class="s2">genData$2</span>
<span class="s1">};</span>

<span class="s3">const </span><span class="s2">parseStyleText </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">cssText</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
    <span class="s3">const </span><span class="s2">listDelimiter </span><span class="s1">= </span><span class="s7">/;(?![^(]*\))/g</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">propertyDelimiter </span><span class="s1">= </span><span class="s7">/:(.+)/</span><span class="s1">;</span>
    <span class="s2">cssText</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s2">listDelimiter</span><span class="s1">).</span><span class="s2">forEach</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">item</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">item</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">tmp </span><span class="s1">= </span><span class="s2">item</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s2">propertyDelimiter</span><span class="s1">);</span>
            <span class="s2">tmp</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&gt; </span><span class="s6">1 </span><span class="s1">&amp;&amp; (</span><span class="s2">res</span><span class="s1">[</span><span class="s2">tmp</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">()] = </span><span class="s2">tmp</span><span class="s1">[</span><span class="s6">1</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">());</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">});</span>

<span class="s3">function </span><span class="s2">transformNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">warn </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">|| </span><span class="s2">baseWarn</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">staticStyle </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'style'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">staticStyle</span><span class="s1">) {</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseText</span><span class="s1">(</span><span class="s2">staticStyle</span><span class="s1">, </span><span class="s2">options</span><span class="s1">.</span><span class="s2">delimiters</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">) {</span>
                <span class="s2">warn</span><span class="s1">(</span><span class="s0">`style=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticStyle</span><span class="s1">}</span><span class="s0">&quot;: ` </span><span class="s1">+</span>
                    <span class="s0">'Interpolation inside attributes has been removed. ' </span><span class="s1">+</span>
                    <span class="s0">'Use v-bind or the colon shorthand instead. For example, ' </span><span class="s1">+</span>
                    <span class="s0">'instead of &lt;div style=&quot;{{ val }}&quot;&gt;, use &lt;div :style=&quot;val&quot;&gt;.'</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'style'</span><span class="s1">]);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">staticStyle </span><span class="s1">= </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">parseStyleText</span><span class="s1">(</span><span class="s2">staticStyle</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">styleBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'style'</span><span class="s1">, </span><span class="s3">false </span><span class="s4">/* getStatic */</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">styleBinding</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">styleBinding </span><span class="s1">= </span><span class="s2">styleBinding</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genData$1</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">data </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticStyle</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`staticStyle:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticStyle</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">styleBinding</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`style:(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">styleBinding</span><span class="s1">}</span><span class="s0">),`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">data</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">var </span><span class="s2">style </span><span class="s1">= {</span>
    <span class="s2">staticKeys</span><span class="s1">: [</span><span class="s0">'staticStyle'</span><span class="s1">],</span>
    <span class="s2">transformNode</span><span class="s1">,</span>
    <span class="s2">genData</span><span class="s1">: </span><span class="s2">genData$1</span>
<span class="s1">};</span>

<span class="s5">/**</span>
 <span class="s5">* Cross-platform code generation for component v-model</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">genComponentModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s1">{ </span><span class="s2">number</span><span class="s1">, </span><span class="s2">trim </span><span class="s1">} = </span><span class="s2">modifiers </span><span class="s1">|| {};</span>
    <span class="s3">const </span><span class="s2">baseValueExpression </span><span class="s1">= </span><span class="s0">'$$v'</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">valueExpression </span><span class="s1">= </span><span class="s2">baseValueExpression</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">trim</span><span class="s1">) {</span>
        <span class="s2">valueExpression </span><span class="s1">=</span>
            <span class="s0">`(typeof </span><span class="s2">$</span><span class="s1">{</span><span class="s2">baseValueExpression</span><span class="s1">} </span><span class="s0">=== 'string'` </span><span class="s1">+</span>
                <span class="s0">`? </span><span class="s2">$</span><span class="s1">{</span><span class="s2">baseValueExpression</span><span class="s1">}</span><span class="s0">.trim()` </span><span class="s1">+</span>
                <span class="s0">`: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">baseValueExpression</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">number</span><span class="s1">) {</span>
        <span class="s2">valueExpression </span><span class="s1">= </span><span class="s0">`_n(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">valueExpression</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">assignment </span><span class="s1">= </span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">valueExpression</span><span class="s1">);</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">model </span><span class="s1">= {</span>
        <span class="s2">value</span><span class="s1">: </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">,</span>
        <span class="s2">expression</span><span class="s1">: </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">value</span><span class="s1">),</span>
        <span class="s2">callback</span><span class="s1">: </span><span class="s0">`function (</span><span class="s2">$</span><span class="s1">{</span><span class="s2">baseValueExpression</span><span class="s1">}</span><span class="s0">) {</span><span class="s2">$</span><span class="s1">{</span><span class="s2">assignment</span><span class="s1">}</span><span class="s0">}`</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Cross-platform codegen helper for generating v-model value assignment code.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">assignment</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseModel</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">.</span><span class="s2">key </span><span class="s1">=== </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">=</span><span class="s2">$</span><span class="s1">{</span><span class="s2">assignment</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s0">`$set(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">res</span><span class="s1">.</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">, </span><span class="s2">$</span><span class="s1">{</span><span class="s2">res</span><span class="s1">.</span><span class="s2">key</span><span class="s1">}</span><span class="s0">, </span><span class="s2">$</span><span class="s1">{</span><span class="s2">assignment</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Parse a v-model expression into a base path and a final key segment.</span>
 <span class="s5">* Handles both dot-path and possible square brackets.</span>
 <span class="s5">*</span>
 <span class="s5">* Possible cases:</span>
 <span class="s5">*</span>
 <span class="s5">* - test</span>
 <span class="s5">* - test[key]</span>
 <span class="s5">* - test[test1[key]]</span>
 <span class="s5">* - test[&quot;a&quot;][key]</span>
 <span class="s5">* - xxx.test[a[a].test1[key]]</span>
 <span class="s5">* - test.xxx.a[&quot;asa&quot;][test1[key]]</span>
 <span class="s5">*</span>
 <span class="s5">*/</span>
<span class="s3">let </span><span class="s2">len</span><span class="s1">, </span><span class="s2">str</span><span class="s1">, </span><span class="s2">chr</span><span class="s1">, </span><span class="s2">index</span><span class="s1">, </span><span class="s2">expressionPos</span><span class="s1">, </span><span class="s2">expressionEndPos</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">parseModel</span><span class="s1">(</span><span class="s2">val</span><span class="s1">) {</span>
    <span class="s4">// Fix https://github.com/vuejs/vue/pull/7730</span>
    <span class="s4">// allow v-model=&quot;obj.val &quot; (trailing whitespace)</span>
    <span class="s2">val </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">();</span>
    <span class="s2">len </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">val</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'['</span><span class="s1">) &lt; </span><span class="s6">0 </span><span class="s1">|| </span><span class="s2">val</span><span class="s1">.</span><span class="s2">lastIndexOf</span><span class="s1">(</span><span class="s0">']'</span><span class="s1">) &lt; </span><span class="s2">len </span><span class="s1">- </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s2">index </span><span class="s1">= </span><span class="s2">val</span><span class="s1">.</span><span class="s2">lastIndexOf</span><span class="s1">(</span><span class="s0">'.'</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">index </span><span class="s1">&gt; -</span><span class="s6">1</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s1">{</span>
                <span class="s2">exp</span><span class="s1">: </span><span class="s2">val</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">index</span><span class="s1">),</span>
                <span class="s2">key</span><span class="s1">: </span><span class="s0">'&quot;' </span><span class="s1">+ </span><span class="s2">val</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">index </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">) + </span><span class="s0">'&quot;'</span>
            <span class="s1">};</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">return </span><span class="s1">{</span>
                <span class="s2">exp</span><span class="s1">: </span><span class="s2">val</span><span class="s1">,</span>
                <span class="s2">key</span><span class="s1">: </span><span class="s3">null</span>
            <span class="s1">};</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">str </span><span class="s1">= </span><span class="s2">val</span><span class="s1">;</span>
    <span class="s2">index </span><span class="s1">= </span><span class="s2">expressionPos </span><span class="s1">= </span><span class="s2">expressionEndPos </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(!</span><span class="s2">eof</span><span class="s1">()) {</span>
        <span class="s2">chr </span><span class="s1">= </span><span class="s2">next</span><span class="s1">();</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isStringStart</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">)) {</span>
            <span class="s2">parseString</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">chr </span><span class="s1">=== </span><span class="s6">0x5b</span><span class="s1">) {</span>
            <span class="s2">parseBracket</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">exp</span><span class="s1">: </span><span class="s2">val</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, </span><span class="s2">expressionPos</span><span class="s1">),</span>
        <span class="s2">key</span><span class="s1">: </span><span class="s2">val</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s2">expressionPos </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">, </span><span class="s2">expressionEndPos</span><span class="s1">)</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">next</span><span class="s1">() {</span>
    <span class="s3">return </span><span class="s2">str</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(++</span><span class="s2">index</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">eof</span><span class="s1">() {</span>
    <span class="s3">return </span><span class="s2">index </span><span class="s1">&gt;= </span><span class="s2">len</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isStringStart</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">chr </span><span class="s1">=== </span><span class="s6">0x22 </span><span class="s1">|| </span><span class="s2">chr </span><span class="s1">=== </span><span class="s6">0x27</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">parseBracket</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">inBracket </span><span class="s1">= </span><span class="s6">1</span><span class="s1">;</span>
    <span class="s2">expressionPos </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(!</span><span class="s2">eof</span><span class="s1">()) {</span>
        <span class="s2">chr </span><span class="s1">= </span><span class="s2">next</span><span class="s1">();</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isStringStart</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">)) {</span>
            <span class="s2">parseString</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">);</span>
            <span class="s3">continue</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">chr </span><span class="s1">=== </span><span class="s6">0x5b</span><span class="s1">)</span>
            <span class="s2">inBracket</span><span class="s1">++;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">chr </span><span class="s1">=== </span><span class="s6">0x5d</span><span class="s1">)</span>
            <span class="s2">inBracket</span><span class="s1">--;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">inBracket </span><span class="s1">=== </span><span class="s6">0</span><span class="s1">) {</span>
            <span class="s2">expressionEndPos </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
            <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">parseString</span><span class="s1">(</span><span class="s2">chr</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">stringQuote </span><span class="s1">= </span><span class="s2">chr</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(!</span><span class="s2">eof</span><span class="s1">()) {</span>
        <span class="s2">chr </span><span class="s1">= </span><span class="s2">next</span><span class="s1">();</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">chr </span><span class="s1">=== </span><span class="s2">stringQuote</span><span class="s1">) {</span>
            <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">onRE </span><span class="s1">= </span><span class="s7">/^@|^v-on:/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">dirRE </span><span class="s1">= </span><span class="s7">/^v-|^@|^:|^#/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">forAliasRE </span><span class="s1">= </span><span class="s7">/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">forIteratorRE </span><span class="s1">= </span><span class="s7">/,([^,\}\]]*)(?:,([^,\}\]]*))?$/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">stripParensRE </span><span class="s1">= </span><span class="s7">/^\(|\)$/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">dynamicArgRE </span><span class="s1">= </span><span class="s7">/^\[.*\]$/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">argRE </span><span class="s1">= </span><span class="s7">/:(.*)$/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">bindRE </span><span class="s1">= </span><span class="s7">/^:|^\.|^v-bind:/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">modifierRE </span><span class="s1">= </span><span class="s7">/\.[^.\]]+(?=[^\]]*$)/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">slotRE </span><span class="s1">= </span><span class="s7">/^v-slot(:|$)|^#/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">lineBreakRE </span><span class="s1">= </span><span class="s7">/[\r\n]/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">whitespaceRE </span><span class="s1">= </span><span class="s7">/[ \f\t\r\n]+/g</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">invalidAttributeRE </span><span class="s1">= </span><span class="s7">/[\s&quot;'&lt;&gt;\/=]/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">decodeHTMLCached </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">(</span><span class="s2">he__default</span><span class="s1">[</span><span class="s0">&quot;default&quot;</span><span class="s1">].</span><span class="s2">decode</span><span class="s1">);</span>
<span class="s3">const </span><span class="s2">emptySlotScopeToken </span><span class="s1">= </span><span class="s0">`_empty_`</span><span class="s1">;</span>
<span class="s4">// configurable state</span>
<span class="s3">let </span><span class="s2">warn$1</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">delimiters</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">transforms</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">preTransforms</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">postTransforms</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">platformIsPreTag</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">platformMustUseProp</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">platformGetTagNamespace</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">maybeComponent</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">createASTElement</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">type</span><span class="s1">: </span><span class="s6">1</span><span class="s1">,</span>
        <span class="s2">tag</span><span class="s1">,</span>
        <span class="s2">attrsList</span><span class="s1">: </span><span class="s2">attrs</span><span class="s1">,</span>
        <span class="s2">attrsMap</span><span class="s1">: </span><span class="s2">makeAttrsMap</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">),</span>
        <span class="s2">rawAttrsMap</span><span class="s1">: {},</span>
        <span class="s2">parent</span><span class="s1">,</span>
        <span class="s2">children</span><span class="s1">: []</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s5">/**</span>
 <span class="s5">* Convert HTML string to AST.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">parse</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s2">warn$1 </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">|| </span><span class="s2">baseWarn</span><span class="s1">;</span>
    <span class="s2">platformIsPreTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isPreTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s2">platformMustUseProp </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">mustUseProp </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s2">platformGetTagNamespace </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">getTagNamespace </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">isReservedTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isReservedTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s2">maybeComponent </span><span class="s1">= (</span><span class="s2">el</span><span class="s1">) =&gt; !!(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component </span><span class="s1">||</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">':is'</span><span class="s1">] ||</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind:is'</span><span class="s1">] ||</span>
        <span class="s1">!(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">is </span><span class="s1">? </span><span class="s2">isReservedTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">is</span><span class="s1">) : </span><span class="s2">isReservedTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">)));</span>
    <span class="s2">transforms </span><span class="s1">= </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">, </span><span class="s0">'transformNode'</span><span class="s1">);</span>
    <span class="s2">preTransforms </span><span class="s1">= </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">, </span><span class="s0">'preTransformNode'</span><span class="s1">);</span>
    <span class="s2">postTransforms </span><span class="s1">= </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">, </span><span class="s0">'postTransformNode'</span><span class="s1">);</span>
    <span class="s2">delimiters </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">delimiters</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">stack </span><span class="s1">= [];</span>
    <span class="s3">const </span><span class="s2">preserveWhitespace </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">preserveWhitespace </span><span class="s1">!== </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">whitespaceOption </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">whitespace</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">root</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">currentParent</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">inVPre </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">inPre </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">warned </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">function </span><span class="s2">warnOnce</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">warned</span><span class="s1">) {</span>
            <span class="s2">warned </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">closeElement</span><span class="s1">(</span><span class="s2">element</span><span class="s1">) {</span>
        <span class="s2">trimEndingWhitespace</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">inVPre </span><span class="s1">&amp;&amp; !</span><span class="s2">element</span><span class="s1">.</span><span class="s2">processed</span><span class="s1">) {</span>
            <span class="s2">element </span><span class="s1">= </span><span class="s2">processElement</span><span class="s1">(</span><span class="s2">element</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s4">// tree management</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp; </span><span class="s2">element </span><span class="s1">!== </span><span class="s2">root</span><span class="s1">) {</span>
            <span class="s4">// allow root elements with v-if, v-else-if and v-else</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">root</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; (</span><span class="s2">element</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">|| </span><span class="s2">element</span><span class="s1">.</span><span class="s2">else</span><span class="s1">)) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s2">checkRootConstraints</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">root</span><span class="s1">, {</span>
                    <span class="s2">exp</span><span class="s1">: </span><span class="s2">element</span><span class="s1">.</span><span class="s2">elseif</span><span class="s1">,</span>
                    <span class="s2">block</span><span class="s1">: </span><span class="s2">element</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s2">warnOnce</span><span class="s1">(</span><span class="s0">`Component template should contain exactly one root element. ` </span><span class="s1">+</span>
                    <span class="s0">`If you are using v-if on multiple elements, ` </span><span class="s1">+</span>
                    <span class="s0">`use v-else-if to chain them instead.`</span><span class="s1">, { </span><span class="s2">start</span><span class="s1">: </span><span class="s2">element</span><span class="s1">.</span><span class="s2">start </span><span class="s1">});</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">currentParent </span><span class="s1">&amp;&amp; !</span><span class="s2">element</span><span class="s1">.</span><span class="s2">forbidden</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">|| </span><span class="s2">element</span><span class="s1">.</span><span class="s2">else</span><span class="s1">) {</span>
                <span class="s2">processIfConditions</span><span class="s1">(</span><span class="s2">element</span><span class="s1">, </span><span class="s2">currentParent</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">) {</span>
                    <span class="s4">// scoped slot</span>
                    <span class="s4">// keep it in the children list so that v-else(-if) conditions can</span>
                    <span class="s4">// find it as the prev node.</span>
                    <span class="s3">const </span><span class="s2">name </span><span class="s1">= </span><span class="s2">element</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">|| </span><span class="s0">'&quot;default&quot;'</span><span class="s1">;</span>
                    <span class="s1">(</span><span class="s2">currentParent</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">|| (</span><span class="s2">currentParent</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">= {}))[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">element</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s2">currentParent</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
                <span class="s2">element</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">= </span><span class="s2">currentParent</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s4">// final children cleanup</span>
        <span class="s4">// filter out scoped slots</span>
        <span class="s2">element</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= </span><span class="s2">element</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">(</span><span class="s2">c </span><span class="s1">=&gt; !</span><span class="s2">c</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">);</span>
        <span class="s4">// remove trailing whitespace node again</span>
        <span class="s2">trimEndingWhitespace</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
        <span class="s4">// check pre state</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
            <span class="s2">inVPre </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">platformIsPreTag</span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">)) {</span>
            <span class="s2">inPre </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s4">// apply post-transforms</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">postTransforms</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">postTransforms</span><span class="s1">[</span><span class="s2">i</span><span class="s1">](</span><span class="s2">element</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">trimEndingWhitespace</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
        <span class="s4">// remove trailing whitespace node</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">inPre</span><span class="s1">) {</span>
            <span class="s3">let </span><span class="s2">lastNode</span><span class="s1">;</span>
            <span class="s3">while </span><span class="s1">((</span><span class="s2">lastNode </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">]) &amp;&amp;</span>
                <span class="s2">lastNode</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3 </span><span class="s1">&amp;&amp;</span>
                <span class="s2">lastNode</span><span class="s1">.</span><span class="s2">text </span><span class="s1">=== </span><span class="s0">' '</span><span class="s1">) {</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">function </span><span class="s2">checkRootConstraints</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'slot' </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
            <span class="s2">warnOnce</span><span class="s1">(</span><span class="s0">`Cannot use &lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt; as component root element because it may ` </span><span class="s1">+</span>
                <span class="s0">'contain multiple nodes.'</span><span class="s1">, { </span><span class="s2">start</span><span class="s1">: </span><span class="s2">el</span><span class="s1">.</span><span class="s2">start </span><span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">hasOwnProperty</span><span class="s1">(</span><span class="s0">'v-for'</span><span class="s1">)) {</span>
            <span class="s2">warnOnce</span><span class="s1">(</span><span class="s0">'Cannot use v-for on stateful component root element because ' </span><span class="s1">+</span>
                <span class="s0">'it renders multiple elements.'</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-for'</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">parseHTML</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, {</span>
        <span class="s2">warn</span><span class="s1">: </span><span class="s2">warn$1</span><span class="s1">,</span>
        <span class="s2">expectHTML</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">expectHTML</span><span class="s1">,</span>
        <span class="s2">isUnaryTag</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isUnaryTag</span><span class="s1">,</span>
        <span class="s2">canBeLeftOpenTag</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">canBeLeftOpenTag</span><span class="s1">,</span>
        <span class="s2">shouldDecodeNewlines</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">shouldDecodeNewlines</span><span class="s1">,</span>
        <span class="s2">shouldDecodeNewlinesForHref</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">shouldDecodeNewlinesForHref</span><span class="s1">,</span>
        <span class="s2">shouldKeepComment</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">comments</span><span class="s1">,</span>
        <span class="s2">outputSourceRange</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">,</span>
        <span class="s2">start</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">unary</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
            <span class="s4">// check namespace.</span>
            <span class="s4">// inherit parent ns if there is one</span>
            <span class="s3">const </span><span class="s2">ns </span><span class="s1">= (</span><span class="s2">currentParent </span><span class="s1">&amp;&amp; </span><span class="s2">currentParent</span><span class="s1">.</span><span class="s2">ns</span><span class="s1">) || </span><span class="s2">platformGetTagNamespace</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">);</span>
            <span class="s4">// handle IE svg bug</span>
            <span class="s4">/* istanbul ignore if */</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isIE </span><span class="s1">&amp;&amp; </span><span class="s2">ns </span><span class="s1">=== </span><span class="s0">'svg'</span><span class="s1">) {</span>
                <span class="s2">attrs </span><span class="s1">= </span><span class="s2">guardIESVGBug</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">let </span><span class="s2">element </span><span class="s1">= </span><span class="s2">createASTElement</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">, </span><span class="s2">currentParent</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">ns</span><span class="s1">) {</span>
                <span class="s2">element</span><span class="s1">.</span><span class="s2">ns </span><span class="s1">= </span><span class="s2">ns</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                    <span class="s2">element</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">start</span><span class="s1">;</span>
                    <span class="s2">element</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">end</span><span class="s1">;</span>
                    <span class="s2">element</span><span class="s1">.</span><span class="s2">rawAttrsMap </span><span class="s1">= </span><span class="s2">element</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">.</span><span class="s2">reduce</span><span class="s1">((</span><span class="s2">cumulated</span><span class="s1">, </span><span class="s2">attr</span><span class="s1">) =&gt; {</span>
                        <span class="s2">cumulated</span><span class="s1">[</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">attr</span><span class="s1">;</span>
                        <span class="s3">return </span><span class="s2">cumulated</span><span class="s1">;</span>
                    <span class="s1">}, {});</span>
                <span class="s1">}</span>
                <span class="s2">attrs</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">attr </span><span class="s1">=&gt; {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">invalidAttributeRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Invalid dynamic argument expression: attribute names cannot contain ` </span><span class="s1">+</span>
                            <span class="s0">`spaces, quotes, &lt;, &gt;, / or =.`</span><span class="s1">, </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span>
                            <span class="s1">? {</span>
                                <span class="s2">start</span><span class="s1">: </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">start </span><span class="s1">+ </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">`[`</span><span class="s1">),</span>
                                <span class="s2">end</span><span class="s1">: </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">start </span><span class="s1">+ </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">.</span><span class="s2">length</span>
                            <span class="s1">}</span>
                            <span class="s1">: </span><span class="s2">undefined</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isForbiddenTag</span><span class="s1">(</span><span class="s2">element</span><span class="s1">) &amp;&amp; !</span><span class="s2">isServerRendering</span><span class="s1">()) {</span>
                <span class="s2">element</span><span class="s1">.</span><span class="s2">forbidden </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">'Templates should only be responsible for mapping the state to the ' </span><span class="s1">+</span>
                        <span class="s0">'UI. Avoid placing tags with side-effects in your templates, such as ' </span><span class="s1">+</span>
                        <span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt;` </span><span class="s1">+</span>
                        <span class="s0">', as they will not be parsed.'</span><span class="s1">, { </span><span class="s2">start</span><span class="s1">: </span><span class="s2">element</span><span class="s1">.</span><span class="s2">start </span><span class="s1">});</span>
            <span class="s1">}</span>
            <span class="s4">// apply pre-transforms</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">preTransforms</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">element </span><span class="s1">= </span><span class="s2">preTransforms</span><span class="s1">[</span><span class="s2">i</span><span class="s1">](</span><span class="s2">element</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) || </span><span class="s2">element</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">inVPre</span><span class="s1">) {</span>
                <span class="s2">processPre</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
                    <span class="s2">inVPre </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">platformIsPreTag</span><span class="s1">(</span><span class="s2">element</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">)) {</span>
                <span class="s2">inPre </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">inVPre</span><span class="s1">) {</span>
                <span class="s2">processRawAttrs</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(!</span><span class="s2">element</span><span class="s1">.</span><span class="s2">processed</span><span class="s1">) {</span>
                <span class="s4">// structural directives</span>
                <span class="s2">processFor</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
                <span class="s2">processIf</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
                <span class="s2">processOnce</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">root</span><span class="s1">) {</span>
                <span class="s2">root </span><span class="s1">= </span><span class="s2">element</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s2">checkRootConstraints</span><span class="s1">(</span><span class="s2">root</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">unary</span><span class="s1">) {</span>
                <span class="s2">currentParent </span><span class="s1">= </span><span class="s2">element</span><span class="s1">;</span>
                <span class="s2">stack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">closeElement</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">},</span>
        <span class="s2">end</span><span class="s1">(</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">element </span><span class="s1">= </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">];</span>
            <span class="s4">// pop stack</span>
            <span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">-= </span><span class="s6">1</span><span class="s1">;</span>
            <span class="s2">currentParent </span><span class="s1">= </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                <span class="s2">element</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">end</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">closeElement</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
        <span class="s1">},</span>
        <span class="s2">chars</span><span class="s1">(</span><span class="s2">text</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">currentParent</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">text </span><span class="s1">=== </span><span class="s2">template</span><span class="s1">) {</span>
                        <span class="s2">warnOnce</span><span class="s1">(</span><span class="s0">'Component template requires a root element, rather than just text.'</span><span class="s1">, { </span><span class="s2">start </span><span class="s1">});</span>
                    <span class="s1">}</span>
                    <span class="s3">else if </span><span class="s1">((</span><span class="s2">text </span><span class="s1">= </span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">())) {</span>
                        <span class="s2">warnOnce</span><span class="s1">(</span><span class="s0">`text &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">}</span><span class="s0">&quot; outside root element will be ignored.`</span><span class="s1">, {</span>
                            <span class="s2">start</span>
                        <span class="s1">});</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s3">return</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s4">// IE textarea placeholder bug</span>
            <span class="s4">/* istanbul ignore if */</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">isIE </span><span class="s1">&amp;&amp;</span>
                <span class="s2">currentParent</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'textarea' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">currentParent</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">placeholder </span><span class="s1">=== </span><span class="s2">text</span><span class="s1">) {</span>
                <span class="s3">return</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">currentParent</span><span class="s1">.</span><span class="s2">children</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">inPre </span><span class="s1">|| </span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()) {</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">isTextTag</span><span class="s1">(</span><span class="s2">currentParent</span><span class="s1">)</span>
                    <span class="s1">? </span><span class="s2">text</span>
                    <span class="s1">: </span><span class="s2">decodeHTMLCached</span><span class="s1">(</span><span class="s2">text</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(!</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
                <span class="s4">// remove the whitespace-only node right after an opening tag</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">whitespaceOption</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">whitespaceOption </span><span class="s1">=== </span><span class="s0">'condense'</span><span class="s1">) {</span>
                    <span class="s4">// in condense mode, remove the whitespace node if it contains</span>
                    <span class="s4">// line break, otherwise condense to a single space</span>
                    <span class="s2">text </span><span class="s1">= </span><span class="s2">lineBreakRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">text</span><span class="s1">) ? </span><span class="s0">'' </span><span class="s1">: </span><span class="s0">' '</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">text </span><span class="s1">= </span><span class="s0">' '</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s2">preserveWhitespace </span><span class="s1">? </span><span class="s0">' ' </span><span class="s1">: </span><span class="s0">''</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">text</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(!</span><span class="s2">inPre </span><span class="s1">&amp;&amp; </span><span class="s2">whitespaceOption </span><span class="s1">=== </span><span class="s0">'condense'</span><span class="s1">) {</span>
                    <span class="s4">// condense consecutive whitespaces into single space</span>
                    <span class="s2">text </span><span class="s1">= </span><span class="s2">text</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">whitespaceRE</span><span class="s1">, </span><span class="s0">' '</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">let </span><span class="s2">res</span><span class="s1">;</span>
                <span class="s3">let </span><span class="s2">child</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(!</span><span class="s2">inVPre </span><span class="s1">&amp;&amp; </span><span class="s2">text </span><span class="s1">!== </span><span class="s0">' ' </span><span class="s1">&amp;&amp; (</span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseText</span><span class="s1">(</span><span class="s2">text</span><span class="s1">, </span><span class="s2">delimiters</span><span class="s1">))) {</span>
                    <span class="s2">child </span><span class="s1">= {</span>
                        <span class="s2">type</span><span class="s1">: </span><span class="s6">2</span><span class="s1">,</span>
                        <span class="s2">expression</span><span class="s1">: </span><span class="s2">res</span><span class="s1">.</span><span class="s2">expression</span><span class="s1">,</span>
                        <span class="s2">tokens</span><span class="s1">: </span><span class="s2">res</span><span class="s1">.</span><span class="s2">tokens</span><span class="s1">,</span>
                        <span class="s2">text</span>
                    <span class="s1">};</span>
                <span class="s1">}</span>
                <span class="s3">else if </span><span class="s1">(</span><span class="s2">text </span><span class="s1">!== </span><span class="s0">' ' </span><span class="s1">||</span>
                    <span class="s1">!</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">||</span>
                    <span class="s2">children</span><span class="s1">[</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">].</span><span class="s2">text </span><span class="s1">!== </span><span class="s0">' '</span><span class="s1">) {</span>
                    <span class="s2">child </span><span class="s1">= {</span>
                        <span class="s2">type</span><span class="s1">: </span><span class="s6">3</span><span class="s1">,</span>
                        <span class="s2">text</span>
                    <span class="s1">};</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">child</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                        <span class="s2">child</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">start</span><span class="s1">;</span>
                        <span class="s2">child</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">end</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s2">children</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">},</span>
        <span class="s2">comment</span><span class="s1">(</span><span class="s2">text</span><span class="s1">, </span><span class="s2">start</span><span class="s1">, </span><span class="s2">end</span><span class="s1">) {</span>
            <span class="s4">// adding anything as a sibling to the root node is forbidden</span>
            <span class="s4">// comments should still be allowed, but ignored</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">currentParent</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">child </span><span class="s1">= {</span>
                    <span class="s2">type</span><span class="s1">: </span><span class="s6">3</span><span class="s1">,</span>
                    <span class="s2">text</span><span class="s1">,</span>
                    <span class="s2">isComment</span><span class="s1">: </span><span class="s3">true</span>
                <span class="s1">};</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                    <span class="s2">child</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">start</span><span class="s1">;</span>
                    <span class="s2">child</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">end</span><span class="s1">;</span>
                <span class="s1">}</span>
                <span class="s2">currentParent</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
    <span class="s3">return </span><span class="s2">root</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processPre</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-pre'</span><span class="s1">) != </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processRawAttrs</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">list </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">len </span><span class="s1">= </span><span class="s2">list</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">len</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">attrs </span><span class="s1">= (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">= </span><span class="s3">new </span><span class="s2">Array</span><span class="s1">(</span><span class="s2">len</span><span class="s1">));</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = {</span>
                <span class="s2">name</span><span class="s1">: </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name</span><span class="s1">,</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">value</span><span class="s1">)</span>
            <span class="s1">};</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">start </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
                <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">start </span><span class="s1">= </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">start</span><span class="s1">;</span>
                <span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">end </span><span class="s1">= </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">end</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
        <span class="s4">// non root node in pre blocks with no attributes</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processElement</span><span class="s1">(</span><span class="s2">element</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s2">processKey</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s4">// determine whether this is a plain element after</span>
    <span class="s4">// removing structural attributes</span>
    <span class="s2">element</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">=</span>
        <span class="s1">!</span><span class="s2">element</span><span class="s1">.</span><span class="s2">key </span><span class="s1">&amp;&amp; !</span><span class="s2">element</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">&amp;&amp; !</span><span class="s2">element</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s2">processRef</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s2">processSlotContent</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s2">processSlotOutlet</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s2">processComponent</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">transforms</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">element </span><span class="s1">= </span><span class="s2">transforms</span><span class="s1">[</span><span class="s2">i</span><span class="s1">](</span><span class="s2">element</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) || </span><span class="s2">element</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">processAttrs</span><span class="s1">(</span><span class="s2">element</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s2">element</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processKey</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">exp </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'key'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">exp</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
                <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`&lt;template&gt; cannot be keyed. Place the key on real elements instead.`</span><span class="s1">, </span><span class="s2">getRawBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'key'</span><span class="s1">));</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">for</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">iterator </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator2 </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator1</span><span class="s1">;</span>
                <span class="s3">const </span><span class="s2">parent </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">iterator </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">iterator </span><span class="s1">=== </span><span class="s2">exp </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">parent </span><span class="s1">&amp;&amp;</span>
                    <span class="s2">parent</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'transition-group'</span><span class="s1">) {</span>
                    <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Do not use v-for index as key on &lt;transition-group&gt; children, ` </span><span class="s1">+</span>
                        <span class="s0">`this is the same as not using keys.`</span><span class="s1">, </span><span class="s2">getRawBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'key'</span><span class="s1">), </span><span class="s3">true </span><span class="s4">/* tip */</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">key </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processRef</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">ref </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'ref'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">ref</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">ref </span><span class="s1">= </span><span class="s2">ref</span><span class="s1">;</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">refInFor </span><span class="s1">= </span><span class="s2">checkInFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">exp</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">exp </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-for'</span><span class="s1">))) {</span>
        <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseFor</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">) {</span>
            <span class="s2">extend</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">res</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Invalid v-for expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-for'</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">parseFor</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">inMatch </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">forAliasRE</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">inMatch</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
    <span class="s2">res</span><span class="s1">.</span><span class="s2">for </span><span class="s1">= </span><span class="s2">inMatch</span><span class="s1">[</span><span class="s6">2</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span>
    <span class="s3">const </span><span class="s2">alias </span><span class="s1">= </span><span class="s2">inMatch</span><span class="s1">[</span><span class="s6">1</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">().</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">stripParensRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">iteratorMatch </span><span class="s1">= </span><span class="s2">alias</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">forIteratorRE</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">iteratorMatch</span><span class="s1">) {</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">alias </span><span class="s1">= </span><span class="s2">alias</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">forIteratorRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">).</span><span class="s2">trim</span><span class="s1">();</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">iterator1 </span><span class="s1">= </span><span class="s2">iteratorMatch</span><span class="s1">[</span><span class="s6">1</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">iteratorMatch</span><span class="s1">[</span><span class="s6">2</span><span class="s1">]) {</span>
            <span class="s2">res</span><span class="s1">.</span><span class="s2">iterator2 </span><span class="s1">= </span><span class="s2">iteratorMatch</span><span class="s1">[</span><span class="s6">2</span><span class="s1">].</span><span class="s2">trim</span><span class="s1">();</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">alias </span><span class="s1">= </span><span class="s2">alias</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">exp </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-if'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">exp</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">;</span>
        <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, {</span>
            <span class="s2">exp</span><span class="s1">: </span><span class="s2">exp</span><span class="s1">,</span>
            <span class="s2">block</span><span class="s1">: </span><span class="s2">el</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-else'</span><span class="s1">) != </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">else </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">const </span><span class="s2">elseif </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-else-if'</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">elseif</span><span class="s1">) {</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">= </span><span class="s2">elseif</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processIfConditions</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">prev </span><span class="s1">= </span><span class="s2">findPrevElement</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">children</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">prev </span><span class="s1">&amp;&amp; </span><span class="s2">prev</span><span class="s1">.</span><span class="s2">if</span><span class="s1">) {</span>
        <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">prev</span><span class="s1">, {</span>
            <span class="s2">exp</span><span class="s1">: </span><span class="s2">el</span><span class="s1">.</span><span class="s2">elseif</span><span class="s1">,</span>
            <span class="s2">block</span><span class="s1">: </span><span class="s2">el</span>
        <span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`v-</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">? </span><span class="s0">'else-if=&quot;' </span><span class="s1">+ </span><span class="s2">el</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">+ </span><span class="s0">'&quot;' </span><span class="s1">: </span><span class="s0">'else'</span><span class="s1">} </span><span class="s0">` </span><span class="s1">+</span>
            <span class="s0">`used on element &lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt; without corresponding v-if.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s2">el</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">? </span><span class="s0">'v-else-if' </span><span class="s1">: </span><span class="s0">'v-else'</span><span class="s1">]);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">findPrevElement</span><span class="s1">(</span><span class="s2">children</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">--) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">text </span><span class="s1">!== </span><span class="s0">' '</span><span class="s1">) {</span>
                <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`text &quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s0">&quot; between v-if and v-else(-if) ` </span><span class="s1">+</span>
                    <span class="s0">`will be ignored.`</span><span class="s1">, </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
            <span class="s1">}</span>
            <span class="s2">children</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">condition</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions </span><span class="s1">= [];</span>
    <span class="s1">}</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">condition</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processOnce</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">once </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-once'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">once </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">once </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// handle content being passed to a component as slot,</span>
<span class="s4">// e.g. &lt;template slot=&quot;xxx&quot;&gt;, &lt;div slot-scope=&quot;xxx&quot;&gt;</span>
<span class="s3">function </span><span class="s2">processSlotContent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">slotScope</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
        <span class="s2">slotScope </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'scope'</span><span class="s1">);</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">slotScope</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`the &quot;scope&quot; attribute for scoped slots have been deprecated and ` </span><span class="s1">+</span>
                <span class="s0">`replaced by &quot;slot-scope&quot; since 2.5. The new &quot;slot-scope&quot; attribute ` </span><span class="s1">+</span>
                <span class="s0">`can also be used on plain elements in addition to &lt;template&gt; to ` </span><span class="s1">+</span>
                <span class="s0">`denote scoped slots.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'scope'</span><span class="s1">], </span><span class="s3">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">slotScope </span><span class="s1">|| </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'slot-scope'</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">((</span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'slot-scope'</span><span class="s1">))) {</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-for'</span><span class="s1">]) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Ambiguous combined usage of slot-scope and v-for on &lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt; ` </span><span class="s1">+</span>
                <span class="s0">`(v-for takes higher priority). Use a wrapper &lt;template&gt; for the ` </span><span class="s1">+</span>
                <span class="s0">`scoped slot to make it clearer.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'slot-scope'</span><span class="s1">], </span><span class="s3">true</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">slotScope</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// slot=&quot;xxx&quot;</span>
    <span class="s3">const </span><span class="s2">slotTarget </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'slot'</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">slotTarget</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">= </span><span class="s2">slotTarget </span><span class="s1">=== </span><span class="s0">'&quot;&quot;' </span><span class="s1">? </span><span class="s0">'&quot;default&quot;' </span><span class="s1">: </span><span class="s2">slotTarget</span><span class="s1">;</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">slotTargetDynamic </span><span class="s1">= !!(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">':slot'</span><span class="s1">] || </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind:slot'</span><span class="s1">]);</span>
        <span class="s4">// preserve slot as an attribute for native shadow DOM compat</span>
        <span class="s4">// only for non-scoped slots.</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'template' </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">) {</span>
            <span class="s2">addAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'slot'</span><span class="s1">, </span><span class="s2">slotTarget</span><span class="s1">, </span><span class="s2">getRawBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'slot'</span><span class="s1">));</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s4">// 2.6 v-slot syntax</span>
    <span class="s1">{</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
            <span class="s4">// v-slot on &lt;template&gt;</span>
            <span class="s3">const </span><span class="s2">slotBinding </span><span class="s1">= </span><span class="s2">getAndRemoveAttrByRegex</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">slotRE</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">slotBinding</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Unexpected mixed usage of different slot syntaxes.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">&amp;&amp; !</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">)) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`&lt;template v-slot&gt; can only appear at the root level inside ` </span><span class="s1">+</span>
                            <span class="s0">`the receiving component`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s3">const </span><span class="s1">{ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic </span><span class="s1">} = </span><span class="s2">getSlotName</span><span class="s1">(</span><span class="s2">slotBinding</span><span class="s1">);</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">= </span><span class="s2">name</span><span class="s1">;</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">slotTargetDynamic </span><span class="s1">= </span><span class="s2">dynamic</span><span class="s1">;</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">slotBinding</span><span class="s1">.</span><span class="s2">value </span><span class="s1">|| </span><span class="s2">emptySlotScopeToken</span><span class="s1">; </span><span class="s4">// force it into a scoped slot for perf</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// v-slot on component, denotes default slot</span>
            <span class="s3">const </span><span class="s2">slotBinding </span><span class="s1">= </span><span class="s2">getAndRemoveAttrByRegex</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">slotRE</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">slotBinding</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(!</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">)) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`v-slot can only be used on components or &lt;template&gt;.`</span><span class="s1">, </span><span class="s2">slotBinding</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget</span><span class="s1">) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`Unexpected mixed usage of different slot syntaxes.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">) {</span>
                        <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`To avoid scope ambiguity, the default slot should also use ` </span><span class="s1">+</span>
                            <span class="s0">`&lt;template&gt; syntax when there are other named slots.`</span><span class="s1">, </span><span class="s2">slotBinding</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s4">// add the component's children to its default slot</span>
                <span class="s3">const </span><span class="s2">slots </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">scopedSlots </span><span class="s1">= {});</span>
                <span class="s3">const </span><span class="s1">{ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">dynamic </span><span class="s1">} = </span><span class="s2">getSlotName</span><span class="s1">(</span><span class="s2">slotBinding</span><span class="s1">);</span>
                <span class="s3">const </span><span class="s2">slotContainer </span><span class="s1">= (</span><span class="s2">slots</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">createASTElement</span><span class="s1">(</span><span class="s0">'template'</span><span class="s1">, [], </span><span class="s2">el</span><span class="s1">));</span>
                <span class="s2">slotContainer</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">= </span><span class="s2">name</span><span class="s1">;</span>
                <span class="s2">slotContainer</span><span class="s1">.</span><span class="s2">slotTargetDynamic </span><span class="s1">= </span><span class="s2">dynamic</span><span class="s1">;</span>
                <span class="s2">slotContainer</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">((</span><span class="s2">c</span><span class="s1">) =&gt; {</span>
                    <span class="s3">if </span><span class="s1">(!</span><span class="s2">c</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">) {</span>
                        <span class="s2">c</span><span class="s1">.</span><span class="s2">parent </span><span class="s1">= </span><span class="s2">slotContainer</span><span class="s1">;</span>
                        <span class="s3">return true</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">});</span>
                <span class="s2">slotContainer</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">slotBinding</span><span class="s1">.</span><span class="s2">value </span><span class="s1">|| </span><span class="s2">emptySlotScopeToken</span><span class="s1">;</span>
                <span class="s4">// remove children as they are returned from scopedSlots now</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= [];</span>
                <span class="s4">// mark el non-plain so data gets generated</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">getSlotName</span><span class="s1">(</span><span class="s2">binding</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">name </span><span class="s1">= </span><span class="s2">binding</span><span class="s1">.</span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">slotRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">name</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">binding</span><span class="s1">.</span><span class="s2">name</span><span class="s1">[</span><span class="s6">0</span><span class="s1">] !== </span><span class="s0">'#'</span><span class="s1">) {</span>
            <span class="s2">name </span><span class="s1">= </span><span class="s0">'default'</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`v-slot shorthand syntax requires a slot name.`</span><span class="s1">, </span><span class="s2">binding</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">dynamicArgRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)</span>
        <span class="s1">? </span><span class="s4">// dynamic [name]</span>
            <span class="s1">{ </span><span class="s2">name</span><span class="s1">: </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">), </span><span class="s2">dynamic</span><span class="s1">: </span><span class="s3">true </span><span class="s1">}</span>
        <span class="s1">: </span><span class="s4">// static name</span>
            <span class="s1">{ </span><span class="s2">name</span><span class="s1">: </span><span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">dynamic</span><span class="s1">: </span><span class="s3">false </span><span class="s1">};</span>
<span class="s1">}</span>
<span class="s4">// handle &lt;slot/&gt; outlets</span>
<span class="s3">function </span><span class="s2">processSlotOutlet</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'slot'</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">slotName </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'name'</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">el</span><span class="s1">.</span><span class="s2">key</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`</span><span class="s3">\`</span><span class="s0">key</span><span class="s3">\` </span><span class="s0">does not work on &lt;slot&gt; because slots are abstract outlets ` </span><span class="s1">+</span>
                <span class="s0">`and can possibly expand into multiple elements. ` </span><span class="s1">+</span>
                <span class="s0">`Use the key on a wrapping element instead.`</span><span class="s1">, </span><span class="s2">getRawBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'key'</span><span class="s1">));</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">binding</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'is'</span><span class="s1">))) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">component </span><span class="s1">= </span><span class="s2">binding</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'inline-template'</span><span class="s1">) != </span><span class="s3">null</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">inlineTemplate </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">processAttrs</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">list </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">i</span><span class="s1">, </span><span class="s2">l</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">rawName</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">, </span><span class="s2">syncGen</span><span class="s1">, </span><span class="s2">isDynamic</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">list</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">name </span><span class="s1">= </span><span class="s2">rawName </span><span class="s1">= </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name</span><span class="s1">;</span>
        <span class="s2">value </span><span class="s1">= </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">value</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">dirRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
            <span class="s4">// mark element as dynamic</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">hasBindings </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s4">// modifiers</span>
            <span class="s2">modifiers </span><span class="s1">= </span><span class="s2">parseModifiers</span><span class="s1">(</span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">dirRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">));</span>
            <span class="s4">// support .foo shorthand syntax for the .prop modifier</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">) {</span>
                <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">modifierRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">bindRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
                <span class="s4">// v-bind</span>
                <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">bindRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
                <span class="s2">value </span><span class="s1">= </span><span class="s2">parseFilters</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
                <span class="s2">isDynamic </span><span class="s1">= </span><span class="s2">dynamicArgRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">isDynamic</span><span class="s1">) {</span>
                    <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">value</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">().</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">0</span><span class="s1">) {</span>
                    <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`The value for a v-bind expression cannot be empty. Found in &quot;v-bind:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">prop </span><span class="s1">&amp;&amp; !</span><span class="s2">isDynamic</span><span class="s1">) {</span>
                        <span class="s2">name </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
                        <span class="s3">if </span><span class="s1">(</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'innerHtml'</span><span class="s1">)</span>
                            <span class="s2">name </span><span class="s1">= </span><span class="s0">'innerHTML'</span><span class="s1">;</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">camel </span><span class="s1">&amp;&amp; !</span><span class="s2">isDynamic</span><span class="s1">) {</span>
                        <span class="s2">name </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">sync</span><span class="s1">) {</span>
                        <span class="s2">syncGen </span><span class="s1">= </span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">`$event`</span><span class="s1">);</span>
                        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isDynamic</span><span class="s1">) {</span>
                            <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">`update:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">syncGen</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">warn$1</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
                            <span class="s3">if </span><span class="s1">(</span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) !== </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
                                <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">`update:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">hyphenate</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">syncGen</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">warn$1</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s3">else </span><span class="s1">{</span>
                            <span class="s4">// handler w/ dynamic event name</span>
                            <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">`&quot;update:&quot;+(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">, </span><span class="s2">syncGen</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">warn$1</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s3">true </span><span class="s4">// dynamic</span>
                            <span class="s1">);</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s3">if </span><span class="s1">((</span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">prop</span><span class="s1">) ||</span>
                    <span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component </span><span class="s1">&amp;&amp; </span><span class="s2">platformMustUseProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type</span><span class="s1">, </span><span class="s2">name</span><span class="s1">))) {</span>
                    <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">isDynamic</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">addAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">isDynamic</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">onRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
                <span class="s4">// v-on</span>
                <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">onRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
                <span class="s2">isDynamic </span><span class="s1">= </span><span class="s2">dynamicArgRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">isDynamic</span><span class="s1">) {</span>
                    <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">, </span><span class="s3">false</span><span class="s1">, </span><span class="s2">warn$1</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">isDynamic</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s4">// normal directives</span>
                <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">dirRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
                <span class="s4">// parse arg</span>
                <span class="s3">const </span><span class="s2">argMatch </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">argRE</span><span class="s1">);</span>
                <span class="s3">let </span><span class="s2">arg </span><span class="s1">= </span><span class="s2">argMatch </span><span class="s1">&amp;&amp; </span><span class="s2">argMatch</span><span class="s1">[</span><span class="s6">1</span><span class="s1">];</span>
                <span class="s2">isDynamic </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">arg</span><span class="s1">) {</span>
                    <span class="s2">name </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -(</span><span class="s2">arg</span><span class="s1">.</span><span class="s2">length </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">));</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamicArgRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">arg</span><span class="s1">)) {</span>
                        <span class="s2">arg </span><span class="s1">= </span><span class="s2">arg</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">);</span>
                        <span class="s2">isDynamic </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s2">addDirective</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">rawName</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">arg</span><span class="s1">, </span><span class="s2">isDynamic</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'model'</span><span class="s1">) {</span>
                    <span class="s2">checkForAliasModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// literal attribute</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">res </span><span class="s1">= </span><span class="s2">parseText</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">delimiters</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">res</span><span class="s1">) {</span>
                    <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;: ` </span><span class="s1">+</span>
                        <span class="s0">'Interpolation inside attributes has been removed. ' </span><span class="s1">+</span>
                        <span class="s0">'Use v-bind or the colon shorthand instead. For example, ' </span><span class="s1">+</span>
                        <span class="s0">'instead of &lt;div id=&quot;{{ val }}&quot;&gt;, use &lt;div :id=&quot;val&quot;&gt;.'</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">addAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">value</span><span class="s1">), </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
            <span class="s4">// #6887 firefox doesn't update muted state if set via attribute</span>
            <span class="s4">// even immediately after element creation</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component </span><span class="s1">&amp;&amp;</span>
                <span class="s2">name </span><span class="s1">=== </span><span class="s0">'muted' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">platformMustUseProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type</span><span class="s1">, </span><span class="s2">name</span><span class="s1">)) {</span>
                <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s0">'true'</span><span class="s1">, </span><span class="s2">list</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkInFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">parent </span><span class="s1">= </span><span class="s2">el</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">for </span><span class="s1">!== </span><span class="s2">undefined</span><span class="s1">) {</span>
            <span class="s3">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s2">parent </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">parseModifiers</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">match </span><span class="s1">= </span><span class="s2">name</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">modifierRE</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">match</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">ret </span><span class="s1">= {};</span>
        <span class="s2">match</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">m </span><span class="s1">=&gt; {</span>
            <span class="s2">ret</span><span class="s1">[</span><span class="s2">m</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">1</span><span class="s1">)] = </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s1">});</span>
        <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">makeAttrsMap</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">map </span><span class="s1">= {};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">map</span><span class="s1">[</span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name</span><span class="s1">] &amp;&amp; !</span><span class="s2">isIE </span><span class="s1">&amp;&amp; !</span><span class="s2">isEdge</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">'duplicate attribute: ' </span><span class="s1">+ </span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
        <span class="s1">}</span>
        <span class="s2">map</span><span class="s1">[</span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">name</span><span class="s1">] = </span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">value</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">map</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// for script (e.g. type=&quot;x/template&quot;) or style, do not decode content</span>
<span class="s3">function </span><span class="s2">isTextTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'script' </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'style'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isForbiddenTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'style' </span><span class="s1">||</span>
        <span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'script' </span><span class="s1">&amp;&amp;</span>
            <span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'text/javascript'</span><span class="s1">)));</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">ieNSBug </span><span class="s1">= </span><span class="s7">/^xmlns:NS\d+/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">ieNSPrefix </span><span class="s1">= </span><span class="s7">/^NS\d+:/</span><span class="s1">;</span>
<span class="s4">/* istanbul ignore next */</span>
<span class="s3">function </span><span class="s2">guardIESVGBug</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= [];</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">attr </span><span class="s1">= </span><span class="s2">attrs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">ieNSBug</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)) {</span>
            <span class="s2">attr</span><span class="s1">.</span><span class="s2">name </span><span class="s1">= </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">ieNSPrefix</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
            <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkForAliasModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">_el </span><span class="s1">= </span><span class="s2">el</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">_el</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">_el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; </span><span class="s2">_el</span><span class="s1">.</span><span class="s2">alias </span><span class="s1">=== </span><span class="s2">value</span><span class="s1">) {</span>
            <span class="s2">warn$1</span><span class="s1">(</span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">} </span><span class="s0">v-model=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;&gt;: ` </span><span class="s1">+</span>
                <span class="s0">`You are binding v-model directly to a v-for iteration alias. ` </span><span class="s1">+</span>
                <span class="s0">`This will not be able to modify the v-for source array because ` </span><span class="s1">+</span>
                <span class="s0">`writing to the alias is like modifying a function local variable. ` </span><span class="s1">+</span>
                <span class="s0">`Consider using an array of objects and use v-model on an object property instead.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-model'</span><span class="s1">]);</span>
        <span class="s1">}</span>
        <span class="s2">_el </span><span class="s1">= </span><span class="s2">_el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* Expand input[v-model] with dynamic type bindings into v-if-else chains</span>
 <span class="s5">* Turn this:</span>
 <span class="s5">*   &lt;input v-model=&quot;data[type]&quot; :type=&quot;type&quot;&gt;</span>
 <span class="s5">* into this:</span>
 <span class="s5">*   &lt;input v-if=&quot;type === 'checkbox'&quot; type=&quot;checkbox&quot; v-model=&quot;data[type]&quot;&gt;</span>
 <span class="s5">*   &lt;input v-else-if=&quot;type === 'radio'&quot; type=&quot;radio&quot; v-model=&quot;data[type]&quot;&gt;</span>
 <span class="s5">*   &lt;input v-else :type=&quot;type&quot; v-model=&quot;data[type]&quot;&gt;</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">preTransformNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input'</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">map </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">map</span><span class="s1">[</span><span class="s0">'v-model'</span><span class="s1">]) {</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">let </span><span class="s2">typeBinding</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">map</span><span class="s1">[</span><span class="s0">':type'</span><span class="s1">] || </span><span class="s2">map</span><span class="s1">[</span><span class="s0">'v-bind:type'</span><span class="s1">]) {</span>
            <span class="s2">typeBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'type'</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">map</span><span class="s1">.</span><span class="s2">type </span><span class="s1">&amp;&amp; !</span><span class="s2">typeBinding </span><span class="s1">&amp;&amp; </span><span class="s2">map</span><span class="s1">[</span><span class="s0">'v-bind'</span><span class="s1">]) {</span>
            <span class="s2">typeBinding </span><span class="s1">= </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">map</span><span class="s1">[</span><span class="s0">'v-bind'</span><span class="s1">]}</span><span class="s0">).type`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">typeBinding</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">ifCondition </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-if'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
            <span class="s3">const </span><span class="s2">ifConditionExtra </span><span class="s1">= </span><span class="s2">ifCondition </span><span class="s1">? </span><span class="s0">`&amp;&amp;(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ifCondition</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">: </span><span class="s0">``</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">hasElse </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-else'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">) != </span><span class="s3">null</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">elseIfCondition </span><span class="s1">= </span><span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'v-else-if'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
            <span class="s4">// 1. checkbox</span>
            <span class="s3">const </span><span class="s2">branch0 </span><span class="s1">= </span><span class="s2">cloneASTElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
            <span class="s4">// process for on the main node</span>
            <span class="s2">processFor</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">);</span>
            <span class="s2">addRawAttr</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">, </span><span class="s0">'type'</span><span class="s1">, </span><span class="s0">'checkbox'</span><span class="s1">);</span>
            <span class="s2">processElement</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
            <span class="s2">branch0</span><span class="s1">.</span><span class="s2">processed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">; </span><span class="s4">// prevent it from double-processed</span>
            <span class="s2">branch0</span><span class="s1">.</span><span class="s2">if </span><span class="s1">= </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">typeBinding</span><span class="s1">}</span><span class="s0">)==='checkbox'` </span><span class="s1">+ </span><span class="s2">ifConditionExtra</span><span class="s1">;</span>
            <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">, {</span>
                <span class="s2">exp</span><span class="s1">: </span><span class="s2">branch0</span><span class="s1">.</span><span class="s2">if</span><span class="s1">,</span>
                <span class="s2">block</span><span class="s1">: </span><span class="s2">branch0</span>
            <span class="s1">});</span>
            <span class="s4">// 2. add radio else-if condition</span>
            <span class="s3">const </span><span class="s2">branch1 </span><span class="s1">= </span><span class="s2">cloneASTElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
            <span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">branch1</span><span class="s1">, </span><span class="s0">'v-for'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
            <span class="s2">addRawAttr</span><span class="s1">(</span><span class="s2">branch1</span><span class="s1">, </span><span class="s0">'type'</span><span class="s1">, </span><span class="s0">'radio'</span><span class="s1">);</span>
            <span class="s2">processElement</span><span class="s1">(</span><span class="s2">branch1</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
            <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">, {</span>
                <span class="s2">exp</span><span class="s1">: </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">typeBinding</span><span class="s1">}</span><span class="s0">)==='radio'` </span><span class="s1">+ </span><span class="s2">ifConditionExtra</span><span class="s1">,</span>
                <span class="s2">block</span><span class="s1">: </span><span class="s2">branch1</span>
            <span class="s1">});</span>
            <span class="s4">// 3. other</span>
            <span class="s3">const </span><span class="s2">branch2 </span><span class="s1">= </span><span class="s2">cloneASTElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
            <span class="s2">getAndRemoveAttr</span><span class="s1">(</span><span class="s2">branch2</span><span class="s1">, </span><span class="s0">'v-for'</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
            <span class="s2">addRawAttr</span><span class="s1">(</span><span class="s2">branch2</span><span class="s1">, </span><span class="s0">':type'</span><span class="s1">, </span><span class="s2">typeBinding</span><span class="s1">);</span>
            <span class="s2">processElement</span><span class="s1">(</span><span class="s2">branch2</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
            <span class="s2">addIfCondition</span><span class="s1">(</span><span class="s2">branch0</span><span class="s1">, {</span>
                <span class="s2">exp</span><span class="s1">: </span><span class="s2">ifCondition</span><span class="s1">,</span>
                <span class="s2">block</span><span class="s1">: </span><span class="s2">branch2</span>
            <span class="s1">});</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">hasElse</span><span class="s1">) {</span>
                <span class="s2">branch0</span><span class="s1">.</span><span class="s2">else </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">elseIfCondition</span><span class="s1">) {</span>
                <span class="s2">branch0</span><span class="s1">.</span><span class="s2">elseif </span><span class="s1">= </span><span class="s2">elseIfCondition</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">return </span><span class="s2">branch0</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">cloneASTElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">createASTElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsList</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(), </span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">var </span><span class="s2">model$1 </span><span class="s1">= {</span>
    <span class="s2">preTransformNode</span>
<span class="s1">};</span>

<span class="s3">var </span><span class="s2">modules </span><span class="s1">= [</span><span class="s2">klass</span><span class="s1">, </span><span class="s2">style</span><span class="s1">, </span><span class="s2">model$1</span><span class="s1">];</span>

<span class="s3">let </span><span class="s2">warn</span><span class="s1">;</span>
<span class="s4">// in some cases, the event used has to be determined at runtime</span>
<span class="s4">// so we used some reserved tokens during compile.</span>
<span class="s3">const </span><span class="s2">RANGE_TOKEN </span><span class="s1">= </span><span class="s0">'__r'</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">model</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">, </span><span class="s2">_warn</span><span class="s1">) {</span>
    <span class="s2">warn </span><span class="s1">= </span><span class="s2">_warn</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">modifiers </span><span class="s1">= </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">tag </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">type </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s4">// inputs with type=&quot;file&quot; are read only and setting the input's</span>
        <span class="s4">// value will throw an error.</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input' </span><span class="s1">&amp;&amp; </span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'file'</span><span class="s1">) {</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">} </span><span class="s0">v-model=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot; type=&quot;file&quot;&gt;:</span><span class="s3">\n</span><span class="s0">` </span><span class="s1">+</span>
                <span class="s0">`File inputs are read only. Use a v-on:change listener instead.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-model'</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component</span><span class="s1">) {</span>
        <span class="s2">genComponentModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
        <span class="s4">// component v-model doesn't need extra runtime</span>
        <span class="s3">return false</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'select'</span><span class="s1">) {</span>
        <span class="s2">genSelect</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input' </span><span class="s1">&amp;&amp; </span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'checkbox'</span><span class="s1">) {</span>
        <span class="s2">genCheckboxModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input' </span><span class="s1">&amp;&amp; </span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'radio'</span><span class="s1">) {</span>
        <span class="s2">genRadioModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'input' </span><span class="s1">|| </span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'textarea'</span><span class="s1">) {</span>
        <span class="s2">genDefaultModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">genComponentModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">);</span>
        <span class="s4">// component v-model doesn't need extra runtime</span>
        <span class="s3">return false</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// ensure runtime directive metadata</span>
    <span class="s3">return true</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genCheckboxModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">number </span><span class="s1">= </span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">number</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">valueBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'value'</span><span class="s1">) || </span><span class="s0">'null'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">trueValueBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'true-value'</span><span class="s1">) || </span><span class="s0">'true'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">falseValueBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'false-value'</span><span class="s1">) || </span><span class="s0">'false'</span><span class="s1">;</span>
    <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'checked'</span><span class="s1">, </span><span class="s0">`Array.isArray(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">+</span>
        <span class="s0">`?_i(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">valueBinding</span><span class="s1">}</span><span class="s0">)&gt;-1` </span><span class="s1">+</span>
        <span class="s1">(</span><span class="s2">trueValueBinding </span><span class="s1">=== </span><span class="s0">'true'</span>
            <span class="s1">? </span><span class="s0">`:(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span>
            <span class="s1">: </span><span class="s0">`:_q(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">trueValueBinding</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">));</span>
    <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'change'</span><span class="s1">, </span><span class="s0">`var $$a=</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,` </span><span class="s1">+</span>
        <span class="s0">'$$el=$event.target,' </span><span class="s1">+</span>
        <span class="s0">`$$c=$$el.checked?(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">trueValueBinding</span><span class="s1">}</span><span class="s0">):(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">falseValueBinding</span><span class="s1">}</span><span class="s0">);` </span><span class="s1">+</span>
        <span class="s0">'if(Array.isArray($$a)){' </span><span class="s1">+</span>
        <span class="s0">`var $$v=</span><span class="s2">$</span><span class="s1">{</span><span class="s2">number </span><span class="s1">? </span><span class="s0">'_n(' </span><span class="s1">+ </span><span class="s2">valueBinding </span><span class="s1">+ </span><span class="s0">')' </span><span class="s1">: </span><span class="s2">valueBinding</span><span class="s1">}</span><span class="s0">,` </span><span class="s1">+</span>
        <span class="s0">'$$i=_i($$a,$$v);' </span><span class="s1">+</span>
        <span class="s0">`if($$el.checked){$$i&lt;0&amp;&amp;(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">'$$a.concat([$$v])'</span><span class="s1">)}</span><span class="s0">)}` </span><span class="s1">+</span>
        <span class="s0">`else{$$i&gt;-1&amp;&amp;(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">'$$a.slice(0,$$i).concat($$a.slice($$i+1))'</span><span class="s1">)}</span><span class="s0">)}` </span><span class="s1">+</span>
        <span class="s0">`}else{</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">'$$c'</span><span class="s1">)}</span><span class="s0">}`</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genRadioModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">number </span><span class="s1">= </span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">number</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">valueBinding </span><span class="s1">= </span><span class="s2">getBindingAttr</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'value'</span><span class="s1">) || </span><span class="s0">'null'</span><span class="s1">;</span>
    <span class="s2">valueBinding </span><span class="s1">= </span><span class="s2">number </span><span class="s1">? </span><span class="s0">`_n(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">valueBinding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">: </span><span class="s2">valueBinding</span><span class="s1">;</span>
    <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'checked'</span><span class="s1">, </span><span class="s0">`_q(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">valueBinding</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">);</span>
    <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'change'</span><span class="s1">, </span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">valueBinding</span><span class="s1">), </span><span class="s3">null</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genSelect</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">number </span><span class="s1">= </span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">number</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">selectedVal </span><span class="s1">= </span><span class="s0">`Array.prototype.filter` </span><span class="s1">+</span>
        <span class="s0">`.call($event.target.options,function(o){return o.selected})` </span><span class="s1">+</span>
        <span class="s0">`.map(function(o){var val = &quot;_value&quot; in o ? o._value : o.value;` </span><span class="s1">+</span>
        <span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">number </span><span class="s1">? </span><span class="s0">'_n(val)' </span><span class="s1">: </span><span class="s0">'val'</span><span class="s1">}</span><span class="s0">})`</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">assignment </span><span class="s1">= </span><span class="s0">'$event.target.multiple ? $$selectedVal : $$selectedVal[0]'</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">code </span><span class="s1">= </span><span class="s0">`var $$selectedVal = </span><span class="s2">$</span><span class="s1">{</span><span class="s2">selectedVal</span><span class="s1">}</span><span class="s0">;`</span><span class="s1">;</span>
    <span class="s2">code </span><span class="s1">= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">} </span><span class="s2">$</span><span class="s1">{</span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">assignment</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'change'</span><span class="s1">, </span><span class="s2">code</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genDefaultModel</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">value</span><span class="s1">, </span><span class="s2">modifiers</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">type </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">type</span><span class="s1">;</span>
    <span class="s4">// warn if v-bind:value conflicts with v-model</span>
    <span class="s4">// except for inputs with v-bind:type</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind:value'</span><span class="s1">] || </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">':value'</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">typeBinding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind:type'</span><span class="s1">] || </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">':type'</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">value </span><span class="s1">&amp;&amp; !</span><span class="s2">typeBinding</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind:value'</span><span class="s1">] ? </span><span class="s0">'v-bind:value' </span><span class="s1">: </span><span class="s0">':value'</span><span class="s1">;</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot; conflicts with v-model on the same element ` </span><span class="s1">+</span>
                <span class="s0">'because the latter already expands to a value binding internally'</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s2">binding</span><span class="s1">]);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s1">{ </span><span class="s2">lazy</span><span class="s1">, </span><span class="s2">number</span><span class="s1">, </span><span class="s2">trim </span><span class="s1">} = </span><span class="s2">modifiers </span><span class="s1">|| {};</span>
    <span class="s3">const </span><span class="s2">needCompositionGuard </span><span class="s1">= !</span><span class="s2">lazy </span><span class="s1">&amp;&amp; </span><span class="s2">type </span><span class="s1">!== </span><span class="s0">'range'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">event </span><span class="s1">= </span><span class="s2">lazy </span><span class="s1">? </span><span class="s0">'change' </span><span class="s1">: </span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'range' </span><span class="s1">? </span><span class="s2">RANGE_TOKEN </span><span class="s1">: </span><span class="s0">'input'</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">valueExpression </span><span class="s1">= </span><span class="s0">'$event.target.value'</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">trim</span><span class="s1">) {</span>
        <span class="s2">valueExpression </span><span class="s1">= </span><span class="s0">`$event.target.value.trim()`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">number</span><span class="s1">) {</span>
        <span class="s2">valueExpression </span><span class="s1">= </span><span class="s0">`_n(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">valueExpression</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">let </span><span class="s2">code </span><span class="s1">= </span><span class="s2">genAssignmentCode</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s2">valueExpression</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">needCompositionGuard</span><span class="s1">) {</span>
        <span class="s2">code </span><span class="s1">= </span><span class="s0">`if($event.target.composing)return;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'value'</span><span class="s1">, </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">);</span>
    <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">event</span><span class="s1">, </span><span class="s2">code</span><span class="s1">, </span><span class="s3">null</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">trim </span><span class="s1">|| </span><span class="s2">number</span><span class="s1">) {</span>
        <span class="s2">addHandler</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'blur'</span><span class="s1">, </span><span class="s0">'$forceUpdate()'</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">text</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">) {</span>
        <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'textContent'</span><span class="s1">, </span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">html</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">) {</span>
        <span class="s2">addProp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s0">'innerHTML'</span><span class="s1">, </span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">var </span><span class="s2">directives </span><span class="s1">= {</span>
    <span class="s2">model</span><span class="s1">,</span>
    <span class="s2">text</span><span class="s1">,</span>
    <span class="s2">html</span>
<span class="s1">};</span>

<span class="s3">const </span><span class="s2">baseOptions </span><span class="s1">= {</span>
    <span class="s2">expectHTML</span><span class="s1">: </span><span class="s3">true</span><span class="s1">,</span>
    <span class="s2">modules</span><span class="s1">,</span>
    <span class="s2">directives</span><span class="s1">,</span>
    <span class="s2">isPreTag</span><span class="s1">,</span>
    <span class="s2">isUnaryTag</span><span class="s1">,</span>
    <span class="s2">mustUseProp</span><span class="s1">,</span>
    <span class="s2">canBeLeftOpenTag</span><span class="s1">,</span>
    <span class="s2">isReservedTag</span><span class="s1">,</span>
    <span class="s2">getTagNamespace</span><span class="s1">,</span>
    <span class="s2">staticKeys</span><span class="s1">: </span><span class="s2">genStaticKeys$1</span><span class="s1">(</span><span class="s2">modules</span><span class="s1">)</span>
<span class="s1">};</span>

<span class="s3">let </span><span class="s2">isStaticKey</span><span class="s1">;</span>
<span class="s3">let </span><span class="s2">isPlatformReservedTag$1</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">genStaticKeysCached </span><span class="s1">= </span><span class="s2">cached</span><span class="s1">(</span><span class="s2">genStaticKeys</span><span class="s1">);</span>
<span class="s5">/**</span>
 <span class="s5">* Goal of the optimizer: walk the generated template AST tree</span>
 <span class="s5">* and detect sub-trees that are purely static, i.e. parts of</span>
 <span class="s5">* the DOM that never needs to change.</span>
 <span class="s5">*</span>
 <span class="s5">* Once we detect these sub-trees, we can:</span>
 <span class="s5">*</span>
 <span class="s5">* 1. Hoist them into constants, so that we no longer need to</span>
 <span class="s5">*    create fresh nodes for them on each re-render;</span>
 <span class="s5">* 2. Completely skip them in the patching process.</span>
 <span class="s5">*/</span>
<span class="s3">function </span><span class="s2">optimize$1</span><span class="s1">(</span><span class="s2">root</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">root</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s2">isStaticKey </span><span class="s1">= </span><span class="s2">genStaticKeysCached</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">staticKeys </span><span class="s1">|| </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s2">isPlatformReservedTag$1 </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isReservedTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s4">// first pass: mark all non-static nodes.</span>
    <span class="s2">markStatic</span><span class="s1">(</span><span class="s2">root</span><span class="s1">);</span>
    <span class="s4">// second pass: mark static roots.</span>
    <span class="s2">markStaticRoots</span><span class="s1">(</span><span class="s2">root</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genStaticKeys</span><span class="s1">(</span><span class="s2">keys</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap' </span><span class="s1">+</span>
        <span class="s1">(</span><span class="s2">keys </span><span class="s1">? </span><span class="s0">',' </span><span class="s1">+ </span><span class="s2">keys </span><span class="s1">: </span><span class="s0">''</span><span class="s1">));</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">markStatic</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s2">node</span><span class="s1">.</span><span class="s2">static </span><span class="s1">= </span><span class="s2">isStatic</span><span class="s1">(</span><span class="s2">node</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s4">// do not make component slot content static. this avoids</span>
        <span class="s4">// 1. components not able to mutate slot nodes</span>
        <span class="s4">// 2. static slot content fails for hot-reloading</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isPlatformReservedTag$1</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) &amp;&amp;</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'slot' </span><span class="s1">&amp;&amp;</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'inline-template'</span><span class="s1">] == </span><span class="s3">null</span><span class="s1">) {</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">child </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s2">markStatic</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">child</span><span class="s1">.</span><span class="s2">static</span><span class="s1">) {</span>
                <span class="s2">node</span><span class="s1">.</span><span class="s2">static </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">1</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s3">const </span><span class="s2">block </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">block</span><span class="s1">;</span>
                <span class="s2">markStatic</span><span class="s1">(</span><span class="s2">block</span><span class="s1">);</span>
                <span class="s3">if </span><span class="s1">(!</span><span class="s2">block</span><span class="s1">.</span><span class="s2">static</span><span class="s1">) {</span>
                    <span class="s2">node</span><span class="s1">.</span><span class="s2">static </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">markStaticRoots</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">isInFor</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">static </span><span class="s1">|| </span><span class="s2">node</span><span class="s1">.</span><span class="s2">once</span><span class="s1">) {</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">staticInFor </span><span class="s1">= </span><span class="s2">isInFor</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s4">// For a node to qualify as a static root, it should have children that</span>
        <span class="s4">// are not just static text. Otherwise the cost of hoisting out will</span>
        <span class="s4">// outweigh the benefits and it's better off to just always render it fresh.</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">static </span><span class="s1">&amp;&amp;</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp; </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3</span><span class="s1">)) {</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">staticRoot </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s3">return</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">staticRoot </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">markStaticRoots</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">isInFor </span><span class="s1">|| !!</span><span class="s2">node</span><span class="s1">.</span><span class="s2">for</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">1</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">markStaticRoots</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">block</span><span class="s1">, </span><span class="s2">isInFor</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isStatic</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">2</span><span class="s1">) {</span>
        <span class="s4">// expression</span>
        <span class="s3">return false</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3</span><span class="s1">) {</span>
        <span class="s4">// text</span>
        <span class="s3">return true</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">!!(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">||</span>
        <span class="s1">(!</span><span class="s2">node</span><span class="s1">.</span><span class="s2">hasBindings </span><span class="s1">&amp;&amp; </span><span class="s4">// no dynamic bindings</span>
            <span class="s1">!</span><span class="s2">node</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp;</span>
            <span class="s1">!</span><span class="s2">node</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; </span><span class="s4">// not v-if or v-for or v-else</span>
            <span class="s1">!</span><span class="s2">isBuiltInTag</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) &amp;&amp; </span><span class="s4">// not a built-in</span>
            <span class="s2">isPlatformReservedTag$1</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) &amp;&amp; </span><span class="s4">// not a component</span>
            <span class="s1">!</span><span class="s2">isDirectChildOfTemplateFor</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) &amp;&amp;</span>
            <span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">node</span><span class="s1">).</span><span class="s2">every</span><span class="s1">(</span><span class="s2">isStaticKey</span><span class="s1">)));</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isDirectChildOfTemplateFor</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">) {</span>
        <span class="s2">node </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'template'</span><span class="s1">) {</span>
            <span class="s3">return false</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">for</span><span class="s1">) {</span>
            <span class="s3">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">fnExpRE </span><span class="s1">= </span><span class="s7">/^([\w$_]+|\([^)]*?\))\s*=&gt;|^function(?:\s+[\w$]+)?\s*\(/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">fnInvokeRE </span><span class="s1">= </span><span class="s7">/\([^)]*?\);*$/</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">simplePathRE </span><span class="s1">= </span><span class="s7">/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\[&quot;[^&quot;]*?&quot;]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/</span><span class="s1">;</span>
<span class="s4">// KeyboardEvent.keyCode aliases</span>
<span class="s3">const </span><span class="s2">keyCodes </span><span class="s1">= {</span>
    <span class="s2">esc</span><span class="s1">: </span><span class="s6">27</span><span class="s1">,</span>
    <span class="s2">tab</span><span class="s1">: </span><span class="s6">9</span><span class="s1">,</span>
    <span class="s2">enter</span><span class="s1">: </span><span class="s6">13</span><span class="s1">,</span>
    <span class="s2">space</span><span class="s1">: </span><span class="s6">32</span><span class="s1">,</span>
    <span class="s2">up</span><span class="s1">: </span><span class="s6">38</span><span class="s1">,</span>
    <span class="s2">left</span><span class="s1">: </span><span class="s6">37</span><span class="s1">,</span>
    <span class="s2">right</span><span class="s1">: </span><span class="s6">39</span><span class="s1">,</span>
    <span class="s2">down</span><span class="s1">: </span><span class="s6">40</span><span class="s1">,</span>
    <span class="s3">delete</span><span class="s1">: [</span><span class="s6">8</span><span class="s1">, </span><span class="s6">46</span><span class="s1">]</span>
<span class="s1">};</span>
<span class="s4">// KeyboardEvent.key aliases</span>
<span class="s3">const </span><span class="s2">keyNames </span><span class="s1">= {</span>
    <span class="s4">// #7880: IE11 and Edge use `Esc` for Escape key name.</span>
    <span class="s2">esc</span><span class="s1">: [</span><span class="s0">'Esc'</span><span class="s1">, </span><span class="s0">'Escape'</span><span class="s1">],</span>
    <span class="s2">tab</span><span class="s1">: </span><span class="s0">'Tab'</span><span class="s1">,</span>
    <span class="s2">enter</span><span class="s1">: </span><span class="s0">'Enter'</span><span class="s1">,</span>
    <span class="s4">// #9112: IE11 uses `Spacebar` for Space key name.</span>
    <span class="s2">space</span><span class="s1">: [</span><span class="s0">' '</span><span class="s1">, </span><span class="s0">'Spacebar'</span><span class="s1">],</span>
    <span class="s4">// #7806: IE11 uses key names without `Arrow` prefix for arrow keys.</span>
    <span class="s2">up</span><span class="s1">: [</span><span class="s0">'Up'</span><span class="s1">, </span><span class="s0">'ArrowUp'</span><span class="s1">],</span>
    <span class="s2">left</span><span class="s1">: [</span><span class="s0">'Left'</span><span class="s1">, </span><span class="s0">'ArrowLeft'</span><span class="s1">],</span>
    <span class="s2">right</span><span class="s1">: [</span><span class="s0">'Right'</span><span class="s1">, </span><span class="s0">'ArrowRight'</span><span class="s1">],</span>
    <span class="s2">down</span><span class="s1">: [</span><span class="s0">'Down'</span><span class="s1">, </span><span class="s0">'ArrowDown'</span><span class="s1">],</span>
    <span class="s4">// #9112: IE11 uses `Del` for Delete key name.</span>
    <span class="s3">delete</span><span class="s1">: [</span><span class="s0">'Backspace'</span><span class="s1">, </span><span class="s0">'Delete'</span><span class="s1">, </span><span class="s0">'Del'</span><span class="s1">]</span>
<span class="s1">};</span>
<span class="s4">// #4868: modifiers that prevent the execution of the listener</span>
<span class="s4">// need to explicitly return null so that we can determine whether to remove</span>
<span class="s4">// the listener for .once</span>
<span class="s3">const </span><span class="s2">genGuard </span><span class="s1">= </span><span class="s2">condition </span><span class="s1">=&gt; </span><span class="s0">`if(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">condition</span><span class="s1">}</span><span class="s0">)return null;`</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">modifierCode </span><span class="s1">= {</span>
    <span class="s2">stop</span><span class="s1">: </span><span class="s0">'$event.stopPropagation();'</span><span class="s1">,</span>
    <span class="s2">prevent</span><span class="s1">: </span><span class="s0">'$event.preventDefault();'</span><span class="s1">,</span>
    <span class="s2">self</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`$event.target !== $event.currentTarget`</span><span class="s1">),</span>
    <span class="s2">ctrl</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`!$event.ctrlKey`</span><span class="s1">),</span>
    <span class="s2">shift</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`!$event.shiftKey`</span><span class="s1">),</span>
    <span class="s2">alt</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`!$event.altKey`</span><span class="s1">),</span>
    <span class="s2">meta</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`!$event.metaKey`</span><span class="s1">),</span>
    <span class="s2">left</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`'button' in $event &amp;&amp; $event.button !== 0`</span><span class="s1">),</span>
    <span class="s2">middle</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`'button' in $event &amp;&amp; $event.button !== 1`</span><span class="s1">),</span>
    <span class="s2">right</span><span class="s1">: </span><span class="s2">genGuard</span><span class="s1">(</span><span class="s0">`'button' in $event &amp;&amp; $event.button !== 2`</span><span class="s1">)</span>
<span class="s1">};</span>
<span class="s3">function </span><span class="s2">genHandlers</span><span class="s1">(</span><span class="s2">events</span><span class="s1">, </span><span class="s2">isNative</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">prefix </span><span class="s1">= </span><span class="s2">isNative </span><span class="s1">? </span><span class="s0">'nativeOn:' </span><span class="s1">: </span><span class="s0">'on:'</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">staticHandlers </span><span class="s1">= </span><span class="s0">``</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">dynamicHandlers </span><span class="s1">= </span><span class="s0">``</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">name </span><span class="s3">in </span><span class="s2">events</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">handlerCode </span><span class="s1">= </span><span class="s2">genHandler</span><span class="s1">(</span><span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">]);</span>
        <span class="s4">//@ts-expect-error</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] &amp;&amp; </span><span class="s2">events</span><span class="s1">[</span><span class="s2">name</span><span class="s1">].</span><span class="s2">dynamic</span><span class="s1">) {</span>
            <span class="s2">dynamicHandlers </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">handlerCode</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">staticHandlers </span><span class="s1">+= </span><span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">handlerCode</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">staticHandlers </span><span class="s1">= </span><span class="s0">`{</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticHandlers</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">)}</span><span class="s0">}`</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamicHandlers</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">prefix </span><span class="s1">+ </span><span class="s0">`_d(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticHandlers</span><span class="s1">}</span><span class="s0">,[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dynamicHandlers</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">)}</span><span class="s0">])`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">prefix </span><span class="s1">+ </span><span class="s2">staticHandlers</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genHandler</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">handler</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">'function(){}'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">Array</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">)) {</span>
        <span class="s3">return </span><span class="s0">`[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">handler </span><span class="s1">=&gt; </span><span class="s2">genHandler</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">)).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">)}</span><span class="s0">]`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">isMethodPath </span><span class="s1">= </span><span class="s2">simplePathRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">isFunctionExpression </span><span class="s1">= </span><span class="s2">fnExpRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">isFunctionInvocation </span><span class="s1">= </span><span class="s2">simplePathRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">fnInvokeRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">));</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isMethodPath </span><span class="s1">|| </span><span class="s2">isFunctionExpression</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s0">`function($event){</span><span class="s2">$</span><span class="s1">{</span><span class="s2">isFunctionInvocation </span><span class="s1">? </span><span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">; </span><span class="s4">// inline statement</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">let </span><span class="s2">code </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s3">let </span><span class="s2">genModifierCode </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">keys </span><span class="s1">= [];</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">modifierCode</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
                <span class="s2">genModifierCode </span><span class="s1">+= </span><span class="s2">modifierCode</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
                <span class="s4">// left/right</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">keyCodes</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
                    <span class="s2">keys</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">else if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">=== </span><span class="s0">'exact'</span><span class="s1">) {</span>
                <span class="s3">const </span><span class="s2">modifiers </span><span class="s1">= </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">;</span>
                <span class="s2">genModifierCode </span><span class="s1">+= </span><span class="s2">genGuard</span><span class="s1">([</span><span class="s0">'ctrl'</span><span class="s1">, </span><span class="s0">'shift'</span><span class="s1">, </span><span class="s0">'alt'</span><span class="s1">, </span><span class="s0">'meta'</span><span class="s1">]</span>
                    <span class="s1">.</span><span class="s2">filter</span><span class="s1">(</span><span class="s2">keyModifier </span><span class="s1">=&gt; !</span><span class="s2">modifiers</span><span class="s1">[</span><span class="s2">keyModifier</span><span class="s1">])</span>
                    <span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">keyModifier </span><span class="s1">=&gt; </span><span class="s0">`$event.</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keyModifier</span><span class="s1">}</span><span class="s0">Key`</span><span class="s1">)</span>
                    <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'||'</span><span class="s1">));</span>
            <span class="s1">}</span>
            <span class="s3">else </span><span class="s1">{</span>
                <span class="s2">keys</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">keys</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
            <span class="s2">code </span><span class="s1">+= </span><span class="s2">genKeyFilter</span><span class="s1">(</span><span class="s2">keys</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s4">// Make sure modifiers like prevent and stop get executed after key filtering</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">genModifierCode</span><span class="s1">) {</span>
            <span class="s2">code </span><span class="s1">+= </span><span class="s2">genModifierCode</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">const </span><span class="s2">handlerCode </span><span class="s1">= </span><span class="s2">isMethodPath</span>
            <span class="s1">? </span><span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">.apply(null, arguments)`</span>
            <span class="s1">: </span><span class="s2">isFunctionExpression</span>
                <span class="s1">? </span><span class="s0">`return (</span><span class="s2">$</span><span class="s1">{</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">).apply(null, arguments)`</span>
                <span class="s1">: </span><span class="s2">isFunctionInvocation</span>
                    <span class="s1">? </span><span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">`</span>
                    <span class="s1">: </span><span class="s2">handler</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s0">`function($event){</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">handlerCode</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genKeyFilter</span><span class="s1">(</span><span class="s2">keys</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span>
    <span class="s4">// make sure the key filters only apply to KeyboardEvents</span>
    <span class="s4">// #9441: can't use 'keyCode' in $event because Chrome autofill fires fake</span>
    <span class="s4">// key events that do not have keyCode property...</span>
    <span class="s0">`if(!$event.type.indexOf('key')&amp;&amp;` </span><span class="s1">+</span>
        <span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keys</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">genFilterCode</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'&amp;&amp;'</span><span class="s1">)}</span><span class="s0">)return null;`</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genFilterCode</span><span class="s1">(</span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">keyVal </span><span class="s1">= </span><span class="s2">parseInt</span><span class="s1">(</span><span class="s2">key</span><span class="s1">, </span><span class="s6">10</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">keyVal</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`$event.keyCode!==</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keyVal</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">keyCode </span><span class="s1">= </span><span class="s2">keyCodes</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s3">const </span><span class="s2">keyName </span><span class="s1">= </span><span class="s2">keyNames</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s0">`_k($event.keyCode,` </span><span class="s1">+</span>
        <span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">key</span><span class="s1">)}</span><span class="s0">,` </span><span class="s1">+</span>
        <span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">keyCode</span><span class="s1">)}</span><span class="s0">,` </span><span class="s1">+</span>
        <span class="s0">`$event.key,` </span><span class="s1">+</span>
        <span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">keyName</span><span class="s1">)}</span><span class="s0">` </span><span class="s1">+</span>
        <span class="s0">`)`</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">on</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">) {</span>
        <span class="s2">warn$2</span><span class="s1">(</span><span class="s0">`v-on without argument does not support modifiers.`</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">wrapListeners </span><span class="s1">= (</span><span class="s2">code</span><span class="s1">) =&gt; </span><span class="s0">`_g(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">bind</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">) {</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">wrapData </span><span class="s1">= (</span><span class="s2">code</span><span class="s1">) =&gt; {</span>
        <span class="s3">return </span><span class="s0">`_b(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">,'</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">',</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">prop </span><span class="s1">? </span><span class="s0">'true' </span><span class="s1">: </span><span class="s0">'false'</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers </span><span class="s1">&amp;&amp; </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">.</span><span class="s2">sync </span><span class="s1">? </span><span class="s0">',true' </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s3">var </span><span class="s2">baseDirectives </span><span class="s1">= {</span>
    <span class="s2">on</span><span class="s1">,</span>
    <span class="s2">bind</span><span class="s1">,</span>
    <span class="s2">cloak</span><span class="s1">: </span><span class="s2">noop</span>
<span class="s1">};</span>

<span class="s3">class </span><span class="s2">CodegenState </span><span class="s1">{</span>
    <span class="s2">constructor</span><span class="s1">(</span><span class="s2">options</span><span class="s1">) {</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">options </span><span class="s1">= </span><span class="s2">options</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">|| </span><span class="s2">baseWarn</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">transforms </span><span class="s1">= </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">, </span><span class="s0">'transformCode'</span><span class="s1">);</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">dataGenFns </span><span class="s1">= </span><span class="s2">pluckModuleFunction</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">, </span><span class="s0">'genData'</span><span class="s1">);</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">= </span><span class="s2">extend</span><span class="s1">(</span><span class="s2">extend</span><span class="s1">({}, </span><span class="s2">baseDirectives</span><span class="s1">), </span><span class="s2">options</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">isReservedTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isReservedTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">maybeComponent </span><span class="s1">= (</span><span class="s2">el</span><span class="s1">) =&gt; !!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component </span><span class="s1">|| !</span><span class="s2">isReservedTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">);</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">onceId </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">staticRenderFns </span><span class="s1">= [];</span>
        <span class="s3">this</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">generate$1</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">state </span><span class="s1">= </span><span class="s3">new </span><span class="s2">CodegenState</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
    <span class="s4">// fix #11483, Root level &lt;script&gt; tags should not be rendered.</span>
    <span class="s3">const </span><span class="s2">code </span><span class="s1">= </span><span class="s2">ast</span>
        <span class="s1">? </span><span class="s2">ast</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'script'</span>
            <span class="s1">? </span><span class="s0">'null'</span>
            <span class="s1">: </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)</span>
        <span class="s1">: </span><span class="s0">'_c(&quot;div&quot;)'</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">render</span><span class="s1">: </span><span class="s0">`with(this){return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">,</span>
        <span class="s2">staticRenderFns</span><span class="s1">: </span><span class="s2">state</span><span class="s1">.</span><span class="s2">staticRenderFns</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticRoot </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genStatic</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">once </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">onceProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genOnce</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template' </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">&amp;&amp; !</span><span class="s2">state</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) || </span><span class="s0">'void 0'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'slot'</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genSlot</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s4">// component or element</span>
        <span class="s3">let </span><span class="s2">code</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component</span><span class="s1">) {</span>
            <span class="s2">code </span><span class="s1">= </span><span class="s2">genComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component</span><span class="s1">, </span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s3">let </span><span class="s2">data</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">maybeComponent </span><span class="s1">= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">|| (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">&amp;&amp; </span><span class="s2">maybeComponent</span><span class="s1">)) {</span>
                <span class="s2">data </span><span class="s1">= </span><span class="s2">genData</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">let </span><span class="s2">tag</span><span class="s1">;</span>
            <span class="s4">// check if this is a component in &lt;script setup&gt;</span>
            <span class="s3">const </span><span class="s2">bindings </span><span class="s1">= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">bindings</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">maybeComponent </span><span class="s1">&amp;&amp; </span><span class="s2">bindings </span><span class="s1">&amp;&amp; </span><span class="s2">bindings</span><span class="s1">.</span><span class="s2">__isScriptSetup </span><span class="s1">!== </span><span class="s3">false</span><span class="s1">) {</span>
                <span class="s2">tag </span><span class="s1">= </span><span class="s2">checkBindingType</span><span class="s1">(</span><span class="s2">bindings</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(!</span><span class="s2">tag</span><span class="s1">)</span>
                <span class="s2">tag </span><span class="s1">= </span><span class="s0">`'</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">'`</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">inlineTemplate </span><span class="s1">? </span><span class="s3">null </span><span class="s1">: </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
            <span class="s2">code </span><span class="s1">= </span><span class="s0">`_c(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">tag</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">data </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">data</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">'' </span><span class="s4">// data</span>
            <span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">'' </span><span class="s4">// children</span>
            <span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s4">// module transforms</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">state</span><span class="s1">.</span><span class="s2">transforms</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s2">code </span><span class="s1">= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">transforms</span><span class="s1">[</span><span class="s2">i</span><span class="s1">](</span><span class="s2">el</span><span class="s1">, </span><span class="s2">code</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">code</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkBindingType</span><span class="s1">(</span><span class="s2">bindings</span><span class="s1">, </span><span class="s2">key</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">camelName </span><span class="s1">= </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">key</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">PascalName </span><span class="s1">= </span><span class="s2">capitalize</span><span class="s1">(</span><span class="s2">camelName</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">checkType </span><span class="s1">= (</span><span class="s2">type</span><span class="s1">) =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">bindings</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] === </span><span class="s2">type</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">key</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">bindings</span><span class="s1">[</span><span class="s2">camelName</span><span class="s1">] === </span><span class="s2">type</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">camelName</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">bindings</span><span class="s1">[</span><span class="s2">PascalName</span><span class="s1">] === </span><span class="s2">type</span><span class="s1">) {</span>
            <span class="s3">return </span><span class="s2">PascalName</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
    <span class="s3">const </span><span class="s2">fromConst </span><span class="s1">= </span><span class="s2">checkType</span><span class="s1">(</span><span class="s0">&quot;setup-const&quot; </span><span class="s4">/* BindingTypes.SETUP_CONST */</span><span class="s1">) ||</span>
        <span class="s2">checkType</span><span class="s1">(</span><span class="s0">&quot;setup-reactive-const&quot; </span><span class="s4">/* BindingTypes.SETUP_REACTIVE_CONST */</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">fromConst</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">fromConst</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">fromMaybeRef </span><span class="s1">= </span><span class="s2">checkType</span><span class="s1">(</span><span class="s0">&quot;setup-let&quot; </span><span class="s4">/* BindingTypes.SETUP_LET */</span><span class="s1">) ||</span>
        <span class="s2">checkType</span><span class="s1">(</span><span class="s0">&quot;setup-ref&quot; </span><span class="s4">/* BindingTypes.SETUP_REF */</span><span class="s1">) ||</span>
        <span class="s2">checkType</span><span class="s1">(</span><span class="s0">&quot;setup-maybe-ref&quot; </span><span class="s4">/* BindingTypes.SETUP_MAYBE_REF */</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">fromMaybeRef</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">fromMaybeRef</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// hoist static sub-trees out</span>
<span class="s3">function </span><span class="s2">genStatic</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">staticProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s4">// Some elements (templates) need to behave differently inside of a v-pre</span>
    <span class="s4">// node.  All pre nodes are static roots, so we can use this as a location to</span>
    <span class="s4">// wrap a state change and reset it upon exiting the pre node.</span>
    <span class="s3">const </span><span class="s2">originalPreState </span><span class="s1">= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
        <span class="s2">state</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s2">state</span><span class="s1">.</span><span class="s2">staticRenderFns</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`with(this){return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">}`</span><span class="s1">);</span>
    <span class="s2">state</span><span class="s1">.</span><span class="s2">pre </span><span class="s1">= </span><span class="s2">originalPreState</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s0">`_m(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">state</span><span class="s1">.</span><span class="s2">staticRenderFns</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s6">1</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticInFor </span><span class="s1">? </span><span class="s0">',true' </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// v-once</span>
<span class="s3">function </span><span class="s2">genOnce</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">onceProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticInFor</span><span class="s1">) {</span>
        <span class="s3">let </span><span class="s2">key </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s3">let </span><span class="s2">parent </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">for</span><span class="s1">) {</span>
                <span class="s2">key </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">key</span><span class="s1">;</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">parent </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(!</span><span class="s2">key</span><span class="s1">) {</span>
            <span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
                <span class="s2">state</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">`v-once can only be used inside v-for that is keyed. `</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-once'</span><span class="s1">]);</span>
            <span class="s3">return </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s0">`_o(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">state</span><span class="s1">.</span><span class="s2">onceId</span><span class="s1">++}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">key</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">genStatic</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">altGen</span><span class="s1">, </span><span class="s2">altEmpty</span><span class="s1">) {</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">; </span><span class="s4">// avoid recursion</span>
    <span class="s3">return </span><span class="s2">genIfConditions</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(), </span><span class="s2">state</span><span class="s1">, </span><span class="s2">altGen</span><span class="s1">, </span><span class="s2">altEmpty</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genIfConditions</span><span class="s1">(</span><span class="s2">conditions</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">altGen</span><span class="s1">, </span><span class="s2">altEmpty</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">conditions</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">altEmpty </span><span class="s1">|| </span><span class="s0">'_e()'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">condition </span><span class="s1">= </span><span class="s2">conditions</span><span class="s1">.</span><span class="s2">shift</span><span class="s1">();</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">condition</span><span class="s1">.</span><span class="s2">exp</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">condition</span><span class="s1">.</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">)?</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genTernaryExp</span><span class="s1">(</span><span class="s2">condition</span><span class="s1">.</span><span class="s2">block</span><span class="s1">)}</span><span class="s0">:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genIfConditions</span><span class="s1">(</span><span class="s2">conditions</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">altGen</span><span class="s1">, </span><span class="s2">altEmpty</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genTernaryExp</span><span class="s1">(</span><span class="s2">condition</span><span class="s1">.</span><span class="s2">block</span><span class="s1">)}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// v-if with v-once should generate code like (a)?_m(0):_m(1)</span>
    <span class="s3">function </span><span class="s2">genTernaryExp</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">altGen</span>
            <span class="s1">? </span><span class="s2">altGen</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s2">el</span><span class="s1">.</span><span class="s2">once</span>
                <span class="s1">? </span><span class="s2">genOnce</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)</span>
                <span class="s1">: </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">altGen</span><span class="s1">, </span><span class="s2">altHelper</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">exp </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">for</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">alias </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">alias</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">iterator1 </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator1 </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator1</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">iterator2 </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator2 </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">iterator2</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp;</span>
        <span class="s2">state</span><span class="s1">.</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) &amp;&amp;</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'slot' </span><span class="s1">&amp;&amp;</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'template' </span><span class="s1">&amp;&amp;</span>
        <span class="s1">!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">key</span><span class="s1">) {</span>
        <span class="s2">state</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">} </span><span class="s0">v-for=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">alias</span><span class="s1">} </span><span class="s0">in </span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">&quot;&gt;: component lists rendered with ` </span><span class="s1">+</span>
            <span class="s0">`v-for should have explicit keys. ` </span><span class="s1">+</span>
            <span class="s0">`See https://v2.vuejs.org/v2/guide/list.html#key for more info.`</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s0">'v-for'</span><span class="s1">], </span><span class="s3">true </span><span class="s4">/* tip */</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">; </span><span class="s4">// avoid recursion</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">altHelper </span><span class="s1">|| </span><span class="s0">'_l'</span><span class="s1">}</span><span class="s0">((</span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">),` </span><span class="s1">+</span>
        <span class="s0">`function(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">alias</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">iterator1</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">iterator2</span><span class="s1">}</span><span class="s0">){` </span><span class="s1">+</span>
        <span class="s0">`return </span><span class="s2">$</span><span class="s1">{(</span><span class="s2">altGen </span><span class="s1">|| </span><span class="s2">genElement</span><span class="s1">)(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">` </span><span class="s1">+</span>
        <span class="s0">'})'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genData</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">data </span><span class="s1">= </span><span class="s0">'{'</span><span class="s1">;</span>
    <span class="s4">// directives first.</span>
    <span class="s4">// directives may mutate the el's other properties before they are generated.</span>
    <span class="s3">const </span><span class="s2">dirs </span><span class="s1">= </span><span class="s2">genDirectives</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dirs</span><span class="s1">)</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s2">dirs </span><span class="s1">+ </span><span class="s0">','</span><span class="s1">;</span>
    <span class="s4">// key</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">key</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`key:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">key</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// ref</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ref</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`ref:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ref</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">refInFor</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`refInFor:true,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// pre</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">pre</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`pre:true,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// record original tag name for components using &quot;is&quot; attribute</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">component</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`tag:&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&quot;,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// module data generation functions</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">state</span><span class="s1">.</span><span class="s2">dataGenFns</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">dataGenFns</span><span class="s1">[</span><span class="s2">i</span><span class="s1">](</span><span class="s2">el</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// attributes</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`attrs:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genProps</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">)}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// DOM props</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`domProps:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genProps</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">)}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// event handlers</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">events</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genHandlers</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">events</span><span class="s1">, </span><span class="s3">false</span><span class="s1">)}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">nativeEvents</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genHandlers</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">nativeEvents</span><span class="s1">, </span><span class="s3">true</span><span class="s1">)}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// slot target</span>
    <span class="s4">// only for non-scoped slots</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`slot:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// scoped slots</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genScopedSlots</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">scopedSlots</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">,`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// component v-model</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">model</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">+= </span><span class="s0">`model:{value:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,callback:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">callback</span><span class="s1">}</span><span class="s0">,expression:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">model</span><span class="s1">.</span><span class="s2">expression</span><span class="s1">}</span><span class="s0">},`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// inline-template</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">inlineTemplate</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">inlineTemplate </span><span class="s1">= </span><span class="s2">genInlineTemplate</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">inlineTemplate</span><span class="s1">) {</span>
            <span class="s2">data </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">inlineTemplate</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">data </span><span class="s1">= </span><span class="s2">data</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/,$/</span><span class="s1">, </span><span class="s0">''</span><span class="s1">) + </span><span class="s0">'}'</span><span class="s1">;</span>
    <span class="s4">// v-bind dynamic argument wrap</span>
    <span class="s4">// v-bind with dynamic arguments must be applied using the same v-bind object</span>
    <span class="s4">// merge helper so that class/style/mustUseProp attrs are handled correctly.</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">= </span><span class="s0">`_b(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">data</span><span class="s1">}</span><span class="s0">,&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&quot;,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genProps</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs</span><span class="s1">)}</span><span class="s0">)`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// v-bind data wrap</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">wrapData</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">wrapData</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s4">// v-on data wrap</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">wrapListeners</span><span class="s1">) {</span>
        <span class="s2">data </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">wrapListeners</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">data</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genDirectives</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">dirs </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">dirs</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">res </span><span class="s1">= </span><span class="s0">'directives:['</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">hasRuntime </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">i</span><span class="s1">, </span><span class="s2">l</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">, </span><span class="s2">needRuntime</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">dirs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">dir </span><span class="s1">= </span><span class="s2">dirs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s2">needRuntime </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">gen </span><span class="s1">= </span><span class="s2">state</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">[</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">name</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">gen</span><span class="s1">) {</span>
            <span class="s4">// compile-time directive that manipulates AST.</span>
            <span class="s4">// returns true if it also needs a runtime counterpart.</span>
            <span class="s2">needRuntime </span><span class="s1">= !!</span><span class="s2">gen</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">, </span><span class="s2">state</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">needRuntime</span><span class="s1">) {</span>
            <span class="s2">hasRuntime </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s2">res </span><span class="s1">+= </span><span class="s0">`{name:&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;,rawName:&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">rawName</span><span class="s1">}</span><span class="s0">&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span>
                <span class="s1">? </span><span class="s0">`,value:(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">),expression:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">value</span><span class="s1">)}</span><span class="s0">`</span>
                <span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">arg </span><span class="s1">? </span><span class="s0">`,arg:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">isDynamicArg </span><span class="s1">? </span><span class="s2">dir</span><span class="s1">.</span><span class="s2">arg </span><span class="s1">: </span><span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">arg</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers </span><span class="s1">? </span><span class="s0">`,modifiers:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">modifiers</span><span class="s1">)}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">},`</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">hasRuntime</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">res</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">) + </span><span class="s0">']'</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genInlineTemplate</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">ast </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s6">0</span><span class="s1">];</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; (</span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">!== </span><span class="s6">1 </span><span class="s1">|| </span><span class="s2">ast</span><span class="s1">.</span><span class="s2">type </span><span class="s1">!== </span><span class="s6">1</span><span class="s1">)) {</span>
        <span class="s2">state</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">(</span><span class="s0">'Inline-template components must have exactly one child element.'</span><span class="s1">, { </span><span class="s2">start</span><span class="s1">: </span><span class="s2">el</span><span class="s1">.</span><span class="s2">start </span><span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">ast </span><span class="s1">&amp;&amp; </span><span class="s2">ast</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">inlineRenderFns </span><span class="s1">= </span><span class="s2">generate$1</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">state</span><span class="s1">.</span><span class="s2">options</span><span class="s1">);</span>
        <span class="s3">return </span><span class="s0">`inlineTemplate:{render:function(){</span><span class="s2">$</span><span class="s1">{</span><span class="s2">inlineRenderFns</span><span class="s1">.</span><span class="s2">render</span><span class="s1">}</span><span class="s0">},staticRenderFns:[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">inlineRenderFns</span><span class="s1">.</span><span class="s2">staticRenderFns</span>
            <span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">code </span><span class="s1">=&gt; </span><span class="s0">`function(){</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">)</span>
            <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">)}</span><span class="s0">]}`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genScopedSlots</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">slots</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s4">// by default scoped slots are considered &quot;stable&quot;, this allows child</span>
    <span class="s4">// components with only scoped slots to skip forced updates from parent.</span>
    <span class="s4">// but in some cases we have to bail-out of this optimization</span>
    <span class="s4">// for example if the slot contains dynamic names, has v-if or v-for on them...</span>
    <span class="s3">let </span><span class="s2">needsForceUpdate </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">||</span>
        <span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">slots</span><span class="s1">).</span><span class="s2">some</span><span class="s1">(</span><span class="s2">key </span><span class="s1">=&gt; {</span>
            <span class="s3">const </span><span class="s2">slot </span><span class="s1">= </span><span class="s2">slots</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
            <span class="s3">return </span><span class="s1">(</span><span class="s2">slot</span><span class="s1">.</span><span class="s2">slotTargetDynamic </span><span class="s1">|| </span><span class="s2">slot</span><span class="s1">.</span><span class="s2">if </span><span class="s1">|| </span><span class="s2">slot</span><span class="s1">.</span><span class="s2">for </span><span class="s1">|| </span><span class="s2">containsSlotChild</span><span class="s1">(</span><span class="s2">slot</span><span class="s1">) </span><span class="s4">// is passing down slot from parent which may be dynamic</span>
            <span class="s1">);</span>
        <span class="s1">});</span>
    <span class="s4">// #9534: if a component with scoped slots is inside a conditional branch,</span>
    <span class="s4">// it's possible for the same component to be reused but with different</span>
    <span class="s4">// compiled slot content. To avoid that, we generate a unique key based on</span>
    <span class="s4">// the generated code of all the slot contents.</span>
    <span class="s3">let </span><span class="s2">needsKey </span><span class="s1">= !!</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if</span><span class="s1">;</span>
    <span class="s4">// OR when it is inside another scoped slot or v-for (the reactivity may be</span>
    <span class="s4">// disconnected due to the intermediate scope variable)</span>
    <span class="s4">// #9438, #9506</span>
    <span class="s4">// TODO: this can be further optimized by properly analyzing in-scope bindings</span>
    <span class="s4">// and skip force updating ones that do not actually use scope variables.</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">needsForceUpdate</span><span class="s1">) {</span>
        <span class="s3">let </span><span class="s2">parent </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">((</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">&amp;&amp; </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">!== </span><span class="s2">emptySlotScopeToken</span><span class="s1">) ||</span>
                <span class="s2">parent</span><span class="s1">.</span><span class="s2">for</span><span class="s1">) {</span>
                <span class="s2">needsForceUpdate </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">parent</span><span class="s1">.</span><span class="s2">if</span><span class="s1">) {</span>
                <span class="s2">needsKey </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">parent </span><span class="s1">= </span><span class="s2">parent</span><span class="s1">.</span><span class="s2">parent</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">generatedSlots </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s2">slots</span><span class="s1">)</span>
        <span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">key </span><span class="s1">=&gt; </span><span class="s2">genScopedSlot</span><span class="s1">(</span><span class="s2">slots</span><span class="s1">[</span><span class="s2">key</span><span class="s1">], </span><span class="s2">state</span><span class="s1">))</span>
        <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s0">`scopedSlots:_u([</span><span class="s2">$</span><span class="s1">{</span><span class="s2">generatedSlots</span><span class="s1">}</span><span class="s0">]</span><span class="s2">$</span><span class="s1">{</span><span class="s2">needsForceUpdate </span><span class="s1">? </span><span class="s0">`,null,true` </span><span class="s1">: </span><span class="s0">``</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{!</span><span class="s2">needsForceUpdate </span><span class="s1">&amp;&amp; </span><span class="s2">needsKey </span><span class="s1">? </span><span class="s0">`,null,false,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">hash</span><span class="s1">(</span><span class="s2">generatedSlots</span><span class="s1">)}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">``</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">hash</span><span class="s1">(</span><span class="s2">str</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">hash </span><span class="s1">= </span><span class="s6">5381</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s2">str</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
    <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">) {</span>
        <span class="s2">hash </span><span class="s1">= (</span><span class="s2">hash </span><span class="s1">* </span><span class="s6">33</span><span class="s1">) ^ </span><span class="s2">str</span><span class="s1">.</span><span class="s2">charCodeAt</span><span class="s1">(--</span><span class="s2">i</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">hash </span><span class="s1">&gt;&gt;&gt; </span><span class="s6">0</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">containsSlotChild</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'slot'</span><span class="s1">) {</span>
            <span class="s3">return true</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">containsSlotChild</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">return false</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genScopedSlot</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">isLegacySyntax </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'slot-scope'</span><span class="s1">];</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed </span><span class="s1">&amp;&amp; !</span><span class="s2">isLegacySyntax</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">genScopedSlot</span><span class="s1">, </span><span class="s0">`null`</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">genScopedSlot</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">slotScope </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope </span><span class="s1">=== </span><span class="s2">emptySlotScopeToken </span><span class="s1">? </span><span class="s0">`` </span><span class="s1">: </span><span class="s2">String</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotScope</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">fn </span><span class="s1">= </span><span class="s0">`function(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">slotScope</span><span class="s1">}</span><span class="s0">){` </span><span class="s1">+</span>
        <span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span>
            <span class="s1">? </span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; </span><span class="s2">isLegacySyntax</span>
                <span class="s1">? </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if</span><span class="s1">}</span><span class="s0">)?</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) || </span><span class="s0">'undefined'</span><span class="s1">}</span><span class="s0">:undefined`</span>
                <span class="s1">: </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) || </span><span class="s0">'undefined'</span>
            <span class="s1">: </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">}`</span><span class="s1">;</span>
    <span class="s4">// reverse proxy v-slot without scope on this.$slots</span>
    <span class="s3">const </span><span class="s2">reverseProxy </span><span class="s1">= </span><span class="s2">slotScope </span><span class="s1">? </span><span class="s0">`` </span><span class="s1">: </span><span class="s0">`,proxy:true`</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s0">`{key:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget </span><span class="s1">|| </span><span class="s0">`&quot;default&quot;`</span><span class="s1">}</span><span class="s0">,fn:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">fn</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">reverseProxy</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">checkSkip</span><span class="s1">, </span><span class="s2">altGenElement</span><span class="s1">, </span><span class="s2">altGenNode</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">el </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s6">0</span><span class="s1">];</span>
        <span class="s4">// optimize single v-for</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp;</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp;</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'template' </span><span class="s1">&amp;&amp;</span>
            <span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">!== </span><span class="s0">'slot'</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">normalizationType </span><span class="s1">= </span><span class="s2">checkSkip</span>
                <span class="s1">? </span><span class="s2">state</span><span class="s1">.</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">)</span>
                    <span class="s1">? </span><span class="s0">`,1`</span>
                    <span class="s1">: </span><span class="s0">`,0`</span>
                <span class="s1">: </span><span class="s0">``</span><span class="s1">;</span>
            <span class="s3">return </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{(</span><span class="s2">altGenElement </span><span class="s1">|| </span><span class="s2">genElement</span><span class="s1">)(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">normalizationType</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">const </span><span class="s2">normalizationType </span><span class="s1">= </span><span class="s2">checkSkip</span>
            <span class="s1">? </span><span class="s2">getNormalizationType</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">state</span><span class="s1">.</span><span class="s2">maybeComponent</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s6">0</span><span class="s1">;</span>
        <span class="s3">const </span><span class="s2">gen </span><span class="s1">= </span><span class="s2">altGenNode </span><span class="s1">|| </span><span class="s2">genNode</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s0">`[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">c </span><span class="s1">=&gt; </span><span class="s2">gen</span><span class="s1">(</span><span class="s2">c</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">)}</span><span class="s0">]</span><span class="s2">$</span><span class="s1">{</span><span class="s2">normalizationType </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">normalizationType</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// determine the normalization needed for the children array.</span>
<span class="s4">// 0: no normalization needed</span>
<span class="s4">// 1: simple normalization needed (possible 1-level deep nested array)</span>
<span class="s4">// 2: full normalization needed</span>
<span class="s3">function </span><span class="s2">getNormalizationType</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">maybeComponent</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">res </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">el </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">type </span><span class="s1">!== </span><span class="s6">1</span><span class="s1">) {</span>
            <span class="s3">continue</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">needsNormalization</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) ||</span>
            <span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions </span><span class="s1">&amp;&amp;</span>
                <span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">c </span><span class="s1">=&gt; </span><span class="s2">needsNormalization</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">block</span><span class="s1">)))) {</span>
            <span class="s2">res </span><span class="s1">= </span><span class="s6">2</span><span class="s1">;</span>
            <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) ||</span>
            <span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions </span><span class="s1">&amp;&amp; </span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">c </span><span class="s1">=&gt; </span><span class="s2">maybeComponent</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">block</span><span class="s1">)))) {</span>
            <span class="s2">res </span><span class="s1">= </span><span class="s6">1</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">needsNormalization</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">!== </span><span class="s2">undefined </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template' </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'slot'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genNode</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3 </span><span class="s1">&amp;&amp; </span><span class="s2">node</span><span class="s1">.</span><span class="s2">isComment</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genComment</span><span class="s1">(</span><span class="s2">node</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">genText</span><span class="s1">(</span><span class="s2">node</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genText</span><span class="s1">(</span><span class="s2">text</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s0">`_v(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">2</span>
        <span class="s1">? </span><span class="s2">text</span><span class="s1">.</span><span class="s2">expression </span><span class="s4">// no need for () because already wrapped in _s()</span>
        <span class="s1">: </span><span class="s2">transformSpecialNewlines</span><span class="s1">(</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">text</span><span class="s1">.</span><span class="s2">text</span><span class="s1">))}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genComment</span><span class="s1">(</span><span class="s2">comment</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s0">`_e(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">comment</span><span class="s1">.</span><span class="s2">text</span><span class="s1">)}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genSlot</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">slotName </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotName </span><span class="s1">|| </span><span class="s0">'&quot;default&quot;'</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">let </span><span class="s2">res </span><span class="s1">= </span><span class="s0">`_t(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">slotName</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children </span><span class="s1">? </span><span class="s0">`,function(){return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">}</span><span class="s0">}` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">attrs </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs</span>
        <span class="s1">? </span><span class="s2">genProps</span><span class="s1">((</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs </span><span class="s1">|| []).</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">dynamicAttrs </span><span class="s1">|| []).</span><span class="s2">map</span><span class="s1">(</span><span class="s2">attr </span><span class="s1">=&gt; ({</span>
            <span class="s4">// slot props are camelized</span>
            <span class="s2">name</span><span class="s1">: </span><span class="s2">camelize</span><span class="s1">(</span><span class="s2">attr</span><span class="s1">.</span><span class="s2">name</span><span class="s1">),</span>
            <span class="s2">value</span><span class="s1">: </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">value</span><span class="s1">,</span>
            <span class="s2">dynamic</span><span class="s1">: </span><span class="s2">attr</span><span class="s1">.</span><span class="s2">dynamic</span>
        <span class="s1">})))</span>
        <span class="s1">: </span><span class="s3">null</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">bind </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind'</span><span class="s1">];</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">attrs </span><span class="s1">|| </span><span class="s2">bind</span><span class="s1">) &amp;&amp; !</span><span class="s2">children</span><span class="s1">) {</span>
        <span class="s2">res </span><span class="s1">+= </span><span class="s0">`,null`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">) {</span>
        <span class="s2">res </span><span class="s1">+= </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">attrs</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">bind</span><span class="s1">) {</span>
        <span class="s2">res </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">attrs </span><span class="s1">? </span><span class="s0">'' </span><span class="s1">: </span><span class="s0">',null'</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">bind</span><span class="s1">}</span><span class="s0">`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res </span><span class="s1">+ </span><span class="s0">')'</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s4">// componentName is el.component, take it as argument to shun flow's pessimistic refinement</span>
<span class="s3">function </span><span class="s2">genComponent</span><span class="s1">(</span><span class="s2">componentName</span><span class="s1">, </span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">inlineTemplate </span><span class="s1">? </span><span class="s3">null </span><span class="s1">: </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s0">`_c(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">componentName</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genData</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genProps</span><span class="s1">(</span><span class="s2">props</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">staticProps </span><span class="s1">= </span><span class="s0">``</span><span class="s1">;</span>
    <span class="s3">let </span><span class="s2">dynamicProps </span><span class="s1">= </span><span class="s0">``</span><span class="s1">;</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">props</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">prop </span><span class="s1">= </span><span class="s2">props</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">transformSpecialNewlines</span><span class="s1">(</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">value</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">dynamic</span><span class="s1">) {</span>
            <span class="s2">dynamicProps </span><span class="s1">+= </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">name</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">staticProps </span><span class="s1">+= </span><span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">prop</span><span class="s1">.</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;:</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">,`</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">staticProps </span><span class="s1">= </span><span class="s0">`{</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticProps</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">)}</span><span class="s0">}`</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">dynamicProps</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s0">`_d(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticProps</span><span class="s1">}</span><span class="s0">,[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">dynamicProps</span><span class="s1">.</span><span class="s2">slice</span><span class="s1">(</span><span class="s6">0</span><span class="s1">, -</span><span class="s6">1</span><span class="s1">)}</span><span class="s0">])`</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s2">staticProps</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s4">// #3895, #4268</span>
<span class="s3">function </span><span class="s2">transformSpecialNewlines</span><span class="s1">(</span><span class="s2">text</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">text</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/\u2028/g</span><span class="s1">, </span><span class="s0">'</span><span class="s3">\\</span><span class="s0">u2028'</span><span class="s1">).</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/\u2029/g</span><span class="s1">, </span><span class="s0">'</span><span class="s3">\\</span><span class="s0">u2029'</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s4">// these keywords should not appear inside expressions, but operators like</span>
<span class="s4">// typeof, instanceof and in are allowed</span>
<span class="s3">const </span><span class="s2">prohibitedKeywordRE </span><span class="s1">= </span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\\</span><span class="s0">b' </span><span class="s1">+</span>
    <span class="s1">(</span><span class="s0">'do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,' </span><span class="s1">+</span>
        <span class="s0">'super,throw,while,yield,delete,export,import,return,switch,default,' </span><span class="s1">+</span>
        <span class="s0">'extends,finally,continue,debugger,function,arguments'</span><span class="s1">)</span>
        <span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">','</span><span class="s1">)</span>
        <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\\</span><span class="s0">b|</span><span class="s3">\\</span><span class="s0">b'</span><span class="s1">) +</span>
    <span class="s0">'</span><span class="s3">\\</span><span class="s0">b'</span><span class="s1">);</span>
<span class="s4">// these unary operators should not be used as property/method names</span>
<span class="s3">const </span><span class="s2">unaryOperatorsRE </span><span class="s1">= </span><span class="s3">new </span><span class="s2">RegExp</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\\</span><span class="s0">b' </span><span class="s1">+</span>
    <span class="s0">'delete,typeof,void'</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s0">','</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\\</span><span class="s0">s*</span><span class="s3">\\</span><span class="s0">([^</span><span class="s3">\\</span><span class="s0">)]*</span><span class="s3">\\</span><span class="s0">)|</span><span class="s3">\\</span><span class="s0">b'</span><span class="s1">) +</span>
    <span class="s0">'</span><span class="s3">\\</span><span class="s0">s*</span><span class="s3">\\</span><span class="s0">([^</span><span class="s3">\\</span><span class="s0">)]*</span><span class="s3">\\</span><span class="s0">)'</span><span class="s1">);</span>
<span class="s4">// strip strings in expressions</span>
<span class="s3">const </span><span class="s2">stripStringRE </span><span class="s1">= </span><span class="s7">/'(?:[^'\\]|\\.)*'|&quot;(?:[^&quot;\\]|\\.)*&quot;|`(?:[^`\\]|\\.)*\$\{|\}(?:[^`\\]|\\.)*`|`(?:[^`\\]|\\.)*`/g</span><span class="s1">;</span>
<span class="s4">// detect problematic expressions in a template</span>
<span class="s3">function </span><span class="s2">detectErrors</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">ast</span><span class="s1">) {</span>
        <span class="s2">checkNode</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkNode</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">name </span><span class="s3">in </span><span class="s2">node</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">dirRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
                <span class="s3">const </span><span class="s2">value </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
                    <span class="s3">const </span><span class="s2">range </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">rawAttrsMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'v-for'</span><span class="s1">) {</span>
                        <span class="s2">checkFor</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s0">`v-for=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">else if </span><span class="s1">(</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'v-slot' </span><span class="s1">|| </span><span class="s2">name</span><span class="s1">[</span><span class="s6">0</span><span class="s1">] === </span><span class="s0">'#'</span><span class="s1">) {</span>
                        <span class="s2">checkFunctionParameterExpression</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">else if </span><span class="s1">(</span><span class="s2">onRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)) {</span>
                        <span class="s2">checkEvent</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
                    <span class="s1">}</span>
                    <span class="s3">else </span><span class="s1">{</span>
                        <span class="s2">checkExpression</span><span class="s1">(</span><span class="s2">value</span><span class="s1">, </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">&quot;`</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s2">checkNode</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">warn</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">2</span><span class="s1">) {</span>
        <span class="s2">checkExpression</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">expression</span><span class="s1">, </span><span class="s2">node</span><span class="s1">.</span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">node</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkEvent</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">stripped </span><span class="s1">= </span><span class="s2">exp</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">stripStringRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">keywordMatch </span><span class="s1">= </span><span class="s2">stripped</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">unaryOperatorsRE</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">keywordMatch </span><span class="s1">&amp;&amp; </span><span class="s2">stripped</span><span class="s1">.</span><span class="s2">charAt</span><span class="s1">(</span><span class="s2">keywordMatch</span><span class="s1">.</span><span class="s2">index </span><span class="s1">- </span><span class="s6">1</span><span class="s1">) !== </span><span class="s0">'$'</span><span class="s1">) {</span>
        <span class="s2">warn</span><span class="s1">(</span><span class="s0">`avoid using JavaScript unary operator as property name: ` </span><span class="s1">+</span>
            <span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keywordMatch</span><span class="s1">[</span><span class="s6">0</span><span class="s1">]}</span><span class="s0">&quot; in expression </span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s2">checkExpression</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkFor</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s2">checkExpression</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">for </span><span class="s1">|| </span><span class="s0">''</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s2">checkIdentifier</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">alias</span><span class="s1">, </span><span class="s0">'v-for alias'</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s2">checkIdentifier</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">iterator1</span><span class="s1">, </span><span class="s0">'v-for iterator'</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s2">checkIdentifier</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">iterator2</span><span class="s1">, </span><span class="s0">'v-for iterator'</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkIdentifier</span><span class="s1">(</span><span class="s2">ident</span><span class="s1">, </span><span class="s2">type</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">ident </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
        <span class="s3">try </span><span class="s1">{</span>
            <span class="s3">new </span><span class="s2">Function</span><span class="s1">(</span><span class="s0">`var </span><span class="s2">$</span><span class="s1">{</span><span class="s2">ident</span><span class="s1">}</span><span class="s0">=_`</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`invalid </span><span class="s2">$</span><span class="s1">{</span><span class="s2">type</span><span class="s1">} </span><span class="s0">&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">ident</span><span class="s1">}</span><span class="s0">&quot; in expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkExpression</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s3">new </span><span class="s2">Function</span><span class="s1">(</span><span class="s0">`return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s0">`</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
        <span class="s3">const </span><span class="s2">keywordMatch </span><span class="s1">= </span><span class="s2">exp</span>
            <span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s2">stripStringRE</span><span class="s1">, </span><span class="s0">''</span><span class="s1">)</span>
            <span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s2">prohibitedKeywordRE</span><span class="s1">);</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">keywordMatch</span><span class="s1">) {</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`avoid using JavaScript keyword as property name: ` </span><span class="s1">+</span>
                <span class="s0">`&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">keywordMatch</span><span class="s1">[</span><span class="s6">0</span><span class="s1">]}</span><span class="s0">&quot;</span><span class="s3">\n  </span><span class="s0">Raw expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s0">`</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">warn</span><span class="s1">(</span><span class="s0">`invalid expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">message</span><span class="s1">} </span><span class="s0">in</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
                <span class="s0">`    </span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
                <span class="s0">`  Raw expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s3">\n</span><span class="s0">`</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">checkFunctionParameterExpression</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s2">text</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">, </span><span class="s2">range</span><span class="s1">) {</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s3">new </span><span class="s2">Function</span><span class="s1">(</span><span class="s2">exp</span><span class="s1">, </span><span class="s0">''</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
        <span class="s2">warn</span><span class="s1">(</span><span class="s0">`invalid function parameter expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">message</span><span class="s1">} </span><span class="s0">in</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
            <span class="s0">`    </span><span class="s2">$</span><span class="s1">{</span><span class="s2">exp</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
            <span class="s0">`  Raw expression: </span><span class="s2">$</span><span class="s1">{</span><span class="s2">text</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">()}</span><span class="s3">\n</span><span class="s0">`</span><span class="s1">, </span><span class="s2">range</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">range </span><span class="s1">= </span><span class="s6">2</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">generateCodeFrame</span><span class="s1">(</span><span class="s2">source</span><span class="s1">, </span><span class="s2">start </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">end </span><span class="s1">= </span><span class="s2">source</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">lines </span><span class="s1">= </span><span class="s2">source</span><span class="s1">.</span><span class="s2">split</span><span class="s1">(</span><span class="s7">/\r?\n/</span><span class="s1">);</span>
    <span class="s3">let </span><span class="s2">count </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">res </span><span class="s1">= [];</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">lines</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s2">count </span><span class="s1">+= </span><span class="s2">lines</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">length </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">count </span><span class="s1">&gt;= </span><span class="s2">start</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">j </span><span class="s1">= </span><span class="s2">i </span><span class="s1">- </span><span class="s2">range</span><span class="s1">; </span><span class="s2">j </span><span class="s1">&lt;= </span><span class="s2">i </span><span class="s1">+ </span><span class="s2">range </span><span class="s1">|| </span><span class="s2">end </span><span class="s1">&gt; </span><span class="s2">count</span><span class="s1">; </span><span class="s2">j</span><span class="s1">++) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">j </span><span class="s1">&lt; </span><span class="s6">0 </span><span class="s1">|| </span><span class="s2">j </span><span class="s1">&gt;= </span><span class="s2">lines</span><span class="s1">.</span><span class="s2">length</span><span class="s1">)</span>
                    <span class="s3">continue</span><span class="s1">;</span>
                <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">j </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">repeat</span><span class="s1">(</span><span class="s0">` `</span><span class="s1">, </span><span class="s6">3 </span><span class="s1">- </span><span class="s2">String</span><span class="s1">(</span><span class="s2">j </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">).</span><span class="s2">length</span><span class="s1">)}</span><span class="s0">|  </span><span class="s2">$</span><span class="s1">{</span><span class="s2">lines</span><span class="s1">[</span><span class="s2">j</span><span class="s1">]}</span><span class="s0">`</span><span class="s1">);</span>
                <span class="s3">const </span><span class="s2">lineLength </span><span class="s1">= </span><span class="s2">lines</span><span class="s1">[</span><span class="s2">j</span><span class="s1">].</span><span class="s2">length</span><span class="s1">;</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">j </span><span class="s1">=== </span><span class="s2">i</span><span class="s1">) {</span>
                    <span class="s4">// push underline</span>
                    <span class="s3">const </span><span class="s2">pad </span><span class="s1">= </span><span class="s2">start </span><span class="s1">- (</span><span class="s2">count </span><span class="s1">- </span><span class="s2">lineLength</span><span class="s1">) + </span><span class="s6">1</span><span class="s1">;</span>
                    <span class="s3">const </span><span class="s2">length </span><span class="s1">= </span><span class="s2">end </span><span class="s1">&gt; </span><span class="s2">count </span><span class="s1">? </span><span class="s2">lineLength </span><span class="s1">- </span><span class="s2">pad </span><span class="s1">: </span><span class="s2">end </span><span class="s1">- </span><span class="s2">start</span><span class="s1">;</span>
                    <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`   |  ` </span><span class="s1">+ </span><span class="s2">repeat</span><span class="s1">(</span><span class="s0">` `</span><span class="s1">, </span><span class="s2">pad</span><span class="s1">) + </span><span class="s2">repeat</span><span class="s1">(</span><span class="s0">`^`</span><span class="s1">, </span><span class="s2">length</span><span class="s1">));</span>
                <span class="s1">}</span>
                <span class="s3">else if </span><span class="s1">(</span><span class="s2">j </span><span class="s1">&gt; </span><span class="s2">i</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">end </span><span class="s1">&gt; </span><span class="s2">count</span><span class="s1">) {</span>
                        <span class="s3">const </span><span class="s2">length </span><span class="s1">= </span><span class="s2">Math</span><span class="s1">.</span><span class="s2">min</span><span class="s1">(</span><span class="s2">end </span><span class="s1">- </span><span class="s2">count</span><span class="s1">, </span><span class="s2">lineLength</span><span class="s1">);</span>
                        <span class="s2">res</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`   |  ` </span><span class="s1">+ </span><span class="s2">repeat</span><span class="s1">(</span><span class="s0">`^`</span><span class="s1">, </span><span class="s2">length</span><span class="s1">));</span>
                    <span class="s1">}</span>
                    <span class="s2">count </span><span class="s1">+= </span><span class="s2">lineLength </span><span class="s1">+ </span><span class="s6">1</span><span class="s1">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">break</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">res</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">repeat</span><span class="s1">(</span><span class="s2">str</span><span class="s1">, </span><span class="s2">n</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">result </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">n </span><span class="s1">&gt; </span><span class="s6">0</span><span class="s1">) {</span>
        <span class="s4">// eslint-disable-next-line no-constant-condition</span>
        <span class="s3">while </span><span class="s1">(</span><span class="s3">true</span><span class="s1">) {</span>
            <span class="s4">// eslint-disable-line</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">n </span><span class="s1">&amp; </span><span class="s6">1</span><span class="s1">)</span>
                <span class="s2">result </span><span class="s1">+= </span><span class="s2">str</span><span class="s1">;</span>
            <span class="s2">n </span><span class="s1">&gt;&gt;&gt;= </span><span class="s6">1</span><span class="s1">;</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">n </span><span class="s1">&lt;= </span><span class="s6">0</span><span class="s1">)</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s2">str </span><span class="s1">+= </span><span class="s2">str</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">result</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">createFunction</span><span class="s1">(</span><span class="s2">code</span><span class="s1">, </span><span class="s2">errors</span><span class="s1">) {</span>
    <span class="s3">try </span><span class="s1">{</span>
        <span class="s3">return new </span><span class="s2">Function</span><span class="s1">(</span><span class="s2">code</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">catch </span><span class="s1">(</span><span class="s2">err</span><span class="s1">) {</span>
        <span class="s2">errors</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">err</span><span class="s1">, </span><span class="s2">code </span><span class="s1">});</span>
        <span class="s3">return </span><span class="s2">noop</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">createCompileToFunctionFn</span><span class="s1">(</span><span class="s2">compile</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">cache </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
    <span class="s3">return function </span><span class="s2">compileToFunctions</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">) {</span>
        <span class="s2">options </span><span class="s1">= </span><span class="s2">extend</span><span class="s1">({}, </span><span class="s2">options</span><span class="s1">);</span>
        <span class="s3">const </span><span class="s2">warn </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">|| </span><span class="s2">warn$2</span><span class="s1">;</span>
        <span class="s3">delete </span><span class="s2">options</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">;</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s4">// detect possible CSP restriction</span>
            <span class="s3">try </span><span class="s1">{</span>
                <span class="s3">new </span><span class="s2">Function</span><span class="s1">(</span><span class="s0">'return 1'</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s3">catch </span><span class="s1">(</span><span class="s2">e</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">().</span><span class="s2">match</span><span class="s1">(</span><span class="s7">/unsafe-eval|CSP/</span><span class="s1">)) {</span>
                    <span class="s2">warn</span><span class="s1">(</span><span class="s0">'It seems you are using the standalone build of Vue.js in an ' </span><span class="s1">+</span>
                        <span class="s0">'environment with Content Security Policy that prohibits unsafe-eval. ' </span><span class="s1">+</span>
                        <span class="s0">'The template compiler cannot work in this environment. Consider ' </span><span class="s1">+</span>
                        <span class="s0">'relaxing the policy to allow unsafe-eval or pre-compiling your ' </span><span class="s1">+</span>
                        <span class="s0">'templates into render functions.'</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s4">// check cache</span>
        <span class="s3">const </span><span class="s2">key </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">delimiters</span>
            <span class="s1">? </span><span class="s2">String</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">delimiters</span><span class="s1">) + </span><span class="s2">template</span>
            <span class="s1">: </span><span class="s2">template</span><span class="s1">;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">cache</span><span class="s1">[</span><span class="s2">key</span><span class="s1">]) {</span>
            <span class="s3">return </span><span class="s2">cache</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
        <span class="s1">}</span>
        <span class="s4">// compile</span>
        <span class="s3">const </span><span class="s2">compiled </span><span class="s1">= </span><span class="s2">compile</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
        <span class="s4">// check compilation errors/tips</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors </span><span class="s1">&amp;&amp; </span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                    <span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">e </span><span class="s1">=&gt; {</span>
                        <span class="s2">warn</span><span class="s1">(</span><span class="s0">`Error compiling template:</span><span class="s3">\n\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">.</span><span class="s2">msg</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
                            <span class="s2">generateCodeFrame</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">e</span><span class="s1">.</span><span class="s2">start</span><span class="s1">, </span><span class="s2">e</span><span class="s1">.</span><span class="s2">end</span><span class="s1">), </span><span class="s2">vm</span><span class="s1">);</span>
                    <span class="s1">});</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">warn</span><span class="s1">(</span><span class="s0">`Error compiling template:</span><span class="s3">\n\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">template</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
                        <span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">e </span><span class="s1">=&gt; </span><span class="s0">`- </span><span class="s2">$</span><span class="s1">{</span><span class="s2">e</span><span class="s1">}</span><span class="s0">`</span><span class="s1">).</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">) +</span>
                        <span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">);</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">tips </span><span class="s1">&amp;&amp; </span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">tips</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                    <span class="s2">compiled</span><span class="s1">.</span><span class="s2">tips</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">e </span><span class="s1">=&gt; </span><span class="s2">tip</span><span class="s1">(</span><span class="s2">e</span><span class="s1">.</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">));</span>
                <span class="s1">}</span>
                <span class="s3">else </span><span class="s1">{</span>
                    <span class="s2">compiled</span><span class="s1">.</span><span class="s2">tips</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(</span><span class="s2">msg </span><span class="s1">=&gt; </span><span class="s2">tip</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">vm</span><span class="s1">));</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s4">// turn code into functions</span>
        <span class="s3">const </span><span class="s2">res </span><span class="s1">= {};</span>
        <span class="s3">const </span><span class="s2">fnGenErrors </span><span class="s1">= [];</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">render </span><span class="s1">= </span><span class="s2">createFunction</span><span class="s1">(</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">render</span><span class="s1">, </span><span class="s2">fnGenErrors</span><span class="s1">);</span>
        <span class="s2">res</span><span class="s1">.</span><span class="s2">staticRenderFns </span><span class="s1">= </span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">staticRenderFns</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(</span><span class="s2">code </span><span class="s1">=&gt; {</span>
            <span class="s3">return </span><span class="s2">createFunction</span><span class="s1">(</span><span class="s2">code</span><span class="s1">, </span><span class="s2">fnGenErrors</span><span class="s1">);</span>
        <span class="s1">});</span>
        <span class="s4">// check function generation errors.</span>
        <span class="s4">// this should only happen if there is a bug in the compiler itself.</span>
        <span class="s4">// mostly for codegen development use</span>
        <span class="s4">/* istanbul ignore if */</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
            <span class="s3">if </span><span class="s1">((!</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors </span><span class="s1">|| !</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) &amp;&amp; </span><span class="s2">fnGenErrors</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
                <span class="s2">warn</span><span class="s1">(</span><span class="s0">`Failed to generate render function:</span><span class="s3">\n\n</span><span class="s0">` </span><span class="s1">+</span>
                    <span class="s2">fnGenErrors</span>
                        <span class="s1">.</span><span class="s2">map</span><span class="s1">(({ </span><span class="s2">err</span><span class="s1">, </span><span class="s2">code </span><span class="s1">}) =&gt; </span><span class="s0">`</span><span class="s2">$</span><span class="s1">{</span><span class="s2">err</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">()} </span><span class="s0">in</span><span class="s3">\n\n</span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s3">\n</span><span class="s0">`</span><span class="s1">)</span>
                        <span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">), </span><span class="s2">vm</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s1">(</span><span class="s2">cache</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">res</span><span class="s1">);</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s3">function </span><span class="s2">createCompilerCreator</span><span class="s1">(</span><span class="s2">baseCompile</span><span class="s1">) {</span>
    <span class="s3">return function </span><span class="s2">createCompiler</span><span class="s1">(</span><span class="s2">baseOptions</span><span class="s1">) {</span>
        <span class="s3">function </span><span class="s2">compile</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
            <span class="s3">const </span><span class="s2">finalOptions </span><span class="s1">= </span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">baseOptions</span><span class="s1">);</span>
            <span class="s3">const </span><span class="s2">errors </span><span class="s1">= [];</span>
            <span class="s3">const </span><span class="s2">tips </span><span class="s1">= [];</span>
            <span class="s3">let </span><span class="s2">warn </span><span class="s1">= (</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">, </span><span class="s2">tip</span><span class="s1">) =&gt; {</span>
                <span class="s1">(</span><span class="s2">tip </span><span class="s1">? </span><span class="s2">tips </span><span class="s1">: </span><span class="s2">errors</span><span class="s1">).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">msg</span><span class="s1">);</span>
            <span class="s1">};</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">) {</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production' </span><span class="s1">&amp;&amp; </span><span class="s2">options</span><span class="s1">.</span><span class="s2">outputSourceRange</span><span class="s1">) {</span>
                    <span class="s4">// $flow-disable-line</span>
                    <span class="s3">const </span><span class="s2">leadingSpaceLength </span><span class="s1">= </span><span class="s2">template</span><span class="s1">.</span><span class="s2">match</span><span class="s1">(</span><span class="s7">/^\s*/</span><span class="s1">)[</span><span class="s6">0</span><span class="s1">].</span><span class="s2">length</span><span class="s1">;</span>
                    <span class="s2">warn </span><span class="s1">= (</span><span class="s2">msg</span><span class="s1">, </span><span class="s2">range</span><span class="s1">, </span><span class="s2">tip</span><span class="s1">) =&gt; {</span>
                        <span class="s3">const </span><span class="s2">data </span><span class="s1">= </span><span class="s3">typeof </span><span class="s2">msg </span><span class="s1">=== </span><span class="s0">'string' </span><span class="s1">? { </span><span class="s2">msg </span><span class="s1">} : </span><span class="s2">msg</span><span class="s1">;</span>
                        <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">) {</span>
                            <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">start </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
                                <span class="s2">data</span><span class="s1">.</span><span class="s2">start </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">start </span><span class="s1">+ </span><span class="s2">leadingSpaceLength</span><span class="s1">;</span>
                            <span class="s1">}</span>
                            <span class="s3">if </span><span class="s1">(</span><span class="s2">range</span><span class="s1">.</span><span class="s2">end </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
                                <span class="s2">data</span><span class="s1">.</span><span class="s2">end </span><span class="s1">= </span><span class="s2">range</span><span class="s1">.</span><span class="s2">end </span><span class="s1">+ </span><span class="s2">leadingSpaceLength</span><span class="s1">;</span>
                            <span class="s1">}</span>
                        <span class="s1">}</span>
                        <span class="s1">(</span><span class="s2">tip </span><span class="s1">? </span><span class="s2">tips </span><span class="s1">: </span><span class="s2">errors</span><span class="s1">).</span><span class="s2">push</span><span class="s1">(</span><span class="s2">data</span><span class="s1">);</span>
                    <span class="s1">};</span>
                <span class="s1">}</span>
                <span class="s4">// merge custom modules</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">) {</span>
                    <span class="s2">finalOptions</span><span class="s1">.</span><span class="s2">modules </span><span class="s1">= (</span><span class="s2">baseOptions</span><span class="s1">.</span><span class="s2">modules </span><span class="s1">|| []).</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">modules</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s4">// merge custom directives</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">) {</span>
                    <span class="s2">finalOptions</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">= </span><span class="s2">extend</span><span class="s1">(</span><span class="s2">Object</span><span class="s1">.</span><span class="s2">create</span><span class="s1">(</span><span class="s2">baseOptions</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">|| </span><span class="s3">null</span><span class="s1">), </span><span class="s2">options</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s4">// copy other options</span>
                <span class="s3">for </span><span class="s1">(</span><span class="s3">const </span><span class="s2">key </span><span class="s3">in </span><span class="s2">options</span><span class="s1">) {</span>
                    <span class="s3">if </span><span class="s1">(</span><span class="s2">key </span><span class="s1">!== </span><span class="s0">'modules' </span><span class="s1">&amp;&amp; </span><span class="s2">key </span><span class="s1">!== </span><span class="s0">'directives'</span><span class="s1">) {</span>
                        <span class="s2">finalOptions</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">options</span><span class="s1">[</span><span class="s2">key</span><span class="s1">];</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">finalOptions</span><span class="s1">.</span><span class="s2">warn </span><span class="s1">= </span><span class="s2">warn</span><span class="s1">;</span>
            <span class="s3">const </span><span class="s2">compiled </span><span class="s1">= </span><span class="s2">baseCompile</span><span class="s1">(</span><span class="s2">template</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">(), </span><span class="s2">finalOptions</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">process</span><span class="s1">.</span><span class="s2">env</span><span class="s1">.</span><span class="s2">NODE_ENV </span><span class="s1">!== </span><span class="s0">'production'</span><span class="s1">) {</span>
                <span class="s2">detectErrors</span><span class="s1">(</span><span class="s2">compiled</span><span class="s1">.</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">warn</span><span class="s1">);</span>
            <span class="s1">}</span>
            <span class="s2">compiled</span><span class="s1">.</span><span class="s2">errors </span><span class="s1">= </span><span class="s2">errors</span><span class="s1">;</span>
            <span class="s2">compiled</span><span class="s1">.</span><span class="s2">tips </span><span class="s1">= </span><span class="s2">tips</span><span class="s1">;</span>
            <span class="s3">return </span><span class="s2">compiled</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s1">{</span>
            <span class="s2">compile</span><span class="s1">,</span>
            <span class="s2">compileToFunctions</span><span class="s1">: </span><span class="s2">createCompileToFunctionFn</span><span class="s1">(</span><span class="s2">compile</span><span class="s1">)</span>
        <span class="s1">};</span>
    <span class="s1">};</span>
<span class="s1">}</span>

<span class="s4">// `createCompilerCreator` allows creating compilers that use alternative</span>
<span class="s4">// parser/optimizer/codegen, e.g the SSR optimizing compiler.</span>
<span class="s4">// Here we just export a default compiler using the default parts.</span>
<span class="s3">const </span><span class="s2">createCompiler$1 </span><span class="s1">= </span><span class="s2">createCompilerCreator</span><span class="s1">(</span><span class="s3">function </span><span class="s2">baseCompile</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">ast </span><span class="s1">= </span><span class="s2">parse</span><span class="s1">(</span><span class="s2">template</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">(), </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">optimize </span><span class="s1">!== </span><span class="s3">false</span><span class="s1">) {</span>
        <span class="s2">optimize$1</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">code </span><span class="s1">= </span><span class="s2">generate$1</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">ast</span><span class="s1">,</span>
        <span class="s2">render</span><span class="s1">: </span><span class="s2">code</span><span class="s1">.</span><span class="s2">render</span><span class="s1">,</span>
        <span class="s2">staticRenderFns</span><span class="s1">: </span><span class="s2">code</span><span class="s1">.</span><span class="s2">staticRenderFns</span>
    <span class="s1">};</span>
<span class="s1">});</span>

<span class="s3">const </span><span class="s1">{ </span><span class="s2">compile</span><span class="s1">: </span><span class="s2">compile$1</span><span class="s1">, </span><span class="s2">compileToFunctions</span><span class="s1">: </span><span class="s2">compileToFunctions$1 </span><span class="s1">} = </span><span class="s2">createCompiler$1</span><span class="s1">(</span><span class="s2">baseOptions</span><span class="s1">);</span>

<span class="s3">const </span><span class="s2">isAttr </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'accept,accept-charset,accesskey,action,align,alt,async,autocomplete,' </span><span class="s1">+</span>
    <span class="s0">'autofocus,autoplay,autosave,bgcolor,border,buffered,challenge,charset,' </span><span class="s1">+</span>
    <span class="s0">'checked,cite,class,code,codebase,color,cols,colspan,content,' </span><span class="s1">+</span>
    <span class="s0">'contenteditable,contextmenu,controls,coords,data,datetime,default,' </span><span class="s1">+</span>
    <span class="s0">'defer,dir,dirname,disabled,download,draggable,dropzone,enctype,for,' </span><span class="s1">+</span>
    <span class="s0">'form,formaction,headers,height,hidden,high,href,hreflang,http-equiv,' </span><span class="s1">+</span>
    <span class="s0">'icon,id,ismap,itemprop,keytype,kind,label,lang,language,list,loop,low,' </span><span class="s1">+</span>
    <span class="s0">'manifest,max,maxlength,media,method,GET,POST,min,multiple,email,file,' </span><span class="s1">+</span>
    <span class="s0">'muted,name,novalidate,open,optimum,pattern,ping,placeholder,poster,' </span><span class="s1">+</span>
    <span class="s0">'preload,radiogroup,readonly,rel,required,reversed,rows,rowspan,sandbox,' </span><span class="s1">+</span>
    <span class="s0">'scope,scoped,seamless,selected,shape,size,type,text,password,sizes,span,' </span><span class="s1">+</span>
    <span class="s0">'spellcheck,src,srcdoc,srclang,srcset,start,step,style,summary,tabindex,' </span><span class="s1">+</span>
    <span class="s0">'target,title,usemap,value,width,wrap'</span><span class="s1">);</span>
<span class="s4">/* istanbul ignore next */</span>
<span class="s3">const </span><span class="s2">isRenderableAttr </span><span class="s1">= (</span><span class="s2">name</span><span class="s1">) =&gt; {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">isAttr</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) || </span><span class="s2">name</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'data-'</span><span class="s1">) === </span><span class="s6">0 </span><span class="s1">|| </span><span class="s2">name</span><span class="s1">.</span><span class="s2">indexOf</span><span class="s1">(</span><span class="s0">'aria-'</span><span class="s1">) === </span><span class="s6">0</span><span class="s1">);</span>
<span class="s1">};</span>
<span class="s3">const </span><span class="s2">propsToAttrMap </span><span class="s1">= {</span>
    <span class="s2">acceptCharset</span><span class="s1">: </span><span class="s0">'accept-charset'</span><span class="s1">,</span>
    <span class="s2">className</span><span class="s1">: </span><span class="s0">'class'</span><span class="s1">,</span>
    <span class="s2">htmlFor</span><span class="s1">: </span><span class="s0">'for'</span><span class="s1">,</span>
    <span class="s2">httpEquiv</span><span class="s1">: </span><span class="s0">'http-equiv'</span>
<span class="s1">};</span>
<span class="s3">const </span><span class="s2">ESC </span><span class="s1">= {</span>
    <span class="s0">'&lt;'</span><span class="s1">: </span><span class="s0">'&amp;lt;'</span><span class="s1">,</span>
    <span class="s0">'&gt;'</span><span class="s1">: </span><span class="s0">'&amp;gt;'</span><span class="s1">,</span>
    <span class="s0">'&quot;'</span><span class="s1">: </span><span class="s0">'&amp;quot;'</span><span class="s1">,</span>
    <span class="s0">'&amp;'</span><span class="s1">: </span><span class="s0">'&amp;amp;'</span>
<span class="s1">};</span>
<span class="s3">function </span><span class="s2">escape</span><span class="s1">(</span><span class="s2">s</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">s</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/[&lt;&gt;&quot;&amp;]/g</span><span class="s1">, </span><span class="s2">escapeChar</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">escapeChar</span><span class="s1">(</span><span class="s2">a</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">ESC</span><span class="s1">[</span><span class="s2">a</span><span class="s1">] || </span><span class="s2">a</span><span class="s1">;</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">plainStringRE </span><span class="s1">= </span><span class="s7">/^&quot;(?:[^&quot;\\]|\\.)*&quot;$|^'(?:[^'\\]|\\.)*'$/</span><span class="s1">;</span>
<span class="s4">// let the model AST transform translate v-model into appropriate</span>
<span class="s4">// props bindings</span>
<span class="s3">function </span><span class="s2">applyModelTransform</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">dir </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">dir</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'model'</span><span class="s1">) {</span>
                <span class="s2">state</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">.</span><span class="s2">model</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">dir</span><span class="s1">, </span><span class="s2">state</span><span class="s1">.</span><span class="s2">warn</span><span class="s1">);</span>
                <span class="s4">// remove value for textarea as its converted to text</span>
                <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'textarea' </span><span class="s1">&amp;&amp; </span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">) {</span>
                    <span class="s2">el</span><span class="s1">.</span><span class="s2">props </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">.</span><span class="s2">filter</span><span class="s1">(</span><span class="s2">p </span><span class="s1">=&gt; </span><span class="s2">p</span><span class="s1">.</span><span class="s2">name </span><span class="s1">!== </span><span class="s0">'value'</span><span class="s1">);</span>
                <span class="s1">}</span>
                <span class="s3">break</span><span class="s1">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genAttrSegments</span><span class="s1">(</span><span class="s2">attrs</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">map</span><span class="s1">(({ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value </span><span class="s1">}) =&gt; </span><span class="s2">genAttrSegment</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">));</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genDOMPropSegments</span><span class="s1">(</span><span class="s2">props</span><span class="s1">, </span><span class="s2">attrs</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">segments </span><span class="s1">= [];</span>
    <span class="s2">props</span><span class="s1">.</span><span class="s2">forEach</span><span class="s1">(({ </span><span class="s2">name</span><span class="s1">, </span><span class="s2">value </span><span class="s1">}) =&gt; {</span>
        <span class="s2">name </span><span class="s1">= </span><span class="s2">propsToAttrMap</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] || </span><span class="s2">name</span><span class="s1">.</span><span class="s2">toLowerCase</span><span class="s1">();</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isRenderableAttr</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) &amp;&amp;</span>
            <span class="s1">!(</span><span class="s2">attrs </span><span class="s1">&amp;&amp; </span><span class="s2">attrs</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">a </span><span class="s1">=&gt; </span><span class="s2">a</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s2">name</span><span class="s1">))) {</span>
            <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">genAttrSegment</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">));</span>
        <span class="s1">}</span>
    <span class="s1">});</span>
    <span class="s3">return </span><span class="s2">segments</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genAttrSegment</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">value</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">plainStringRE</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)) {</span>
        <span class="s4">// force double quote</span>
        <span class="s2">value </span><span class="s1">= </span><span class="s2">value</span><span class="s1">.</span><span class="s2">replace</span><span class="s1">(</span><span class="s7">/^'|'$/g</span><span class="s1">, </span><span class="s0">'&quot;'</span><span class="s1">);</span>
        <span class="s4">// force enumerated attr to &quot;true&quot;</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">isEnumeratedAttr</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) &amp;&amp; </span><span class="s2">value </span><span class="s1">!== </span><span class="s0">`&quot;false&quot;`</span><span class="s1">) {</span>
            <span class="s2">value </span><span class="s1">= </span><span class="s0">`&quot;true&quot;`</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">return </span><span class="s1">{</span>
            <span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">,</span>
            <span class="s2">value</span><span class="s1">: </span><span class="s2">isBooleanAttr</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)</span>
                <span class="s1">? </span><span class="s0">` </span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">&quot;`</span>
                <span class="s1">: </span><span class="s2">value </span><span class="s1">=== </span><span class="s0">'&quot;&quot;'</span>
                    <span class="s1">? </span><span class="s0">` </span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">`</span>
                    <span class="s1">: </span><span class="s0">` </span><span class="s2">$</span><span class="s1">{</span><span class="s2">name</span><span class="s1">}</span><span class="s0">=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">value</span><span class="s1">)}</span><span class="s0">&quot;`</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s1">{</span>
            <span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">,</span>
            <span class="s2">value</span><span class="s1">: </span><span class="s0">`_ssrAttr(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">name</span><span class="s1">)}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span>
        <span class="s1">};</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genClassSegments</span><span class="s1">(</span><span class="s2">staticClass</span><span class="s1">, </span><span class="s2">classBinding</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">staticClass </span><span class="s1">&amp;&amp; !</span><span class="s2">classBinding</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s1">[{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">` class=&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">parse</span><span class="s1">(</span><span class="s2">staticClass</span><span class="s1">)}</span><span class="s0">&quot;` </span><span class="s1">}];</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s1">[</span>
            <span class="s1">{</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">,</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s0">`_ssrClass(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">staticClass </span><span class="s1">|| </span><span class="s0">'null'</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">classBinding </span><span class="s1">|| </span><span class="s0">'null'</span><span class="s1">}</span><span class="s0">)`</span>
            <span class="s1">}</span>
        <span class="s1">];</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genStyleSegments</span><span class="s1">(</span><span class="s2">staticStyle</span><span class="s1">, </span><span class="s2">parsedStaticStyle</span><span class="s1">, </span><span class="s2">styleBinding</span><span class="s1">, </span><span class="s2">vShowExpression</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">staticStyle </span><span class="s1">&amp;&amp; !</span><span class="s2">styleBinding </span><span class="s1">&amp;&amp; !</span><span class="s2">vShowExpression</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s1">[{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">` style=</span><span class="s2">$</span><span class="s1">{</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">staticStyle</span><span class="s1">)}</span><span class="s0">` </span><span class="s1">}];</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s3">return </span><span class="s1">[</span>
            <span class="s1">{</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">,</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s0">`_ssrStyle(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">parsedStaticStyle </span><span class="s1">|| </span><span class="s0">'null'</span><span class="s1">}</span><span class="s0">,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">styleBinding </span><span class="s1">|| </span><span class="s0">'null'</span><span class="s1">}</span><span class="s0">, </span><span class="s2">$</span><span class="s1">{</span><span class="s2">vShowExpression</span>
                    <span class="s1">? </span><span class="s0">`{ display: (</span><span class="s2">$</span><span class="s1">{</span><span class="s2">vShowExpression</span><span class="s1">}</span><span class="s0">) ? '' : 'none' }`</span>
                    <span class="s1">: </span><span class="s0">'null'</span><span class="s1">}</span><span class="s0">)`</span>
            <span class="s1">}</span>
        <span class="s1">];</span>
    <span class="s1">}</span>
<span class="s1">}</span>

<span class="s5">/**</span>
 <span class="s5">* In SSR, the vdom tree is generated only once and never patched, so</span>
 <span class="s5">* we can optimize most element / trees into plain string render functions.</span>
 <span class="s5">* The SSR optimizer walks the AST tree to detect optimizable elements and trees.</span>
 <span class="s5">*</span>
 <span class="s5">* The criteria for SSR optimizability is quite a bit looser than static tree</span>
 <span class="s5">* detection (which is designed for client re-render). In SSR we bail only for</span>
 <span class="s5">* components/slots/custom directives.</span>
 <span class="s5">*/</span>
<span class="s4">// optimizability constants</span>
<span class="s3">const </span><span class="s2">optimizability </span><span class="s1">= {</span>
    <span class="s2">FALSE</span><span class="s1">: </span><span class="s6">0</span><span class="s1">,</span>
    <span class="s2">FULL</span><span class="s1">: </span><span class="s6">1</span><span class="s1">,</span>
    <span class="s2">SELF</span><span class="s1">: </span><span class="s6">2</span><span class="s1">,</span>
    <span class="s2">CHILDREN</span><span class="s1">: </span><span class="s6">3</span><span class="s1">,</span>
    <span class="s2">PARTIAL</span><span class="s1">: </span><span class="s6">4 </span><span class="s4">// self un-optimizable with some un-optimizable children</span>
<span class="s1">};</span>
<span class="s3">let </span><span class="s2">isPlatformReservedTag</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">optimize</span><span class="s1">(</span><span class="s2">root</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(!</span><span class="s2">root</span><span class="s1">)</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s2">isPlatformReservedTag </span><span class="s1">= </span><span class="s2">options</span><span class="s1">.</span><span class="s2">isReservedTag </span><span class="s1">|| </span><span class="s2">no</span><span class="s1">;</span>
    <span class="s2">walk</span><span class="s1">(</span><span class="s2">root</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">walk</span><span class="s1">(</span><span class="s2">node</span><span class="s1">, </span><span class="s2">isRoot</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">isUnOptimizableTree</span><span class="s1">(</span><span class="s2">node</span><span class="s1">)) {</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">= </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FALSE</span><span class="s1">;</span>
        <span class="s3">return</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s4">// root node or nodes with custom directives should always be a VNode</span>
    <span class="s3">const </span><span class="s2">selfUnoptimizable </span><span class="s1">= </span><span class="s2">isRoot </span><span class="s1">|| </span><span class="s2">hasCustomDirective</span><span class="s1">(</span><span class="s2">node</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">check </span><span class="s1">= </span><span class="s2">child </span><span class="s1">=&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">child</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">!== </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span><span class="s1">) {</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">= </span><span class="s2">selfUnoptimizable</span>
                <span class="s1">? </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">PARTIAL</span>
                <span class="s1">: </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">SELF</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">selfUnoptimizable</span><span class="s1">) {</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">= </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">CHILDREN</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
        <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
            <span class="s3">const </span><span class="s2">child </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
            <span class="s2">walk</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
            <span class="s2">check</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">) {</span>
            <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">1</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
                <span class="s3">const </span><span class="s2">block </span><span class="s1">= </span><span class="s2">node</span><span class="s1">.</span><span class="s2">ifConditions</span><span class="s1">[</span><span class="s2">i</span><span class="s1">].</span><span class="s2">block</span><span class="s1">;</span>
                <span class="s2">walk</span><span class="s1">(</span><span class="s2">block</span><span class="s1">, </span><span class="s2">isRoot</span><span class="s1">);</span>
                <span class="s2">check</span><span class="s1">(</span><span class="s2">block</span><span class="s1">);</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">== </span><span class="s3">null </span><span class="s1">||</span>
            <span class="s1">(!</span><span class="s2">isRoot </span><span class="s1">&amp;&amp; (</span><span class="s2">node</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-html'</span><span class="s1">] || </span><span class="s2">node</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-text'</span><span class="s1">]))) {</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">= </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s2">node</span><span class="s1">.</span><span class="s2">children </span><span class="s1">= </span><span class="s2">optimizeSiblings</span><span class="s1">(</span><span class="s2">node</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">else </span><span class="s1">{</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">= </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span><span class="s1">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">optimizeSiblings</span><span class="s1">(</span><span class="s2">el</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">optimizedChildren </span><span class="s1">= [];</span>
    <span class="s3">let </span><span class="s2">currentOptimizableGroup </span><span class="s1">= [];</span>
    <span class="s3">const </span><span class="s2">pushGroup </span><span class="s1">= () =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">currentOptimizableGroup</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
            <span class="s2">optimizedChildren</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s6">1</span><span class="s1">,</span>
                <span class="s2">parent</span><span class="s1">: </span><span class="s2">el</span><span class="s1">,</span>
                <span class="s2">tag</span><span class="s1">: </span><span class="s0">'template'</span><span class="s1">,</span>
                <span class="s2">attrsList</span><span class="s1">: [],</span>
                <span class="s2">attrsMap</span><span class="s1">: {},</span>
                <span class="s2">rawAttrsMap</span><span class="s1">: {},</span>
                <span class="s2">children</span><span class="s1">: </span><span class="s2">currentOptimizableGroup</span><span class="s1">,</span>
                <span class="s2">ssrOptimizability</span><span class="s1">: </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span>
            <span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s2">currentOptimizableGroup </span><span class="s1">= [];</span>
    <span class="s1">};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">c </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">=== </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span><span class="s1">) {</span>
            <span class="s2">currentOptimizableGroup</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">c</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else </span><span class="s1">{</span>
            <span class="s4">// wrap fully-optimizable adjacent siblings inside a template tag</span>
            <span class="s4">// so that they can be optimized into a single ssrNode by codegen</span>
            <span class="s2">pushGroup</span><span class="s1">();</span>
            <span class="s2">optimizedChildren</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">c</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">pushGroup</span><span class="s1">();</span>
    <span class="s3">return </span><span class="s2">optimizedChildren</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">isUnOptimizableTree</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">2 </span><span class="s1">|| </span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3</span><span class="s1">) {</span>
        <span class="s4">// text or expression</span>
        <span class="s3">return false</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">isBuiltInTag</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) || </span><span class="s4">// built-in (slot, component)</span>
        <span class="s1">!</span><span class="s2">isPlatformReservedTag</span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">) || </span><span class="s4">// custom component</span>
        <span class="s1">!!</span><span class="s2">node</span><span class="s1">.</span><span class="s2">component </span><span class="s1">|| </span><span class="s4">// &quot;is&quot; component</span>
        <span class="s2">isSelectWithModel</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) </span><span class="s4">// &lt;select v-model&gt; requires runtime inspection</span>
    <span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">const </span><span class="s2">isBuiltInDir </span><span class="s1">= </span><span class="s2">makeMap</span><span class="s1">(</span><span class="s0">'text,html,show,on,bind,model,pre,cloak,once'</span><span class="s1">);</span>
<span class="s3">function </span><span class="s2">hasCustomDirective</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp;</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">&amp;&amp;</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">d </span><span class="s1">=&gt; !</span><span class="s2">isBuiltInDir</span><span class="s1">(</span><span class="s2">d</span><span class="s1">.</span><span class="s2">name</span><span class="s1">)));</span>
<span class="s1">}</span>
<span class="s4">// &lt;select v-model&gt; cannot be optimized because it requires a runtime check</span>
<span class="s4">// to determine proper selected option</span>
<span class="s3">function </span><span class="s2">isSelectWithModel</span><span class="s1">(</span><span class="s2">node</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">&amp;&amp;</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'select' </span><span class="s1">&amp;&amp;</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">directives </span><span class="s1">!= </span><span class="s3">null </span><span class="s1">&amp;&amp;</span>
        <span class="s2">node</span><span class="s1">.</span><span class="s2">directives</span><span class="s1">.</span><span class="s2">some</span><span class="s1">(</span><span class="s2">d </span><span class="s1">=&gt; </span><span class="s2">d</span><span class="s1">.</span><span class="s2">name </span><span class="s1">=== </span><span class="s0">'model'</span><span class="s1">));</span>
<span class="s1">}</span>

<span class="s4">// The SSR codegen is essentially extending the default codegen to handle</span>
<span class="s4">// segment types</span>
<span class="s3">const </span><span class="s2">RAW </span><span class="s1">= </span><span class="s6">0</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">INTERPOLATION </span><span class="s1">= </span><span class="s6">1</span><span class="s1">;</span>
<span class="s3">const </span><span class="s2">EXPRESSION </span><span class="s1">= </span><span class="s6">2</span><span class="s1">;</span>
<span class="s3">function </span><span class="s2">generate</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">state </span><span class="s1">= </span><span class="s3">new </span><span class="s2">CodegenState</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">code </span><span class="s1">= </span><span class="s2">ast </span><span class="s1">? </span><span class="s2">genSSRElement</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) : </span><span class="s0">'_c(&quot;div&quot;)'</span><span class="s1">;</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">render</span><span class="s1">: </span><span class="s0">`with(this){return </span><span class="s2">$</span><span class="s1">{</span><span class="s2">code</span><span class="s1">}</span><span class="s0">}`</span><span class="s1">,</span>
        <span class="s2">staticRenderFns</span><span class="s1">: </span><span class="s2">state</span><span class="s1">.</span><span class="s2">staticRenderFns</span>
    <span class="s1">};</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genSSRElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">genSSRElement</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">genSSRElement</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template' </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">slotTarget</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">ssrOptimizability </span><span class="s1">=== </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span>
            <span class="s1">? </span><span class="s2">genChildrenAsStringNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)</span>
            <span class="s1">: </span><span class="s2">genSSRChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) || </span><span class="s0">'void 0'</span><span class="s1">;</span>
    <span class="s1">}</span>
    <span class="s3">switch </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ssrOptimizability</span><span class="s1">) {</span>
        <span class="s3">case </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">FULL</span><span class="s1">:</span>
            <span class="s4">// stringify whole tree</span>
            <span class="s3">return </span><span class="s2">genStringElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
        <span class="s3">case </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">SELF</span><span class="s1">:</span>
            <span class="s4">// stringify self and check children</span>
            <span class="s3">return </span><span class="s2">genStringElementWithChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
        <span class="s3">case </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">CHILDREN</span><span class="s1">:</span>
            <span class="s4">// generate self as VNode and stringify children</span>
            <span class="s3">return </span><span class="s2">genNormalElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
        <span class="s3">case </span><span class="s2">optimizability</span><span class="s1">.</span><span class="s2">PARTIAL</span><span class="s1">:</span>
            <span class="s4">// generate self as VNode and check children</span>
            <span class="s3">return </span><span class="s2">genNormalElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">false</span><span class="s1">);</span>
        <span class="s3">default</span><span class="s1">:</span>
            <span class="s4">// bail whole tree</span>
            <span class="s3">return </span><span class="s2">genElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genNormalElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">stringifyChildren</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">data </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">plain </span><span class="s1">? </span><span class="s2">undefined </span><span class="s1">: </span><span class="s2">genData</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">stringifyChildren</span>
        <span class="s1">? </span><span class="s0">`[</span><span class="s2">$</span><span class="s1">{</span><span class="s2">genChildrenAsStringNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">]`</span>
        <span class="s1">: </span><span class="s2">genSSRChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s0">`_c('</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">'</span><span class="s2">$</span><span class="s1">{</span><span class="s2">data </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">data</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genSSRChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">checkSkip</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">genChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">checkSkip</span><span class="s1">, </span><span class="s2">genSSRElement</span><span class="s1">, </span><span class="s2">genSSRNode</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genSSRNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1 </span><span class="s1">? </span><span class="s2">genSSRElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) : </span><span class="s2">genText</span><span class="s1">(</span><span class="s2">el</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genChildrenAsStringNode</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span>
        <span class="s1">? </span><span class="s0">`_ssrNode(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">flattenSegments</span><span class="s1">(</span><span class="s2">childrenToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">))}</span><span class="s0">)`</span>
        <span class="s1">: </span><span class="s0">''</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genStringElement</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s0">`_ssrNode(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">elementToString</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">)}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">genStringElementWithChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">children </span><span class="s1">= </span><span class="s2">genSSRChildren</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s0">`_ssrNode(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">flattenSegments</span><span class="s1">(</span><span class="s2">elementToOpenTagSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">))}</span><span class="s0">,&quot;&lt;/</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt;&quot;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children </span><span class="s1">? </span><span class="s0">`,</span><span class="s2">$</span><span class="s1">{</span><span class="s2">children</span><span class="s1">}</span><span class="s0">` </span><span class="s1">: </span><span class="s0">''</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">elementToString</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">return </span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">flattenSegments</span><span class="s1">(</span><span class="s2">elementToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">))}</span><span class="s0">)`</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">elementToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s4">// v-for / v-if</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">for </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">forProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s1">[</span>
            <span class="s1">{</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">,</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s2">genFor</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">elementToString</span><span class="s1">, </span><span class="s0">'_ssrList'</span><span class="s1">)</span>
            <span class="s1">}</span>
        <span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">if </span><span class="s1">&amp;&amp; !</span><span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed</span><span class="s1">) {</span>
        <span class="s2">el</span><span class="s1">.</span><span class="s2">ifProcessed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
        <span class="s3">return </span><span class="s1">[</span>
            <span class="s1">{</span>
                <span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">,</span>
                <span class="s2">value</span><span class="s1">: </span><span class="s2">genIf</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">, </span><span class="s2">elementToString</span><span class="s1">, </span><span class="s0">'&quot;&lt;!----&gt;&quot;'</span><span class="s1">)</span>
            <span class="s1">}</span>
        <span class="s1">];</span>
    <span class="s1">}</span>
    <span class="s3">else if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'template'</span><span class="s1">) {</span>
        <span class="s3">return </span><span class="s2">childrenToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s1">}</span>
    <span class="s3">const </span><span class="s2">openSegments </span><span class="s1">= </span><span class="s2">elementToOpenTagSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">childrenSegments </span><span class="s1">= </span><span class="s2">childrenToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s1">{ </span><span class="s2">isUnaryTag </span><span class="s1">} = </span><span class="s2">state</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">close </span><span class="s1">= </span><span class="s2">isUnaryTag </span><span class="s1">&amp;&amp; </span><span class="s2">isUnaryTag</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">)</span>
        <span class="s1">? []</span>
        <span class="s1">: [{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`&lt;/</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">&gt;` </span><span class="s1">}];</span>
    <span class="s3">return </span><span class="s2">openSegments</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">childrenSegments</span><span class="s1">, </span><span class="s2">close</span><span class="s1">);</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">elementToOpenTagSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s2">applyModelTransform</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">);</span>
    <span class="s3">let </span><span class="s2">binding</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">segments </span><span class="s1">= [{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`&lt;</span><span class="s2">$</span><span class="s1">{</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag</span><span class="s1">}</span><span class="s0">` </span><span class="s1">}];</span>
    <span class="s4">// attrs</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">, </span><span class="s2">genAttrSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s4">// domProps</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">, </span><span class="s2">genDOMPropSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">props</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrs</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s4">// v-bind=&quot;object&quot;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind'</span><span class="s1">])) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`_ssrAttrs(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s4">// v-bind.prop=&quot;object&quot;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-bind.prop'</span><span class="s1">])) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`_ssrDOMProps(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s4">// class</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticClass </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">classBinding</span><span class="s1">) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">, </span><span class="s2">genClassSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticClass</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">classBinding</span><span class="s1">));</span>
    <span class="s1">}</span>
    <span class="s4">// style &amp; v-show</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticStyle </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">styleBinding </span><span class="s1">|| </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-show'</span><span class="s1">]) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">, </span><span class="s2">genStyleSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">.</span><span class="s2">style</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">staticStyle</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">styleBinding</span><span class="s1">, </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-show'</span><span class="s1">]));</span>
    <span class="s1">}</span>
    <span class="s4">// _scopedId</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">state</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">scopeId</span><span class="s1">) {</span>
        <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">` </span><span class="s2">$</span><span class="s1">{</span><span class="s2">state</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">scopeId</span><span class="s1">}</span><span class="s0">` </span><span class="s1">});</span>
    <span class="s1">}</span>
    <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`&gt;` </span><span class="s1">});</span>
    <span class="s3">return </span><span class="s2">segments</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">childrenToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">let </span><span class="s2">binding</span><span class="s1">;</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-html'</span><span class="s1">])) {</span>
        <span class="s3">return </span><span class="s1">[{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">EXPRESSION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">}];</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">((</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-text'</span><span class="s1">])) {</span>
        <span class="s3">return </span><span class="s1">[{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">INTERPOLATION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">}];</span>
    <span class="s1">}</span>
    <span class="s3">if </span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">tag </span><span class="s1">=== </span><span class="s0">'textarea' </span><span class="s1">&amp;&amp; (</span><span class="s2">binding </span><span class="s1">= </span><span class="s2">el</span><span class="s1">.</span><span class="s2">attrsMap</span><span class="s1">[</span><span class="s0">'v-model'</span><span class="s1">])) {</span>
        <span class="s3">return </span><span class="s1">[{ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">INTERPOLATION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s0">`_s(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">binding</span><span class="s1">}</span><span class="s0">)` </span><span class="s1">}];</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">el</span><span class="s1">.</span><span class="s2">children </span><span class="s1">? </span><span class="s2">nodesToSegments</span><span class="s1">(</span><span class="s2">el</span><span class="s1">.</span><span class="s2">children</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) : [];</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">nodesToSegments</span><span class="s1">(</span><span class="s2">children</span><span class="s1">, </span><span class="s2">state</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">segments </span><span class="s1">= [];</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">c </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">1</span><span class="s1">) {</span>
            <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">, </span><span class="s2">elementToSegments</span><span class="s1">(</span><span class="s2">c</span><span class="s1">, </span><span class="s2">state</span><span class="s1">));</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">2</span><span class="s1">) {</span>
            <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">INTERPOLATION</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s2">c</span><span class="s1">.</span><span class="s2">expression </span><span class="s1">});</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s6">3</span><span class="s1">) {</span>
            <span class="s3">let </span><span class="s2">text </span><span class="s1">= </span><span class="s2">escape</span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">text</span><span class="s1">);</span>
            <span class="s3">if </span><span class="s1">(</span><span class="s2">c</span><span class="s1">.</span><span class="s2">isComment</span><span class="s1">) {</span>
                <span class="s2">text </span><span class="s1">= </span><span class="s0">'&lt;!--' </span><span class="s1">+ </span><span class="s2">text </span><span class="s1">+ </span><span class="s0">'--&gt;'</span><span class="s1">;</span>
            <span class="s1">}</span>
            <span class="s2">segments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">({ </span><span class="s2">type</span><span class="s1">: </span><span class="s2">RAW</span><span class="s1">, </span><span class="s2">value</span><span class="s1">: </span><span class="s2">text </span><span class="s1">});</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s3">return </span><span class="s2">segments</span><span class="s1">;</span>
<span class="s1">}</span>
<span class="s3">function </span><span class="s2">flattenSegments</span><span class="s1">(</span><span class="s2">segments</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">mergedSegments </span><span class="s1">= [];</span>
    <span class="s3">let </span><span class="s2">textBuffer </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
    <span class="s3">const </span><span class="s2">pushBuffer </span><span class="s1">= () =&gt; {</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">textBuffer</span><span class="s1">) {</span>
            <span class="s2">mergedSegments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">textBuffer</span><span class="s1">));</span>
            <span class="s2">textBuffer </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
        <span class="s1">}</span>
    <span class="s1">};</span>
    <span class="s3">for </span><span class="s1">(</span><span class="s3">let </span><span class="s2">i </span><span class="s1">= </span><span class="s6">0</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">segments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
        <span class="s3">const </span><span class="s2">s </span><span class="s1">= </span><span class="s2">segments</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
        <span class="s3">if </span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">RAW</span><span class="s1">) {</span>
            <span class="s2">textBuffer </span><span class="s1">+= </span><span class="s2">s</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">INTERPOLATION</span><span class="s1">) {</span>
            <span class="s2">pushBuffer</span><span class="s1">();</span>
            <span class="s2">mergedSegments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`_ssrEscape(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">);</span>
        <span class="s1">}</span>
        <span class="s3">else if </span><span class="s1">(</span><span class="s2">s</span><span class="s1">.</span><span class="s2">type </span><span class="s1">=== </span><span class="s2">EXPRESSION</span><span class="s1">) {</span>
            <span class="s2">pushBuffer</span><span class="s1">();</span>
            <span class="s2">mergedSegments</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">`(</span><span class="s2">$</span><span class="s1">{</span><span class="s2">s</span><span class="s1">.</span><span class="s2">value</span><span class="s1">}</span><span class="s0">)`</span><span class="s1">);</span>
        <span class="s1">}</span>
    <span class="s1">}</span>
    <span class="s2">pushBuffer</span><span class="s1">();</span>
    <span class="s3">return </span><span class="s2">mergedSegments</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">'+'</span><span class="s1">);</span>
<span class="s1">}</span>

<span class="s3">const </span><span class="s2">createCompiler </span><span class="s1">= </span><span class="s2">createCompilerCreator</span><span class="s1">(</span><span class="s3">function </span><span class="s2">baseCompile</span><span class="s1">(</span><span class="s2">template</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
    <span class="s3">const </span><span class="s2">ast </span><span class="s1">= </span><span class="s2">parse</span><span class="s1">(</span><span class="s2">template</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">(), </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s2">optimize</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s3">const </span><span class="s2">code </span><span class="s1">= </span><span class="s2">generate</span><span class="s1">(</span><span class="s2">ast</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
    <span class="s3">return </span><span class="s1">{</span>
        <span class="s2">ast</span><span class="s1">,</span>
        <span class="s2">render</span><span class="s1">: </span><span class="s2">code</span><span class="s1">.</span><span class="s2">render</span><span class="s1">,</span>
        <span class="s2">staticRenderFns</span><span class="s1">: </span><span class="s2">code</span><span class="s1">.</span><span class="s2">staticRenderFns</span>
    <span class="s1">};</span>
<span class="s1">});</span>

<span class="s3">const </span><span class="s1">{ </span><span class="s2">compile</span><span class="s1">, </span><span class="s2">compileToFunctions </span><span class="s1">} = </span><span class="s2">createCompiler</span><span class="s1">(</span><span class="s2">baseOptions</span><span class="s1">);</span>

<span class="s2">exports</span><span class="s1">.</span><span class="s2">compile </span><span class="s1">= </span><span class="s2">compile$1</span><span class="s1">;</span>
<span class="s2">exports</span><span class="s1">.</span><span class="s2">compileToFunctions </span><span class="s1">= </span><span class="s2">compileToFunctions$1</span><span class="s1">;</span>
<span class="s2">exports</span><span class="s1">.</span><span class="s2">generateCodeFrame </span><span class="s1">= </span><span class="s2">generateCodeFrame</span><span class="s1">;</span>
<span class="s2">exports</span><span class="s1">.</span><span class="s2">parseComponent </span><span class="s1">= </span><span class="s2">parseComponent</span><span class="s1">;</span>
<span class="s2">exports</span><span class="s1">.</span><span class="s2">ssrCompile </span><span class="s1">= </span><span class="s2">compile</span><span class="s1">;</span>
<span class="s2">exports</span><span class="s1">.</span><span class="s2">ssrCompileToFunctions </span><span class="s1">= </span><span class="s2">compileToFunctions</span><span class="s1">;</span>
</pre>
</body>
</html>