<html>
<head>
<title>config-chain.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
config-chain.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_path&quot;</span><span class="s0">,</span><span class="s1">&quot;data&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;_debug&quot;</span><span class="s0">,</span><span class="s1">&quot;_options&quot;</span><span class="s0">,</span><span class="s1">&quot;_patternToRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;_printer&quot;</span><span class="s0">,</span><span class="s1">&quot;_rewriteStackTrace&quot;</span><span class="s0">,</span><span class="s1">&quot;_configError&quot;</span><span class="s0">,</span><span class="s1">&quot;_index&quot;</span><span class="s0">,</span><span class="s1">&quot;_caching&quot;</span><span class="s0">,</span><span class="s1">&quot;_configDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;debug&quot;</span><span class="s0">,</span><span class="s1">&quot;buildDebug&quot;</span><span class="s0">,</span><span class="s1">&quot;buildPresetChain&quot;</span><span class="s0">,</span><span class="s1">&quot;arg&quot;</span><span class="s0">,</span><span class="s1">&quot;context&quot;</span><span class="s0">,</span><span class="s1">&quot;chain&quot;</span><span class="s0">,</span><span class="s1">&quot;buildPresetChainWalker&quot;</span><span class="s0">,</span><span class="s1">&quot;plugins&quot;</span><span class="s0">,</span><span class="s1">&quot;dedupDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;presets&quot;</span><span class="s0">,</span><span class="s1">&quot;options&quot;</span><span class="s0">,</span><span class="s1">&quot;map&quot;</span><span class="s0">,</span><span class="s1">&quot;o&quot;</span><span class="s0">,</span><span class="s1">&quot;normalizeOptions&quot;</span><span class="s0">,</span><span class="s1">&quot;files&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;makeChainWalker&quot;</span><span class="s0">,</span><span class="s1">&quot;root&quot;</span><span class="s0">,</span><span class="s1">&quot;preset&quot;</span><span class="s0">,</span><span class="s1">&quot;loadPresetDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;env&quot;</span><span class="s0">,</span><span class="s1">&quot;envName&quot;</span><span class="s0">,</span><span class="s1">&quot;loadPresetEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;overrides&quot;</span><span class="s0">,</span><span class="s1">&quot;index&quot;</span><span class="s0">,</span><span class="s1">&quot;loadPresetOverridesDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;overridesEnv&quot;</span><span class="s0">,</span><span class="s1">&quot;loadPresetOverridesEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;createLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;exports&quot;</span><span class="s0">,</span><span class="s1">&quot;makeWeakCacheSync&quot;</span><span class="s0">,</span><span class="s1">&quot;buildRootDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;alias&quot;</span><span class="s0">,</span><span class="s1">&quot;createUncachedDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;makeStrongCacheSync&quot;</span><span class="s0">,</span><span class="s1">&quot;buildEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;buildOverrideDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;buildOverrideEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;buildRootChain&quot;</span><span class="s0">,</span><span class="s1">&quot;opts&quot;</span><span class="s0">,</span><span class="s1">&quot;configReport&quot;</span><span class="s0">,</span><span class="s1">&quot;babelRcReport&quot;</span><span class="s0">,</span><span class="s1">&quot;programmaticLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;ConfigPrinter&quot;</span><span class="s0">,</span><span class="s1">&quot;programmaticChain&quot;</span><span class="s0">,</span><span class="s1">&quot;loadProgrammaticChain&quot;</span><span class="s0">,</span><span class="s1">&quot;dirname&quot;</span><span class="s0">,</span><span class="s1">&quot;cwd&quot;</span><span class="s0">,</span><span class="s1">&quot;undefined&quot;</span><span class="s0">,</span><span class="s1">&quot;programmaticReport&quot;</span><span class="s0">,</span><span class="s1">&quot;output&quot;</span><span class="s0">,</span><span class="s1">&quot;configFile&quot;</span><span class="s0">,</span><span class="s1">&quot;loadConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;caller&quot;</span><span class="s0">,</span><span class="s1">&quot;findRootConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrc&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcRoots&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcRootsDirectory&quot;</span><span class="s0">,</span><span class="s1">&quot;configFileChain&quot;</span><span class="s0">,</span><span class="s1">&quot;emptyChain&quot;</span><span class="s0">,</span><span class="s1">&quot;configFileLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;validatedFile&quot;</span><span class="s0">,</span><span class="s1">&quot;validateConfigFile&quot;</span><span class="s0">,</span><span class="s1">&quot;result&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileChain&quot;</span><span class="s0">,</span><span class="s1">&quot;mergeChain&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreFile&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcFile&quot;</span><span class="s0">,</span><span class="s1">&quot;isIgnored&quot;</span><span class="s0">,</span><span class="s1">&quot;fileChain&quot;</span><span class="s0">,</span><span class="s1">&quot;filename&quot;</span><span class="s0">,</span><span class="s1">&quot;pkgData&quot;</span><span class="s0">,</span><span class="s1">&quot;findPackageData&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcLoadEnabled&quot;</span><span class="s0">,</span><span class="s1">&quot;ignore&quot;</span><span class="s0">,</span><span class="s1">&quot;config&quot;</span><span class="s0">,</span><span class="s1">&quot;findRelativeConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;filepath&quot;</span><span class="s0">,</span><span class="s1">&quot;shouldIgnore&quot;</span><span class="s0">,</span><span class="s1">&quot;validateBabelrcFile&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;showConfig&quot;</span><span class="s0">,</span><span class="s1">&quot;console&quot;</span><span class="s0">,</span><span class="s1">&quot;log&quot;</span><span class="s0">,</span><span class="s1">&quot;filter&quot;</span><span class="s0">,</span><span class="s1">&quot;x&quot;</span><span class="s0">,</span><span class="s1">&quot;join&quot;</span><span class="s0">,</span><span class="s1">&quot;fileHandling&quot;</span><span class="s0">,</span><span class="s1">&quot;absoluteRoot&quot;</span><span class="s0">,</span><span class="s1">&quot;directories&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;babelrcPatterns&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;isArray&quot;</span><span class="s0">,</span><span class="s1">&quot;pat&quot;</span><span class="s0">,</span><span class="s1">&quot;path&quot;</span><span class="s0">,</span><span class="s1">&quot;resolve&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;some&quot;</span><span class="s0">,</span><span class="s1">&quot;pathPatternToRegex&quot;</span><span class="s0">,</span><span class="s1">&quot;directory&quot;</span><span class="s0">,</span><span class="s1">&quot;matchPattern&quot;</span><span class="s0">,</span><span class="s1">&quot;file&quot;</span><span class="s0">,</span><span class="s1">&quot;validate&quot;</span><span class="s0">,</span><span class="s1">&quot;validateExtendFile&quot;</span><span class="s0">,</span><span class="s1">&quot;input&quot;</span><span class="s0">,</span><span class="s1">&quot;createCachedDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;baseLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;buildProgrammaticLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileChainWalker&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileOverridesDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;loadFileOverridesEnvDescriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;buildFileLogger&quot;</span><span class="s0">,</span><span class="s1">&quot;configure&quot;</span><span class="s0">,</span><span class="s1">&quot;ChainFormatter&quot;</span><span class="s0">,</span><span class="s1">&quot;Config&quot;</span><span class="s0">,</span><span class="s1">&quot;descriptors&quot;</span><span class="s0">,</span><span class="s1">&quot;_&quot;</span><span class="s0">,</span><span class="s1">&quot;_context$caller&quot;</span><span class="s0">,</span><span class="s1">&quot;Programmatic&quot;</span><span class="s0">,</span><span class="s1">&quot;callerName&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;_options$env&quot;</span><span class="s0">,</span><span class="s1">&quot;_options$overrides&quot;</span><span class="s0">,</span><span class="s1">&quot;Error&quot;</span><span class="s0">,</span><span class="s1">&quot;_options$overrides2&quot;</span><span class="s0">,</span><span class="s1">&quot;_override$env&quot;</span><span class="s0">,</span><span class="s1">&quot;override&quot;</span><span class="s0">,</span><span class="s1">&quot;chainWalker&quot;</span><span class="s0">,</span><span class="s1">&quot;flattenedConfigs&quot;</span><span class="s0">,</span><span class="s1">&quot;rootOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;configIsApplicable&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;envOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;forEach&quot;</span><span class="s0">,</span><span class="s1">&quot;overrideOps&quot;</span><span class="s0">,</span><span class="s1">&quot;overrideEnvOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;only&quot;</span><span class="s0">,</span><span class="s1">&quot;logger&quot;</span><span class="s0">,</span><span class="s1">&quot;mergeExtendsChain&quot;</span><span class="s0">,</span><span class="s1">&quot;mergeChainOpts&quot;</span><span class="s0">,</span><span class="s1">&quot;extends&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;delete&quot;</span><span class="s0">,</span><span class="s1">&quot;target&quot;</span><span class="s0">,</span><span class="s1">&quot;source&quot;</span><span class="s0">,</span><span class="s1">&quot;Object&quot;</span><span class="s0">,</span><span class="s1">&quot;assign&quot;</span><span class="s0">,</span><span class="s1">&quot;passPerPreset&quot;</span><span class="s0">,</span><span class="s1">&quot;test&quot;</span><span class="s0">,</span><span class="s1">&quot;include&quot;</span><span class="s0">,</span><span class="s1">&quot;exclude&quot;</span><span class="s0">,</span><span class="s1">&quot;prototype&quot;</span><span class="s0">,</span><span class="s1">&quot;hasOwnProperty&quot;</span><span class="s0">,</span><span class="s1">&quot;call&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceMaps&quot;</span><span class="s0">,</span><span class="s1">&quot;sourceMap&quot;</span><span class="s0">,</span><span class="s1">&quot;items&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;item&quot;</span><span class="s0">,</span><span class="s1">&quot;value&quot;</span><span class="s0">,</span><span class="s1">&quot;fnKey&quot;</span><span class="s0">,</span><span class="s1">&quot;nameMap&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;desc&quot;</span><span class="s0">,</span><span class="s1">&quot;ownPass&quot;</span><span class="s0">,</span><span class="s1">&quot;reduce&quot;</span><span class="s0">,</span><span class="s1">&quot;acc&quot;</span><span class="s0">,</span><span class="s1">&quot;configName&quot;</span><span class="s0">,</span><span class="s1">&quot;configFieldIsApplicable&quot;</span><span class="s0">,</span><span class="s1">&quot;patterns&quot;</span><span class="s0">,</span><span class="s1">&quot;matchesPatterns&quot;</span><span class="s0">,</span><span class="s1">&quot;ignoreListReplacer&quot;</span><span class="s0">,</span><span class="s1">&quot;_key&quot;</span><span class="s0">,</span><span class="s1">&quot;RegExp&quot;</span><span class="s0">,</span><span class="s1">&quot;String&quot;</span><span class="s0">,</span><span class="s1">&quot;_context$filename&quot;</span><span class="s0">,</span><span class="s1">&quot;message&quot;</span><span class="s0">,</span><span class="s1">&quot;JSON&quot;</span><span class="s0">,</span><span class="s1">&quot;stringify&quot;</span><span class="s0">,</span><span class="s1">&quot;_context$filename2&quot;</span><span class="s0">,</span><span class="s1">&quot;pattern&quot;</span><span class="s0">,</span><span class="s1">&quot;pathToTest&quot;</span><span class="s0">,</span><span class="s1">&quot;endHiddenCallStack&quot;</span><span class="s0">,</span><span class="s1">&quot;ConfigError&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../src/config/config-chain.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;/* eslint-disable @typescript-eslint/no-use-before-define */</span><span class="s3">\n\n</span><span class="s1">import path from </span><span class="s3">\&quot;</span><span class="s1">path</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import buildDebug from </span><span class="s3">\&quot;</span><span class="s1">debug</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { Handler } from </span><span class="s3">\&quot;</span><span class="s1">gensync</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import { validate } from </span><span class="s3">\&quot;</span><span class="s1">./validation/options.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">ValidatedOptions,</span><span class="s3">\n  </span><span class="s1">IgnoreList,</span><span class="s3">\n  </span><span class="s1">ConfigApplicableTest,</span><span class="s3">\n  </span><span class="s1">BabelrcSearch,</span><span class="s3">\n  </span><span class="s1">CallerMetadata,</span><span class="s3">\n  </span><span class="s1">IgnoreItem,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./validation/options.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import pathPatternToRegex from </span><span class="s3">\&quot;</span><span class="s1">./pattern-to-regex.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import { ConfigPrinter, ChainFormatter } from </span><span class="s3">\&quot;</span><span class="s1">./printer.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { ReadonlyDeepArray } from </span><span class="s3">\&quot;</span><span class="s1">./helpers/deep-array.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">import { endHiddenCallStack } from </span><span class="s3">\&quot;</span><span class="s1">../errors/rewrite-stack-trace.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import ConfigError from </span><span class="s3">\&quot;</span><span class="s1">../errors/config-error.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { PluginAPI, PresetAPI } from </span><span class="s3">\&quot;</span><span class="s1">./helpers/config-api.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">const debug = buildDebug(</span><span class="s3">\&quot;</span><span class="s1">babel:config:config-chain</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">findPackageData,</span><span class="s3">\n  </span><span class="s1">findRelativeConfig,</span><span class="s3">\n  </span><span class="s1">findRootConfig,</span><span class="s3">\n  </span><span class="s1">loadConfig,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./files/index.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type { ConfigFile, IgnoreFile, FilePackageData } from </span><span class="s3">\&quot;</span><span class="s1">./files/index.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">import { makeWeakCacheSync, makeStrongCacheSync } from </span><span class="s3">\&quot;</span><span class="s1">./caching.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">import {</span><span class="s3">\n  </span><span class="s1">createCachedDescriptors,</span><span class="s3">\n  </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./config-descriptors.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type {</span><span class="s3">\n  </span><span class="s1">UnloadedDescriptor,</span><span class="s3">\n  </span><span class="s1">OptionsAndDescriptors,</span><span class="s3">\n  </span><span class="s1">ValidatedFile,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">./config-descriptors.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">export type ConfigChain = {</span><span class="s3">\n  </span><span class="s1">plugins: Array&lt;UnloadedDescriptor&lt;PluginAPI&gt;&gt;;</span><span class="s3">\n  </span><span class="s1">presets: Array&lt;UnloadedDescriptor&lt;PresetAPI&gt;&gt;;</span><span class="s3">\n  </span><span class="s1">options: Array&lt;ValidatedOptions&gt;;</span><span class="s3">\n  </span><span class="s1">files: Set&lt;string&gt;;</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">export type PresetInstance = {</span><span class="s3">\n  </span><span class="s1">options: ValidatedOptions;</span><span class="s3">\n  </span><span class="s1">alias: string;</span><span class="s3">\n  </span><span class="s1">dirname: string;</span><span class="s3">\n  </span><span class="s1">externalDependencies: ReadonlyDeepArray&lt;string&gt;;</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">export type ConfigContext = {</span><span class="s3">\n  </span><span class="s1">filename: string | undefined;</span><span class="s3">\n  </span><span class="s1">cwd: string;</span><span class="s3">\n  </span><span class="s1">root: string;</span><span class="s3">\n  </span><span class="s1">envName: string;</span><span class="s3">\n  </span><span class="s1">caller: CallerMetadata | undefined;</span><span class="s3">\n  </span><span class="s1">showConfig: boolean;</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Build a config chain for a given preset.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function* buildPresetChain(</span><span class="s3">\n  </span><span class="s1">arg: PresetInstance,</span><span class="s3">\n  </span><span class="s1">context: any,</span><span class="s3">\n</span><span class="s1">): Handler&lt;ConfigChain | null&gt; {</span><span class="s3">\n  </span><span class="s1">const chain = yield* buildPresetChainWalker(arg, context);</span><span class="s3">\n  </span><span class="s1">if (!chain) return null;</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">plugins: dedupDescriptors(chain.plugins),</span><span class="s3">\n    </span><span class="s1">presets: dedupDescriptors(chain.presets),</span><span class="s3">\n    </span><span class="s1">options: chain.options.map(o =&gt; normalizeOptions(o)),</span><span class="s3">\n    </span><span class="s1">files: new Set(),</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">export const buildPresetChainWalker = makeChainWalker&lt;PresetInstance&gt;({</span><span class="s3">\n  </span><span class="s1">root: preset =&gt; loadPresetDescriptors(preset),</span><span class="s3">\n  </span><span class="s1">env: (preset, envName) =&gt; loadPresetEnvDescriptors(preset)(envName),</span><span class="s3">\n  </span><span class="s1">overrides: (preset, index) =&gt; loadPresetOverridesDescriptors(preset)(index),</span><span class="s3">\n  </span><span class="s1">overridesEnv: (preset, index, envName) =&gt;</span><span class="s3">\n    </span><span class="s1">loadPresetOverridesEnvDescriptors(preset)(index)(envName),</span><span class="s3">\n  </span><span class="s1">createLogger: () =&gt; () =&gt; {}, // Currently we don't support logging how preset is expanded</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n</span><span class="s1">const loadPresetDescriptors = makeWeakCacheSync((preset: PresetInstance) =&gt;</span><span class="s3">\n  </span><span class="s1">buildRootDescriptors(preset, preset.alias, createUncachedDescriptors),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadPresetEnvDescriptors = makeWeakCacheSync((preset: PresetInstance) =&gt;</span><span class="s3">\n  </span><span class="s1">makeStrongCacheSync((envName: string) =&gt;</span><span class="s3">\n    </span><span class="s1">buildEnvDescriptors(</span><span class="s3">\n      </span><span class="s1">preset,</span><span class="s3">\n      </span><span class="s1">preset.alias,</span><span class="s3">\n      </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n      </span><span class="s1">envName,</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n  </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadPresetOverridesDescriptors = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(preset: PresetInstance) =&gt;</span><span class="s3">\n    </span><span class="s1">makeStrongCacheSync((index: number) =&gt;</span><span class="s3">\n      </span><span class="s1">buildOverrideDescriptors(</span><span class="s3">\n        </span><span class="s1">preset,</span><span class="s3">\n        </span><span class="s1">preset.alias,</span><span class="s3">\n        </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n        </span><span class="s1">index,</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadPresetOverridesEnvDescriptors = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(preset: PresetInstance) =&gt;</span><span class="s3">\n    </span><span class="s1">makeStrongCacheSync((index: number) =&gt;</span><span class="s3">\n      </span><span class="s1">makeStrongCacheSync((envName: string) =&gt;</span><span class="s3">\n        </span><span class="s1">buildOverrideEnvDescriptors(</span><span class="s3">\n          </span><span class="s1">preset,</span><span class="s3">\n          </span><span class="s1">preset.alias,</span><span class="s3">\n          </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n          </span><span class="s1">index,</span><span class="s3">\n          </span><span class="s1">envName,</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">export type FileHandling = </span><span class="s3">\&quot;</span><span class="s1">transpile</span><span class="s3">\&quot; </span><span class="s1">| </span><span class="s3">\&quot;</span><span class="s1">ignored</span><span class="s3">\&quot; </span><span class="s1">| </span><span class="s3">\&quot;</span><span class="s1">unsupported</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">export type RootConfigChain = ConfigChain &amp; {</span><span class="s3">\n  </span><span class="s1">babelrc: ConfigFile | void;</span><span class="s3">\n  </span><span class="s1">config: ConfigFile | void;</span><span class="s3">\n  </span><span class="s1">ignore: IgnoreFile | void;</span><span class="s3">\n  </span><span class="s1">fileHandling: FileHandling;</span><span class="s3">\n  </span><span class="s1">files: Set&lt;string&gt;;</span><span class="s3">\n</span><span class="s1">};</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Build a config chain for Babel's full root configuration.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export function* buildRootChain(</span><span class="s3">\n  </span><span class="s1">opts: ValidatedOptions,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n</span><span class="s1">): Handler&lt;RootConfigChain | null&gt; {</span><span class="s3">\n  </span><span class="s1">let configReport, babelRcReport;</span><span class="s3">\n  </span><span class="s1">const programmaticLogger = new ConfigPrinter();</span><span class="s3">\n  </span><span class="s1">const programmaticChain = yield* loadProgrammaticChain(</span><span class="s3">\n    </span><span class="s1">{</span><span class="s3">\n      </span><span class="s1">options: opts,</span><span class="s3">\n      </span><span class="s1">dirname: context.cwd,</span><span class="s3">\n    </span><span class="s1">},</span><span class="s3">\n    </span><span class="s1">context,</span><span class="s3">\n    </span><span class="s1">undefined,</span><span class="s3">\n    </span><span class="s1">programmaticLogger,</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">if (!programmaticChain) return null;</span><span class="s3">\n  </span><span class="s1">const programmaticReport = yield* programmaticLogger.output();</span><span class="s3">\n\n  </span><span class="s1">let configFile;</span><span class="s3">\n  </span><span class="s1">if (typeof opts.configFile === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">configFile = yield* loadConfig(</span><span class="s3">\n      </span><span class="s1">opts.configFile,</span><span class="s3">\n      </span><span class="s1">context.cwd,</span><span class="s3">\n      </span><span class="s1">context.envName,</span><span class="s3">\n      </span><span class="s1">context.caller,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">} else if (opts.configFile !== false) {</span><span class="s3">\n    </span><span class="s1">configFile = yield* findRootConfig(</span><span class="s3">\n      </span><span class="s1">context.root,</span><span class="s3">\n      </span><span class="s1">context.envName,</span><span class="s3">\n      </span><span class="s1">context.caller,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let { babelrc, babelrcRoots } = opts;</span><span class="s3">\n  </span><span class="s1">let babelrcRootsDirectory = context.cwd;</span><span class="s3">\n\n  </span><span class="s1">const configFileChain = emptyChain();</span><span class="s3">\n  </span><span class="s1">const configFileLogger = new ConfigPrinter();</span><span class="s3">\n  </span><span class="s1">if (configFile) {</span><span class="s3">\n    </span><span class="s1">const validatedFile = validateConfigFile(configFile);</span><span class="s3">\n    </span><span class="s1">const result = yield* loadFileChain(</span><span class="s3">\n      </span><span class="s1">validatedFile,</span><span class="s3">\n      </span><span class="s1">context,</span><span class="s3">\n      </span><span class="s1">undefined,</span><span class="s3">\n      </span><span class="s1">configFileLogger,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n    </span><span class="s1">if (!result) return null;</span><span class="s3">\n    </span><span class="s1">configReport = yield* configFileLogger.output();</span><span class="s3">\n\n    </span><span class="s1">// Allow config files to toggle `.babelrc` resolution on and off and</span><span class="s3">\n    </span><span class="s1">// specify where the roots are.</span><span class="s3">\n    </span><span class="s1">if (babelrc === undefined) {</span><span class="s3">\n      </span><span class="s1">babelrc = validatedFile.options.babelrc;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">if (babelrcRoots === undefined) {</span><span class="s3">\n      </span><span class="s1">babelrcRootsDirectory = validatedFile.dirname;</span><span class="s3">\n      </span><span class="s1">babelrcRoots = validatedFile.options.babelrcRoots;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">mergeChain(configFileChain, result);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let ignoreFile, babelrcFile;</span><span class="s3">\n  </span><span class="s1">let isIgnored = false;</span><span class="s3">\n  </span><span class="s1">const fileChain = emptyChain();</span><span class="s3">\n  </span><span class="s1">// resolve all .babelrc files</span><span class="s3">\n  </span><span class="s1">if (</span><span class="s3">\n    </span><span class="s1">(babelrc === true || babelrc === undefined) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">typeof context.filename === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;\n  </span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">const pkgData = yield* findPackageData(context.filename);</span><span class="s3">\n\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">pkgData &amp;&amp;</span><span class="s3">\n      </span><span class="s1">babelrcLoadEnabled(context, pkgData, babelrcRoots, babelrcRootsDirectory)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">({ ignore: ignoreFile, config: babelrcFile } = yield* findRelativeConfig(</span><span class="s3">\n        </span><span class="s1">pkgData,</span><span class="s3">\n        </span><span class="s1">context.envName,</span><span class="s3">\n        </span><span class="s1">context.caller,</span><span class="s3">\n      </span><span class="s1">));</span><span class="s3">\n\n      </span><span class="s1">if (ignoreFile) {</span><span class="s3">\n        </span><span class="s1">fileChain.files.add(ignoreFile.filepath);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">ignoreFile &amp;&amp;</span><span class="s3">\n        </span><span class="s1">shouldIgnore(context, ignoreFile.ignore, null, ignoreFile.dirname)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">isIgnored = true;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (babelrcFile &amp;&amp; !isIgnored) {</span><span class="s3">\n        </span><span class="s1">const validatedFile = validateBabelrcFile(babelrcFile);</span><span class="s3">\n        </span><span class="s1">const babelrcLogger = new ConfigPrinter();</span><span class="s3">\n        </span><span class="s1">const result = yield* loadFileChain(</span><span class="s3">\n          </span><span class="s1">validatedFile,</span><span class="s3">\n          </span><span class="s1">context,</span><span class="s3">\n          </span><span class="s1">undefined,</span><span class="s3">\n          </span><span class="s1">babelrcLogger,</span><span class="s3">\n        </span><span class="s1">);</span><span class="s3">\n        </span><span class="s1">if (!result) {</span><span class="s3">\n          </span><span class="s1">isIgnored = true;</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">babelRcReport = yield* babelrcLogger.output();</span><span class="s3">\n          </span><span class="s1">mergeChain(fileChain, result);</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">if (babelrcFile &amp;&amp; isIgnored) {</span><span class="s3">\n        </span><span class="s1">fileChain.files.add(babelrcFile.filepath);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (context.showConfig) {</span><span class="s3">\n    </span><span class="s1">console.log(</span><span class="s3">\n      </span><span class="s1">`Babel configs on </span><span class="s3">\&quot;</span><span class="s1">${context.filename}</span><span class="s3">\&quot; </span><span class="s1">(ascending priority):</span><span class="s3">\\</span><span class="s1">n` +</span><span class="s3">\n        </span><span class="s1">// print config by the order of ascending priority</span><span class="s3">\n        </span><span class="s1">[configReport, babelRcReport, programmaticReport]</span><span class="s3">\n          </span><span class="s1">.filter(x =&gt; !!x)</span><span class="s3">\n          </span><span class="s1">.join(</span><span class="s3">\&quot;\\</span><span class="s1">n</span><span class="s3">\\</span><span class="s1">n</span><span class="s3">\&quot;</span><span class="s1">) +</span><span class="s3">\n        \&quot;\\</span><span class="s1">n-----End Babel configs-----</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">// Insert file chain in front so programmatic options have priority</span><span class="s3">\n  </span><span class="s1">// over configuration file chain items.</span><span class="s3">\n  </span><span class="s1">const chain = mergeChain(</span><span class="s3">\n    </span><span class="s1">mergeChain(mergeChain(emptyChain(), configFileChain), fileChain),</span><span class="s3">\n    </span><span class="s1">programmaticChain,</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">plugins: isIgnored ? [] : dedupDescriptors(chain.plugins),</span><span class="s3">\n    </span><span class="s1">presets: isIgnored ? [] : dedupDescriptors(chain.presets),</span><span class="s3">\n    </span><span class="s1">options: isIgnored ? [] : chain.options.map(o =&gt; normalizeOptions(o)),</span><span class="s3">\n    </span><span class="s1">fileHandling: isIgnored ? </span><span class="s3">\&quot;</span><span class="s1">ignored</span><span class="s3">\&quot; </span><span class="s1">: </span><span class="s3">\&quot;</span><span class="s1">transpile</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n    </span><span class="s1">ignore: ignoreFile || undefined,</span><span class="s3">\n    </span><span class="s1">babelrc: babelrcFile || undefined,</span><span class="s3">\n    </span><span class="s1">config: configFile || undefined,</span><span class="s3">\n    </span><span class="s1">files: chain.files,</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function babelrcLoadEnabled(</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">pkgData: FilePackageData,</span><span class="s3">\n  </span><span class="s1">babelrcRoots: BabelrcSearch | undefined,</span><span class="s3">\n  </span><span class="s1">babelrcRootsDirectory: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">if (typeof babelrcRoots === </span><span class="s3">\&quot;</span><span class="s1">boolean</span><span class="s3">\&quot;</span><span class="s1">) return babelrcRoots;</span><span class="s3">\n\n  </span><span class="s1">const absoluteRoot = context.root;</span><span class="s3">\n\n  </span><span class="s1">// Fast path to avoid having to match patterns if the babelrc is just</span><span class="s3">\n  </span><span class="s1">// loading in the standard root directory.</span><span class="s3">\n  </span><span class="s1">if (babelrcRoots === undefined) {</span><span class="s3">\n    </span><span class="s1">return pkgData.directories.indexOf(absoluteRoot) !== -1;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">let babelrcPatterns = babelrcRoots;</span><span class="s3">\n  </span><span class="s1">if (!Array.isArray(babelrcPatterns)) {</span><span class="s3">\n    </span><span class="s1">babelrcPatterns = [babelrcPatterns as IgnoreItem];</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">babelrcPatterns = babelrcPatterns.map(pat =&gt; {</span><span class="s3">\n    </span><span class="s1">return typeof pat === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;\n      </span><span class="s1">? path.resolve(babelrcRootsDirectory, pat)</span><span class="s3">\n      </span><span class="s1">: pat;</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n\n  </span><span class="s1">// Fast path to avoid having to match patterns if the babelrc is just</span><span class="s3">\n  </span><span class="s1">// loading in the standard root directory.</span><span class="s3">\n  </span><span class="s1">if (babelrcPatterns.length === 1 &amp;&amp; babelrcPatterns[0] === absoluteRoot) {</span><span class="s3">\n    </span><span class="s1">return pkgData.directories.indexOf(absoluteRoot) !== -1;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return babelrcPatterns.some(pat =&gt; {</span><span class="s3">\n    </span><span class="s1">if (typeof pat === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">pat = pathPatternToRegex(pat, babelrcRootsDirectory);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">return pkgData.directories.some(directory =&gt; {</span><span class="s3">\n      </span><span class="s1">return matchPattern(pat, babelrcRootsDirectory, directory, context);</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const validateConfigFile = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(file: ConfigFile): ValidatedFile =&gt; ({</span><span class="s3">\n    </span><span class="s1">filepath: file.filepath,</span><span class="s3">\n    </span><span class="s1">dirname: file.dirname,</span><span class="s3">\n    </span><span class="s1">options: validate(</span><span class="s3">\&quot;</span><span class="s1">configfile</span><span class="s3">\&quot;</span><span class="s1">, file.options, file.filepath),</span><span class="s3">\n  </span><span class="s1">}),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">const validateBabelrcFile = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(file: ConfigFile): ValidatedFile =&gt; ({</span><span class="s3">\n    </span><span class="s1">filepath: file.filepath,</span><span class="s3">\n    </span><span class="s1">dirname: file.dirname,</span><span class="s3">\n    </span><span class="s1">options: validate(</span><span class="s3">\&quot;</span><span class="s1">babelrcfile</span><span class="s3">\&quot;</span><span class="s1">, file.options, file.filepath),</span><span class="s3">\n  </span><span class="s1">}),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">const validateExtendFile = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(file: ConfigFile): ValidatedFile =&gt; ({</span><span class="s3">\n    </span><span class="s1">filepath: file.filepath,</span><span class="s3">\n    </span><span class="s1">dirname: file.dirname,</span><span class="s3">\n    </span><span class="s1">options: validate(</span><span class="s3">\&quot;</span><span class="s1">extendsfile</span><span class="s3">\&quot;</span><span class="s1">, file.options, file.filepath),</span><span class="s3">\n  </span><span class="s1">}),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Build a config chain for just the programmatic options passed into Babel.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const loadProgrammaticChain = makeChainWalker({</span><span class="s3">\n  </span><span class="s1">root: input =&gt; buildRootDescriptors(input, </span><span class="s3">\&quot;</span><span class="s1">base</span><span class="s3">\&quot;</span><span class="s1">, createCachedDescriptors),</span><span class="s3">\n  </span><span class="s1">env: (input, envName) =&gt;</span><span class="s3">\n    </span><span class="s1">buildEnvDescriptors(input, </span><span class="s3">\&quot;</span><span class="s1">base</span><span class="s3">\&quot;</span><span class="s1">, createCachedDescriptors, envName),</span><span class="s3">\n  </span><span class="s1">overrides: (input, index) =&gt;</span><span class="s3">\n    </span><span class="s1">buildOverrideDescriptors(input, </span><span class="s3">\&quot;</span><span class="s1">base</span><span class="s3">\&quot;</span><span class="s1">, createCachedDescriptors, index),</span><span class="s3">\n  </span><span class="s1">overridesEnv: (input, index, envName) =&gt;</span><span class="s3">\n    </span><span class="s1">buildOverrideEnvDescriptors(</span><span class="s3">\n      </span><span class="s1">input,</span><span class="s3">\n      \&quot;</span><span class="s1">base</span><span class="s3">\&quot;</span><span class="s1">,</span><span class="s3">\n      </span><span class="s1">createCachedDescriptors,</span><span class="s3">\n      </span><span class="s1">index,</span><span class="s3">\n      </span><span class="s1">envName,</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n  </span><span class="s1">createLogger: (input, context, baseLogger) =&gt;</span><span class="s3">\n    </span><span class="s1">buildProgrammaticLogger(input, context, baseLogger),</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Build a config chain for a given file.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">const loadFileChainWalker = makeChainWalker&lt;ValidatedFile&gt;({</span><span class="s3">\n  </span><span class="s1">root: file =&gt; loadFileDescriptors(file),</span><span class="s3">\n  </span><span class="s1">env: (file, envName) =&gt; loadFileEnvDescriptors(file)(envName),</span><span class="s3">\n  </span><span class="s1">overrides: (file, index) =&gt; loadFileOverridesDescriptors(file)(index),</span><span class="s3">\n  </span><span class="s1">overridesEnv: (file, index, envName) =&gt;</span><span class="s3">\n    </span><span class="s1">loadFileOverridesEnvDescriptors(file)(index)(envName),</span><span class="s3">\n  </span><span class="s1">createLogger: (file, context, baseLogger) =&gt;</span><span class="s3">\n    </span><span class="s1">buildFileLogger(file.filepath, context, baseLogger),</span><span class="s3">\n</span><span class="s1">});</span><span class="s3">\n\n</span><span class="s1">function* loadFileChain(</span><span class="s3">\n  </span><span class="s1">input: ValidatedFile,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">files: Set&lt;ConfigFile&gt;,</span><span class="s3">\n  </span><span class="s1">baseLogger: ConfigPrinter,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const chain = yield* loadFileChainWalker(input, context, files, baseLogger);</span><span class="s3">\n  </span><span class="s1">chain?.files.add(input.filepath);</span><span class="s3">\n\n  </span><span class="s1">return chain;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">const loadFileDescriptors = makeWeakCacheSync((file: ValidatedFile) =&gt;</span><span class="s3">\n  </span><span class="s1">buildRootDescriptors(file, file.filepath, createUncachedDescriptors),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadFileEnvDescriptors = makeWeakCacheSync((file: ValidatedFile) =&gt;</span><span class="s3">\n  </span><span class="s1">makeStrongCacheSync((envName: string) =&gt;</span><span class="s3">\n    </span><span class="s1">buildEnvDescriptors(</span><span class="s3">\n      </span><span class="s1">file,</span><span class="s3">\n      </span><span class="s1">file.filepath,</span><span class="s3">\n      </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n      </span><span class="s1">envName,</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n  </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadFileOverridesDescriptors = makeWeakCacheSync((file: ValidatedFile) =&gt;</span><span class="s3">\n  </span><span class="s1">makeStrongCacheSync((index: number) =&gt;</span><span class="s3">\n    </span><span class="s1">buildOverrideDescriptors(</span><span class="s3">\n      </span><span class="s1">file,</span><span class="s3">\n      </span><span class="s1">file.filepath,</span><span class="s3">\n      </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n      </span><span class="s1">index,</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n  </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n</span><span class="s1">const loadFileOverridesEnvDescriptors = makeWeakCacheSync(</span><span class="s3">\n  </span><span class="s1">(file: ValidatedFile) =&gt;</span><span class="s3">\n    </span><span class="s1">makeStrongCacheSync((index: number) =&gt;</span><span class="s3">\n      </span><span class="s1">makeStrongCacheSync((envName: string) =&gt;</span><span class="s3">\n        </span><span class="s1">buildOverrideEnvDescriptors(</span><span class="s3">\n          </span><span class="s1">file,</span><span class="s3">\n          </span><span class="s1">file.filepath,</span><span class="s3">\n          </span><span class="s1">createUncachedDescriptors,</span><span class="s3">\n          </span><span class="s1">index,</span><span class="s3">\n          </span><span class="s1">envName,</span><span class="s3">\n        </span><span class="s1">),</span><span class="s3">\n      </span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">),</span><span class="s3">\n</span><span class="s1">);</span><span class="s3">\n\n</span><span class="s1">function buildFileLogger(</span><span class="s3">\n  </span><span class="s1">filepath: string,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">baseLogger: ConfigPrinter | void,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!baseLogger) {</span><span class="s3">\n    </span><span class="s1">return () =&gt; {};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return baseLogger.configure(context.showConfig, ChainFormatter.Config, {</span><span class="s3">\n    </span><span class="s1">filepath,</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildRootDescriptors(</span><span class="s3">\n  </span><span class="s1">{ dirname, options }: Partial&lt;ValidatedFile&gt;,</span><span class="s3">\n  </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">descriptors: (</span><span class="s3">\n    </span><span class="s1">dirname: string,</span><span class="s3">\n    </span><span class="s1">options: ValidatedOptions,</span><span class="s3">\n    </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">) =&gt; OptionsAndDescriptors,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">return descriptors(dirname, options, alias);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildProgrammaticLogger(</span><span class="s3">\n  </span><span class="s1">_: unknown,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">baseLogger: ConfigPrinter | void,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">if (!baseLogger) {</span><span class="s3">\n    </span><span class="s1">return () =&gt; {};</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return baseLogger.configure(context.showConfig, ChainFormatter.Programmatic, {</span><span class="s3">\n    </span><span class="s1">callerName: context.caller?.name,</span><span class="s3">\n  </span><span class="s1">});</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildEnvDescriptors(</span><span class="s3">\n  </span><span class="s1">{ dirname, options }: Partial&lt;ValidatedFile&gt;,</span><span class="s3">\n  </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">descriptors: (</span><span class="s3">\n    </span><span class="s1">dirname: string,</span><span class="s3">\n    </span><span class="s1">options: ValidatedOptions,</span><span class="s3">\n    </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">) =&gt; OptionsAndDescriptors,</span><span class="s3">\n  </span><span class="s1">envName: string,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const opts = options.env?.[envName];</span><span class="s3">\n  </span><span class="s1">return opts ? descriptors(dirname, opts, `${alias}.env[</span><span class="s3">\&quot;</span><span class="s1">${envName}</span><span class="s3">\&quot;</span><span class="s1">]`) : null;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildOverrideDescriptors(</span><span class="s3">\n  </span><span class="s1">{ dirname, options }: Partial&lt;ValidatedFile&gt;,</span><span class="s3">\n  </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">descriptors: (</span><span class="s3">\n    </span><span class="s1">dirname: string,</span><span class="s3">\n    </span><span class="s1">options: ValidatedOptions,</span><span class="s3">\n    </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">) =&gt; OptionsAndDescriptors,</span><span class="s3">\n  </span><span class="s1">index: number,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const opts = options.overrides?.[index];</span><span class="s3">\n  </span><span class="s1">if (!opts) throw new Error(</span><span class="s3">\&quot;</span><span class="s1">Assertion failure - missing override</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">return descriptors(dirname, opts, `${alias}.overrides[${index}]`);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function buildOverrideEnvDescriptors(</span><span class="s3">\n  </span><span class="s1">{ dirname, options }: Partial&lt;ValidatedFile&gt;,</span><span class="s3">\n  </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">descriptors: (</span><span class="s3">\n    </span><span class="s1">dirname: string,</span><span class="s3">\n    </span><span class="s1">options: ValidatedOptions,</span><span class="s3">\n    </span><span class="s1">alias: string,</span><span class="s3">\n  </span><span class="s1">) =&gt; OptionsAndDescriptors,</span><span class="s3">\n  </span><span class="s1">index: number,</span><span class="s3">\n  </span><span class="s1">envName: string,</span><span class="s3">\n</span><span class="s1">) {</span><span class="s3">\n  </span><span class="s1">const override = options.overrides?.[index];</span><span class="s3">\n  </span><span class="s1">if (!override) throw new Error(</span><span class="s3">\&quot;</span><span class="s1">Assertion failure - missing override</span><span class="s3">\&quot;</span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">const opts = override.env?.[envName];</span><span class="s3">\n  </span><span class="s1">return opts</span><span class="s3">\n    </span><span class="s1">? descriptors(</span><span class="s3">\n        </span><span class="s1">dirname,</span><span class="s3">\n        </span><span class="s1">opts,</span><span class="s3">\n        </span><span class="s1">`${alias}.overrides[${index}].env[</span><span class="s3">\&quot;</span><span class="s1">${envName}</span><span class="s3">\&quot;</span><span class="s1">]`,</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">: null;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function makeChainWalker&lt;</span><span class="s3">\n  </span><span class="s1">ArgT extends {</span><span class="s3">\n    </span><span class="s1">options: ValidatedOptions;</span><span class="s3">\n    </span><span class="s1">dirname: string;</span><span class="s3">\n    </span><span class="s1">filepath?: string;</span><span class="s3">\n  </span><span class="s1">},</span><span class="s3">\n</span><span class="s1">&gt;({</span><span class="s3">\n  </span><span class="s1">root,</span><span class="s3">\n  </span><span class="s1">env,</span><span class="s3">\n  </span><span class="s1">overrides,</span><span class="s3">\n  </span><span class="s1">overridesEnv,</span><span class="s3">\n  </span><span class="s1">createLogger,</span><span class="s3">\n</span><span class="s1">}: {</span><span class="s3">\n  </span><span class="s1">root: (configEntry: ArgT) =&gt; OptionsAndDescriptors;</span><span class="s3">\n  </span><span class="s1">env: (configEntry: ArgT, env: string) =&gt; OptionsAndDescriptors | null;</span><span class="s3">\n  </span><span class="s1">overrides: (configEntry: ArgT, index: number) =&gt; OptionsAndDescriptors;</span><span class="s3">\n  </span><span class="s1">overridesEnv: (</span><span class="s3">\n    </span><span class="s1">configEntry: ArgT,</span><span class="s3">\n    </span><span class="s1">index: number,</span><span class="s3">\n    </span><span class="s1">env: string,</span><span class="s3">\n  </span><span class="s1">) =&gt; OptionsAndDescriptors | null;</span><span class="s3">\n  </span><span class="s1">createLogger: (</span><span class="s3">\n    </span><span class="s1">configEntry: ArgT,</span><span class="s3">\n    </span><span class="s1">context: ConfigContext,</span><span class="s3">\n    </span><span class="s1">printer: ConfigPrinter | void,</span><span class="s3">\n  </span><span class="s1">) =&gt; (</span><span class="s3">\n    </span><span class="s1">opts: OptionsAndDescriptors,</span><span class="s3">\n    </span><span class="s1">index?: number | null,</span><span class="s3">\n    </span><span class="s1">env?: string | null,</span><span class="s3">\n  </span><span class="s1">) =&gt; void;</span><span class="s3">\n</span><span class="s1">}): (</span><span class="s3">\n  </span><span class="s1">configEntry: ArgT,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">files?: Set&lt;ConfigFile&gt;,</span><span class="s3">\n  </span><span class="s1">baseLogger?: ConfigPrinter,</span><span class="s3">\n</span><span class="s1">) =&gt; Handler&lt;ConfigChain | null&gt; {</span><span class="s3">\n  </span><span class="s1">return function* chainWalker(input, context, files = new Set(), baseLogger) {</span><span class="s3">\n    </span><span class="s1">const { dirname } = input;</span><span class="s3">\n\n    </span><span class="s1">const flattenedConfigs: Array&lt;{</span><span class="s3">\n      </span><span class="s1">config: OptionsAndDescriptors;</span><span class="s3">\n      </span><span class="s1">index: number | undefined | null;</span><span class="s3">\n      </span><span class="s1">envName: string | undefined | null;</span><span class="s3">\n    </span><span class="s1">}&gt; = [];</span><span class="s3">\n\n    </span><span class="s1">const rootOpts = root(input);</span><span class="s3">\n    </span><span class="s1">if (configIsApplicable(rootOpts, dirname, context, input.filepath)) {</span><span class="s3">\n      </span><span class="s1">flattenedConfigs.push({</span><span class="s3">\n        </span><span class="s1">config: rootOpts,</span><span class="s3">\n        </span><span class="s1">envName: undefined,</span><span class="s3">\n        </span><span class="s1">index: undefined,</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n\n      </span><span class="s1">const envOpts = env(input, context.envName);</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">envOpts &amp;&amp;</span><span class="s3">\n        </span><span class="s1">configIsApplicable(envOpts, dirname, context, input.filepath)</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">flattenedConfigs.push({</span><span class="s3">\n          </span><span class="s1">config: envOpts,</span><span class="s3">\n          </span><span class="s1">envName: context.envName,</span><span class="s3">\n          </span><span class="s1">index: undefined,</span><span class="s3">\n        </span><span class="s1">});</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">(rootOpts.options.overrides || []).forEach((_, index) =&gt; {</span><span class="s3">\n        </span><span class="s1">const overrideOps = overrides(input, index);</span><span class="s3">\n        </span><span class="s1">if (configIsApplicable(overrideOps, dirname, context, input.filepath)) {</span><span class="s3">\n          </span><span class="s1">flattenedConfigs.push({</span><span class="s3">\n            </span><span class="s1">config: overrideOps,</span><span class="s3">\n            </span><span class="s1">index,</span><span class="s3">\n            </span><span class="s1">envName: undefined,</span><span class="s3">\n          </span><span class="s1">});</span><span class="s3">\n\n          </span><span class="s1">const overrideEnvOpts = overridesEnv(input, index, context.envName);</span><span class="s3">\n          </span><span class="s1">if (</span><span class="s3">\n            </span><span class="s1">overrideEnvOpts &amp;&amp;</span><span class="s3">\n            </span><span class="s1">configIsApplicable(</span><span class="s3">\n              </span><span class="s1">overrideEnvOpts,</span><span class="s3">\n              </span><span class="s1">dirname,</span><span class="s3">\n              </span><span class="s1">context,</span><span class="s3">\n              </span><span class="s1">input.filepath,</span><span class="s3">\n            </span><span class="s1">)</span><span class="s3">\n          </span><span class="s1">) {</span><span class="s3">\n            </span><span class="s1">flattenedConfigs.push({</span><span class="s3">\n              </span><span class="s1">config: overrideEnvOpts,</span><span class="s3">\n              </span><span class="s1">index,</span><span class="s3">\n              </span><span class="s1">envName: context.envName,</span><span class="s3">\n            </span><span class="s1">});</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">});</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Process 'ignore' and 'only' before 'extends' items are processed so</span><span class="s3">\n    </span><span class="s1">// that we don't do extra work loading extended configs if a file is</span><span class="s3">\n    </span><span class="s1">// ignored.</span><span class="s3">\n    </span><span class="s1">if (</span><span class="s3">\n      </span><span class="s1">flattenedConfigs.some(</span><span class="s3">\n        </span><span class="s1">({</span><span class="s3">\n          </span><span class="s1">config: {</span><span class="s3">\n            </span><span class="s1">options: { ignore, only },</span><span class="s3">\n          </span><span class="s1">},</span><span class="s3">\n        </span><span class="s1">}) =&gt; shouldIgnore(context, ignore, only, dirname),</span><span class="s3">\n      </span><span class="s1">)</span><span class="s3">\n    </span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">return null;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">const chain = emptyChain();</span><span class="s3">\n    </span><span class="s1">const logger = createLogger(input, context, baseLogger);</span><span class="s3">\n\n    </span><span class="s1">for (const { config, index, envName } of flattenedConfigs) {</span><span class="s3">\n      </span><span class="s1">if (</span><span class="s3">\n        </span><span class="s1">!(yield* mergeExtendsChain(</span><span class="s3">\n          </span><span class="s1">chain,</span><span class="s3">\n          </span><span class="s1">config.options,</span><span class="s3">\n          </span><span class="s1">dirname,</span><span class="s3">\n          </span><span class="s1">context,</span><span class="s3">\n          </span><span class="s1">files,</span><span class="s3">\n          </span><span class="s1">baseLogger,</span><span class="s3">\n        </span><span class="s1">))</span><span class="s3">\n      </span><span class="s1">) {</span><span class="s3">\n        </span><span class="s1">return null;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">logger(config, index, envName);</span><span class="s3">\n      </span><span class="s1">yield* mergeChainOpts(chain, config);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return chain;</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function* mergeExtendsChain(</span><span class="s3">\n  </span><span class="s1">chain: ConfigChain,</span><span class="s3">\n  </span><span class="s1">opts: ValidatedOptions,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">files: Set&lt;ConfigFile&gt;,</span><span class="s3">\n  </span><span class="s1">baseLogger?: ConfigPrinter,</span><span class="s3">\n</span><span class="s1">): Handler&lt;boolean&gt; {</span><span class="s3">\n  </span><span class="s1">if (opts.extends === undefined) return true;</span><span class="s3">\n\n  </span><span class="s1">const file = yield* loadConfig(</span><span class="s3">\n    </span><span class="s1">opts.extends,</span><span class="s3">\n    </span><span class="s1">dirname,</span><span class="s3">\n    </span><span class="s1">context.envName,</span><span class="s3">\n    </span><span class="s1">context.caller,</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n\n  </span><span class="s1">if (files.has(file)) {</span><span class="s3">\n    </span><span class="s1">throw new Error(</span><span class="s3">\n      </span><span class="s1">`Configuration cycle detected loading ${file.filepath}.</span><span class="s3">\\</span><span class="s1">n` +</span><span class="s3">\n        </span><span class="s1">`File already loaded following the config chain:</span><span class="s3">\\</span><span class="s1">n` +</span><span class="s3">\n        </span><span class="s1">Array.from(files, file =&gt; ` - ${file.filepath}`).join(</span><span class="s3">\&quot;\\</span><span class="s1">n</span><span class="s3">\&quot;</span><span class="s1">),</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">files.add(file);</span><span class="s3">\n  </span><span class="s1">const fileChain = yield* loadFileChain(</span><span class="s3">\n    </span><span class="s1">validateExtendFile(file),</span><span class="s3">\n    </span><span class="s1">context,</span><span class="s3">\n    </span><span class="s1">files,</span><span class="s3">\n    </span><span class="s1">baseLogger,</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">files.delete(file);</span><span class="s3">\n\n  </span><span class="s1">if (!fileChain) return false;</span><span class="s3">\n\n  </span><span class="s1">mergeChain(chain, fileChain);</span><span class="s3">\n\n  </span><span class="s1">return true;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function mergeChain(target: ConfigChain, source: ConfigChain): ConfigChain {</span><span class="s3">\n  </span><span class="s1">target.options.push(...source.options);</span><span class="s3">\n  </span><span class="s1">target.plugins.push(...source.plugins);</span><span class="s3">\n  </span><span class="s1">target.presets.push(...source.presets);</span><span class="s3">\n  </span><span class="s1">for (const file of source.files) {</span><span class="s3">\n    </span><span class="s1">target.files.add(file);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return target;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function* mergeChainOpts(</span><span class="s3">\n  </span><span class="s1">target: ConfigChain,</span><span class="s3">\n  </span><span class="s1">{ options, plugins, presets }: OptionsAndDescriptors,</span><span class="s3">\n</span><span class="s1">): Handler&lt;ConfigChain&gt; {</span><span class="s3">\n  </span><span class="s1">target.options.push(options);</span><span class="s3">\n  </span><span class="s1">target.plugins.push(...(yield* plugins()));</span><span class="s3">\n  </span><span class="s1">target.presets.push(...(yield* presets()));</span><span class="s3">\n\n  </span><span class="s1">return target;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function emptyChain(): ConfigChain {</span><span class="s3">\n  </span><span class="s1">return {</span><span class="s3">\n    </span><span class="s1">options: [],</span><span class="s3">\n    </span><span class="s1">presets: [],</span><span class="s3">\n    </span><span class="s1">plugins: [],</span><span class="s3">\n    </span><span class="s1">files: new Set(),</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function normalizeOptions(opts: ValidatedOptions): ValidatedOptions {</span><span class="s3">\n  </span><span class="s1">const options = {</span><span class="s3">\n    </span><span class="s1">...opts,</span><span class="s3">\n  </span><span class="s1">};</span><span class="s3">\n  </span><span class="s1">delete options.extends;</span><span class="s3">\n  </span><span class="s1">delete options.env;</span><span class="s3">\n  </span><span class="s1">delete options.overrides;</span><span class="s3">\n  </span><span class="s1">delete options.plugins;</span><span class="s3">\n  </span><span class="s1">delete options.presets;</span><span class="s3">\n  </span><span class="s1">delete options.passPerPreset;</span><span class="s3">\n  </span><span class="s1">delete options.ignore;</span><span class="s3">\n  </span><span class="s1">delete options.only;</span><span class="s3">\n  </span><span class="s1">delete options.test;</span><span class="s3">\n  </span><span class="s1">delete options.include;</span><span class="s3">\n  </span><span class="s1">delete options.exclude;</span><span class="s3">\n\n  </span><span class="s1">// </span><span class="s3">\&quot;</span><span class="s1">sourceMap</span><span class="s3">\&quot; </span><span class="s1">is just aliased to sourceMap, so copy it over as</span><span class="s3">\n  </span><span class="s1">// we merge the options together.</span><span class="s3">\n  </span><span class="s1">if (Object.prototype.hasOwnProperty.call(options, </span><span class="s3">\&quot;</span><span class="s1">sourceMap</span><span class="s3">\&quot;</span><span class="s1">)) {</span><span class="s3">\n    </span><span class="s1">options.sourceMaps = options.sourceMap;</span><span class="s3">\n    </span><span class="s1">delete options.sourceMap;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return options;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function dedupDescriptors&lt;API&gt;(</span><span class="s3">\n  </span><span class="s1">items: Array&lt;UnloadedDescriptor&lt;API&gt;&gt;,</span><span class="s3">\n</span><span class="s1">): Array&lt;UnloadedDescriptor&lt;API&gt;&gt; {</span><span class="s3">\n  </span><span class="s1">const map: Map&lt;</span><span class="s3">\n    </span><span class="s1">Function,</span><span class="s3">\n    </span><span class="s1">Map&lt;string | void, { value: UnloadedDescriptor&lt;API&gt; }&gt;</span><span class="s3">\n  </span><span class="s1">&gt; = new Map();</span><span class="s3">\n\n  </span><span class="s1">const descriptors = [];</span><span class="s3">\n\n  </span><span class="s1">for (const item of items) {</span><span class="s3">\n    </span><span class="s1">if (typeof item.value === </span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n      </span><span class="s1">const fnKey = item.value;</span><span class="s3">\n      </span><span class="s1">let nameMap = map.get(fnKey);</span><span class="s3">\n      </span><span class="s1">if (!nameMap) {</span><span class="s3">\n        </span><span class="s1">nameMap = new Map();</span><span class="s3">\n        </span><span class="s1">map.set(fnKey, nameMap);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">let desc = nameMap.get(item.name);</span><span class="s3">\n      </span><span class="s1">if (!desc) {</span><span class="s3">\n        </span><span class="s1">desc = { value: item };</span><span class="s3">\n        </span><span class="s1">descriptors.push(desc);</span><span class="s3">\n\n        </span><span class="s1">// Treat passPerPreset presets as unique, skipping them</span><span class="s3">\n        </span><span class="s1">// in the merge processing steps.</span><span class="s3">\n        </span><span class="s1">if (!item.ownPass) nameMap.set(item.name, desc);</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">desc.value = item;</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">} else {</span><span class="s3">\n      </span><span class="s1">descriptors.push({ value: item });</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return descriptors.reduce((acc, desc) =&gt; {</span><span class="s3">\n    </span><span class="s1">acc.push(desc.value);</span><span class="s3">\n    </span><span class="s1">return acc;</span><span class="s3">\n  </span><span class="s1">}, []);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function configIsApplicable(</span><span class="s3">\n  </span><span class="s1">{ options }: OptionsAndDescriptors,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">configName: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return (</span><span class="s3">\n    </span><span class="s1">(options.test === undefined ||</span><span class="s3">\n      </span><span class="s1">configFieldIsApplicable(context, options.test, dirname, configName)) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(options.include === undefined ||</span><span class="s3">\n      </span><span class="s1">configFieldIsApplicable(context, options.include, dirname, configName)) &amp;&amp;</span><span class="s3">\n    </span><span class="s1">(options.exclude === undefined ||</span><span class="s3">\n      </span><span class="s1">!configFieldIsApplicable(context, options.exclude, dirname, configName))</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function configFieldIsApplicable(</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">test: ConfigApplicableTest,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n  </span><span class="s1">configName: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">const patterns = Array.isArray(test) ? test : [test];</span><span class="s3">\n\n  </span><span class="s1">return matchesPatterns(context, patterns, dirname, configName);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Print the ignoreList-values in a more helpful way than the default.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function ignoreListReplacer(</span><span class="s3">\n  </span><span class="s1">_key: string,</span><span class="s3">\n  </span><span class="s1">value: IgnoreList | IgnoreItem,</span><span class="s3">\n</span><span class="s1">): IgnoreList | IgnoreItem | string {</span><span class="s3">\n  </span><span class="s1">if (value instanceof RegExp) {</span><span class="s3">\n    </span><span class="s1">return String(value);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return value;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Tests if a filename should be ignored based on </span><span class="s3">\&quot;</span><span class="s1">ignore</span><span class="s3">\&quot; </span><span class="s1">and </span><span class="s3">\&quot;</span><span class="s1">only</span><span class="s3">\&quot; </span><span class="s1">options.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function shouldIgnore(</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">ignore: IgnoreList | undefined | null,</span><span class="s3">\n  </span><span class="s1">only: IgnoreList | undefined | null,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">if (ignore &amp;&amp; matchesPatterns(context, ignore, dirname)) {</span><span class="s3">\n    </span><span class="s1">const message = `No config is applied to </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n      </span><span class="s1">context.filename ?? </span><span class="s3">\&quot;</span><span class="s1">(unknown)</span><span class="s3">\&quot;\n    </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">because it matches one of </span><span class="s3">\\</span><span class="s1">`ignore: ${JSON.stringify(</span><span class="s3">\n      </span><span class="s1">ignore,</span><span class="s3">\n      </span><span class="s1">ignoreListReplacer,</span><span class="s3">\n    </span><span class="s1">)}</span><span class="s3">\\</span><span class="s1">` from </span><span class="s3">\&quot;</span><span class="s1">${dirname}</span><span class="s3">\&quot;</span><span class="s1">`;</span><span class="s3">\n    </span><span class="s1">debug(message);</span><span class="s3">\n    </span><span class="s1">if (context.showConfig) {</span><span class="s3">\n      </span><span class="s1">console.log(message);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return true;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (only &amp;&amp; !matchesPatterns(context, only, dirname)) {</span><span class="s3">\n    </span><span class="s1">const message = `No config is applied to </span><span class="s3">\&quot;</span><span class="s1">${</span><span class="s3">\n      </span><span class="s1">context.filename ?? </span><span class="s3">\&quot;</span><span class="s1">(unknown)</span><span class="s3">\&quot;\n    </span><span class="s1">}</span><span class="s3">\&quot; </span><span class="s1">because it fails to match one of </span><span class="s3">\\</span><span class="s1">`only: ${JSON.stringify(</span><span class="s3">\n      </span><span class="s1">only,</span><span class="s3">\n      </span><span class="s1">ignoreListReplacer,</span><span class="s3">\n    </span><span class="s1">)}</span><span class="s3">\\</span><span class="s1">` from </span><span class="s3">\&quot;</span><span class="s1">${dirname}</span><span class="s3">\&quot;</span><span class="s1">`;</span><span class="s3">\n    </span><span class="s1">debug(message);</span><span class="s3">\n    </span><span class="s1">if (context.showConfig) {</span><span class="s3">\n      </span><span class="s1">console.log(message);</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n    </span><span class="s1">return true;</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return false;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Returns result of calling function with filename if pattern is a function.</span><span class="s3">\n </span><span class="s1">* Otherwise returns result of matching pattern Regex with filename.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">function matchesPatterns(</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">patterns: IgnoreList,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n  </span><span class="s1">configName?: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">return patterns.some(pattern =&gt;</span><span class="s3">\n    </span><span class="s1">matchPattern(pattern, dirname, context.filename, context, configName),</span><span class="s3">\n  </span><span class="s1">);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">function matchPattern(</span><span class="s3">\n  </span><span class="s1">pattern: IgnoreItem,</span><span class="s3">\n  </span><span class="s1">dirname: string,</span><span class="s3">\n  </span><span class="s1">pathToTest: string | undefined,</span><span class="s3">\n  </span><span class="s1">context: ConfigContext,</span><span class="s3">\n  </span><span class="s1">configName?: string,</span><span class="s3">\n</span><span class="s1">): boolean {</span><span class="s3">\n  </span><span class="s1">if (typeof pattern === </span><span class="s3">\&quot;</span><span class="s1">function</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">return !!endHiddenCallStack(pattern)(pathToTest, {</span><span class="s3">\n      </span><span class="s1">dirname,</span><span class="s3">\n      </span><span class="s1">envName: context.envName,</span><span class="s3">\n      </span><span class="s1">caller: context.caller,</span><span class="s3">\n    </span><span class="s1">});</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof pathToTest !== </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">throw new ConfigError(</span><span class="s3">\n      </span><span class="s1">`Configuration contains string/RegExp pattern, but no filename was passed to Babel`,</span><span class="s3">\n      </span><span class="s1">configName,</span><span class="s3">\n    </span><span class="s1">);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">if (typeof pattern === </span><span class="s3">\&quot;</span><span class="s1">string</span><span class="s3">\&quot;</span><span class="s1">) {</span><span class="s3">\n    </span><span class="s1">pattern = pathPatternToRegex(pattern, dirname);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n  </span><span class="s1">return pattern.test(pathToTest);</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">}</span></pre>
</body>
</html>