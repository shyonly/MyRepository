<html>
<head>
<title>forge.min.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #42c3d4;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
forge.min.js</font>
</center></td></tr></table>
<pre><span class="s0">!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">module</span><span class="s0">?</span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">t</span><span class="s0">():</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">define</span><span class="s0">&amp;&amp;</span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd</span><span class="s0">?</span><span class="s2">define</span><span class="s0">([],</span><span class="s2">t</span><span class="s0">):</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">exports</span><span class="s0">?</span><span class="s2">exports</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">=</span><span class="s2">t</span><span class="s0">():</span><span class="s2">e</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">=</span><span class="s2">t</span><span class="s0">()}(</span><span class="s2">window</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">function </span><span class="s2">r</span><span class="s0">(</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">exports</span><span class="s0">;</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]={</span><span class="s2">i</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">l</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">exports</span><span class="s0">:{}};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">call</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">d</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)||</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">enumerable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">get</span><span class="s0">:</span><span class="s2">a</span><span class="s0">})},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">Symbol</span><span class="s0">&amp;&amp;</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">toStringTag</span><span class="s0">&amp;&amp;</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">Symbol</span><span class="s0">.</span><span class="s2">toStringTag</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:</span><span class="s3">&quot;Module&quot;</span><span class="s0">}),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;__esModule&quot;</span><span class="s0">,{</span><span class="s2">value</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">__esModule</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s1">null</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">r</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s3">&quot;default&quot;</span><span class="s0">,{</span><span class="s2">enumerable</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}),</span><span class="s4">2</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">d</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]}.</span><span class="s2">bind</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">));</span><span class="s1">return </span><span class="s2">a</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">n</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">__esModule</span><span class="s0">?</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">default</span><span class="s0">}:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">};</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">d</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;a&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">o</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">32</span><span class="s0">)}([</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">={</span><span class="s2">options</span><span class="s0">:{</span><span class="s2">usePureJavaScript</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">35</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">8</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s4">16</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s4">24</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s4">32</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Only 8, 16, 24, or 32 bits supported: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBufferView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">Buffer</span><span class="s0">&amp;&amp;</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Buffer</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">try</span><span class="s0">{</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">])}}</span><span class="s1">else</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">o</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_constructedStringLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}!</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">process</span><span class="s0">&amp;&amp;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">&amp;&amp;!</span><span class="s2">process</span><span class="s0">.</span><span class="s2">browser</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">=</span><span class="s2">process</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">,</span><span class="s1">void</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">setImmediate</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s2">setImmediate</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">setImmediate</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">setImmediate</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">)},</span><span class="s1">void</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">setImmediate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">setTimeout</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)},</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;forge.setImmediate&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=[];</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">window</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;*&quot;</span><span class="s0">)},</span><span class="s2">window</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">source</span><span class="s0">===</span><span class="s2">window</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">stopPropagation</span><span class="s0">();</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">()}))}}),!</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">MutationObserver</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">document</span><span class="s0">.</span><span class="s2">createElement</span><span class="s0">(</span><span class="s3">&quot;div&quot;</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=[];</span><span class="s1">new </span><span class="s2">MutationObserver</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">()}))})).</span><span class="s2">observe</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,{</span><span class="s2">attributes</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">});</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">()-</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">15</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)):(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s4">1</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">setAttribute</span><span class="s0">(</span><span class="s3">&quot;a&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=!</span><span class="s2">a</span><span class="s0">))}}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">}(),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">process</span><span class="s0">&amp;&amp;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">versions</span><span class="s0">&amp;&amp;</span><span class="s2">process</span><span class="s0">.</span><span class="s2">versions</span><span class="s0">.</span><span class="s2">node</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">?</span><span class="s2">t</span><span class="s0">:</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">self</span><span class="s0">?</span><span class="s2">window</span><span class="s0">:</span><span class="s2">self</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">||</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;[object Array]&quot;</span><span class="s0">===</span><span class="s2">Object</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBuffer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">ArrayBuffer</span><span class="s0">&amp;&amp;</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">ArrayBuffer</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBufferView</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">)&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">=</span><span class="s2">o</span><span class="s0">;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">_optimizeConstructedString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_constructedStringLength</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_constructedStringLength</span><span class="s0">&gt;</span><span class="s4">4096</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_constructedStringLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isEmpty</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">),(</span><span class="s2">t</span><span class="s0">&gt;&gt;&gt;=</span><span class="s4">1</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_optimizeConstructedString</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_optimizeConstructedString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt16Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt24Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s2">t</span><span class="s0">-=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s2">t</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">putInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">++)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt24</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">2</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">3</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt24Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)&lt;&lt;</span><span class="s4">16</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt32Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)&lt;&lt;</span><span class="s4">24</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">)+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">++),</span><span class="s2">e</span><span class="s0">-=</span><span class="s4">8</span><span class="s0">}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getSignedInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">&lt;&lt;</span><span class="s2">e</span><span class="s0">-</span><span class="s4">2</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">-=</span><span class="s2">r</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">):</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">at</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">setAt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">+</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">last</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s3">&quot;0&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">decodeUtf8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">())},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">readOffset</span><span class="s0">||</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">growSize</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">growSize</span><span class="s0">||</span><span class="s4">1024</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBufferView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteOffset</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">),</span><span class="s1">void</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s3">&quot;writeOffset&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">writeOffset</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s1">new </span><span class="s2">ArrayBuffer</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s3">&quot;writeOffset&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">writeOffset</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isEmpty</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;=</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s2">t</span><span class="s0">||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">growSize</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteOffset</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()+</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setUint8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">++,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setUint8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBufferView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteOffset</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">)).</span><span class="s2">byteLength</span><span class="s0">-</span><span class="s2">a</span><span class="s0">.</span><span class="s2">byteOffset</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">).</span><span class="s2">set</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">,</span><span class="s1">this</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">),</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">).</span><span class="s2">set</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">,</span><span class="s1">this</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">write</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isArrayBufferView</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">)){</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">());</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">),</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">).</span><span class="s2">set</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">,</span><span class="s1">this</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteStringBuffer</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;binary&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;binary&quot;</span><span class="s0">,</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;hex&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">2</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">hex</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;base64&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">3</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">4</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base64</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;binary&quot;</span><span class="s0">),</span><span class="s3">&quot;binary&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;raw&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">raw</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s1">this</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;utf16&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">2</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint16Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf16</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s1">this</span><span class="s0">;</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid encoding: &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">throw </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid parameter: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;utf16&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">65535</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt16Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt24Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">65535</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">do</span><span class="s0">{</span><span class="s2">t</span><span class="s0">-=</span><span class="s4">8</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">++,</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s2">t</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">accommodate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">/</span><span class="s4">8</span><span class="s0">),</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">putInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">++)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt24</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">2</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt24Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">;</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt32Le</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">)+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getInt8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">++),</span><span class="s2">e</span><span class="s0">-=</span><span class="s4">8</span><span class="s0">}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getSignedInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">&lt;&lt;</span><span class="s2">e</span><span class="s0">-</span><span class="s4">2</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">-=</span><span class="s2">r</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">):</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">at</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getUint8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">setAt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">setUint8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">last</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getUint8</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">(</span><span class="s1">this</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}</span><span class="s1">return this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=</span><span class="s1">new </span><span class="s2">DataView</span><span class="s0">(</span><span class="s1">new </span><span class="s2">ArrayBuffer</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">write</span><span class="s0">),</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">getUint8</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s3">&quot;0&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">DataBuffer</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">length</span><span class="s0">());</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">===(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;utf8&quot;</span><span class="s0">)||</span><span class="s3">&quot;raw&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">raw</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;hex&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">hex</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;base64&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base64</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf8</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;utf16&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf16</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid encoding: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;raw&quot;</span><span class="s0">,</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s1">new </span><span class="s2">i</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">),(</span><span class="s2">t</span><span class="s0">&gt;&gt;&gt;=</span><span class="s4">1</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">,++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)^</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">o</span><span class="s0">&gt;=</span><span class="s4">10</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),++</span><span class="s2">o</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s4">16</span><span class="s0">)));</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">)</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">16</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">int32ToBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=[</span><span class="s4">62</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,</span><span class="s4">63</span><span class="s0">,</span><span class="s4">52</span><span class="s0">,</span><span class="s4">53</span><span class="s0">,</span><span class="s4">54</span><span class="s0">,</span><span class="s4">55</span><span class="s0">,</span><span class="s4">56</span><span class="s0">,</span><span class="s4">57</span><span class="s0">,</span><span class="s4">58</span><span class="s0">,</span><span class="s4">59</span><span class="s0">,</span><span class="s4">60</span><span class="s0">,</span><span class="s4">61</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">18</span><span class="s0">,</span><span class="s4">19</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">21</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">24</span><span class="s0">,</span><span class="s4">25</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,-</span><span class="s4">1</span><span class="s0">,</span><span class="s4">26</span><span class="s0">,</span><span class="s4">27</span><span class="s0">,</span><span class="s4">28</span><span class="s0">,</span><span class="s4">29</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">33</span><span class="s0">,</span><span class="s4">34</span><span class="s0">,</span><span class="s4">35</span><span class="s0">,</span><span class="s4">36</span><span class="s0">,</span><span class="s4">37</span><span class="s0">,</span><span class="s4">38</span><span class="s0">,</span><span class="s4">39</span><span class="s0">,</span><span class="s4">40</span><span class="s0">,</span><span class="s4">41</span><span class="s0">,</span><span class="s4">42</span><span class="s0">,</span><span class="s4">43</span><span class="s0">,</span><span class="s4">44</span><span class="s0">,</span><span class="s4">45</span><span class="s0">,</span><span class="s4">46</span><span class="s0">,</span><span class="s4">47</span><span class="s0">,</span><span class="s4">48</span><span class="s0">,</span><span class="s4">49</span><span class="s0">,</span><span class="s4">50</span><span class="s0">,</span><span class="s4">51</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=</span><span class="s3">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span><span class="s0">;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">++),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">++),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">++),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;&gt;</span><span class="s4">2</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">((</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)&lt;&lt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;</span><span class="s4">4</span><span class="s0">),</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;==&quot;</span><span class="s0">:(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">((</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">)&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;</span><span class="s4">6</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)?</span><span class="s3">&quot;=&quot;</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">t</span><span class="s0">));</span><span class="s1">return </span><span class="s2">s</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decode64</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/[^A-Za-z0-9\+\/\=]/g</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">r</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">r</span><span class="s0">&gt;&gt;</span><span class="s4">4</span><span class="s0">),</span><span class="s4">64</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">((</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)&lt;&lt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;</span><span class="s4">2</span><span class="s0">),</span><span class="s4">64</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">((</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">)&lt;&lt;</span><span class="s4">6</span><span class="s0">|</span><span class="s2">n</span><span class="s0">)));</span><span class="s1">return </span><span class="s2">i</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">unescape</span><span class="s0">(</span><span class="s2">encodeURIComponent</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decodeUtf8</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">decodeURIComponent</span><span class="s0">(</span><span class="s2">escape</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">={</span><span class="s2">raw</span><span class="s0">:{},</span><span class="s2">hex</span><span class="s0">:{},</span><span class="s2">base64</span><span class="s0">:{},</span><span class="s2">base58</span><span class="s0">:{},</span><span class="s2">baseN</span><span class="s0">:{</span><span class="s2">encode</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">,</span><span class="s2">decode</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">raw</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">raw</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">++]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">-</span><span class="s2">r</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">hex</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">hex</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">2</span><span class="s0">)));</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">++]=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s4">16</span><span class="s0">));</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">++]=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">16</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">i</span><span class="s0">-</span><span class="s2">r</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base64</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">byteLength</span><span class="s0">;)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">++],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">++],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">++],</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;&gt;</span><span class="s4">2</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">((</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)&lt;&lt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;</span><span class="s4">4</span><span class="s0">),</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;==&quot;</span><span class="s0">:(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">((</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">)&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;</span><span class="s4">6</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)?</span><span class="s3">&quot;=&quot;</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">t</span><span class="s0">));</span><span class="s1">return </span><span class="s2">s</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base64</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">o</span><span class="s0">||(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s4">3</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">4</span><span class="s0">))),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/[^A-Za-z0-9\+\/\=]/g</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">++)-</span><span class="s4">43</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s2">l</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;</span><span class="s4">4</span><span class="s0">,</span><span class="s4">64</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">[</span><span class="s2">l</span><span class="s0">++]=(</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">)&lt;&lt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;</span><span class="s4">2</span><span class="s0">,</span><span class="s4">64</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">[</span><span class="s2">l</span><span class="s0">++]=(</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">i</span><span class="s0">)&lt;&lt;</span><span class="s4">6</span><span class="s0">|</span><span class="s2">s</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">l</span><span class="s0">-</span><span class="s2">r</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">subarray</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base58</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">baseN</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">base58</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">binary</span><span class="s0">.</span><span class="s2">baseN</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">={</span><span class="s2">utf8</span><span class="s0">:{},</span><span class="s2">utf16</span><span class="s0">:{}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf8</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">++]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">-</span><span class="s2">r</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf8</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">decodeUtf8</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf16</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s4">2</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint16Array</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">++]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">i</span><span class="s0">-</span><span class="s2">r</span><span class="s0">:</span><span class="s2">a</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">text</span><span class="s0">.</span><span class="s2">utf16</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">new </span><span class="s2">Uint16Array</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">buffer</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">deflate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decode64</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">deflate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)).</span><span class="s2">rval</span><span class="s0">),</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s4">32</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">6</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">4</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">inflate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">inflate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)).</span><span class="s2">rval</span><span class="s0">;</span><span class="s1">return null</span><span class="s0">===</span><span class="s2">a</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decode64</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;WebStorage not available.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">removeItem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">stringify</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setItem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rval</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">message</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">n</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">n</span><span class="s0">}},</span><span class="s2">f</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;WebStorage not available.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getItem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">init</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rval</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">error</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">message</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">error</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">a</span><span class="s0">}</span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s1">else </span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rval</span><span class="s0">;</span><span class="s1">return null</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">JSON</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decode64</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">h</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">null</span><span class="s0">===</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">={}),</span><span class="s2">n</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)},</span><span class="s2">d</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return null</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r </span><span class="s1">in </span><span class="s2">a</span><span class="s0">?</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">),</span><span class="s2">a</span><span class="s0">},</span><span class="s2">y</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">r </span><span class="s1">in </span><span class="s2">a</span><span class="s0">){</span><span class="s1">delete </span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s1">in </span><span class="s2">a</span><span class="s0">){</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}},</span><span class="s2">g</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s1">null</span><span class="s0">)},</span><span class="s2">v</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=[</span><span class="s3">&quot;web&quot;</span><span class="s0">,</span><span class="s3">&quot;flash&quot;</span><span class="s0">]);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o </span><span class="s1">in </span><span class="s2">r</span><span class="s0">){</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">o</span><span class="s0">];</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;flash&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">||</span><span class="s3">&quot;both&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Flash local storage not available.&quot;</span><span class="s0">);</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;flash&quot;</span><span class="s0">===</span><span class="s2">a</span><span class="s0">}</span><span class="s3">&quot;web&quot;</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;both&quot;</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">localStorage</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">;</span><span class="s1">return </span><span class="s2">n</span><span class="s0">};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setItem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s2">v</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getItem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">return </span><span class="s2">v</span><span class="s0">(</span><span class="s2">d</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">removeItem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s2">v</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">clearItems</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">v</span><span class="s0">(</span><span class="s2">g</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">isEmpty</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">format</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s5">/%./g</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);){(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">lastIndex</span><span class="s0">-</span><span class="s4">2</span><span class="s0">)).</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">lastIndex</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">1</span><span class="s0">];</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">o</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;s&quot;</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;o&quot;</span><span class="s0">:</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">+</span><span class="s2">n</span><span class="s0">++]):</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&lt;?&gt;&quot;</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;%&quot;</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;%&quot;</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&lt;%&quot;</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;?&gt;&quot;</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatNumber</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))?</span><span class="s4">2</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?</span><span class="s3">&quot;,&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">?</span><span class="s3">&quot;.&quot;</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s3">&quot;-&quot;</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(+</span><span class="s2">n</span><span class="s0">||</span><span class="s4">0</span><span class="s0">).</span><span class="s2">toFixed</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)+</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">3</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">%</span><span class="s4">3</span><span class="s0">:</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">c</span><span class="s0">+(</span><span class="s2">l</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)+</span><span class="s2">o</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s2">u</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">l</span><span class="s0">).</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/(\d{3})(?=\d)/g</span><span class="s0">,</span><span class="s3">&quot;$1&quot;</span><span class="s0">+</span><span class="s2">o</span><span class="s0">)+(</span><span class="s2">i</span><span class="s0">?</span><span class="s2">s</span><span class="s0">+</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(</span><span class="s2">n</span><span class="s0">-</span><span class="s2">u</span><span class="s0">).</span><span class="s2">toFixed</span><span class="s0">(</span><span class="s2">i</span><span class="s0">).</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">2</span><span class="s0">):</span><span class="s3">&quot;&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatSize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">1073741824</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s4">1073741824</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s3">&quot;.&quot;</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s3">&quot; GiB&quot;</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">1048576</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s3">&quot;.&quot;</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s3">&quot; MiB&quot;</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">1024</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)+</span><span class="s3">&quot; KiB&quot;</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">formatNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)+</span><span class="s3">&quot; bytes&quot;</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesFromIP</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesFromIPv4</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):-</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesFromIPv6</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s1">null</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesFromIPv4</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">!==(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)).</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s4">10</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">a</span><span class="s0">))</span><span class="s1">return null</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesFromIPv6</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">*(</span><span class="s4">8</span><span class="s0">-(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">).</span><span class="s2">filter</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;++</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">}))).</span><span class="s2">length</span><span class="s0">+</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">8</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&amp;&amp;</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">length</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">a</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToIP</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s4">4</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToIPv4</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s4">16</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToIPv6</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s1">null</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToIPv4</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToIPv6</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">16</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]+</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]);</span><span class="s3">&quot;0&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;&amp;</span><span class="s3">&quot;0&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">;)</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;0&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">end</span><span class="s0">+</span><span class="s4">1</span><span class="s0">?(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">end</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">end</span><span class="s0">-</span><span class="s2">o</span><span class="s0">.</span><span class="s2">start</span><span class="s0">&gt;</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">end</span><span class="s0">-</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">start</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">start</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">end</span><span class="s0">:</span><span class="s2">c</span><span class="s0">})}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s2">u</span><span class="s0">.</span><span class="s2">end</span><span class="s0">-</span><span class="s2">u</span><span class="s0">.</span><span class="s2">start</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">start</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">end</span><span class="s0">-</span><span class="s2">u</span><span class="s0">.</span><span class="s2">start</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">start</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">unshift</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s4">7</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">end</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;:&quot;</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">estimateCores</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">={}),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s3">&quot;cores&quot;</span><span class="s1">in </span><span class="s2">i</span><span class="s0">&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">navigator</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;hardwareConcurrency&quot;</span><span class="s1">in </span><span class="s2">navigator</span><span class="s0">&amp;&amp;</span><span class="s2">navigator</span><span class="s0">.</span><span class="s2">hardwareConcurrency</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">=</span><span class="s2">navigator</span><span class="s0">.</span><span class="s2">hardwareConcurrency</span><span class="s0">,</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">Worker</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">Blob</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">URL</span><span class="s0">.</span><span class="s2">createObjectURL</span><span class="s0">(</span><span class="s1">new </span><span class="s2">Blob</span><span class="s0">([</span><span class="s3">&quot;(&quot;</span><span class="s0">,</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">self</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">+</span><span class="s4">4</span><span class="s0">;</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">()&lt;</span><span class="s2">r</span><span class="s0">;);</span><span class="s2">self</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">({</span><span class="s2">st</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">et</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})}))}.</span><span class="s2">toString</span><span class="s0">(),</span><span class="s3">&quot;)()&quot;</span><span class="s0">],{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;application/javascript&quot;</span><span class="s0">}));!</span><span class="s1">function </span><span class="s2">e</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">+</span><span class="s2">t</span><span class="s0">}),</span><span class="s4">0</span><span class="s0">)/</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">URL</span><span class="s0">.</span><span class="s2">revokeObjectURL</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">cores</span><span class="s0">)}!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Worker</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">terminate</span><span class="s0">();</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)}})),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">postMessage</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}(</span><span class="s2">s</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&gt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">et</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&gt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">st</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">et</span><span class="s0">)&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)}),</span><span class="s4">0</span><span class="s0">)}(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)}))}([],</span><span class="s4">5</span><span class="s0">,</span><span class="s4">16</span><span class="s0">)}}).</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">r</span><span class="s0">(</span><span class="s4">34</span><span class="s0">))},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">23</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">24</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={},</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">}</span><span class="s2">r</span><span class="s0">.</span><span class="s2">formatKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">4</span><span class="s0">))[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">_expandKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">formatSeed</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">4</span><span class="s0">))[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">_updateBlock</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">increment</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">++</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">e</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">||</span><span class="s2">u</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getRandomValues</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">getRandomValues</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">usePureJavaScript</span><span class="s0">||!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">&amp;&amp;!</span><span class="s2">c</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">||</span><span class="s2">window</span><span class="s0">.</span><span class="s2">document</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">collectInt</span><span class="s0">(+</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s4">32</span><span class="s0">),</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">navigator</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f </span><span class="s1">in </span><span class="s2">navigator</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">navigator</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]&amp;&amp;(</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">navigator</span><span class="s0">[</span><span class="s2">f</span><span class="s0">])}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}</span><span class="s2">o</span><span class="s0">.</span><span class="s2">collect</span><span class="s0">(</span><span class="s2">p</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">().</span><span class="s2">mousemove</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">o</span><span class="s0">.</span><span class="s2">collectInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clientX</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">collectInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clientY</span><span class="s0">,</span><span class="s4">16</span><span class="s0">)})),</span><span class="s2">t</span><span class="s0">().</span><span class="s2">keypress</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">o</span><span class="s0">.</span><span class="s2">collectInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCode</span><span class="s0">,</span><span class="s4">8</span><span class="s0">)})))}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f </span><span class="s1">in </span><span class="s2">o</span><span class="s0">)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">];</span><span class="s1">else </span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">=</span><span class="s2">o</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">createInstance</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">}(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">jQuery</span><span class="s0">?</span><span class="s2">jQuery</span><span class="s0">:</span><span class="s1">null</span><span class="s0">)},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Too few bytes to parse DER.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">available</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">remaining</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">requested</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">}}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">={</span><span class="s2">UNIVERSAL</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">APPLICATION</span><span class="s0">:</span><span class="s4">64</span><span class="s0">,</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">:</span><span class="s4">128</span><span class="s0">,</span><span class="s2">PRIVATE</span><span class="s0">:</span><span class="s4">192</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">={</span><span class="s2">NONE</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">BOOLEAN</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">INTEGER</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">BITSTRING</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">OCTETSTRING</span><span class="s0">:</span><span class="s4">4</span><span class="s0">,</span><span class="s2">NULL</span><span class="s0">:</span><span class="s4">5</span><span class="s0">,</span><span class="s2">OID</span><span class="s0">:</span><span class="s4">6</span><span class="s0">,</span><span class="s2">ODESC</span><span class="s0">:</span><span class="s4">7</span><span class="s0">,</span><span class="s2">EXTERNAL</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s2">REAL</span><span class="s0">:</span><span class="s4">9</span><span class="s0">,</span><span class="s2">ENUMERATED</span><span class="s0">:</span><span class="s4">10</span><span class="s0">,</span><span class="s2">EMBEDDED</span><span class="s0">:</span><span class="s4">11</span><span class="s0">,</span><span class="s2">UTF8</span><span class="s0">:</span><span class="s4">12</span><span class="s0">,</span><span class="s2">ROID</span><span class="s0">:</span><span class="s4">13</span><span class="s0">,</span><span class="s2">SEQUENCE</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s2">SET</span><span class="s0">:</span><span class="s4">17</span><span class="s0">,</span><span class="s2">PRINTABLESTRING</span><span class="s0">:</span><span class="s4">19</span><span class="s0">,</span><span class="s2">IA5STRING</span><span class="s0">:</span><span class="s4">22</span><span class="s0">,</span><span class="s2">UTCTIME</span><span class="s0">:</span><span class="s4">23</span><span class="s0">,</span><span class="s2">GENERALIZEDTIME</span><span class="s0">:</span><span class="s4">24</span><span class="s0">,</span><span class="s2">BMPSTRING</span><span class="s0">:</span><span class="s4">30</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=[],</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]);</span><span class="s2">i</span><span class="s0">=</span><span class="s2">o</span><span class="s0">}</span><span class="s1">var </span><span class="s2">u</span><span class="s0">={</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">composed</span><span class="s0">:</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">value</span><span class="s0">:</span><span class="s2">i</span><span class="s0">};</span><span class="s1">return </span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;bitStringContents&quot;</span><span class="s1">in </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">original</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">t</span><span class="s0">));</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}</span><span class="s1">return</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">:(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">,</span><span class="s2">composed</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">&amp;&amp;!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">excludeBitStringContents</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">),</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">equals</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">equals</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">t</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">equals</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">includeBitStringContents</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">),</span><span class="s2">s</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getBerValueLength</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">128</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">((</span><span class="s4">127</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">)&lt;&lt;</span><span class="s4">3</span><span class="s0">):</span><span class="s2">t</span><span class="s0">};</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">strict</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">parseAllBytes</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">decodeBitStrings</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s3">&quot;boolean&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">strict</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">parseAllBytes</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">decodeBitStrings</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s3">&quot;strict&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;parseAllBytes&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">parseAllBytes</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;decodeBitStrings&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decodeBitStrings</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s1">function </span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">;</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s4">2</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s2">r</span><span class="s0">--;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">192</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s4">31</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">;</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">var </span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">--,</span><span class="s4">128</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">127</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">;</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Negative length: &quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}}(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">-=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">&amp;&amp;</span><span class="s2">h</span><span class="s0">&gt;</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Too few bytes to read ASN.1 value.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">d</span><span class="s0">.</span><span class="s2">available</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">d</span><span class="s0">.</span><span class="s2">remaining</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">d</span><span class="s0">.</span><span class="s2">requested</span><span class="s0">=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">}</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">}</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s4">32</span><span class="s0">==(</span><span class="s4">32</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">y</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">=[],</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">h</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(;;){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)===</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">-=</span><span class="s4">2</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">-=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()}</span><span class="s1">else for</span><span class="s0">(;</span><span class="s2">h</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">a</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">-=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">-=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">p</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">&amp;&amp;(</span><span class="s2">f</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(</span><span class="s2">h</span><span class="s0">));</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">p</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">decodeBitStrings</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">&amp;&amp;</span><span class="s2">h</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">){</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s4">1</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">--),</span><span class="s4">0</span><span class="s0">===</span><span class="s2">m</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">var </span><span class="s2">C</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,{</span><span class="s2">strict</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">decodeBitStrings</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">r</span><span class="s0">-=</span><span class="s2">E</span><span class="s0">,</span><span class="s2">l</span><span class="s0">==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">&amp;&amp;</span><span class="s2">E</span><span class="s0">++;</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">C</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">;</span><span class="s2">E</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">||</span><span class="s2">S</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">&amp;&amp;</span><span class="s2">S</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">||(</span><span class="s2">p</span><span class="s0">=[</span><span class="s2">C</span><span class="s0">])}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">p</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">v</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">p</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">h</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">strict</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Non-constructed ASN.1 object of indefinite length.&quot;</span><span class="s0">);</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BMPSTRING</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">p</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s2">h</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">h</span><span class="s0">-=</span><span class="s4">2</span><span class="s0">)</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">-=</span><span class="s4">2</span><span class="s0">;</span><span class="s1">else </span><span class="s2">p</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">h</span><span class="s0">),</span><span class="s2">r</span><span class="s0">-=</span><span class="s2">h</span><span class="s0">}</span><span class="s1">var </span><span class="s2">T</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:{</span><span class="s2">bitStringContents</span><span class="s0">:</span><span class="s2">f</span><span class="s0">};</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">T</span><span class="s0">)}(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">parseAllBytes</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unparsed DER bytes remain after ASN.1 parsing.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">byteCount</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">remaining</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">}</span><span class="s1">return </span><span class="s2">s</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">|</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;bitStringContents&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">original</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">equals</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">original</span><span class="s0">))),</span><span class="s2">s</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">?</span><span class="s2">r</span><span class="s0">|=</span><span class="s4">32</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]))}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BMPSTRING</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">));</span><span class="s1">else </span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;&amp;</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">))||</span><span class="s4">255</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;&amp;</span><span class="s4">128</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)))?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)):</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;=</span><span class="s4">127</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">127</span><span class="s0">&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">());</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">),</span><span class="s2">c</span><span class="s0">&gt;&gt;&gt;=</span><span class="s4">8</span><span class="s0">}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">c</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">128</span><span class="s0">|</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">o</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">o</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">40</span><span class="s0">*</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s4">10</span><span class="s0">)+</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s4">10</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">c</span><span class="s0">],</span><span class="s4">10</span><span class="s0">);</span><span class="s1">do</span><span class="s0">{</span><span class="s2">i</span><span class="s0">=</span><span class="s4">127</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;=</span><span class="s4">7</span><span class="s0">,</span><span class="s2">t</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">|=</span><span class="s4">128</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">u</span><span class="s0">)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">u</span><span class="s0">])}</span><span class="s1">return </span><span class="s2">o</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">r</span><span class="s0">/</span><span class="s4">40</span><span class="s0">)+</span><span class="s3">&quot;.&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">%</span><span class="s4">40</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">n</span><span class="s0">&lt;&lt;=</span><span class="s4">7</span><span class="s0">,</span><span class="s4">128</span><span class="s0">&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">())?</span><span class="s2">n</span><span class="s0">+=</span><span class="s4">127</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;.&quot;</span><span class="s0">+(</span><span class="s2">n</span><span class="s0">+</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">utcTimeToDate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">);</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">50</span><span class="s0">?</span><span class="s4">1900</span><span class="s0">+</span><span class="s2">r</span><span class="s0">:</span><span class="s4">2e3</span><span class="s0">+</span><span class="s2">r</span><span class="s0">;</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">2</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">6</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">8</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">11</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">10</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">10</span><span class="s0">;</span><span class="s3">&quot;+&quot;</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;-&quot;</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">10</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">u</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setUTCFullYear</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setUTCHours</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s2">u</span><span class="s0">&amp;&amp;(</span><span class="s3">&quot;+&quot;</span><span class="s0">===(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">u</span><span class="s0">))||</span><span class="s3">&quot;-&quot;</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">60</span><span class="s0">*</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)+</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">);</span><span class="s2">l</span><span class="s0">*=</span><span class="s4">6e4</span><span class="s0">,</span><span class="s3">&quot;+&quot;</span><span class="s0">===</span><span class="s2">c</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setTime</span><span class="s0">(+</span><span class="s2">t</span><span class="s0">-</span><span class="s2">l</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setTime</span><span class="s0">(+</span><span class="s2">t</span><span class="s0">+</span><span class="s2">l</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generalizedTimeToDate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">6</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">8</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">10</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">12</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s3">&quot;Z&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)&amp;&amp;(</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">5</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">p</span><span class="s0">);</span><span class="s3">&quot;+&quot;</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;-&quot;</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">||(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">60</span><span class="s0">*</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">p</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)+</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">p</span><span class="s0">+</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s4">10</span><span class="s0">),</span><span class="s2">u</span><span class="s0">*=</span><span class="s4">6e4</span><span class="s0">,</span><span class="s3">&quot;+&quot;</span><span class="s0">===</span><span class="s2">f</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">*=-</span><span class="s4">1</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return</span><span class="s3">&quot;.&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">14</span><span class="s0">)&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">1e3</span><span class="s0">*</span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">14</span><span class="s0">),</span><span class="s4">10</span><span class="s0">)),</span><span class="s2">l</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setUTCFullYear</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setUTCHours</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setTime</span><span class="s0">(+</span><span class="s2">t</span><span class="s0">+</span><span class="s2">u</span><span class="s0">)):(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setFullYear</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">setHours</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToUtcTime</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">((</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCFullYear</span><span class="s0">()).</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCMonth</span><span class="s0">()+</span><span class="s4">1</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCDate</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCHours</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCMinutes</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCSeconds</span><span class="s0">());</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;0&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s1">return </span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;Z&quot;</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToGeneralizedTime</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCFullYear</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCMonth</span><span class="s0">()+</span><span class="s4">1</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCDate</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCHours</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCMinutes</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getUTCSeconds</span><span class="s0">());</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;0&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">];</span><span class="s1">return </span><span class="s2">t</span><span class="s0">+=</span><span class="s3">&quot;Z&quot;</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;=-</span><span class="s4">128</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">128</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">8</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;=-</span><span class="s4">32768</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">32768</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">16</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;=-</span><span class="s4">8388608</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">8388608</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">24</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;=-</span><span class="s4">2147483648</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">2147483648</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putSignedInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">32</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Integer too large; max is 32-bits.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">integer</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToInteger</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">32</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Integer too large; max is 32-bits.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSignedInt</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">+</span><span class="s3">'] Expected tag class &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">+</span><span class="s3">'&quot;, got &quot;'</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">+</span><span class="s3">'&quot;'</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">+</span><span class="s3">'] Expected type &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">'&quot;, got &quot;'</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">'&quot;'</span><span class="s0">));</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">optional</span><span class="s0">||!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]&amp;&amp;((</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">o</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">c</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">))?++</span><span class="s2">o</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">optional</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">)),!</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">+</span><span class="s3">'] Tag class &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">+</span><span class="s3">'&quot;, type &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">'&quot; expected value length &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s3">'&quot;, got &quot;'</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s3">'&quot;'</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">capture</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">capture</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureAsn1</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureAsn1</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureBitStringContents</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;bitStringContents&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureBitStringContents</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureBitStringValue</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;bitStringContents&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureBitStringValue</span><span class="s0">]=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;captureBitStringValue only supported for zero unused bits&quot;</span><span class="s0">);</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">captureBitStringValue</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitStringContents</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)}}</span><span class="s1">else </span><span class="s2">i</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s3">&quot;[&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">+</span><span class="s3">'] Expected constructed &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">+</span><span class="s3">'&quot;, got &quot;'</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">+</span><span class="s3">'&quot;'</span><span class="s0">);</span><span class="s1">return </span><span class="s2">s</span><span class="s0">};</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s5">/[^\\u0000-\\u00ff]/</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prettyPrint</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s4">2</span><span class="s0">,(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s4">0</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">*</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">o</span><span class="s0">+=</span><span class="s3">&quot; &quot;</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;Tag: &quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">){</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;Universal:&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">APPLICATION</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;Application:&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;Context-Specific:&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">PRIVATE</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;Private:&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">)</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NONE</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (None)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BOOLEAN</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Boolean)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Integer)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Bit string)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Octet string)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Null)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Object Identifier)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">ODESC</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Object Descriptor)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">EXTERNAL</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (External or Instance of)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">REAL</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Real)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">ENUMERATED</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Enumerated)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">EMBEDDED</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Embedded PDV)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTF8</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (UTF8)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">ROID</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Relative Object Identifier)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Sequence)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Set)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">PRINTABLESTRING</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Printable String)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">IA5String</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (IA5String (ASCII))&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTCTIME</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (UTC time)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">GENERALIZEDTIME</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (Generalized time)&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BMPSTRING</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (BMP String)&quot;</span><span class="s0">}</span><span class="s1">else </span><span class="s2">i</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;Constructed: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]&amp;&amp;(</span><span class="s2">u</span><span class="s0">+=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prettyPrint</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">c</span><span class="s0">],</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">c</span><span class="s0">+</span><span class="s4">1</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">l</span><span class="s0">+=</span><span class="s3">&quot;,&quot;</span><span class="s0">));</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;Sub values: &quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">+</span><span class="s2">l</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">+</span><span class="s3">&quot;Value: &quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">&amp;&amp;</span><span class="s2">p </span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]+</span><span class="s3">&quot;) &quot;</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToInteger</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;0x&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;0x&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)):</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;(none)&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s4">1</span><span class="s0">==</span><span class="s2">f</span><span class="s0">?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (1 unused bit shown)&quot;</span><span class="s0">:</span><span class="s2">f</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot; (&quot;</span><span class="s0">+</span><span class="s2">f</span><span class="s0">+</span><span class="s3">&quot; unused bits shown)&quot;</span><span class="s0">)}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">)</span><span class="s2">s</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)||(</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;(&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">+</span><span class="s3">&quot;) &quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;0x&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTF8</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">decodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;URI malformed&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">message</span><span class="s0">)</span><span class="s1">throw </span><span class="s2">t</span><span class="s0">;</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;0x&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)+</span><span class="s3">&quot; (malformed UTF8)&quot;</span><span class="s0">}</span><span class="s1">else </span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">PRINTABLESTRING</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">IA5String</span><span class="s0">?</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;0x&quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">):</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">+=</span><span class="s3">&quot;[null]&quot;</span><span class="s0">:</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">||{}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">function </span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">registerAlgorithm</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}))}</span><span class="s2">r</span><span class="s0">(</span><span class="s4">13</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">19</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">startEncrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">a</span><span class="s0">});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">startDecrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">a</span><span class="s0">});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">l</span><span class="s0">||</span><span class="s2">p</span><span class="s0">();</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s1">new </span><span class="s2">t</span><span class="s0">({</span><span class="s2">blockSize</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s2">cipher</span><span class="s0">:{</span><span class="s2">encrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_w</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_w</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)}}}),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">initialize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">||</span><span class="s4">16</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s4">24</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s4">32</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s4">16</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||</span><span class="s4">24</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">||</span><span class="s4">32</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])}}</span><span class="s1">else </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">16</span><span class="s0">===</span><span class="s2">i</span><span class="s0">||</span><span class="s4">24</span><span class="s0">===</span><span class="s2">i</span><span class="s0">||</span><span class="s4">32</span><span class="s0">===</span><span class="s2">i</span><span class="s0">){</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;=</span><span class="s4">2</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">())}}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)||</span><span class="s4">4</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s4">6</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s4">8</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid key parameter.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">name</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">!==[</span><span class="s3">&quot;CFB&quot;</span><span class="s0">,</span><span class="s3">&quot;OFB&quot;</span><span class="s0">,</span><span class="s3">&quot;CTR&quot;</span><span class="s0">,</span><span class="s3">&quot;GCM&quot;</span><span class="s0">].</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_w</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">&amp;&amp;!</span><span class="s2">o</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">_expandKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">l</span><span class="s0">||</span><span class="s2">p</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">_updateBlock</span><span class="s0">=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-ECB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-CBC&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-CFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-OFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-CTR&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;AES-GCM&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">p</span><span class="s0">(){</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">27</span><span class="s0">,</span><span class="s4">54</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">256</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">128</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">+</span><span class="s4">128</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">+</span><span class="s4">128</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">^</span><span class="s4">283</span><span class="s0">;</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">256</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">256</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">4</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">c</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">256</span><span class="s0">),</span><span class="s2">u</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">256</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">256</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s2">p</span><span class="s0">=(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">g</span><span class="s0">^</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">^</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">^</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">^</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">4</span><span class="s0">)&gt;&gt;</span><span class="s4">8</span><span class="s0">^</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">p</span><span class="s0">^</span><span class="s4">99</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s2">y</span><span class="s0">]=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">s</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=(</span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">p</span><span class="s0">])&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">p</span><span class="s0">&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">p</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">p</span><span class="s0">^</span><span class="s2">f</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=((</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">y</span><span class="s0">])^(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">])^(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]))&lt;&lt;</span><span class="s4">24</span><span class="s0">^(</span><span class="s2">y</span><span class="s0">^</span><span class="s2">n</span><span class="s0">)&lt;&lt;</span><span class="s4">16</span><span class="s0">^(</span><span class="s2">y</span><span class="s0">^</span><span class="s2">a</span><span class="s0">^</span><span class="s2">n</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">y</span><span class="s0">^</span><span class="s2">r</span><span class="s0">^</span><span class="s2">n</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">v</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;++</span><span class="s2">v</span><span class="s0">)</span><span class="s2">c</span><span class="s0">[</span><span class="s2">v</span><span class="s0">][</span><span class="s2">y</span><span class="s0">]=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">u</span><span class="s0">[</span><span class="s2">v</span><span class="s0">][</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">24</span><span class="s0">|</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">d</span><span class="s0">&lt;&lt;</span><span class="s4">24</span><span class="s0">|</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">y</span><span class="s0">?</span><span class="s2">y</span><span class="s0">=</span><span class="s2">g</span><span class="s0">=</span><span class="s4">1</span><span class="s0">:(</span><span class="s2">y</span><span class="s0">=</span><span class="s2">r</span><span class="s0">^</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">^</span><span class="s2">n</span><span class="s0">]]],</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">[</span><span class="s2">g</span><span class="s0">]])}}</span><span class="s1">function </span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">4</span><span class="s0">*(</span><span class="s2">s</span><span class="s0">+</span><span class="s4">6</span><span class="s0">+</span><span class="s4">1</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">;</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">;++</span><span class="s2">l</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">l</span><span class="s0">-</span><span class="s4">1</span><span class="s0">],</span><span class="s2">l</span><span class="s0">%</span><span class="s2">s</span><span class="s0">==</span><span class="s4">0</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]^</span><span class="s2">o</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">,</span><span class="s2">n</span><span class="s0">++):</span><span class="s2">s</span><span class="s0">&gt;</span><span class="s4">6</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">%</span><span class="s2">s</span><span class="s0">==</span><span class="s4">4</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">i</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">]),</span><span class="s2">a</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">l</span><span class="s0">-</span><span class="s2">s</span><span class="s0">]^</span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">h</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">d</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">y</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=(</span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)-</span><span class="s4">4</span><span class="s0">);</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">;</span><span class="s2">l</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">v</span><span class="s0">-=</span><span class="s4">4</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">||</span><span class="s2">l</span><span class="s0">===</span><span class="s2">c</span><span class="s0">-</span><span class="s4">4</span><span class="s0">)</span><span class="s2">g</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">v</span><span class="s0">],</span><span class="s2">g</span><span class="s0">[</span><span class="s2">l</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s4">3</span><span class="s0">],</span><span class="s2">g</span><span class="s0">[</span><span class="s2">l</span><span class="s0">+</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s4">2</span><span class="s0">],</span><span class="s2">g</span><span class="s0">[</span><span class="s2">l</span><span class="s0">+</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s4">1</span><span class="s0">];</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">m</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;++</span><span class="s2">m</span><span class="s0">)</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s2">m</span><span class="s0">],</span><span class="s2">g</span><span class="s0">[</span><span class="s2">l</span><span class="s0">+(</span><span class="s4">3</span><span class="s0">&amp;-</span><span class="s2">m</span><span class="s0">)]=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">i</span><span class="s0">[</span><span class="s2">p</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]]^</span><span class="s2">h</span><span class="s0">[</span><span class="s2">i</span><span class="s0">[</span><span class="s2">p</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]]^</span><span class="s2">d</span><span class="s0">[</span><span class="s2">i</span><span class="s0">[</span><span class="s2">p</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]]^</span><span class="s2">y</span><span class="s0">[</span><span class="s2">i</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">p</span><span class="s0">]];</span><span class="s2">a</span><span class="s0">=</span><span class="s2">g</span><span class="s0">}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">C</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">4</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">a</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">f</span><span class="s0">=</span><span class="s2">s</span><span class="s0">):(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">f</span><span class="s0">=</span><span class="s2">i</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">d</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">1</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">y</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s4">3</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">T</span><span class="s0">&lt;</span><span class="s2">E</span><span class="s0">;++</span><span class="s2">T</span><span class="s0">)</span><span class="s2">v</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]^</span><span class="s2">o</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">l</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">p</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">g</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">m</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]^</span><span class="s2">o</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">l</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">p</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">h</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]^</span><span class="s2">o</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">l</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">p</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">d</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]^</span><span class="s2">o</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">l</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]^</span><span class="s2">p</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">y</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">h</span><span class="s0">=</span><span class="s2">v</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">m</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">C</span><span class="s0">;</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">g</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">h</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">d</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">[</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">f</span><span class="s0">[</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">y</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">[++</span><span class="s2">S</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;AES-&quot;</span><span class="s0">+((</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{}).</span><span class="s2">mode</span><span class="s0">||</span><span class="s3">&quot;CBC&quot;</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createDecipher</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createCipher</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)).</span><span class="s2">start</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">r </span><span class="s1">instanceof </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">={}),(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{}).</span><span class="s2">output</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.1&quot;</span><span class="s0">,</span><span class="s3">&quot;rsaEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.4&quot;</span><span class="s0">,</span><span class="s3">&quot;md5WithRSAEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.5&quot;</span><span class="s0">,</span><span class="s3">&quot;sha1WithRSAEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.7&quot;</span><span class="s0">,</span><span class="s3">&quot;RSAES-OAEP&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.8&quot;</span><span class="s0">,</span><span class="s3">&quot;mgf1&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.9&quot;</span><span class="s0">,</span><span class="s3">&quot;pSpecified&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.10&quot;</span><span class="s0">,</span><span class="s3">&quot;RSASSA-PSS&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.11&quot;</span><span class="s0">,</span><span class="s3">&quot;sha256WithRSAEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.12&quot;</span><span class="s0">,</span><span class="s3">&quot;sha384WithRSAEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.1.13&quot;</span><span class="s0">,</span><span class="s3">&quot;sha512WithRSAEncryption&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.101.112&quot;</span><span class="s0">,</span><span class="s3">&quot;EdDSA25519&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.10040.4.3&quot;</span><span class="s0">,</span><span class="s3">&quot;dsa-with-sha1&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.14.3.2.7&quot;</span><span class="s0">,</span><span class="s3">&quot;desCBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.14.3.2.26&quot;</span><span class="s0">,</span><span class="s3">&quot;sha1&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.14.3.2.29&quot;</span><span class="s0">,</span><span class="s3">&quot;sha1WithRSASignature&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.1&quot;</span><span class="s0">,</span><span class="s3">&quot;sha256&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.2&quot;</span><span class="s0">,</span><span class="s3">&quot;sha384&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.3&quot;</span><span class="s0">,</span><span class="s3">&quot;sha512&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.4&quot;</span><span class="s0">,</span><span class="s3">&quot;sha224&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.5&quot;</span><span class="s0">,</span><span class="s3">&quot;sha512-224&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.2.6&quot;</span><span class="s0">,</span><span class="s3">&quot;sha512-256&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.2&quot;</span><span class="s0">,</span><span class="s3">&quot;md2&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.5&quot;</span><span class="s0">,</span><span class="s3">&quot;md5&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.1&quot;</span><span class="s0">,</span><span class="s3">&quot;data&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.2&quot;</span><span class="s0">,</span><span class="s3">&quot;signedData&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.3&quot;</span><span class="s0">,</span><span class="s3">&quot;envelopedData&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.4&quot;</span><span class="s0">,</span><span class="s3">&quot;signedAndEnvelopedData&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.5&quot;</span><span class="s0">,</span><span class="s3">&quot;digestedData&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.7.6&quot;</span><span class="s0">,</span><span class="s3">&quot;encryptedData&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.1&quot;</span><span class="s0">,</span><span class="s3">&quot;emailAddress&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.2&quot;</span><span class="s0">,</span><span class="s3">&quot;unstructuredName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.3&quot;</span><span class="s0">,</span><span class="s3">&quot;contentType&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.4&quot;</span><span class="s0">,</span><span class="s3">&quot;messageDigest&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.5&quot;</span><span class="s0">,</span><span class="s3">&quot;signingTime&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.6&quot;</span><span class="s0">,</span><span class="s3">&quot;counterSignature&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.7&quot;</span><span class="s0">,</span><span class="s3">&quot;challengePassword&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.8&quot;</span><span class="s0">,</span><span class="s3">&quot;unstructuredAddress&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.14&quot;</span><span class="s0">,</span><span class="s3">&quot;extensionRequest&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.20&quot;</span><span class="s0">,</span><span class="s3">&quot;friendlyName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.21&quot;</span><span class="s0">,</span><span class="s3">&quot;localKeyId&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.9.22.1&quot;</span><span class="s0">,</span><span class="s3">&quot;x509Certificate&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.1&quot;</span><span class="s0">,</span><span class="s3">&quot;keyBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.2&quot;</span><span class="s0">,</span><span class="s3">&quot;pkcs8ShroudedKeyBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.3&quot;</span><span class="s0">,</span><span class="s3">&quot;certBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.4&quot;</span><span class="s0">,</span><span class="s3">&quot;crlBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.5&quot;</span><span class="s0">,</span><span class="s3">&quot;secretBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.10.1.6&quot;</span><span class="s0">,</span><span class="s3">&quot;safeContentsBag&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.5.13&quot;</span><span class="s0">,</span><span class="s3">&quot;pkcs5PBES2&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.5.12&quot;</span><span class="s0">,</span><span class="s3">&quot;pkcs5PBKDF2&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.1&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd128BitRC4&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.2&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd40BitRC4&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.3&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.4&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd2-KeyTripleDES-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.5&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd128BitRC2-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.1.12.1.6&quot;</span><span class="s0">,</span><span class="s3">&quot;pbewithSHAAnd40BitRC2-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.7&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.8&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA224&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.9&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA256&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.10&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA384&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.2.11&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA512&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.2.840.113549.3.7&quot;</span><span class="s0">,</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.1.2&quot;</span><span class="s0">,</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.1.22&quot;</span><span class="s0">,</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.101.3.4.1.42&quot;</span><span class="s0">,</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.3&quot;</span><span class="s0">,</span><span class="s3">&quot;commonName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.4&quot;</span><span class="s0">,</span><span class="s3">&quot;surname&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.5&quot;</span><span class="s0">,</span><span class="s3">&quot;serialNumber&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.6&quot;</span><span class="s0">,</span><span class="s3">&quot;countryName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.7&quot;</span><span class="s0">,</span><span class="s3">&quot;localityName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.8&quot;</span><span class="s0">,</span><span class="s3">&quot;stateOrProvinceName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.9&quot;</span><span class="s0">,</span><span class="s3">&quot;streetAddress&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.10&quot;</span><span class="s0">,</span><span class="s3">&quot;organizationName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.11&quot;</span><span class="s0">,</span><span class="s3">&quot;organizationalUnitName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.12&quot;</span><span class="s0">,</span><span class="s3">&quot;title&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.13&quot;</span><span class="s0">,</span><span class="s3">&quot;description&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.15&quot;</span><span class="s0">,</span><span class="s3">&quot;businessCategory&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.17&quot;</span><span class="s0">,</span><span class="s3">&quot;postalCode&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.4.42&quot;</span><span class="s0">,</span><span class="s3">&quot;givenName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.4.1.311.60.2.1.2&quot;</span><span class="s0">,</span><span class="s3">&quot;jurisdictionOfIncorporationStateOrProvinceName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.4.1.311.60.2.1.3&quot;</span><span class="s0">,</span><span class="s3">&quot;jurisdictionOfIncorporationCountryName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.113730.1.1&quot;</span><span class="s0">,</span><span class="s3">&quot;nsCertType&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.16.840.1.113730.1.13&quot;</span><span class="s0">,</span><span class="s3">&quot;nsComment&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.1&quot;</span><span class="s0">,</span><span class="s3">&quot;authorityKeyIdentifier&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.2&quot;</span><span class="s0">,</span><span class="s3">&quot;keyAttributes&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.3&quot;</span><span class="s0">,</span><span class="s3">&quot;certificatePolicies&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.4&quot;</span><span class="s0">,</span><span class="s3">&quot;keyUsageRestriction&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.5&quot;</span><span class="s0">,</span><span class="s3">&quot;policyMapping&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.6&quot;</span><span class="s0">,</span><span class="s3">&quot;subtreesConstraint&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.7&quot;</span><span class="s0">,</span><span class="s3">&quot;subjectAltName&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.8&quot;</span><span class="s0">,</span><span class="s3">&quot;issuerAltName&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.9&quot;</span><span class="s0">,</span><span class="s3">&quot;subjectDirectoryAttributes&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.10&quot;</span><span class="s0">,</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.11&quot;</span><span class="s0">,</span><span class="s3">&quot;nameConstraints&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.12&quot;</span><span class="s0">,</span><span class="s3">&quot;policyConstraints&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.13&quot;</span><span class="s0">,</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.14&quot;</span><span class="s0">,</span><span class="s3">&quot;subjectKeyIdentifier&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.15&quot;</span><span class="s0">,</span><span class="s3">&quot;keyUsage&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.16&quot;</span><span class="s0">,</span><span class="s3">&quot;privateKeyUsagePeriod&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.17&quot;</span><span class="s0">,</span><span class="s3">&quot;subjectAltName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.18&quot;</span><span class="s0">,</span><span class="s3">&quot;issuerAltName&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.19&quot;</span><span class="s0">,</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.20&quot;</span><span class="s0">,</span><span class="s3">&quot;cRLNumber&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.21&quot;</span><span class="s0">,</span><span class="s3">&quot;cRLReason&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.22&quot;</span><span class="s0">,</span><span class="s3">&quot;expirationDate&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.23&quot;</span><span class="s0">,</span><span class="s3">&quot;instructionCode&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.24&quot;</span><span class="s0">,</span><span class="s3">&quot;invalidityDate&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.25&quot;</span><span class="s0">,</span><span class="s3">&quot;cRLDistributionPoints&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.26&quot;</span><span class="s0">,</span><span class="s3">&quot;issuingDistributionPoint&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.27&quot;</span><span class="s0">,</span><span class="s3">&quot;deltaCRLIndicator&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.28&quot;</span><span class="s0">,</span><span class="s3">&quot;issuingDistributionPoint&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.29&quot;</span><span class="s0">,</span><span class="s3">&quot;certificateIssuer&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.30&quot;</span><span class="s0">,</span><span class="s3">&quot;nameConstraints&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.31&quot;</span><span class="s0">,</span><span class="s3">&quot;cRLDistributionPoints&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.32&quot;</span><span class="s0">,</span><span class="s3">&quot;certificatePolicies&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.33&quot;</span><span class="s0">,</span><span class="s3">&quot;policyMappings&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.34&quot;</span><span class="s0">,</span><span class="s3">&quot;policyConstraints&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.35&quot;</span><span class="s0">,</span><span class="s3">&quot;authorityKeyIdentifier&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.36&quot;</span><span class="s0">,</span><span class="s3">&quot;policyConstraints&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;2.5.29.37&quot;</span><span class="s0">,</span><span class="s3">&quot;extKeyUsage&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.46&quot;</span><span class="s0">,</span><span class="s3">&quot;freshestCRL&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s3">&quot;2.5.29.54&quot;</span><span class="s0">,</span><span class="s3">&quot;inhibitAnyPolicy&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.4.1.11129.2.4.2&quot;</span><span class="s0">,</span><span class="s3">&quot;timestampList&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.1.1&quot;</span><span class="s0">,</span><span class="s3">&quot;authorityInfoAccess&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.3.1&quot;</span><span class="s0">,</span><span class="s3">&quot;serverAuth&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.3.2&quot;</span><span class="s0">,</span><span class="s3">&quot;clientAuth&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.3.3&quot;</span><span class="s0">,</span><span class="s3">&quot;codeSigning&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.3.4&quot;</span><span class="s0">,</span><span class="s3">&quot;emailProtection&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s3">&quot;1.3.6.1.5.5.7.3.8&quot;</span><span class="s0">,</span><span class="s3">&quot;timeStamping&quot;</span><span class="s0">)},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">+</span><span class="s3">&quot;: &quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">a</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot; &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">values</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^(\S+\r\n)/</span><span class="s0">,</span><span class="s2">a</span><span class="s0">));</span><span class="s2">t</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">,++</span><span class="s2">i</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">65</span><span class="s0">&amp;&amp;-</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s3">&quot;,&quot;</span><span class="s0">===</span><span class="s2">o</span><span class="s0">?(++</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n </span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)):</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">-</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">,++</span><span class="s2">n</span><span class="s0">}</span><span class="s1">else</span><span class="s3">&quot; &quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&amp;&amp;</span><span class="s3">&quot;</span><span class="s1">\t</span><span class="s3">&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&amp;&amp;</span><span class="s3">&quot;,&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]||(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/^\s+/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;-----BEGIN &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">&quot;-----</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Proc-Type&quot;</span><span class="s0">,</span><span class="s2">values</span><span class="s0">:[</span><span class="s2">String</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">version</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">]})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentDomain</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Content-Domain&quot;</span><span class="s0">,</span><span class="s2">values</span><span class="s0">:[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentDomain</span><span class="s0">]})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DEK-Info&quot;</span><span class="s0">,</span><span class="s2">values</span><span class="s0">:[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">]},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">),</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">headers</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">headers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">headers</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">),</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">body</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">maxline</span><span class="s0">||</span><span class="s4">64</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">+=</span><span class="s3">&quot;-----END &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">&quot;-----</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=</span><span class="s5">/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s5">/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s5">/\r?\n/</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">exec</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span><span class="s3">&quot;NEW CERTIFICATE REQUEST&quot;</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;CERTIFICATE REQUEST&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">procType</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">contentDomain</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">dekInfo</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">headers</span><span class="s0">:[],</span><span class="s2">body</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">decode64</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">3</span><span class="s0">])};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">),</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s2">o</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">p</span><span class="s0">].</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\s+$/</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">p</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s2">h</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">h</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">h</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s5">/\s/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">d</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]))</span><span class="s1">break</span><span class="s0">;</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">h</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">y</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">values</span><span class="s0">:[]},</span><span class="s2">g</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">].</span><span class="s2">split</span><span class="s0">(</span><span class="s3">&quot;,&quot;</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">v</span><span class="s0">&lt;</span><span class="s2">g</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">v</span><span class="s0">)</span><span class="s2">y</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">g</span><span class="s0">[</span><span class="s2">v</span><span class="s0">]));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentDomain</span><span class="s0">||</span><span class="s3">&quot;Content-Domain&quot;</span><span class="s0">!==</span><span class="s2">y</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">||</span><span class="s3">&quot;DEK-Info&quot;</span><span class="s0">!==</span><span class="s2">y</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s2">u</span><span class="s0">.</span><span class="s2">headers</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">y</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">y</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid PEM formatted message. The &quot;DEK-Info&quot; header must have at least one subfield.'</span><span class="s0">);</span><span class="s2">u</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">g</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">parameters</span><span class="s0">:</span><span class="s2">g</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]||</span><span class="s1">null</span><span class="s0">}}</span><span class="s1">else </span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentDomain</span><span class="s0">=</span><span class="s2">g</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]||</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;Proc-Type&quot;</span><span class="s0">!==</span><span class="s2">y</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid PEM formatted message. The first encapsulated header must be &quot;Proc-Type&quot;.'</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">!==</span><span class="s2">y</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid PEM formatted message. The &quot;Proc-Type&quot; header must have two subfields.'</span><span class="s0">);</span><span class="s2">u</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:</span><span class="s2">g</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">type</span><span class="s0">:</span><span class="s2">g</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]}}}++</span><span class="s2">p</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;!</span><span class="s2">u</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid PEM formatted message. The &quot;DEK-Info&quot; header must be present if &quot;Proc-Type&quot; is &quot;ENCRYPTED&quot;.'</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid PEM formatted message.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">||{}).</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">={</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!((</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toLowerCase</span><span class="s0">())</span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unknown hash algorithm &quot;'</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">'&quot;'</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">create</span><span class="s0">()}</span><span class="s1">else </span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">)</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">)</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">;</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">])}</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">u</span><span class="s0">&gt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">54</span><span class="s0">^</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">92</span><span class="s0">^</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s2">u</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">54</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">92</span><span class="s0">);</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">update</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">getMac</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">bytes</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()}};</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getMac</span><span class="s0">,</span><span class="s2">i</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">s</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">128</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s4">64</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">80</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s3">&quot;sha1&quot;</span><span class="s0">,</span><span class="s2">blockLength</span><span class="s0">:</span><span class="s4">64</span><span class="s0">,</span><span class="s2">digestLength</span><span class="s0">:</span><span class="s4">20</span><span class="s0">,</span><span class="s2">messageLength</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">fullMessageLength</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">messageLengthSize</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength64</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s4">1732584193</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s4">4023233417</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s4">2562383102</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s4">271733878</span><span class="s0">,</span><span class="s2">h4</span><span class="s0">:</span><span class="s4">3285377520</span><span class="s0">},</span><span class="s2">n</span><span class="s0">}};</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">i</span><span class="s0">));</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">+=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=[</span><span class="s2">c</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">u</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]+=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">2048</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s2">u</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">l</span><span class="s0">+=(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">p</span><span class="s0">+</span><span class="s4">1</span><span class="s0">])/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">l</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">c</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">l</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">,</span><span class="s2">h4</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">};</span><span class="s2">o</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">),</span><span class="s2">h</span><span class="s0">},</span><span class="s2">n</span><span class="s0">};</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">l</span><span class="s0">&gt;=</span><span class="s4">64</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">o</span><span class="s0">^</span><span class="s2">i</span><span class="s0">&amp;(</span><span class="s2">s</span><span class="s0">^</span><span class="s2">o</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">1518500249</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">20</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">3</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">8</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">14</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">16</span><span class="s0">])&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">31</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">o</span><span class="s0">^</span><span class="s2">i</span><span class="s0">&amp;(</span><span class="s2">s</span><span class="s0">^</span><span class="s2">o</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">1518500249</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">3</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">8</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">14</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">16</span><span class="s0">])&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">31</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">s</span><span class="s0">^</span><span class="s2">o</span><span class="s0">)+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">1859775393</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">40</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">6</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">16</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">28</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">32</span><span class="s0">])&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">30</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">s</span><span class="s0">^</span><span class="s2">o</span><span class="s0">)+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">1859775393</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">60</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">6</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">16</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">28</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">32</span><span class="s0">])&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">30</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">i</span><span class="s0">&amp;</span><span class="s2">s</span><span class="s0">|</span><span class="s2">o</span><span class="s0">&amp;(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">s</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">2400959708</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">80</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">6</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">16</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">28</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">-</span><span class="s4">32</span><span class="s0">])&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">30</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">)+(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">s</span><span class="s0">^</span><span class="s2">o</span><span class="s0">)+</span><span class="s2">c</span><span class="s0">+</span><span class="s4">3395469782</span><span class="s0">+</span><span class="s2">a</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">i</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">+</span><span class="s2">n</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">+</span><span class="s2">i</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">+</span><span class="s2">s</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">+</span><span class="s2">o</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">+</span><span class="s2">c</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">-=</span><span class="s4">64</span><span class="s0">}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">function </span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">registerAlgorithm</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}))}</span><span class="s2">r</span><span class="s0">(</span><span class="s4">13</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">19</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">startEncrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">a</span><span class="s0">||(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;ECB&quot;</span><span class="s0">:</span><span class="s3">&quot;CBC&quot;</span><span class="s0">)});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">startDecrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">a</span><span class="s0">||(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;ECB&quot;</span><span class="s0">:</span><span class="s3">&quot;CBC&quot;</span><span class="s0">)});</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">d</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">output</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">mode</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s1">new </span><span class="s2">t</span><span class="s0">({</span><span class="s2">blockSize</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s2">cipher</span><span class="s0">:{</span><span class="s2">encrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_keys</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_keys</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)}}}),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">Algorithm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">initialize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;3DES&quot;</span><span class="s0">)&amp;&amp;</span><span class="s4">24</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid Triple-DES key size: &quot;</span><span class="s0">+</span><span class="s4">8</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">());</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_keys</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">536870916</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">65540</span><span class="s0">,</span><span class="s4">536936448</span><span class="s0">,</span><span class="s4">536936452</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">516</span><span class="s0">,</span><span class="s4">536871424</span><span class="s0">,</span><span class="s4">536871428</span><span class="s0">,</span><span class="s4">66048</span><span class="s0">,</span><span class="s4">66052</span><span class="s0">,</span><span class="s4">536936960</span><span class="s0">,</span><span class="s4">536936964</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">1048577</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">67108865</span><span class="s0">,</span><span class="s4">68157440</span><span class="s0">,</span><span class="s4">68157441</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">257</span><span class="s0">,</span><span class="s4">1048832</span><span class="s0">,</span><span class="s4">1048833</span><span class="s0">,</span><span class="s4">67109120</span><span class="s0">,</span><span class="s4">67109121</span><span class="s0">,</span><span class="s4">68157696</span><span class="s0">,</span><span class="s4">68157697</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">2056</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">16777224</span><span class="s0">,</span><span class="s4">16779264</span><span class="s0">,</span><span class="s4">16779272</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">2056</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">16777224</span><span class="s0">,</span><span class="s4">16779264</span><span class="s0">,</span><span class="s4">16779272</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">136314880</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">2105344</span><span class="s0">,</span><span class="s4">134225920</span><span class="s0">,</span><span class="s4">136323072</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">2228224</span><span class="s0">,</span><span class="s4">134348800</span><span class="s0">,</span><span class="s4">136445952</span><span class="s0">,</span><span class="s4">139264</span><span class="s0">,</span><span class="s4">2236416</span><span class="s0">,</span><span class="s4">134356992</span><span class="s0">,</span><span class="s4">136454144</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">262160</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">262160</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">4112</span><span class="s0">,</span><span class="s4">266256</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">4112</span><span class="s0">,</span><span class="s4">266256</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">1056</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">1056</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">33555456</span><span class="s0">,</span><span class="s4">33554464</span><span class="s0">,</span><span class="s4">33555488</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">33555456</span><span class="s0">,</span><span class="s4">33554464</span><span class="s0">,</span><span class="s4">33555488</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">268959744</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">268435458</span><span class="s0">,</span><span class="s4">524290</span><span class="s0">,</span><span class="s4">268959746</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">268959744</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">268435458</span><span class="s0">,</span><span class="s4">524290</span><span class="s0">,</span><span class="s4">268959746</span><span class="s0">],</span><span class="s2">u</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">67584</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">536936448</span><span class="s0">,</span><span class="s4">536872960</span><span class="s0">,</span><span class="s4">536938496</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">196608</span><span class="s0">,</span><span class="s4">133120</span><span class="s0">,</span><span class="s4">198656</span><span class="s0">,</span><span class="s4">537001984</span><span class="s0">,</span><span class="s4">537067520</span><span class="s0">,</span><span class="s4">537004032</span><span class="s0">,</span><span class="s4">537069568</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">262146</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">262146</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">33816576</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">33816576</span><span class="s0">,</span><span class="s4">33554434</span><span class="s0">,</span><span class="s4">33816578</span><span class="s0">,</span><span class="s4">33554434</span><span class="s0">,</span><span class="s4">33816578</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">268435464</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">268435464</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">268436480</span><span class="s0">,</span><span class="s4">1032</span><span class="s0">,</span><span class="s4">268436488</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">268436480</span><span class="s0">,</span><span class="s4">1032</span><span class="s0">,</span><span class="s4">268436488</span><span class="s0">],</span><span class="s2">f</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8224</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8224</span><span class="s0">,</span><span class="s4">1056768</span><span class="s0">,</span><span class="s4">1056800</span><span class="s0">,</span><span class="s4">1056768</span><span class="s0">,</span><span class="s4">1056800</span><span class="s0">],</span><span class="s2">h</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">16777728</span><span class="s0">,</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">18874368</span><span class="s0">,</span><span class="s4">2097664</span><span class="s0">,</span><span class="s4">18874880</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">83886080</span><span class="s0">,</span><span class="s4">67109376</span><span class="s0">,</span><span class="s4">83886592</span><span class="s0">,</span><span class="s4">69206016</span><span class="s0">,</span><span class="s4">85983232</span><span class="s0">,</span><span class="s4">69206528</span><span class="s0">,</span><span class="s4">85983744</span><span class="s0">],</span><span class="s2">d</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">134221824</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">528384</span><span class="s0">,</span><span class="s4">134742016</span><span class="s0">,</span><span class="s4">134746112</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">4112</span><span class="s0">,</span><span class="s4">134217744</span><span class="s0">,</span><span class="s4">134221840</span><span class="s0">,</span><span class="s4">524304</span><span class="s0">,</span><span class="s4">528400</span><span class="s0">,</span><span class="s4">134742032</span><span class="s0">,</span><span class="s4">134746128</span><span class="s0">],</span><span class="s2">y</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">260</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">260</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">257</span><span class="s0">,</span><span class="s4">261</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">257</span><span class="s0">,</span><span class="s4">261</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">8</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=[],</span><span class="s2">m</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">C</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">E</span><span class="s0">&lt;</span><span class="s2">g</span><span class="s0">;</span><span class="s2">E</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">T</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s2">S</span><span class="s0">^=(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">252645135</span><span class="s0">&amp;(</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">^</span><span class="s2">T</span><span class="s0">))&lt;&lt;</span><span class="s4">4</span><span class="s0">,</span><span class="s2">S</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">=</span><span class="s4">65535</span><span class="s0">&amp;((</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">)&gt;&gt;&gt;-</span><span class="s4">16</span><span class="s0">^</span><span class="s2">S</span><span class="s0">),</span><span class="s2">S</span><span class="s0">^=(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">858993459</span><span class="s0">&amp;(</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">^(</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">&lt;&lt;-</span><span class="s4">16</span><span class="s0">)))&lt;&lt;</span><span class="s4">2</span><span class="s0">,</span><span class="s2">S</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">=</span><span class="s4">65535</span><span class="s0">&amp;((</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">)&gt;&gt;&gt;-</span><span class="s4">16</span><span class="s0">^</span><span class="s2">S</span><span class="s0">),</span><span class="s2">S</span><span class="s0">^=(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">1431655765</span><span class="s0">&amp;(</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">^(</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">&lt;&lt;-</span><span class="s4">16</span><span class="s0">)))&lt;&lt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">S</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">=</span><span class="s4">16711935</span><span class="s0">&amp;((</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">S</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">S</span><span class="s0">^=(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">1431655765</span><span class="s0">&amp;(</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">^(</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">)))&lt;&lt;</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">|(</span><span class="s2">T</span><span class="s0">^=</span><span class="s2">t</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">20</span><span class="s0">&amp;</span><span class="s4">240</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">24</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">16711680</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">65280</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">240</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">I</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">I</span><span class="s0">&lt;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">I</span><span class="s0">){</span><span class="s2">m</span><span class="s0">[</span><span class="s2">I</span><span class="s0">]?(</span><span class="s2">S</span><span class="s0">=</span><span class="s2">S</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">26</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">26</span><span class="s0">):(</span><span class="s2">S</span><span class="s0">=</span><span class="s2">S</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">27</span><span class="s0">);</span><span class="s1">var </span><span class="s2">A</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[(</span><span class="s2">S</span><span class="s0">&amp;=-</span><span class="s4">15</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">28</span><span class="s0">]|</span><span class="s2">a</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">n</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">20</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">i</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">s</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">12</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">o</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">c</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">],</span><span class="s2">B</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[(</span><span class="s2">T</span><span class="s0">&amp;=-</span><span class="s4">15</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">28</span><span class="s0">]|</span><span class="s2">l</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">p</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">20</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">f</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">h</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">12</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">d</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">]|</span><span class="s2">y</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">&amp;</span><span class="s4">15</span><span class="s0">];</span><span class="s2">t</span><span class="s0">=</span><span class="s4">65535</span><span class="s0">&amp;(</span><span class="s2">B</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">A</span><span class="s0">),</span><span class="s2">v</span><span class="s0">[</span><span class="s2">C</span><span class="s0">++]=</span><span class="s2">A</span><span class="s0">^</span><span class="s2">t</span><span class="s0">,</span><span class="s2">v</span><span class="s0">[</span><span class="s2">C</span><span class="s0">++]=</span><span class="s2">B</span><span class="s0">^</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">16</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">v</span><span class="s0">}(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_init</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;DES-ECB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;DES-CBC&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;DES-CFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;DES-OFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;DES-CTR&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;3DES-ECB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;3DES-CBC&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;3DES-CFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;3DES-OFB&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">),</span><span class="s2">n</span><span class="s0">(</span><span class="s3">&quot;3DES-CTR&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=[</span><span class="s4">16843776</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">16843780</span><span class="s0">,</span><span class="s4">16842756</span><span class="s0">,</span><span class="s4">66564</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">16843776</span><span class="s0">,</span><span class="s4">16843780</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">16778244</span><span class="s0">,</span><span class="s4">16842756</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">1028</span><span class="s0">,</span><span class="s4">16778240</span><span class="s0">,</span><span class="s4">16778240</span><span class="s0">,</span><span class="s4">66560</span><span class="s0">,</span><span class="s4">66560</span><span class="s0">,</span><span class="s4">16842752</span><span class="s0">,</span><span class="s4">16842752</span><span class="s0">,</span><span class="s4">16778244</span><span class="s0">,</span><span class="s4">65540</span><span class="s0">,</span><span class="s4">16777220</span><span class="s0">,</span><span class="s4">16777220</span><span class="s0">,</span><span class="s4">65540</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1028</span><span class="s0">,</span><span class="s4">66564</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">16843780</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">16842752</span><span class="s0">,</span><span class="s4">16843776</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">16777216</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">16842756</span><span class="s0">,</span><span class="s4">65536</span><span class="s0">,</span><span class="s4">66560</span><span class="s0">,</span><span class="s4">16777220</span><span class="s0">,</span><span class="s4">1024</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">16778244</span><span class="s0">,</span><span class="s4">66564</span><span class="s0">,</span><span class="s4">16843780</span><span class="s0">,</span><span class="s4">65540</span><span class="s0">,</span><span class="s4">16842752</span><span class="s0">,</span><span class="s4">16778244</span><span class="s0">,</span><span class="s4">16777220</span><span class="s0">,</span><span class="s4">1028</span><span class="s0">,</span><span class="s4">66564</span><span class="s0">,</span><span class="s4">16843776</span><span class="s0">,</span><span class="s4">1028</span><span class="s0">,</span><span class="s4">16778240</span><span class="s0">,</span><span class="s4">16778240</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">65540</span><span class="s0">,</span><span class="s4">66560</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">16842756</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=[-</span><span class="s4">2146402272</span><span class="s0">,-</span><span class="s4">2147450880</span><span class="s0">,</span><span class="s4">32768</span><span class="s0">,</span><span class="s4">1081376</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,-</span><span class="s4">2146435040</span><span class="s0">,-</span><span class="s4">2147450848</span><span class="s0">,-</span><span class="s4">2147483616</span><span class="s0">,-</span><span class="s4">2146402272</span><span class="s0">,-</span><span class="s4">2146402304</span><span class="s0">,-</span><span class="s4">2147483648</span><span class="s0">,-</span><span class="s4">2147450880</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,-</span><span class="s4">2146435040</span><span class="s0">,</span><span class="s4">1081344</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,-</span><span class="s4">2147450848</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">2147483648</span><span class="s0">,</span><span class="s4">32768</span><span class="s0">,</span><span class="s4">1081376</span><span class="s0">,-</span><span class="s4">2146435072</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,-</span><span class="s4">2147483616</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1081344</span><span class="s0">,</span><span class="s4">32800</span><span class="s0">,-</span><span class="s4">2146402304</span><span class="s0">,-</span><span class="s4">2146435072</span><span class="s0">,</span><span class="s4">32800</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1081376</span><span class="s0">,-</span><span class="s4">2146435040</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,-</span><span class="s4">2147450848</span><span class="s0">,-</span><span class="s4">2146435072</span><span class="s0">,-</span><span class="s4">2146402304</span><span class="s0">,</span><span class="s4">32768</span><span class="s0">,-</span><span class="s4">2146435072</span><span class="s0">,-</span><span class="s4">2147450880</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,-</span><span class="s4">2146402272</span><span class="s0">,</span><span class="s4">1081376</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">32768</span><span class="s0">,-</span><span class="s4">2147483648</span><span class="s0">,</span><span class="s4">32800</span><span class="s0">,-</span><span class="s4">2146402304</span><span class="s0">,</span><span class="s4">1048576</span><span class="s0">,-</span><span class="s4">2147483616</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,-</span><span class="s4">2147450848</span><span class="s0">,-</span><span class="s4">2147483616</span><span class="s0">,</span><span class="s4">1048608</span><span class="s0">,</span><span class="s4">1081344</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,-</span><span class="s4">2147450880</span><span class="s0">,</span><span class="s4">32800</span><span class="s0">,-</span><span class="s4">2147483648</span><span class="s0">,-</span><span class="s4">2146435040</span><span class="s0">,-</span><span class="s4">2146402272</span><span class="s0">,</span><span class="s4">1081344</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">520</span><span class="s0">,</span><span class="s4">134349312</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">134348808</span><span class="s0">,</span><span class="s4">134218240</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">131592</span><span class="s0">,</span><span class="s4">134218240</span><span class="s0">,</span><span class="s4">131080</span><span class="s0">,</span><span class="s4">134217736</span><span class="s0">,</span><span class="s4">134217736</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">134349320</span><span class="s0">,</span><span class="s4">131080</span><span class="s0">,</span><span class="s4">134348800</span><span class="s0">,</span><span class="s4">520</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">134349312</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">131584</span><span class="s0">,</span><span class="s4">134348800</span><span class="s0">,</span><span class="s4">134348808</span><span class="s0">,</span><span class="s4">131592</span><span class="s0">,</span><span class="s4">134218248</span><span class="s0">,</span><span class="s4">131584</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">134218248</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">134349320</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">134349312</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">131080</span><span class="s0">,</span><span class="s4">520</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">134349312</span><span class="s0">,</span><span class="s4">134218240</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">131080</span><span class="s0">,</span><span class="s4">134349320</span><span class="s0">,</span><span class="s4">134218240</span><span class="s0">,</span><span class="s4">134217736</span><span class="s0">,</span><span class="s4">512</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">134348808</span><span class="s0">,</span><span class="s4">134218248</span><span class="s0">,</span><span class="s4">131072</span><span class="s0">,</span><span class="s4">134217728</span><span class="s0">,</span><span class="s4">134349320</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">131592</span><span class="s0">,</span><span class="s4">131584</span><span class="s0">,</span><span class="s4">134217736</span><span class="s0">,</span><span class="s4">134348800</span><span class="s0">,</span><span class="s4">134218248</span><span class="s0">,</span><span class="s4">520</span><span class="s0">,</span><span class="s4">134348800</span><span class="s0">,</span><span class="s4">131592</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">134348808</span><span class="s0">,</span><span class="s4">131584</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=[</span><span class="s4">8396801</span><span class="s0">,</span><span class="s4">8321</span><span class="s0">,</span><span class="s4">8321</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">8396928</span><span class="s0">,</span><span class="s4">8388737</span><span class="s0">,</span><span class="s4">8388609</span><span class="s0">,</span><span class="s4">8193</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8396800</span><span class="s0">,</span><span class="s4">8396800</span><span class="s0">,</span><span class="s4">8396929</span><span class="s0">,</span><span class="s4">129</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8388736</span><span class="s0">,</span><span class="s4">8388609</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8388608</span><span class="s0">,</span><span class="s4">8396801</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">8388608</span><span class="s0">,</span><span class="s4">8193</span><span class="s0">,</span><span class="s4">8320</span><span class="s0">,</span><span class="s4">8388737</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">8320</span><span class="s0">,</span><span class="s4">8388736</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8396928</span><span class="s0">,</span><span class="s4">8396929</span><span class="s0">,</span><span class="s4">129</span><span class="s0">,</span><span class="s4">8388736</span><span class="s0">,</span><span class="s4">8388609</span><span class="s0">,</span><span class="s4">8396800</span><span class="s0">,</span><span class="s4">8396929</span><span class="s0">,</span><span class="s4">129</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8396800</span><span class="s0">,</span><span class="s4">8320</span><span class="s0">,</span><span class="s4">8388736</span><span class="s0">,</span><span class="s4">8388737</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">8396801</span><span class="s0">,</span><span class="s4">8321</span><span class="s0">,</span><span class="s4">8321</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">8396929</span><span class="s0">,</span><span class="s4">129</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8388609</span><span class="s0">,</span><span class="s4">8193</span><span class="s0">,</span><span class="s4">8396928</span><span class="s0">,</span><span class="s4">8388737</span><span class="s0">,</span><span class="s4">8193</span><span class="s0">,</span><span class="s4">8320</span><span class="s0">,</span><span class="s4">8388608</span><span class="s0">,</span><span class="s4">8396801</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">8388608</span><span class="s0">,</span><span class="s4">8192</span><span class="s0">,</span><span class="s4">8396928</span><span class="s0">],</span><span class="s2">u</span><span class="s0">=[</span><span class="s4">256</span><span class="s0">,</span><span class="s4">34078976</span><span class="s0">,</span><span class="s4">34078720</span><span class="s0">,</span><span class="s4">1107296512</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">1073741824</span><span class="s0">,</span><span class="s4">34078720</span><span class="s0">,</span><span class="s4">1074266368</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">33554688</span><span class="s0">,</span><span class="s4">1074266368</span><span class="s0">,</span><span class="s4">1107296512</span><span class="s0">,</span><span class="s4">1107820544</span><span class="s0">,</span><span class="s4">524544</span><span class="s0">,</span><span class="s4">1073741824</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">1074266112</span><span class="s0">,</span><span class="s4">1074266112</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1073742080</span><span class="s0">,</span><span class="s4">1107820800</span><span class="s0">,</span><span class="s4">1107820800</span><span class="s0">,</span><span class="s4">33554688</span><span class="s0">,</span><span class="s4">1107820544</span><span class="s0">,</span><span class="s4">1073742080</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1107296256</span><span class="s0">,</span><span class="s4">34078976</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">1107296256</span><span class="s0">,</span><span class="s4">524544</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">1107296512</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">1073741824</span><span class="s0">,</span><span class="s4">34078720</span><span class="s0">,</span><span class="s4">1107296512</span><span class="s0">,</span><span class="s4">1074266368</span><span class="s0">,</span><span class="s4">33554688</span><span class="s0">,</span><span class="s4">1073741824</span><span class="s0">,</span><span class="s4">1107820544</span><span class="s0">,</span><span class="s4">34078976</span><span class="s0">,</span><span class="s4">1074266368</span><span class="s0">,</span><span class="s4">256</span><span class="s0">,</span><span class="s4">33554432</span><span class="s0">,</span><span class="s4">1107820544</span><span class="s0">,</span><span class="s4">1107820800</span><span class="s0">,</span><span class="s4">524544</span><span class="s0">,</span><span class="s4">1107296256</span><span class="s0">,</span><span class="s4">1107820800</span><span class="s0">,</span><span class="s4">34078720</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1074266112</span><span class="s0">,</span><span class="s4">1107296256</span><span class="s0">,</span><span class="s4">524544</span><span class="s0">,</span><span class="s4">33554688</span><span class="s0">,</span><span class="s4">1073742080</span><span class="s0">,</span><span class="s4">524288</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1074266112</span><span class="s0">,</span><span class="s4">34078976</span><span class="s0">,</span><span class="s4">1073742080</span><span class="s0">],</span><span class="s2">l</span><span class="s0">=[</span><span class="s4">536870928</span><span class="s0">,</span><span class="s4">541065216</span><span class="s0">,</span><span class="s4">16384</span><span class="s0">,</span><span class="s4">541081616</span><span class="s0">,</span><span class="s4">541065216</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">541081616</span><span class="s0">,</span><span class="s4">4194304</span><span class="s0">,</span><span class="s4">536887296</span><span class="s0">,</span><span class="s4">4210704</span><span class="s0">,</span><span class="s4">4194304</span><span class="s0">,</span><span class="s4">536870928</span><span class="s0">,</span><span class="s4">4194320</span><span class="s0">,</span><span class="s4">536887296</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">16400</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4194320</span><span class="s0">,</span><span class="s4">536887312</span><span class="s0">,</span><span class="s4">16384</span><span class="s0">,</span><span class="s4">4210688</span><span class="s0">,</span><span class="s4">536887312</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">541065232</span><span class="s0">,</span><span class="s4">541065232</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4210704</span><span class="s0">,</span><span class="s4">541081600</span><span class="s0">,</span><span class="s4">16400</span><span class="s0">,</span><span class="s4">4210688</span><span class="s0">,</span><span class="s4">541081600</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">536887296</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">541065232</span><span class="s0">,</span><span class="s4">4210688</span><span class="s0">,</span><span class="s4">541081616</span><span class="s0">,</span><span class="s4">4194304</span><span class="s0">,</span><span class="s4">16400</span><span class="s0">,</span><span class="s4">536870928</span><span class="s0">,</span><span class="s4">4194304</span><span class="s0">,</span><span class="s4">536887296</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">16400</span><span class="s0">,</span><span class="s4">536870928</span><span class="s0">,</span><span class="s4">541081616</span><span class="s0">,</span><span class="s4">4210688</span><span class="s0">,</span><span class="s4">541065216</span><span class="s0">,</span><span class="s4">4210704</span><span class="s0">,</span><span class="s4">541081600</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">541065232</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">16384</span><span class="s0">,</span><span class="s4">541065216</span><span class="s0">,</span><span class="s4">4210704</span><span class="s0">,</span><span class="s4">16384</span><span class="s0">,</span><span class="s4">4194320</span><span class="s0">,</span><span class="s4">536887312</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">541081600</span><span class="s0">,</span><span class="s4">536870912</span><span class="s0">,</span><span class="s4">4194320</span><span class="s0">,</span><span class="s4">536887312</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=[</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">69206018</span><span class="s0">,</span><span class="s4">67110914</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">67110914</span><span class="s0">,</span><span class="s4">2099202</span><span class="s0">,</span><span class="s4">69208064</span><span class="s0">,</span><span class="s4">69208066</span><span class="s0">,</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">67108866</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">69206018</span><span class="s0">,</span><span class="s4">2050</span><span class="s0">,</span><span class="s4">67110912</span><span class="s0">,</span><span class="s4">2099202</span><span class="s0">,</span><span class="s4">2097154</span><span class="s0">,</span><span class="s4">67110912</span><span class="s0">,</span><span class="s4">67108866</span><span class="s0">,</span><span class="s4">69206016</span><span class="s0">,</span><span class="s4">69208064</span><span class="s0">,</span><span class="s4">2097154</span><span class="s0">,</span><span class="s4">69206016</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">2050</span><span class="s0">,</span><span class="s4">69208066</span><span class="s0">,</span><span class="s4">2099200</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">2099200</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">2099200</span><span class="s0">,</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">67110914</span><span class="s0">,</span><span class="s4">67110914</span><span class="s0">,</span><span class="s4">69206018</span><span class="s0">,</span><span class="s4">69206018</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">2097154</span><span class="s0">,</span><span class="s4">67108864</span><span class="s0">,</span><span class="s4">67110912</span><span class="s0">,</span><span class="s4">2097152</span><span class="s0">,</span><span class="s4">69208064</span><span class="s0">,</span><span class="s4">2050</span><span class="s0">,</span><span class="s4">2099202</span><span class="s0">,</span><span class="s4">69208064</span><span class="s0">,</span><span class="s4">2050</span><span class="s0">,</span><span class="s4">67108866</span><span class="s0">,</span><span class="s4">69208066</span><span class="s0">,</span><span class="s4">69206016</span><span class="s0">,</span><span class="s4">2099200</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">69208066</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">2099202</span><span class="s0">,</span><span class="s4">69206016</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">67108866</span><span class="s0">,</span><span class="s4">67110912</span><span class="s0">,</span><span class="s4">2048</span><span class="s0">,</span><span class="s4">2097154</span><span class="s0">],</span><span class="s2">f</span><span class="s0">=[</span><span class="s4">268439616</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">268701760</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">268439616</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">262208</span><span class="s0">,</span><span class="s4">268697600</span><span class="s0">,</span><span class="s4">268701760</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">268701696</span><span class="s0">,</span><span class="s4">266304</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">268697600</span><span class="s0">,</span><span class="s4">268435520</span><span class="s0">,</span><span class="s4">268439552</span><span class="s0">,</span><span class="s4">4160</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">262208</span><span class="s0">,</span><span class="s4">268697664</span><span class="s0">,</span><span class="s4">268701696</span><span class="s0">,</span><span class="s4">4160</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268697664</span><span class="s0">,</span><span class="s4">268435520</span><span class="s0">,</span><span class="s4">268439552</span><span class="s0">,</span><span class="s4">266304</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">266304</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">268701696</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">268697664</span><span class="s0">,</span><span class="s4">4096</span><span class="s0">,</span><span class="s4">266304</span><span class="s0">,</span><span class="s4">268439552</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">268435520</span><span class="s0">,</span><span class="s4">268697600</span><span class="s0">,</span><span class="s4">268697664</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">262144</span><span class="s0">,</span><span class="s4">268439616</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268701760</span><span class="s0">,</span><span class="s4">262208</span><span class="s0">,</span><span class="s4">268435520</span><span class="s0">,</span><span class="s4">268697600</span><span class="s0">,</span><span class="s4">268439552</span><span class="s0">,</span><span class="s4">268439616</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">268701760</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">266240</span><span class="s0">,</span><span class="s4">4160</span><span class="s0">,</span><span class="s4">4160</span><span class="s0">,</span><span class="s4">262208</span><span class="s0">,</span><span class="s4">268435456</span><span class="s0">,</span><span class="s4">268701696</span><span class="s0">];</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">32</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">9</span><span class="s0">;</span><span class="s2">n</span><span class="s0">=</span><span class="s4">3</span><span class="s0">===</span><span class="s2">d</span><span class="s0">?</span><span class="s2">a</span><span class="s0">?[</span><span class="s4">30</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">]:[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">2</span><span class="s0">]:</span><span class="s2">a</span><span class="s0">?[</span><span class="s4">94</span><span class="s0">,</span><span class="s4">62</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">]:[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">62</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,-</span><span class="s4">2</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">96</span><span class="s0">,</span><span class="s4">2</span><span class="s0">];</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">];</span><span class="s2">y</span><span class="s0">^=(</span><span class="s2">h</span><span class="s0">=</span><span class="s4">252645135</span><span class="s0">&amp;(</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">^</span><span class="s2">g</span><span class="s0">))&lt;&lt;</span><span class="s4">4</span><span class="s0">,</span><span class="s2">y</span><span class="s0">^=(</span><span class="s2">h</span><span class="s0">=</span><span class="s4">65535</span><span class="s0">&amp;(</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">^(</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">)))&lt;&lt;</span><span class="s4">16</span><span class="s0">,</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">=</span><span class="s4">858993459</span><span class="s0">&amp;((</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">^</span><span class="s2">y</span><span class="s0">),</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">=</span><span class="s4">16711935</span><span class="s0">&amp;((</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">^</span><span class="s2">y</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=(</span><span class="s2">y</span><span class="s0">^=(</span><span class="s2">h</span><span class="s0">=</span><span class="s4">1431655765</span><span class="s0">&amp;(</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">^(</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">8</span><span class="s0">)))&lt;&lt;</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">31</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=(</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">)&lt;&lt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">31</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">v</span><span class="s0">&lt;</span><span class="s2">d</span><span class="s0">;</span><span class="s2">v</span><span class="s0">+=</span><span class="s4">3</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s4">1</span><span class="s0">],</span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">v</span><span class="s0">+</span><span class="s4">2</span><span class="s0">],</span><span class="s2">E</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">v</span><span class="s0">];</span><span class="s2">E</span><span class="s0">!=</span><span class="s2">m</span><span class="s0">;</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">C</span><span class="s0">){</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">g</span><span class="s0">^</span><span class="s2">e</span><span class="s0">[</span><span class="s2">E</span><span class="s0">],</span><span class="s2">T</span><span class="s0">=(</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">28</span><span class="s0">)^</span><span class="s2">e</span><span class="s0">[</span><span class="s2">E</span><span class="s0">+</span><span class="s4">1</span><span class="s0">];</span><span class="s2">h</span><span class="s0">=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">h</span><span class="s0">^(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">c</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">l</span><span class="s0">[</span><span class="s2">S</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">f</span><span class="s0">[</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">S</span><span class="s0">]|</span><span class="s2">i</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">o</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">u</span><span class="s0">[</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">63</span><span class="s0">]|</span><span class="s2">p</span><span class="s0">[</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">T</span><span class="s0">])}</span><span class="s2">h</span><span class="s0">=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">h</span><span class="s0">}</span><span class="s2">g</span><span class="s0">=</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">g</span><span class="s0">&lt;&lt;</span><span class="s4">31</span><span class="s0">,</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">=</span><span class="s4">1431655765</span><span class="s0">&amp;((</span><span class="s2">y</span><span class="s0">=</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">|</span><span class="s2">y</span><span class="s0">&lt;&lt;</span><span class="s4">31</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">^</span><span class="s2">g</span><span class="s0">),</span><span class="s2">g</span><span class="s0">^=(</span><span class="s2">h</span><span class="s0">=</span><span class="s4">16711935</span><span class="s0">&amp;(</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">^(</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">1</span><span class="s0">)))&lt;&lt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">g</span><span class="s0">^=(</span><span class="s2">h</span><span class="s0">=</span><span class="s4">858993459</span><span class="s0">&amp;(</span><span class="s2">g</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">^(</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">)))&lt;&lt;</span><span class="s4">2</span><span class="s0">,</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">=</span><span class="s4">65535</span><span class="s0">&amp;((</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">^</span><span class="s2">g</span><span class="s0">),</span><span class="s2">g</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">=</span><span class="s4">252645135</span><span class="s0">&amp;((</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">16</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">^</span><span class="s2">g</span><span class="s0">),</span><span class="s2">y</span><span class="s0">^=</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">4</span><span class="s0">,</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">r</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">g</span><span class="s0">}</span><span class="s1">function </span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;DES-&quot;</span><span class="s0">+((</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{}).</span><span class="s2">mode</span><span class="s0">||</span><span class="s3">&quot;CBC&quot;</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createDecipher</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createCipher</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)).</span><span class="s2">start</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">r </span><span class="s1">instanceof </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">={}),(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{}).</span><span class="s2">output</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">12</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">26</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">27</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">)</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">?</span><span class="s2">r</span><span class="s0">(</span><span class="s4">16</span><span class="s0">):</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=[</span><span class="s4">6</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">2</span><span class="s0">],</span><span class="s2">l</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyVersion&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo.privateKeyAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyOid&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKey&quot;</span><span class="s0">}]},</span><span class="s2">p</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyVersion&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.modulus&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyModulus&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.publicExponent&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyPublicExponent&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.privateExponent&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyPrivateExponent&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.prime1&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyPrime1&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.prime2&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyPrime2&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.exponent1&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyExponent1&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.exponent2&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyExponent2&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPrivateKey.coefficient&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyCoefficient&quot;</span><span class="s0">}]},</span><span class="s2">f</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPublicKey&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPublicKey.modulus&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;publicKeyModulus&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSAPublicKey.exponent&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;publicKeyExponent&quot;</span><span class="s0">}]},</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">publicKeyValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;subjectPublicKeyInfo&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo.AlgorithmIdentifier&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;publicKeyOid&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo.subjectPublicKey&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;rsaPublicKey&quot;</span><span class="s0">}]}]},</span><span class="s2">d</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DigestInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DigestInfo.DigestAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DigestInfo.DigestAlgorithm.algorithmIdentifier&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;algorithmIdentifier&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DigestInfo.DigestAlgorithm.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;parameters&quot;</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;DigestInfo.digest&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;digest&quot;</span><span class="s0">}]},</span><span class="s2">y</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">algorithm </span><span class="s1">in </span><span class="s2">c</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unknown message digest algorithm.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s2">t</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">];</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">));</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">g</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">||!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">d</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dP</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dP</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">d</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dQ</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dQ</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">d</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">qInv</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">qInv</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">));</span><span class="s1">do</span><span class="s0">{</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">)),</span><span class="s4">16</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">||!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">).</span><span class="s2">equals</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)).</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)).</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">).</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dP</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">).</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dQ</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">);</span><span class="s2">s</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">o</span><span class="s0">).</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">qInv</span><span class="s0">).</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">p</span><span class="s0">).</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">q</span><span class="s0">).</span><span class="s2">add</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s1">return </span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)).</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)};</span><span class="s1">function </span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">i</span><span class="s0">-</span><span class="s4">11</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Message is too long for PKCS#1 v1.5 padding.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">max</span><span class="s0">=</span><span class="s2">i</span><span class="s0">-</span><span class="s4">11</span><span class="s0">,</span><span class="s2">s</span><span class="s0">}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">-</span><span class="s4">3</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">||</span><span class="s4">1</span><span class="s0">===</span><span class="s2">r</span><span class="s0">){</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s4">255</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">else for</span><span class="s0">(;</span><span class="s2">c</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s4">0</span><span class="s0">===(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">u</span><span class="s0">))?++</span><span class="s2">l</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s2">c</span><span class="s0">=</span><span class="s2">l</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">}</span><span class="s1">function </span><span class="s2">m</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">||</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">||!</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">2</span><span class="s0">!=</span><span class="s2">c</span><span class="s0">||</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encryption block is invalid.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">){</span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">-</span><span class="s4">3</span><span class="s0">-</span><span class="s2">n</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">;++</span><span class="s2">l</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encryption block is invalid.&quot;</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">1</span><span class="s0">;){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">255</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()){--</span><span class="s2">s</span><span class="s0">.</span><span class="s2">read</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}++</span><span class="s2">u</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">1</span><span class="s0">;){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()){--</span><span class="s2">s</span><span class="s0">.</span><span class="s2">read</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}++</span><span class="s2">u</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()||</span><span class="s2">u</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">-</span><span class="s4">3</span><span class="s0">-</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encryption block is invalid.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">C</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">={});</span><span class="s1">var </span><span class="s2">i</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:{</span><span class="s2">name</span><span class="s0">:(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">algorithm</span><span class="s0">||</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">,</span><span class="s2">options</span><span class="s0">:{</span><span class="s2">workers</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">workers</span><span class="s0">||</span><span class="s4">2</span><span class="s0">,</span><span class="s2">workLoad</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">workLoad</span><span class="s0">||</span><span class="s4">100</span><span class="s0">,</span><span class="s2">workerScript</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">workerScript</span><span class="s0">}}};</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(){</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pBits</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">?</span><span class="s2">u</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">):</span><span class="s1">void </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qBits</span><span class="s0">,</span><span class="s2">u</span><span class="s0">))}))}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">.</span><span class="s2">generateProbablePrime</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">u</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s2">i</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">).</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">void </span><span class="s2">s</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">).</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">void </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qBits</span><span class="s0">,</span><span class="s2">u</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">),</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">.</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">void </span><span class="s2">s</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bits</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">void </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qBits</span><span class="s0">,</span><span class="s2">u</span><span class="s0">);</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">={</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPrivateKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">)),</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPublicKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">r</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">)}</span><span class="s3">&quot;prng&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">),</span><span class="s2">s</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">);</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&gt;=</span><span class="s3">&quot;8&quot;</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;00&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;&amp;</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">))||</span><span class="s4">255</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;&amp;</span><span class="s4">128</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)))?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">):</span><span class="s2">r</span><span class="s0">}</span><span class="s1">function </span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">100</span><span class="s0">?</span><span class="s4">27</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">150</span><span class="s0">?</span><span class="s4">18</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">200</span><span class="s0">?</span><span class="s4">15</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">250</span><span class="s0">?</span><span class="s4">12</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">300</span><span class="s0">?</span><span class="s4">9</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">350</span><span class="s0">?</span><span class="s4">8</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">400</span><span class="s0">?</span><span class="s4">7</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">500</span><span class="s0">?</span><span class="s4">6</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">600</span><span class="s0">?</span><span class="s4">5</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">800</span><span class="s0">?</span><span class="s4">4</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">1250</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">2</span><span class="s0">}</span><span class="s1">function </span><span class="s2">T</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">I</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">B</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">);!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">?(</span><span class="s2">s</span><span class="s0">=</span><span class="s4">2</span><span class="s0">===</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)):(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">()).</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s4">16</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">g</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">-</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">2</span><span class="s0">);</span><span class="s2">p</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),--</span><span class="s2">p</span><span class="s0">;</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encrypted message length is invalid.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">expected</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s4">16</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encrypted message is invalid.&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">g</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">s</span><span class="s0">-</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">2</span><span class="s0">);</span><span class="s2">p</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),--</span><span class="s2">p</span><span class="s0">;</span><span class="s1">return </span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)),!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">?</span><span class="s2">m</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">createKeyPairGenerationState</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">10</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||</span><span class="s4">2048</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{}).</span><span class="s2">prng</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">,</span><span class="s2">o</span><span class="s0">={</span><span class="s2">nextBytes</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}},</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">||</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid key generation algorithm: &quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">);</span><span class="s1">return</span><span class="s0">(</span><span class="s2">i</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">state</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">bits</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">rng</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">eInt</span><span class="s0">:</span><span class="s2">t</span><span class="s0">||</span><span class="s4">65537</span><span class="s0">,</span><span class="s2">e</span><span class="s0">:</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">q</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">qBits</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">pBits</span><span class="s0">:</span><span class="s2">e</span><span class="s0">-(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">pqState</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">num</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">keys</span><span class="s0">:</span><span class="s1">null</span><span class="s0">}).</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">eInt</span><span class="s0">),</span><span class="s2">i</span><span class="s0">},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">stepKeyPairGenerationState</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;algorithm&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s4">30</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">|</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">=+</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">||</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">);){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pBits</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qBits</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">p</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">rng</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">testBit</span><span class="s0">(</span><span class="s2">f</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">(</span><span class="s2">f</span><span class="s0">),</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s4">31</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">r</span><span class="s0">).</span><span class="s2">byteValue</span><span class="s0">(),</span><span class="s4">0</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">):</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()&gt;</span><span class="s2">p</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">=</span><span class="s4">0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">isProbablePrime</span><span class="s0">(</span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()))?++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s2">u</span><span class="s0">[</span><span class="s2">i</span><span class="s0">++%</span><span class="s4">8</span><span class="s0">],</span><span class="s4">0</span><span class="s0">):</span><span class="s4">2</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">).</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">0</span><span class="s0">:</span><span class="s4">3</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pqState</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">,</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">&amp;&amp;++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">=</span><span class="s1">null</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">num</span><span class="s0">),++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">),++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">3</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">)</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">.</span><span class="s2">gcd</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)?++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bits</span><span class="s0">?++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">5</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">phi</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">={</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPrivateKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p1</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">)),</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPublicKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">)}}</span><span class="s2">l</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=+</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">)-</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">}</span><span class="s1">return null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">generateKeyPair</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">===</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s4">2</span><span class="s0">===</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s3">&quot;number&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s4">3</span><span class="s0">===</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">void </span><span class="s4">0</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{},</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">bits</span><span class="s0">||</span><span class="s4">2048</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">e</span><span class="s0">||</span><span class="s4">65537</span><span class="s0">),!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">usePureJavaScript</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">256</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">16384</span><span class="s0">&amp;&amp;(</span><span class="s4">65537</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s4">3</span><span class="s0">===</span><span class="s2">t</span><span class="s0">))</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">T</span><span class="s0">(</span><span class="s3">&quot;generateKeyPair&quot;</span><span class="s0">))</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">generateKeyPair</span><span class="s0">(</span><span class="s3">&quot;rsa&quot;</span><span class="s0">,{</span><span class="s2">modulusLength</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">publicExponent</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">publicKeyEncoding</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;spki&quot;</span><span class="s0">,</span><span class="s2">format</span><span class="s0">:</span><span class="s3">&quot;pem&quot;</span><span class="s0">},</span><span class="s2">privateKeyEncoding</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;pkcs8&quot;</span><span class="s0">,</span><span class="s2">format</span><span class="s0">:</span><span class="s3">&quot;pem&quot;</span><span class="s0">}},(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyFromPem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)})}));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">I</span><span class="s0">(</span><span class="s3">&quot;generateKey&quot;</span><span class="s0">)&amp;&amp;</span><span class="s2">I</span><span class="s0">(</span><span class="s3">&quot;exportKey&quot;</span><span class="s0">))</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">.</span><span class="s2">generateKey</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSASSA-PKCS1-v1_5&quot;</span><span class="s0">,</span><span class="s2">modulusLength</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">publicExponent</span><span class="s0">:</span><span class="s2">B</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">hash</span><span class="s0">:{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SHA-256&quot;</span><span class="s0">}},!</span><span class="s4">0</span><span class="s0">,[</span><span class="s3">&quot;sign&quot;</span><span class="s0">,</span><span class="s3">&quot;verify&quot;</span><span class="s0">]).</span><span class="s2">then</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">.</span><span class="s2">exportKey</span><span class="s0">(</span><span class="s3">&quot;pkcs8&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">)})).</span><span class="s2">then</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})).</span><span class="s2">then</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)));</span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPublicKey</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">e</span><span class="s0">)})}}));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">A</span><span class="s0">(</span><span class="s3">&quot;generateKey&quot;</span><span class="s0">)&amp;&amp;</span><span class="s2">A</span><span class="s0">(</span><span class="s3">&quot;exportKey&quot;</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">.</span><span class="s2">generateKey</span><span class="s0">({</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RSASSA-PKCS1-v1_5&quot;</span><span class="s0">,</span><span class="s2">modulusLength</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">publicExponent</span><span class="s0">:</span><span class="s2">B</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">hash</span><span class="s0">:{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SHA-256&quot;</span><span class="s0">}},!</span><span class="s4">0</span><span class="s0">,[</span><span class="s3">&quot;sign&quot;</span><span class="s0">,</span><span class="s3">&quot;verify&quot;</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">oncomplete</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">target</span><span class="s0">.</span><span class="s2">result</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">.</span><span class="s2">subtle</span><span class="s0">.</span><span class="s2">exportKey</span><span class="s0">(</span><span class="s3">&quot;pkcs8&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">oncomplete</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">target</span><span class="s0">.</span><span class="s2">result</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)));</span><span class="s2">n</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,{</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPublicKey</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">n</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">e</span><span class="s0">)})},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">onerror</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s1">void</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">onerror</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">n</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">T</span><span class="s0">(</span><span class="s3">&quot;generateKeyPairSync&quot;</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">generateKeyPairSync</span><span class="s0">(</span><span class="s3">&quot;rsa&quot;</span><span class="s0">,{</span><span class="s2">modulusLength</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">publicExponent</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">publicKeyEncoding</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;spki&quot;</span><span class="s0">,</span><span class="s2">format</span><span class="s0">:</span><span class="s3">&quot;pem&quot;</span><span class="s0">},</span><span class="s2">privateKeyEncoding</span><span class="s0">:{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;pkcs8&quot;</span><span class="s0">,</span><span class="s2">format</span><span class="s0">:</span><span class="s3">&quot;pem&quot;</span><span class="s0">}});</span><span class="s1">return</span><span class="s0">{</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">),</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyFromPem</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">)}}</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">createKeyPairGenerationState</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">stepKeyPairGenerationState</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">;</span><span class="s2">C</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPublicKey</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPublicKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">encrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">():</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;RSAES-PKCS1-V1_5&quot;</span><span class="s0">),</span><span class="s3">&quot;RSAES-PKCS1-V1_5&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s4">2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()}};</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;RSA-OAEP&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;RSAES-OAEP&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs1</span><span class="s0">.</span><span class="s2">encode_rsa_oaep</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)}};</span><span class="s1">else if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">!==[</span><span class="s3">&quot;RAW&quot;</span><span class="s0">,</span><span class="s3">&quot;NONE&quot;</span><span class="s0">,</span><span class="s3">&quot;NULL&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">].</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s2">t</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}};</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unsupported encryption scheme: &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">verify</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">n</span><span class="s0">?</span><span class="s2">n</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">():</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;RSASSA-PKCS1-V1_5&quot;</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">={</span><span class="s2">_parseAllDigestBytes</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}),</span><span class="s3">&quot;_parseAllDigestBytes&quot;</span><span class="s1">in </span><span class="s2">i</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_parseAllDigestBytes</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;RSASSA-PKCS1-V1_5&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">?</span><span class="s2">n</span><span class="s0">={</span><span class="s2">verify</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">parseAllBytes</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">_parseAllDigestBytes</span><span class="s0">}),</span><span class="s2">o</span><span class="s0">={},</span><span class="s2">c</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">algorithmIdentifier</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md2</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha224</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;sha512-224&quot;</span><span class="s0">]&amp;&amp;</span><span class="s2">l</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;sha512-256&quot;</span><span class="s0">])</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">u</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((</span><span class="s2">l</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md2</span><span class="s0">||</span><span class="s2">l</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">)&amp;&amp;!(</span><span class="s3">&quot;parameters&quot;</span><span class="s1">in </span><span class="s2">o</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">}}:</span><span class="s3">&quot;NONE&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;NULL&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">||(</span><span class="s2">n</span><span class="s0">={</span><span class="s2">verify</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">===(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">))}});</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">())}};</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPrivateKey</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">setPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">={</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">d</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">p</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">q</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">dP</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">dQ</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">qInv</span><span class="s0">:</span><span class="s2">u</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">():</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;RSAES-PKCS1-V1_5&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;RSAES-PKCS1-V1_5&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">={</span><span class="s2">decode</span><span class="s0">:</span><span class="s2">m</span><span class="s0">};</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;RSA-OAEP&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;RSAES-OAEP&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">={</span><span class="s2">decode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs1</span><span class="s0">.</span><span class="s2">decode_rsa_oaep</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}};</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">===[</span><span class="s3">&quot;RAW&quot;</span><span class="s0">,</span><span class="s3">&quot;NONE&quot;</span><span class="s0">,</span><span class="s3">&quot;NULL&quot;</span><span class="s0">,</span><span class="s1">null</span><span class="s0">].</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unsupported encryption scheme: &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s2">t</span><span class="s0">={</span><span class="s2">decode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">sign</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">()),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;RSASSA-PKCS1-V1_5&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s2">y</span><span class="s0">},</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">):</span><span class="s3">&quot;NONE&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;NULL&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}},</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">());</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}};</span><span class="s1">return </span><span class="s2">l</span><span class="s0">},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">wrapRsaPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s4">0</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">={},</span><span class="s2">g</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">))),</span><span class="s2">y</span><span class="s0">={},</span><span class="s2">g</span><span class="s0">=[],!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">v</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">v</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyModulus</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyPublicExponent</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyPrivateExponent</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyPrime1</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyPrime2</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyExponent1</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyExponent2</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">privateKeyCoefficient</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPrivateKey</span><span class="s0">(</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">d</span><span class="s0">,</span><span class="s4">16</span><span class="s0">))},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyToAsn1</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">privateKeyToRSAPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s4">0</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">d</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dP</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dQ</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qInv</span><span class="s0">))])},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKeyOid</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read public key. Unknown OID.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">i</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">rsaPublicKey</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=[],!</span><span class="s2">s</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read public key. ASN.1 object does not contain an RSAPublicKey.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKeyModulus</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKeyExponent</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">();</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">setRsaPublicKey</span><span class="s0">(</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s4">16</span><span class="s0">),</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s4">16</span><span class="s0">))},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyToAsn1</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyToSubjectPublicKeyInfo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,[</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyToRSAPublicKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)])])},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKeyToRSAPublicKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">))])}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">=[],</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):</span><span class="s1">null</span><span class="s0">==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">256</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">))}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(){</span><span class="s1">return new </span><span class="s2">i</span><span class="s0">(</span><span class="s1">null</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">16383</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">&gt;&gt;</span><span class="s4">14</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">16383</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">u</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">++]&gt;&gt;</span><span class="s4">14</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">*</span><span class="s2">c</span><span class="s0">+</span><span class="s2">u</span><span class="s0">*</span><span class="s2">s</span><span class="s0">;</span><span class="s2">n</span><span class="s0">=((</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">*</span><span class="s2">c</span><span class="s0">+((</span><span class="s4">16383</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">)&lt;&lt;</span><span class="s4">14</span><span class="s0">)+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">)&gt;&gt;</span><span class="s4">28</span><span class="s0">)+(</span><span class="s2">l</span><span class="s0">&gt;&gt;</span><span class="s4">14</span><span class="s0">)+</span><span class="s2">o</span><span class="s0">*</span><span class="s2">u</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">++]=</span><span class="s4">268435455</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">navigator</span><span class="s0">?(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">am</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">28</span><span class="s0">):</span><span class="s3">&quot;Microsoft Internet Explorer&quot;</span><span class="s0">==</span><span class="s2">navigator</span><span class="s0">.</span><span class="s2">appName</span><span class="s0">?(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">am</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">32767</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">&gt;&gt;</span><span class="s4">15</span><span class="s0">;--</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">32767</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">u</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">++]&gt;&gt;</span><span class="s4">15</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">*</span><span class="s2">c</span><span class="s0">+</span><span class="s2">u</span><span class="s0">*</span><span class="s2">s</span><span class="s0">;</span><span class="s2">n</span><span class="s0">=((</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">*</span><span class="s2">c</span><span class="s0">+((</span><span class="s4">32767</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">)&lt;&lt;</span><span class="s4">15</span><span class="s0">)+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]+(</span><span class="s4">1073741823</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">30</span><span class="s0">)+(</span><span class="s2">l</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">15</span><span class="s0">)+</span><span class="s2">o</span><span class="s0">*</span><span class="s2">u</span><span class="s0">+(</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">30</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">++]=</span><span class="s4">1073741823</span><span class="s0">&amp;</span><span class="s2">c</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">=</span><span class="s4">30</span><span class="s0">):</span><span class="s3">&quot;Netscape&quot;</span><span class="s0">!=</span><span class="s2">navigator</span><span class="s0">.</span><span class="s2">appName</span><span class="s0">?(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">am</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(;--</span><span class="s2">i</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">++]+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">;</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">s</span><span class="s0">/</span><span class="s4">67108864</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">++]=</span><span class="s4">67108863</span><span class="s0">&amp;</span><span class="s2">s</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">=</span><span class="s4">26</span><span class="s0">):(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">am</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">28</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">a</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">=</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">a</span><span class="s0">;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">FV</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s4">2</span><span class="s0">,</span><span class="s4">52</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">F1</span><span class="s0">=</span><span class="s4">52</span><span class="s0">-</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">F2</span><span class="s0">=</span><span class="s4">2</span><span class="s0">*</span><span class="s2">a</span><span class="s0">-</span><span class="s4">52</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;0&quot;</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;=</span><span class="s4">9</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">l</span><span class="s0">[</span><span class="s2">c</span><span class="s0">++]=</span><span class="s2">u</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;a&quot;</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">10</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">36</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">l</span><span class="s0">[</span><span class="s2">c</span><span class="s0">++]=</span><span class="s2">u</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;A&quot;</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">10</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">36</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">l</span><span class="s0">[</span><span class="s2">c</span><span class="s0">++]=</span><span class="s2">u</span><span class="s0">;</span><span class="s1">function </span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s3">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)];</span><span class="s1">return null</span><span class="s0">==</span><span class="s2">r</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return </span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">16</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">16</span><span class="s0">),</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">8</span><span class="s0">),</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">4</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">),</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">2</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">),</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">1</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+=</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">}</span><span class="s1">function </span><span class="s2">y</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">g</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mp</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">invDigit</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mpl</span><span class="s0">=</span><span class="s4">32767</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mp</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mph</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mp</span><span class="s0">&gt;&gt;</span><span class="s4">15</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">um</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s4">15</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mt2</span><span class="s0">=</span><span class="s4">2</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">m</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">|</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">C</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">^</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;~</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s4">0</span><span class="s0">==(</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">&gt;&gt;=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">t</span><span class="s0">+=</span><span class="s4">16</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">&gt;&gt;=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">t</span><span class="s0">+=</span><span class="s4">8</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">&gt;&gt;=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">t</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">&gt;&gt;=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">t</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&amp;&amp;++</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">T</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">&amp;=</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,++</span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">I</span><span class="s0">(){}</span><span class="s1">function </span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">B</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">q3</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">dlShiftTo</span><span class="s0">(</span><span class="s4">2</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mu</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">.</span><span class="s2">divide</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">}</span><span class="s2">y</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">):</span><span class="s2">e</span><span class="s0">},</span><span class="s2">y</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">y</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">y</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">y</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">squareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">g</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">().</span><span class="s2">dlShiftTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">g</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">g</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mt2</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">32767</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mpl</span><span class="s0">+((</span><span class="s2">r</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mph</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&gt;&gt;</span><span class="s4">15</span><span class="s0">)*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mpl</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">um</span><span class="s0">)&lt;&lt;</span><span class="s4">15</span><span class="s0">)&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]&gt;=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]-=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[++</span><span class="s2">r</span><span class="s0">]++}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">drShiftTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">g</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">g</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">squareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">t</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;-</span><span class="s4">1</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fromString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">16</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">8</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s4">3</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">256</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s4">8</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">32</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s4">5</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">!=</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return void this</span><span class="s0">.</span><span class="s2">fromRadix</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">8</span><span class="s0">==</span><span class="s2">r</span><span class="s0">?</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]:</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">);</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s3">&quot;-&quot;</span><span class="s0">==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)&amp;&amp;(</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">):(</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">==</span><span class="s2">s</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s2">o</span><span class="s0">:</span><span class="s2">s</span><span class="s0">+</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">?(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]|=(</span><span class="s2">o</span><span class="s0">&amp;(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">s</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s2">s</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s2">o</span><span class="s0">&gt;&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">s</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]|=</span><span class="s2">o</span><span class="s0">&lt;&lt;</span><span class="s2">s</span><span class="s0">,(</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">)&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">))}</span><span class="s4">8</span><span class="s0">==</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">!=(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]|=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">s</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">s</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s1">this</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]==</span><span class="s2">e</span><span class="s0">;)--</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">dlShiftTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">drShiftTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">-</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s2">e</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">n</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;&lt;</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]&gt;&gt;</span><span class="s2">n</span><span class="s0">|</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]&amp;</span><span class="s2">i</span><span class="s0">)&lt;&lt;</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">a</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]&gt;&gt;</span><span class="s2">a</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">-</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]|=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&amp;</span><span class="s2">i</span><span class="s0">)&lt;&lt;</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">-</span><span class="s2">r</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&gt;&gt;</span><span class="s2">a</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]|=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s2">i</span><span class="s0">)&lt;&lt;</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">-=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s2">a</span><span class="s0">-=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&lt;-</span><span class="s4">1</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">+</span><span class="s2">a</span><span class="s0">:</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;--</span><span class="s2">n</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">squareTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s4">2</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">);(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">]+=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">))&gt;=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">]-=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]=</span><span class="s4">1</span><span class="s0">)}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">e</span><span class="s0">,</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return null</span><span class="s0">!=</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s1">void</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">null</span><span class="s0">==</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">());</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">d</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]);</span><span class="s2">l</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)):(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">p</span><span class="s0">-</span><span class="s4">1</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">f</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">f</span><span class="s0">*(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">F1</span><span class="s0">)+(</span><span class="s2">p</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">p</span><span class="s0">-</span><span class="s4">2</span><span class="s0">]&gt;&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">F2</span><span class="s0">:</span><span class="s4">0</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">FV</span><span class="s0">/</span><span class="s2">h</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">F1</span><span class="s0">)/</span><span class="s2">h</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">F2</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s2">m</span><span class="s0">-</span><span class="s2">p</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s1">null</span><span class="s0">==</span><span class="s2">t</span><span class="s0">?</span><span class="s2">s</span><span class="s0">():</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">dlShiftTo</span><span class="s0">(</span><span class="s2">C</span><span class="s0">,</span><span class="s2">E</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">dlShiftTo</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">E</span><span class="s0">),</span><span class="s2">E</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">);</span><span class="s2">o</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">p</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">o</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;--</span><span class="s2">C</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[--</span><span class="s2">m</span><span class="s0">]==</span><span class="s2">f</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">:</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]*</span><span class="s2">y</span><span class="s0">+(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">v</span><span class="s0">)*</span><span class="s2">g</span><span class="s0">);</span><span class="s1">if</span><span class="s0">((</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]+=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">S</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">C</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">))&lt;</span><span class="s2">S</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">dlShiftTo</span><span class="s0">(</span><span class="s2">C</span><span class="s0">,</span><span class="s2">E</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]&lt;--</span><span class="s2">S</span><span class="s0">;)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">drShiftTo</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">c</span><span class="s0">!=</span><span class="s2">u</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">invDigit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">1</span><span class="s0">)</span><span class="s1">return </span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return </span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">3</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">*(</span><span class="s4">2</span><span class="s0">-(</span><span class="s4">15</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)*</span><span class="s2">t</span><span class="s0">)&amp;</span><span class="s4">15</span><span class="s0">)*(</span><span class="s4">2</span><span class="s0">-(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)*</span><span class="s2">t</span><span class="s0">)&amp;</span><span class="s4">255</span><span class="s0">)*(</span><span class="s4">2</span><span class="s0">-((</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)*</span><span class="s2">t</span><span class="s0">&amp;</span><span class="s4">65535</span><span class="s0">))&amp;</span><span class="s4">65535</span><span class="s0">)*(</span><span class="s4">2</span><span class="s0">-</span><span class="s2">e</span><span class="s0">*</span><span class="s2">t</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">-</span><span class="s2">t</span><span class="s0">:-</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">==(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">exp</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">4294967295</span><span class="s0">||</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">1</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">(</span><span class="s1">this</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);--</span><span class="s2">o</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),(</span><span class="s2">e</span><span class="s0">&amp;</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">o</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">c</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;-&quot;</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">negate</span><span class="s0">().</span><span class="s2">toString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">16</span><span class="s0">==</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">8</span><span class="s0">==</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s4">3</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">2</span><span class="s0">==</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s4">32</span><span class="s0">==</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s4">5</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s4">4</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">toRadix</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s4">2</span><span class="s0">}</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">s</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">%</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">-- &gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&gt;&gt;</span><span class="s2">o</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">p</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&amp;(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">o</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s2">t</span><span class="s0">-</span><span class="s2">o</span><span class="s0">,</span><span class="s2">r</span><span class="s0">|=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[--</span><span class="s2">s</span><span class="s0">]&gt;&gt;(</span><span class="s2">o</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">t</span><span class="s0">)):(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&gt;&gt;(</span><span class="s2">o</span><span class="s0">-=</span><span class="s2">t</span><span class="s0">)&amp;</span><span class="s2">a</span><span class="s0">,</span><span class="s2">o</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">,--</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">p</span><span class="s0">(</span><span class="s2">r</span><span class="s0">));</span><span class="s1">return </span><span class="s2">n</span><span class="s0">?</span><span class="s2">i</span><span class="s0">:</span><span class="s3">&quot;0&quot;</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">negate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">negate</span><span class="s0">():</span><span class="s1">this</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?-</span><span class="s2">t</span><span class="s0">:</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;--</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]))</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">return </span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">*(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)+</span><span class="s2">d</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">().</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">modPowInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">return </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">256</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()?</span><span class="s1">new </span><span class="s2">y</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s1">new </span><span class="s2">g</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">exp</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">=</span><span class="s2">A</span><span class="s0">,</span><span class="s2">I</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">=</span><span class="s2">A</span><span class="s0">,</span><span class="s2">I</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">I</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">squareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">B</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">B</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">B</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">drShiftTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mu</span><span class="s0">.</span><span class="s2">multiplyUpperTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">q3</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">multiplyLowerTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">q3</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">r2</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">m</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">B</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">B</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">squareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">b</span><span class="s0">=[</span><span class="s4">2</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">19</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">29</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">37</span><span class="s0">,</span><span class="s4">41</span><span class="s0">,</span><span class="s4">43</span><span class="s0">,</span><span class="s4">47</span><span class="s0">,</span><span class="s4">53</span><span class="s0">,</span><span class="s4">59</span><span class="s0">,</span><span class="s4">61</span><span class="s0">,</span><span class="s4">67</span><span class="s0">,</span><span class="s4">71</span><span class="s0">,</span><span class="s4">73</span><span class="s0">,</span><span class="s4">79</span><span class="s0">,</span><span class="s4">83</span><span class="s0">,</span><span class="s4">89</span><span class="s0">,</span><span class="s4">97</span><span class="s0">,</span><span class="s4">101</span><span class="s0">,</span><span class="s4">103</span><span class="s0">,</span><span class="s4">107</span><span class="s0">,</span><span class="s4">109</span><span class="s0">,</span><span class="s4">113</span><span class="s0">,</span><span class="s4">127</span><span class="s0">,</span><span class="s4">131</span><span class="s0">,</span><span class="s4">137</span><span class="s0">,</span><span class="s4">139</span><span class="s0">,</span><span class="s4">149</span><span class="s0">,</span><span class="s4">151</span><span class="s0">,</span><span class="s4">157</span><span class="s0">,</span><span class="s4">163</span><span class="s0">,</span><span class="s4">167</span><span class="s0">,</span><span class="s4">173</span><span class="s0">,</span><span class="s4">179</span><span class="s0">,</span><span class="s4">181</span><span class="s0">,</span><span class="s4">191</span><span class="s0">,</span><span class="s4">193</span><span class="s0">,</span><span class="s4">197</span><span class="s0">,</span><span class="s4">199</span><span class="s0">,</span><span class="s4">211</span><span class="s0">,</span><span class="s4">223</span><span class="s0">,</span><span class="s4">227</span><span class="s0">,</span><span class="s4">229</span><span class="s0">,</span><span class="s4">233</span><span class="s0">,</span><span class="s4">239</span><span class="s0">,</span><span class="s4">241</span><span class="s0">,</span><span class="s4">251</span><span class="s0">,</span><span class="s4">257</span><span class="s0">,</span><span class="s4">263</span><span class="s0">,</span><span class="s4">269</span><span class="s0">,</span><span class="s4">271</span><span class="s0">,</span><span class="s4">277</span><span class="s0">,</span><span class="s4">281</span><span class="s0">,</span><span class="s4">283</span><span class="s0">,</span><span class="s4">293</span><span class="s0">,</span><span class="s4">307</span><span class="s0">,</span><span class="s4">311</span><span class="s0">,</span><span class="s4">313</span><span class="s0">,</span><span class="s4">317</span><span class="s0">,</span><span class="s4">331</span><span class="s0">,</span><span class="s4">337</span><span class="s0">,</span><span class="s4">347</span><span class="s0">,</span><span class="s4">349</span><span class="s0">,</span><span class="s4">353</span><span class="s0">,</span><span class="s4">359</span><span class="s0">,</span><span class="s4">367</span><span class="s0">,</span><span class="s4">373</span><span class="s0">,</span><span class="s4">379</span><span class="s0">,</span><span class="s4">383</span><span class="s0">,</span><span class="s4">389</span><span class="s0">,</span><span class="s4">397</span><span class="s0">,</span><span class="s4">401</span><span class="s0">,</span><span class="s4">409</span><span class="s0">,</span><span class="s4">419</span><span class="s0">,</span><span class="s4">421</span><span class="s0">,</span><span class="s4">431</span><span class="s0">,</span><span class="s4">433</span><span class="s0">,</span><span class="s4">439</span><span class="s0">,</span><span class="s4">443</span><span class="s0">,</span><span class="s4">449</span><span class="s0">,</span><span class="s4">457</span><span class="s0">,</span><span class="s4">461</span><span class="s0">,</span><span class="s4">463</span><span class="s0">,</span><span class="s4">467</span><span class="s0">,</span><span class="s4">479</span><span class="s0">,</span><span class="s4">487</span><span class="s0">,</span><span class="s4">491</span><span class="s0">,</span><span class="s4">499</span><span class="s0">,</span><span class="s4">503</span><span class="s0">,</span><span class="s4">509</span><span class="s0">],</span><span class="s2">N</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s4">26</span><span class="s0">)/</span><span class="s2">b</span><span class="s0">[</span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">];</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">chunkSize</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">LN2</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">/</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toRadix</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">==</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s4">10</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()||</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">||</span><span class="s2">e</span><span class="s0">&gt;</span><span class="s4">36</span><span class="s0">)</span><span class="s1">return</span><span class="s3">&quot;0&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">chunkSize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s2">n</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">=(</span><span class="s2">r</span><span class="s0">+</span><span class="s2">i</span><span class="s0">.</span><span class="s2">intValue</span><span class="s0">()).</span><span class="s2">toString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)+</span><span class="s2">o</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">intValue</span><span class="s0">().</span><span class="s2">toString</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)+</span><span class="s2">o</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fromRadix</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s1">null</span><span class="s0">==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">10</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">chunkSize</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">);</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s3">&quot;-&quot;</span><span class="s0">==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)&amp;&amp;</span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()&amp;&amp;(</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">):(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">*</span><span class="s2">o</span><span class="s0">+</span><span class="s2">u</span><span class="s0">,++</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dMultiply</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">))}</span><span class="s2">s</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dMultiply</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s1">this</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">fromNumber</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromNumber</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">testBit</span><span class="s0">(</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)||</span><span class="s1">this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">(</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s2">m</span><span class="s0">,</span><span class="s1">this</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">);!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">isProbablePrime</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s4">2</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()&gt;</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">(</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s1">this</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">7</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s4">1</span><span class="s0">+(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s4">3</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">nextBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s2">n</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">a</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">n</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">:</span><span class="s2">a</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">fromString</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s4">256</span><span class="s0">)}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">n</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">}</span><span class="s2">r</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">changeBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">;</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s2">a</span><span class="s0">:</span><span class="s2">a</span><span class="s0">&lt;-</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">++]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">+</span><span class="s2">a</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">dMultiply</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">),++</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s2">t</span><span class="s0">;)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]+=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">;)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">,++</span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">++]=</span><span class="s4">0</span><span class="s0">),++</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">multiplyLowerTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[--</span><span class="s2">n</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">-</span><span class="s2">n</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">()},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">multiplyUpperTo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){--</span><span class="s2">t</span><span class="s0">;</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s2">t</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s4">0</span><span class="s0">);</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">a</span><span class="s0">-</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">am</span><span class="s0">(</span><span class="s2">t</span><span class="s0">-</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">+</span><span class="s2">a</span><span class="s0">-</span><span class="s2">t</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">clamp</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">drShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">modInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">%</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">:</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]%</span><span class="s2">e</span><span class="s0">;</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">*</span><span class="s2">r</span><span class="s0">+</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])%</span><span class="s2">e</span><span class="s0">;</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">millerRabin</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shiftRight</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">={</span><span class="s2">nextBytes</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s4">256</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">random</span><span class="s0">())}},</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">do</span><span class="s0">{</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">i</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)&lt;=</span><span class="s4">0</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">modPow</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s1">this</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)&amp;&amp;</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++&lt;</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">modPowInt</span><span class="s0">(</span><span class="s4">2</span><span class="s0">,</span><span class="s1">this</span><span class="s0">)).</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">intValue</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DV</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return </span><span class="s4">0</span><span class="s0">}</span><span class="s1">return</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]&amp;(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s4">32</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">|</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">byteValue</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&lt;&lt;</span><span class="s4">24</span><span class="s0">&gt;&gt;</span><span class="s4">24</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">shortValue</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&lt;&lt;</span><span class="s4">16</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?-</span><span class="s4">1</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">||</span><span class="s4">1</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&lt;=</span><span class="s4">0</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s4">1</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">toByteArray</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">;</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">e</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">%</span><span class="s4">8</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">-- &gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&gt;&gt;</span><span class="s2">a</span><span class="s0">)!=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">)&gt;&gt;</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">++]=</span><span class="s2">r</span><span class="s0">|</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s2">a</span><span class="s0">);</span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">8</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&amp;(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">a</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s4">8</span><span class="s0">-</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">|=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[--</span><span class="s2">e</span><span class="s0">]&gt;&gt;(</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s4">8</span><span class="s0">)):(</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]&gt;&gt;(</span><span class="s2">a</span><span class="s0">-=</span><span class="s4">8</span><span class="s0">)&amp;</span><span class="s4">255</span><span class="s0">,</span><span class="s2">a</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">,--</span><span class="s2">e</span><span class="s0">)),</span><span class="s4">0</span><span class="s0">!=(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">r</span><span class="s0">|=-</span><span class="s4">256</span><span class="s0">),</span><span class="s4">0</span><span class="s0">==</span><span class="s2">n</span><span class="s0">&amp;&amp;(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">)!=(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)&amp;&amp;++</span><span class="s2">n</span><span class="s0">,(</span><span class="s2">n</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">||</span><span class="s2">r</span><span class="s0">!=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">)&amp;&amp;(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">++]=</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">equals</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s4">0</span><span class="s0">==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">min</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">max</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">:</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">and</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">or</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">xor</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">C</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">andNot</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">E</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">not</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">&amp;~</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">=~</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(-</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">shiftRight</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">(-</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">):</span><span class="s1">this</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">])</span><span class="s1">return </span><span class="s2">e</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">+</span><span class="s2">S</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">:-</span><span class="s4">1</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">bitCount</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DM</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">+=</span><span class="s2">T</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">testBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">e</span><span class="s0">/</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">t</span><span class="s0">?</span><span class="s4">0</span><span class="s0">!=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">:</span><span class="s4">0</span><span class="s0">!=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">e</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">setBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">changeBit</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">m</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clearBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">changeBit</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">E</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">flipBit</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">changeBit</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">C</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">add</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">addTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">multiplyTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">divide</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">remainder</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">divideAndRemainder</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">divRemTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">modPow</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">i</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">18</span><span class="s0">?</span><span class="s4">1</span><span class="s0">:</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">48</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">144</span><span class="s0">?</span><span class="s4">4</span><span class="s0">:</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">768</span><span class="s0">?</span><span class="s4">5</span><span class="s0">:</span><span class="s4">6</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">8</span><span class="s0">?</span><span class="s1">new </span><span class="s2">y</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()?</span><span class="s1">new </span><span class="s2">B</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s1">new </span><span class="s2">g</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">r</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">convert</span><span class="s0">(</span><span class="s1">this</span><span class="s0">),</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">p</span><span class="s0">);</span><span class="s2">c</span><span class="s0">&lt;=</span><span class="s2">l</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">-</span><span class="s4">2</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">}</span><span class="s1">var </span><span class="s2">f</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s2">s</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">])-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">m</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&gt;=</span><span class="s2">u</span><span class="s0">?</span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]&gt;&gt;</span><span class="s2">n</span><span class="s0">-</span><span class="s2">u</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">:(</span><span class="s2">f</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]&amp;(</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">n</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">)&lt;&lt;</span><span class="s2">u</span><span class="s0">-</span><span class="s2">n</span><span class="s0">,</span><span class="s2">m</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">f</span><span class="s0">|=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]&gt;&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">+</span><span class="s2">n</span><span class="s0">-</span><span class="s2">u</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s4">0</span><span class="s0">==(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">f</span><span class="s0">);)</span><span class="s2">f</span><span class="s0">&gt;&gt;=</span><span class="s4">1</span><span class="s0">,--</span><span class="s2">c</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((</span><span class="s2">n</span><span class="s0">-=</span><span class="s2">c</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">,--</span><span class="s2">m</span><span class="s0">),</span><span class="s2">C</span><span class="s0">)</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">].</span><span class="s2">copyTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">c</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">E</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">c</span><span class="s0">-=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">E</span><span class="s0">):(</span><span class="s2">v</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">E</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s2">v</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mulTo</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">],</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">m</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">==(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s2">m</span><span class="s0">]&amp;</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">n</span><span class="s0">);)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sqrTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">E</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">E</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s2">v</span><span class="s0">,--</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">DB</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,--</span><span class="s2">m</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">revert</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">modInverse</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()&amp;&amp;</span><span class="s2">t</span><span class="s0">||</span><span class="s4">0</span><span class="s0">==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">())</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s4">0</span><span class="s0">!=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">();){</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">();)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()||(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">addTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)):</span><span class="s2">s</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()||</span><span class="s2">s</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">();)</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">t</span><span class="s0">?(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()||(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">addTo</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)):</span><span class="s2">c</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">()||</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)):(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">c</span><span class="s0">))}</span><span class="s1">return </span><span class="s4">0</span><span class="s0">!=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">ZERO</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subtract</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()&lt;</span><span class="s4">0</span><span class="s0">?(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">addTo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">add</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s2">c</span><span class="s0">):</span><span class="s2">c</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">exp</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">new </span><span class="s2">I</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">gcd</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">negate</span><span class="s0">():</span><span class="s1">this</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">negate</span><span class="s0">():</span><span class="s2">e</span><span class="s0">.</span><span class="s2">clone</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&lt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">}</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">));</span><span class="s2">t</span><span class="s0">.</span><span class="s2">signum</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">())&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getLowestSetBit</span><span class="s0">())&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)):(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subTo</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">rShiftTo</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">));</span><span class="s1">return </span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">lShiftTo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isProbablePrime</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&lt;=</span><span class="s2">b</span><span class="s0">[</span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]==</span><span class="s2">b</span><span class="s0">[</span><span class="s2">t</span><span class="s0">])</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">isEven</span><span class="s0">())</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">b</span><span class="s0">[</span><span class="s2">t</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">b</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">N</span><span class="s0">;)</span><span class="s2">a</span><span class="s0">*=</span><span class="s2">b</span><span class="s0">[</span><span class="s2">n</span><span class="s0">++];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">modInt</span><span class="s0">(</span><span class="s2">a</span><span class="s0">);</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">%</span><span class="s2">b</span><span class="s0">[</span><span class="s2">t</span><span class="s0">++]==</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">millerRabin</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">getAlgorithm</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">()),!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported algorithm: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">BlockCipher</span><span class="s0">({</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createDecipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">getAlgorithm</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">()),!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported algorithm: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">BlockCipher</span><span class="s0">({</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">decrypt</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">})},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">registerAlgorithm</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">getAlgorithm</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">())</span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]:</span><span class="s1">null</span><span class="s0">};</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">BlockCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">this</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_finish</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">output</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_op</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_decrypt</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">.</span><span class="s2">initialize</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)};</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_decrypt</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_finish</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">output</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">output</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_op</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">output</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_finish</span><span class="s0">)&amp;&amp;!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_finish</span><span class="s0">;);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">()},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){!</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;ECB&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;CBC&quot;</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">pad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">unpad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)});</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_decrypt</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">overflow</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">,!(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_decrypt</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">pad</span><span class="s0">&amp;&amp;!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">pad</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_input</span><span class="s0">,</span><span class="s2">t</span><span class="s0">))&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_finish</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(),!(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_decrypt</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">unpad</span><span class="s0">&amp;&amp;!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">unpad</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">output</span><span class="s0">,</span><span class="s2">t</span><span class="s0">))&amp;&amp;!(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">afterFinish</span><span class="s0">&amp;&amp;!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mode</span><span class="s0">.</span><span class="s2">afterFinish</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">output</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)))}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">u</span><span class="s0">||</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">i</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">128</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s4">64</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">9</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">7</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">21</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">21</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">21</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">21</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">64</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">e</span><span class="s0">)</span><span class="s2">c</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s4">4294967296</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">sin</span><span class="s0">(</span><span class="s2">e</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)));</span><span class="s2">u</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}();</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s3">&quot;md5&quot;</span><span class="s0">,</span><span class="s2">blockLength</span><span class="s0">:</span><span class="s4">64</span><span class="s0">,</span><span class="s2">digestLength</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s2">messageLength</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">fullMessageLength</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">messageLengthSize</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength64</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s4">1732584193</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s4">4023233417</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s4">2562383102</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s4">271733878</span><span class="s0">},</span><span class="s2">n</span><span class="s0">}};</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">i</span><span class="s0">));</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=[</span><span class="s2">o</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">c</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]+=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">2048</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s2">o</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">p</span><span class="s0">)</span><span class="s2">u</span><span class="s0">=(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]+</span><span class="s2">u</span><span class="s0">)/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">(</span><span class="s2">c</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">};</span><span class="s2">l</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32Le</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">),</span><span class="s2">h</span><span class="s0">},</span><span class="s2">n</span><span class="s0">};</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">h</span><span class="s0">&gt;=</span><span class="s4">64</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32Le</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+(</span><span class="s2">l</span><span class="s0">^</span><span class="s2">i</span><span class="s0">&amp;(</span><span class="s2">u</span><span class="s0">^</span><span class="s2">l</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">f</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">&lt;&lt;(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">])|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">32</span><span class="s0">-</span><span class="s2">p</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+(</span><span class="s2">u</span><span class="s0">^</span><span class="s2">l</span><span class="s0">&amp;(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">u</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">&lt;&lt;(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">])|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">32</span><span class="s0">-</span><span class="s2">p</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s4">48</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+(</span><span class="s2">i</span><span class="s0">^</span><span class="s2">u</span><span class="s0">^</span><span class="s2">l</span><span class="s0">)+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">&lt;&lt;(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">])|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">32</span><span class="s0">-</span><span class="s2">p</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+(</span><span class="s2">u</span><span class="s0">^(</span><span class="s2">i</span><span class="s0">|~</span><span class="s2">l</span><span class="s0">))+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">&lt;&lt;(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">f</span><span class="s0">])|</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">32</span><span class="s0">-</span><span class="s2">p</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">+</span><span class="s2">n</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">+</span><span class="s2">i</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">+</span><span class="s2">u</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">+</span><span class="s2">l</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">h</span><span class="s0">-=</span><span class="s4">64</span><span class="s0">}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs5</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs5</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">usePureJavaScript</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">16</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">usePureJavaScript</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">&amp;&amp;(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">||</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">)&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2Sync</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">4</span><span class="s0">||!</span><span class="s2">s</span><span class="s0">||</span><span class="s3">&quot;sha1&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">))</span><span class="s1">return</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s3">&quot;sha1&quot;</span><span class="s0">),</span><span class="s2">e</span><span class="s0">=</span><span class="s2">Buffer</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s3">&quot;binary&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">Buffer</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;binary&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">?</span><span class="s4">4</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2Sync</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">o</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">))})):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">o</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">))})):</span><span class="s4">4</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2Sync</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2Sync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">pbkdf2Sync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">==</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s3">&quot;sha1&quot;</span><span class="s0">),</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">s </span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unknown hash algorithm: &quot;</span><span class="s0">+</span><span class="s2">s</span><span class="s0">);</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">s</span><span class="s0">].</span><span class="s2">create</span><span class="s0">()}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">4294967295</span><span class="s0">*</span><span class="s2">c</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Derived key is too long.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">u</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">u</span><span class="s0">}</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">i</span><span class="s0">/</span><span class="s2">c</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">i</span><span class="s0">-(</span><span class="s2">l</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)*</span><span class="s2">c</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">v</span><span class="s0">&lt;=</span><span class="s2">l</span><span class="s0">;++</span><span class="s2">v</span><span class="s0">){</span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">int32ToBytes</span><span class="s0">(</span><span class="s2">v</span><span class="s0">)),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">y</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">m</span><span class="s0">&lt;=</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">m</span><span class="s0">)</span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">y</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">d</span><span class="s0">;</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">v</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">?</span><span class="s2">h</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">g</span><span class="s0">}</span><span class="s2">v</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">C</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">v</span><span class="s0">&gt;</span><span class="s2">l</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">g</span><span class="s0">);</span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">int32ToBytes</span><span class="s0">(</span><span class="s2">v</span><span class="s0">)),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">y</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">E</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">E</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">&lt;=</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">y</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,++</span><span class="s2">m</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">(</span><span class="s2">E</span><span class="s0">);</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">v</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">?</span><span class="s2">h</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">),++</span><span class="s2">v</span><span class="s0">,</span><span class="s2">C</span><span class="s0">()}</span><span class="s2">C</span><span class="s0">()}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">10</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">37</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">18</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">11</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{},</span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">,</span><span class="s2">o</span><span class="s0">={};</span><span class="s2">o</span><span class="s0">.</span><span class="s2">CN</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">commonName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">commonName</span><span class="s0">=</span><span class="s3">&quot;CN&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">C</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">countryName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">countryName</span><span class="s0">=</span><span class="s3">&quot;C&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">L</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">localityName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">localityName</span><span class="s0">=</span><span class="s3">&quot;L&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">ST</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">stateOrProvinceName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">stateOrProvinceName</span><span class="s0">=</span><span class="s3">&quot;ST&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">O</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">organizationName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">organizationName</span><span class="s0">=</span><span class="s3">&quot;O&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">OU</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">organizationalUnitName</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">organizationalUnitName</span><span class="s0">=</span><span class="s3">&quot;OU&quot;</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">E</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">emailAddress</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">emailAddress</span><span class="s0">=</span><span class="s3">&quot;E&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">publicKeyValidator</span><span class="s0">,</span><span class="s2">u</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;tbsCertificate&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.version.integer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certVersion&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.serialNumber&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certSerialNumber&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.signature&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.signature.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certinfoSignatureOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.signature.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certinfoSignatureParams&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.issuer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certIssuer&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.validity&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.validity.notBefore (utc)&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTCTIME</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certValidity1UTCTime&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.validity.notBefore (generalized)&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">GENERALIZEDTIME</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certValidity2GeneralizedTime&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.validity.notAfter (utc)&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTCTIME</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certValidity3UTCTime&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.validity.notAfter (generalized)&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">GENERALIZEDTIME</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certValidity4GeneralizedTime&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.subject&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certSubject&quot;</span><span class="s0">},</span><span class="s2">c</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.issuerUniqueID&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.issuerUniqueID.id&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureBitStringValue</span><span class="s0">:</span><span class="s3">&quot;certIssuerUniqueId&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.subjectUniqueID&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.subjectUniqueID.id&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureBitStringValue</span><span class="s0">:</span><span class="s3">&quot;certSubjectUniqueId&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.extensions&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certExtensions&quot;</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.signatureAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.signatureAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certSignatureOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.TBSCertificate.signature.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certSignatureParams&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Certificate.signatureValue&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureBitStringValue</span><span class="s0">:</span><span class="s3">&quot;certSignature&quot;</span><span class="s0">}]},</span><span class="s2">l</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.hashAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.hashAlgorithm.AlgorithmIdentifier&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;hashOid&quot;</span><span class="s0">}]}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.maskGenAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.maskGenAlgorithm.AlgorithmIdentifier&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;maskGenOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.maskGenAlgorithm.AlgorithmIdentifier.params&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;maskGenHashOid&quot;</span><span class="s0">}]}]}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.saltLength&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.saltLength.saltLength&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;saltLength&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.trailerField&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;rsapss.trailer.trailer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;trailer&quot;</span><span class="s0">}]}]},</span><span class="s2">p</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certificationRequestInfo&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.integer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certificationRequestInfoVersion&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.subject&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certificationRequestInfoSubject&quot;</span><span class="s0">},</span><span class="s2">c</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.attributes&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certificationRequestInfoAttributes&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.attributes&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.attributes.type&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequestInfo.attributes.value&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}]}]}]},</span><span class="s2">f</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequest&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;csr&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[</span><span class="s2">p</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequest.signatureAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequest.signatureAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;csrSignatureOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequest.signatureAlgorithm.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;csrSignatureParams&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertificationRequest.signature&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureBitStringValue</span><span class="s0">:</span><span class="s3">&quot;csrSignature&quot;</span><span class="s0">}]};</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">shortName</span><span class="s0">:</span><span class="s2">t</span><span class="s0">});</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">null</span><span class="s0">===</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">)&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=[],</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">u</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">l</span><span class="s0">)</span><span class="s2">i</span><span class="s0">={},</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">l</span><span class="s0">],</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">value</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">valueTagClass</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">type</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type </span><span class="s1">in </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">],</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">])),</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">c</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">CRIAttributesAsArray</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">value</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">l</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">l</span><span class="s0">].</span><span class="s2">value</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">valueTagClass</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">l</span><span class="s0">].</span><span class="s2">type</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">type </span><span class="s1">in </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">p</span><span class="s0">.</span><span class="s2">type</span><span class="s0">],</span><span class="s2">p</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">p</span><span class="s0">.</span><span class="s2">name</span><span class="s0">])),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">extensionRequest</span><span class="s0">){</span><span class="s2">p</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">p</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionFromAsn1</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]))}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">};</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">[</span><span class="s3">&quot;RSASSA-PSS&quot;</span><span class="s0">])</span><span class="s1">return </span><span class="s2">a</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">={</span><span class="s2">hash</span><span class="s0">:{</span><span class="s2">algorithmOid</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">},</span><span class="s2">mgf</span><span class="s0">:{</span><span class="s2">algorithmOid</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">,</span><span class="s2">hash</span><span class="s0">:{</span><span class="s2">algorithmOid</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">}},</span><span class="s2">saltLength</span><span class="s0">:</span><span class="s4">20</span><span class="s0">});</span><span class="s1">var </span><span class="s2">i</span><span class="s0">={},</span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read RSASSA-PSS parameter block.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">c</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">}</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">hashOid</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">hashOid</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">maskGenOid</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">maskGenOid</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">maskGenHashOid</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">},</span><span class="s2">y</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">]){</span><span class="s1">case</span><span class="s3">&quot;sha1WithRSAEncryption&quot;</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;sha1WithRSASignature&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">case</span><span class="s3">&quot;md5WithRSAEncryption&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">case</span><span class="s3">&quot;sha256WithRSAEncryption&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">case</span><span class="s3">&quot;sha384WithRSAEncryption&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">case</span><span class="s3">&quot;sha512WithRSAEncryption&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">case</span><span class="s3">&quot;RSASSA-PSS&quot;</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not compute &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">&quot; digest. Unknown signature OID.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">t</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">t</span><span class="s0">}},</span><span class="s2">g</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificate</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">){</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">sha1WithRSAEncryption</span><span class="s0">:</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">sha1WithRSASignature</span><span class="s0">:</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">s</span><span class="s0">[</span><span class="s3">&quot;RSASSA-PSS&quot;</span><span class="s0">]:</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">])||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported MGF hash function.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">])||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">[</span><span class="s2">i</span><span class="s0">])</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported MGF function.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">create</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">create</span><span class="s0">()),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">])||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported RSASSA-PSS hash function.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pss</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)};</span><span class="s1">function </span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]).</span><span class="s2">value</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">PRINTABLESTRING</span><span class="s0">;</span><span class="s3">&quot;valueTagClass&quot;</span><span class="s1">in </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">valueTagClass</span><span class="s0">)===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTF8</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">)])]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">}</span><span class="s1">function </span><span class="s2">m</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]).</span><span class="s2">name</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type </span><span class="s1">in </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName </span><span class="s1">in </span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">o</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">]])),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||!(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Attribute type not specified.&quot;</span><span class="s0">)).</span><span class="s2">attribute</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">c</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">]}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shortName</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">extensionRequest</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">valueConstructed</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">valueTagClass</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionToAsn1</span><span class="s0">(</span><span class="s2">C</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])))}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Attribute value not specified.&quot;</span><span class="s0">)).</span><span class="s2">attribute</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">c</span><span class="s0">}}</span><span class="s1">function </span><span class="s2">C</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{},</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id </span><span class="s1">in </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">]),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||!(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">S</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Extension ID not specified.&quot;</span><span class="s0">)).</span><span class="s2">extension</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">S</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">]}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;keyUsage&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digitalSignature</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">128</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">7</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">nonRepudiation</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">6</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyEncipherment</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">5</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dataEncipherment</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">4</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyAgreement</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">3</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyCertSign</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cRLSign</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encipherOnly</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decipherOnly</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">|=</span><span class="s4">128</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">7</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">?</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">c</span><span class="s0">):</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cA</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BOOLEAN</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">))),</span><span class="s3">&quot;pathLenConstraint&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">pathLenConstraint</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()));</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;extKeyUsage&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p </span><span class="s1">in </span><span class="s2">e</span><span class="s0">)!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]&amp;&amp;(</span><span class="s2">p </span><span class="s1">in </span><span class="s2">s</span><span class="s0">?</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]).</span><span class="s2">getBytes</span><span class="s0">())):-</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">p</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;.&quot;</span><span class="s0">)&amp;&amp;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())))}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;nsCertType&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">client</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">128</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">7</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">server</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">6</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">email</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">5</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">objsign</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">4</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">reserved</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">3</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sslCA</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">2</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">emailCA</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">objCA</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">|=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">);</span><span class="s2">u</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;subjectAltName&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||</span><span class="s3">&quot;issuerAltName&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">){</span><span class="s2">u</span><span class="s0">=(</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]).</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">7</span><span class="s0">===</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesFromIP</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">)))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">S</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Extension &quot;ip&quot; value is not a valid IPv4 or IPv6 address.'</span><span class="s0">)).</span><span class="s2">extension</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">S</span><span class="s0">}</span><span class="s1">else </span><span class="s4">8</span><span class="s0">===</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">)):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">u</span><span class="s0">));</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">))}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;nsComment&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s5">/^[\x00-\x7F]*$/</span><span class="s0">.</span><span class="s2">test</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">comment</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">comment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">1</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">comment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">128</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid &quot;nsComment&quot; content.'</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">IA5STRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">comment</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;subjectKeyIdentifier&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">.</span><span class="s2">generateSubjectKeyIdentifier</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subjectKeyIdentifier</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;authorityKeyIdentifier&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyIdentifier</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyIdentifier</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">.</span><span class="s2">generateSubjectKeyIdentifier</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">():</span><span class="s2">e</span><span class="s0">.</span><span class="s2">keyIdentifier</span><span class="s0">;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">d</span><span class="s0">))}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">authorityCertIssuer</span><span class="s0">){</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">v</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">authorityCertIssuer</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">authorityCertIssuer</span><span class="s0">)])];</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">y</span><span class="s0">))}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">){</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">);</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">g</span><span class="s0">))}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;cRLDistributionPoints&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">var </span><span class="s2">m</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">){</span><span class="s2">u</span><span class="s0">=(</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]).</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">7</span><span class="s0">===</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesFromIP</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">)))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">S</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Extension &quot;ip&quot; value is not a valid IPv4 or IPv6 address.'</span><span class="s0">)).</span><span class="s2">extension</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">S</span><span class="s0">}</span><span class="s1">else </span><span class="s4">8</span><span class="s0">===</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">m</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">)):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">u</span><span class="s0">));</span><span class="s2">E</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">m</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">))}</span><span class="s2">C</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">E</span><span class="s0">])),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">C</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">S</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">S</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Extension value not specified.&quot;</span><span class="s0">)).</span><span class="s2">extension</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">S</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case </span><span class="s2">s</span><span class="s0">[</span><span class="s3">&quot;RSASSA-PSS&quot;</span><span class="s0">]:</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">return void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)])])),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)])])])),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">default</span><span class="s0">:</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)}}</span><span class="s1">function </span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTF8</span><span class="s0">;</span><span class="s3">&quot;valueTagClass&quot;</span><span class="s1">in </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valueTagClass</span><span class="s0">),</span><span class="s2">c</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTF8</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">o</span><span class="s0">));</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s3">&quot;valueConstructed&quot;</span><span class="s1">in </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">valueConstructed</span><span class="s0">);</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)])]);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;X509 CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;TRUSTED CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert certificate from PEM; PEM header type is not &quot;CERTIFICATE&quot;, &quot;X509 CERTIFICATE&quot;, or &quot;TRUSTED CERTIFICATE&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert certificate from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">body</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;CERTIFICATE&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;PUBLIC KEY&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;RSA PUBLIC KEY&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert public key from PEM; PEM header type is not &quot;PUBLIC KEY&quot; or &quot;RSA PUBLIC KEY&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert public key from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">body</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;PUBLIC KEY&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToRSAPublicKeyPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;RSA PUBLIC KEY&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToRSAPublicKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getPublicKeyFingerprint</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">md</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">||</span><span class="s3">&quot;RSAPublicKey&quot;</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;RSAPublicKey&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToRSAPublicKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;SubjectPublicKeyInfo&quot;</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unknown fingerprint type &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">)}</span><span class="s2">s</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;hex&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s5">/.{2}/g</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">):</span><span class="s2">c</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unknown encoding &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;CERTIFICATE REQUEST&quot;</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert certification request from PEM; PEM header type is not &quot;CERTIFICATE REQUEST&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert certification request from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">body</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestFromAsn1</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;CERTIFICATE REQUEST&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">serialNumber</span><span class="s0">:</span><span class="s3">&quot;00&quot;</span><span class="s0">,</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">signature</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">siginfo</span><span class="s0">:{}};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">={},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notBefore</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notAfter</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">={},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">t</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">={},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">t</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setSubject</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">delete </span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">,</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">=</span><span class="s2">r</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setIssuer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s1">delete </span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">,</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">=</span><span class="s2">r</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setExtensions</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">C</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],{</span><span class="s2">cert</span><span class="s0">:</span><span class="s2">e</span><span class="s0">});</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=</span><span class="s2">t</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getExtension</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">t</span><span class="s0">});</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">null</span><span class="s0">===</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">id</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">name</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)&amp;&amp;(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">+</span><span class="s3">&quot;WithRSAEncryption&quot;</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not compute certificate digest. Unknown message digest algorithm OID.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">c</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">c</span><span class="s0">}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getTBSCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issued</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">expectedIssuer</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">actualIssuer</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">md</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">){</span><span class="s2">c</span><span class="s0">=</span><span class="s2">y</span><span class="s0">({</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;certificate&quot;</span><span class="s0">});</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getTBSCertificate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">u</span><span class="s0">);</span><span class="s2">c</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())}</span><span class="s1">return null</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">g</span><span class="s0">({</span><span class="s2">certificate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">md</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">signature</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">})),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">isIssuer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">[</span><span class="s2">o</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">[</span><span class="s2">o</span><span class="s0">],</span><span class="s2">i</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">value</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">||(</span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issued</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">isIssuer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">generateSubjectKeyIdentifier</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">getPublicKeyFingerprint</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;RSAPublicKey&quot;</span><span class="s0">})},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifySubjectKeyIdentifier</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">subjectKeyIdentifier</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">id</span><span class="s0">===</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">generateSubjectKeyIdentifier</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">subjectKeyIdentifier</span><span class="s0">)===</span><span class="s2">i</span><span class="s0">}}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">e</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={},</span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">publicKeyOid</span><span class="s0">)!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read public key. OID is not RSA.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createCertificate</span><span class="s0">();</span><span class="s2">c</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certVersion</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certVersion</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">):</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSerialNumber</span><span class="s0">);</span><span class="s2">c</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSignatureOid</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSignatureParams</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certinfoSignatureOid</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certinfoSignatureParams</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSignature</span><span class="s0">;</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity1UTCTime</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">utcTimeToDate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity1UTCTime</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity2GeneralizedTime</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generalizedTimeToDate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity2GeneralizedTime</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity3UTCTime</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">utcTimeToDate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity3UTCTime</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity4GeneralizedTime</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generalizedTimeToDate</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certValidity4GeneralizedTime</span><span class="s0">)),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notBefore</span><span class="s0">=</span><span class="s2">p</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">c</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notAfter</span><span class="s0">=</span><span class="s2">p</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">c</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">y</span><span class="s0">({</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;certificate&quot;</span><span class="s0">});</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">);</span><span class="s2">c</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())}</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certIssuer</span><span class="s0">);</span><span class="s2">g</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">v</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">e</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certIssuer</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certIssuerUniqueId</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certIssuerUniqueId</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">g</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">toHex</span><span class="s0">();</span><span class="s1">var </span><span class="s2">C</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSubject</span><span class="s0">);</span><span class="s1">return </span><span class="s2">C</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">E</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">e</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSubject</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSubjectUniqueId</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certSubjectUniqueId</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">C</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certExtensions</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionsFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certExtensions</span><span class="s0">):</span><span class="s2">c</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">=[],</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subjectPublicKeyInfo</span><span class="s0">),</span><span class="s2">c</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionsFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionFromAsn1</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">critical</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BOOLEAN</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">critical</span><span class="s0">=</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">2</span><span class="s0">].</span><span class="s2">value</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">value</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id </span><span class="s1">in </span><span class="s2">s</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">],</span><span class="s3">&quot;keyUsage&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)).</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">2</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">2</span><span class="s0">):</span><span class="s4">0</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digitalSignature</span><span class="s0">=</span><span class="s4">128</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">nonRepudiation</span><span class="s0">=</span><span class="s4">64</span><span class="s0">==(</span><span class="s4">64</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyEncipherment</span><span class="s0">=</span><span class="s4">32</span><span class="s0">==(</span><span class="s4">32</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dataEncipherment</span><span class="s0">=</span><span class="s4">16</span><span class="s0">==(</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyAgreement</span><span class="s0">=</span><span class="s4">8</span><span class="s0">==(</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyCertSign</span><span class="s0">=</span><span class="s4">4</span><span class="s0">==(</span><span class="s4">4</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cRLSign</span><span class="s0">=</span><span class="s4">2</span><span class="s0">==(</span><span class="s4">2</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encipherOnly</span><span class="s0">=</span><span class="s4">1</span><span class="s0">==(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decipherOnly</span><span class="s0">=</span><span class="s4">128</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)).</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BOOLEAN</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cA</span><span class="s0">=</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">):</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cA</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">type</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">?</span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">].</span><span class="s2">value</span><span class="s0">),</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pathLenConstraint</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToInteger</span><span class="s0">(</span><span class="s2">o</span><span class="s0">))}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;extKeyUsage&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">u</span><span class="s0">].</span><span class="s2">value</span><span class="s0">);</span><span class="s2">l </span><span class="s1">in </span><span class="s2">s</span><span class="s0">?</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]]=!</span><span class="s4">0</span><span class="s0">:</span><span class="s2">t</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]=!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;nsCertType&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)).</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">1</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">client</span><span class="s0">=</span><span class="s4">128</span><span class="s0">==(</span><span class="s4">128</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">server</span><span class="s0">=</span><span class="s4">64</span><span class="s0">==(</span><span class="s4">64</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">email</span><span class="s0">=</span><span class="s4">32</span><span class="s0">==(</span><span class="s4">32</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">objsign</span><span class="s0">=</span><span class="s4">16</span><span class="s0">==(</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reserved</span><span class="s0">=</span><span class="s4">8</span><span class="s0">==(</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sslCA</span><span class="s0">=</span><span class="s4">4</span><span class="s0">==(</span><span class="s4">4</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">emailCA</span><span class="s0">=</span><span class="s4">2</span><span class="s0">==(</span><span class="s4">2</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">objCA</span><span class="s0">=</span><span class="s4">1</span><span class="s0">==(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;subjectAltName&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">||</span><span class="s3">&quot;issuerAltName&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">=[];</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">f</span><span class="s0">]).</span><span class="s2">type</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">};</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">altNames</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">h</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">case </span><span class="s4">1</span><span class="s0">:</span><span class="s1">case </span><span class="s4">2</span><span class="s0">:</span><span class="s1">case </span><span class="s4">6</span><span class="s0">:</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s4">7</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">ip</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToIP</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s4">8</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}}}</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;subjectKeyIdentifier&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">name</span><span class="s0">){</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">subjectKeyIdentifier</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={},</span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">publicKeyOid</span><span class="s0">)!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read public key. OID is not RSA.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createCertificationRequest</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrVersion</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrVersion</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">):</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrSignatureOid</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrSignatureParams</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrSignatureOid</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrSignatureParams</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">csrSignature</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">y</span><span class="s0">({</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;certification request&quot;</span><span class="s0">});</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">);</span><span class="s2">c</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())}</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">e</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certificationRequestInfoSubject</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">subjectPublicKeyInfo</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">getAttribute</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">addAttribute</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">e</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">c</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">CRIAttributesAsArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">certificationRequestInfoAttributes</span><span class="s0">||[]),</span><span class="s2">c</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createCertificationRequest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">signature</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">siginfo</span><span class="s0">:{}};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">={},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">getField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">addField</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">t</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getAttribute</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">addAttribute</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">([</span><span class="s2">t</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setSubject</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s1">null</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setAttributes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">m</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">t</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">+</span><span class="s3">&quot;WithRSAEncryption&quot;</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not compute certification request digest. Unknown message digest algorithm OID.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">c</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">c</span><span class="s0">}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getCertificationRequestInfo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s2">y</span><span class="s0">({</span><span class="s2">signatureOid</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;certification request&quot;</span><span class="s0">});</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getCertificationRequestInfo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())}</span><span class="s1">return null</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">g</span><span class="s0">({</span><span class="s2">certificate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">md</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">signature</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">})),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">e</span><span class="s0">};</span><span class="s1">var </span><span class="s2">T</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s3">&quot;1950-01-01T00:00:00Z&quot;</span><span class="s0">),</span><span class="s2">I</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s3">&quot;2050-01-01T00:00:00Z&quot;</span><span class="s0">);</span><span class="s1">function </span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&gt;=</span><span class="s2">T</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">&lt;</span><span class="s2">I</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTCTIME</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToUtcTime</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">GENERALIZEDTIME</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToGeneralizedTime</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getTBSCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notBefore</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notAfter</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">algorithmOid</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">siginfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">)]),</span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">]),</span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">)]);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">)])),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">uniqueId</span><span class="s0">)])),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionsToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getCertificationRequestInfo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">publicKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">),</span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)])},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">distinguishedNameToAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tbsCertificate</span><span class="s0">||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getTBSCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">)]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">)])},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionsToAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateExtensionToAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">id</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">critical</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BOOLEAN</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">255</span><span class="s0">)));</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">return</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificationRequestToAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificationRequestInfo</span><span class="s0">||</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getCertificationRequestInfo</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureOid</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureParameters</span><span class="s0">)]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">)])},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createCaStore</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={</span><span class="s2">certs</span><span class="s0">:{}};</span><span class="s1">function </span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">]||</span><span class="s1">null</span><span class="s0">}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">(</span><span class="s2">v</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">toHex</span><span class="s0">()}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getIssuer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">addCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">),!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hasCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash </span><span class="s1">in </span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">];</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)||(</span><span class="s2">r</span><span class="s0">=[</span><span class="s2">r</span><span class="s0">]),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">}</span><span class="s1">else </span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hasCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)||(</span><span class="s2">t</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">])).</span><span class="s2">getBytes</span><span class="s0">())</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">listAllCertificates</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r </span><span class="s1">in </span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">.</span><span class="s2">hasOwnProperty</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">n</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]);</span><span class="s1">else </span><span class="s2">e</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">removeCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">),!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">hasCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))</span><span class="s1">return null</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">c</span><span class="s0">))</span><span class="s1">return </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">],</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">],</span><span class="s2">o</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">l</span><span class="s0">){</span><span class="s2">u</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">c</span><span class="s0">[</span><span class="s2">l</span><span class="s0">])).</span><span class="s2">getBytes</span><span class="s0">()&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s2">l</span><span class="s0">],</span><span class="s2">c</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s4">1</span><span class="s0">))}</span><span class="s1">return </span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s1">delete </span><span class="s2">t</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">.</span><span class="s2">hash</span><span class="s0">],</span><span class="s2">o</span><span class="s0">},</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">o</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">addCertificate</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">={</span><span class="s2">bad_certificate</span><span class="s0">:</span><span class="s3">&quot;forge.pki.BadCertificate&quot;</span><span class="s0">,</span><span class="s2">unsupported_certificate</span><span class="s0">:</span><span class="s3">&quot;forge.pki.UnsupportedCertificate&quot;</span><span class="s0">,</span><span class="s2">certificate_revoked</span><span class="s0">:</span><span class="s3">&quot;forge.pki.CertificateRevoked&quot;</span><span class="s0">,</span><span class="s2">certificate_expired</span><span class="s0">:</span><span class="s3">&quot;forge.pki.CertificateExpired&quot;</span><span class="s0">,</span><span class="s2">certificate_unknown</span><span class="s0">:</span><span class="s3">&quot;forge.pki.CertificateUnknown&quot;</span><span class="s0">,</span><span class="s2">unknown_ca</span><span class="s0">:</span><span class="s3">&quot;forge.pki.UnknownCertificateAuthority&quot;</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">verifyCertificateChain</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">={</span><span class="s2">verify</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)).</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">validityCheckDate</span><span class="s0">;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notBefore</span><span class="s0">||</span><span class="s2">s</span><span class="s0">&gt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notAfter</span><span class="s0">)&amp;&amp;(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate is not valid yet or has expired.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">,</span><span class="s2">notBefore</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notBefore</span><span class="s0">,</span><span class="s2">notAfter</span><span class="s0">:</span><span class="s2">l</span><span class="s0">.</span><span class="s2">validity</span><span class="s0">.</span><span class="s2">notAfter</span><span class="s0">,</span><span class="s2">now</span><span class="s0">:</span><span class="s2">s</span><span class="s0">}),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getIssuer</span><span class="s0">(</span><span class="s2">l</span><span class="s0">))&amp;&amp;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isIssuer</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)&amp;&amp;(</span><span class="s2">f</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">l</span><span class="s0">),</span><span class="s2">p</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">p</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">h</span><span class="s0">)||(</span><span class="s2">h</span><span class="s0">=[</span><span class="s2">h</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;!</span><span class="s2">d</span><span class="s0">&amp;&amp;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;){</span><span class="s2">p</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">try</span><span class="s0">{</span><span class="s2">d</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}}</span><span class="s2">d</span><span class="s0">||(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate signature is invalid.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">})}</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">||</span><span class="s2">p</span><span class="s0">&amp;&amp;!</span><span class="s2">f</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">hasCertificate</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)||(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate is not trusted.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">})}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">&amp;&amp;!</span><span class="s2">l</span><span class="s0">.</span><span class="s2">isIssuer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)&amp;&amp;(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate issuer is invalid.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">y</span><span class="s0">={</span><span class="s2">keyUsage</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">basicConstraints</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">g</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s2">g</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">g</span><span class="s0">){</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">[</span><span class="s2">g</span><span class="s0">];</span><span class="s2">v</span><span class="s0">.</span><span class="s2">critical</span><span class="s0">&amp;&amp;!(</span><span class="s2">v</span><span class="s0">.</span><span class="s2">name </span><span class="s1">in </span><span class="s2">y</span><span class="s0">)&amp;&amp;(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate has an unsupported critical extension.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">})}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;(!</span><span class="s2">o</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(!</span><span class="s2">p</span><span class="s0">||</span><span class="s2">f</span><span class="s0">))){</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getExtension</span><span class="s0">(</span><span class="s3">&quot;basicConstraints&quot;</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getExtension</span><span class="s0">(</span><span class="s3">&quot;keyUsage&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">C</span><span class="s0">&amp;&amp;(</span><span class="s2">C</span><span class="s0">.</span><span class="s2">keyCertSign</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">m</span><span class="s0">||(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">})),</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">m</span><span class="s0">||</span><span class="s2">m</span><span class="s0">.</span><span class="s2">cA</span><span class="s0">||(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate basicConstraints indicates the certificate is not a CA.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">C</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;pathLenConstraint&quot;</span><span class="s1">in </span><span class="s2">m</span><span class="s0">)</span><span class="s2">u</span><span class="s0">-</span><span class="s4">1</span><span class="s0">&gt;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">pathLenConstraint</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Certificate basicConstraints pathLenConstraint violated.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">})}</span><span class="s1">var </span><span class="s2">E</span><span class="s0">=</span><span class="s1">null</span><span class="s0">===</span><span class="s2">c</span><span class="s0">||</span><span class="s2">c</span><span class="s0">.</span><span class="s2">error</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">n</span><span class="s0">):</span><span class="s2">E</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">S</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">!</span><span class="s4">0</span><span class="s0">===</span><span class="s2">E</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;The application rejected the certificate.&quot;</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}),(</span><span class="s2">S</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">S</span><span class="s0">)&amp;&amp;(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">S</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">S</span><span class="s0">)?</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">S</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">error</span><span class="s0">=</span><span class="s2">S</span><span class="s0">):(</span><span class="s2">S</span><span class="s0">.</span><span class="s2">message</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">S</span><span class="s0">.</span><span class="s2">message</span><span class="s0">),</span><span class="s2">S</span><span class="s0">.</span><span class="s2">error</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">error</span><span class="s0">=</span><span class="s2">S</span><span class="s0">.</span><span class="s2">error</span><span class="s0">))),</span><span class="s2">c</span><span class="s0">;</span><span class="s2">c</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,++</span><span class="s2">u</span><span class="s0">}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pss</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pss</span><span class="s0">||{}).</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s4">3</span><span class="s0">===</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">={</span><span class="s2">md</span><span class="s0">:</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">mgf</span><span class="s0">:</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">saltLength</span><span class="s0">:</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]});</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">salt</span><span class="s0">||</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)),</span><span class="s3">&quot;saltLength&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">saltLength</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Salt length not specified or specific salt not given.&quot;</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()!==</span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Given salt length does not match length of given salt.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">,</span><span class="s2">c</span><span class="s0">={</span><span class="s2">encode</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">c</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">p</span><span class="s0">/</span><span class="s4">8</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Message is too long to encrypt.&quot;</span><span class="s0">);</span><span class="s2">l</span><span class="s0">=</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">t</span><span class="s0">):</span><span class="s2">s</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s2">d</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">),</span><span class="s2">d</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">h</span><span class="s0">),</span><span class="s2">d</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">g</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s2">g</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">-</span><span class="s2">t</span><span class="s0">-</span><span class="s2">i</span><span class="s0">-</span><span class="s4">2</span><span class="s0">),</span><span class="s2">g</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">g</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">l</span><span class="s0">);</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s2">g</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">f</span><span class="s0">-</span><span class="s2">i</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">m</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">m</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++)</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">v</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">u</span><span class="s0">)^</span><span class="s2">C</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">u</span><span class="s0">));</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s4">65280</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">*</span><span class="s2">f</span><span class="s0">-</span><span class="s2">p</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">;</span><span class="s1">return</span><span class="s0">(</span><span class="s2">E</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">E</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;~</span><span class="s2">S</span><span class="s0">)+</span><span class="s2">E</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">))+</span><span class="s2">y</span><span class="s0">+</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">188</span><span class="s0">)},</span><span class="s2">verify</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">o</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">u</span><span class="s0">/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(-</span><span class="s2">l</span><span class="s0">),</span><span class="s2">l</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Inconsistent parameters to PSS signature verification.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">188</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">l</span><span class="s0">-</span><span class="s4">1</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Encoded message does not end in 0xBC.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">l</span><span class="s0">-</span><span class="s2">i</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s4">65280</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">*</span><span class="s2">l</span><span class="s0">-</span><span class="s2">u</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!=(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;</span><span class="s2">d</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Bits beyond keysize not zero as expected.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">p</span><span class="s0">),</span><span class="s2">g</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">p</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)^</span><span class="s2">y</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">));</span><span class="s2">g</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">g</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;~</span><span class="s2">d</span><span class="s0">)+</span><span class="s2">g</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s2">l</span><span class="s0">-</span><span class="s2">i</span><span class="s0">-</span><span class="s2">t</span><span class="s0">-</span><span class="s4">2</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">v</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">g</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Leftmost octets not zero as expected&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">g</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">v</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Inconsistent PSS signature, 0x01 marker not found&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s2">g</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(-</span><span class="s2">t</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">return </span><span class="s2">C</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">),</span><span class="s2">C</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">C</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">m</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">C</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">h</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()}};</span><span class="s1">return </span><span class="s2">c</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">modes</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">4</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">])}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV length; got &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()+</span><span class="s3">&quot; bytes and expected &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">+</span><span class="s3">&quot; bytes.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">/</span><span class="s4">4</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">());</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s4">4294967295</span><span class="s0">}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">[</span><span class="s2">e</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s4">4294967295</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">]}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;ECB&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&amp;&amp;!(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&amp;&amp;!(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">])},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">pad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ecb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">unpad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">overflow</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return</span><span class="s0">!(</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),!</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;CBC&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;iv&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&amp;&amp;!(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]^</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&amp;&amp;!(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_prev</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">pad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cbc</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">unpad</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">overflow</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">);</span><span class="s1">return</span><span class="s0">!(</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&lt;&lt;</span><span class="s4">2</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),!</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;CFB&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;iv&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">a</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">else for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cfb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">a</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">else for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;OFB&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;iv&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">a</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">else for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ofb</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;CTR&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;iv&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_iv</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">a</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ctr</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s1">this</span><span class="s0">.</span><span class="s2">name</span><span class="s0">=</span><span class="s3">&quot;GCM&quot;</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">||</span><span class="s4">16</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_R</span><span class="s0">=</span><span class="s4">3774873600</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">start</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;iv&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid IV parameter.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;additionalData&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">additionalData</span><span class="s0">):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tagLength</span><span class="s0">=</span><span class="s3">&quot;tagLength&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tagLength</span><span class="s0">:</span><span class="s4">128</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tag</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">&amp;&amp;(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tag</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tag</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tagLength</span><span class="s0">/</span><span class="s4">8</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Authentication tag does not match tag length.&quot;</span><span class="s0">);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">([</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">componentBits</span><span class="s0">=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_m</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">generateHashTable</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">componentBits</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">12</span><span class="s0">===</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">=[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s4">1</span><span class="s0">];</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">,[</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()]);</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">,[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">)))}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_aDataLength</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s4">8</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">());</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()])},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">a</span><span class="s0">)</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s4">0</span><span class="s0">===</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]^=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">());</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">a</span><span class="s0">)%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">i</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&lt;=</span><span class="s4">0</span><span class="s0">||</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">else this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">),</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialOutput</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">)),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_partialBytes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">&amp;&amp;!(</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">))</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_inBlock</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">(),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_outBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]^</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashBlock</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">?</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">%</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">:</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">+=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">afterFinish</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">overflow</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">blockSize</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">overflow</span><span class="s0">),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_aDataLength</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s4">8</span><span class="s0">*</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_cipherLength</span><span class="s0">));</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_hashSubkey</span><span class="s0">,</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=[];</span><span class="s1">this</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_j0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_ints</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_s</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]^</span><span class="s2">i</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]);</span><span class="s1">return this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()%(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tagLength</span><span class="s0">/</span><span class="s4">8</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">&amp;&amp;</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tag</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()!==</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_tag</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">128</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">){</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">/</span><span class="s4">32</span><span class="s0">|</span><span class="s4">0</span><span class="s0">]&amp;</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s4">31</span><span class="s0">-</span><span class="s2">n</span><span class="s0">%</span><span class="s4">32</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">r</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]),</span><span class="s1">this</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s4">3</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">|(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">])&lt;&lt;</span><span class="s4">31</span><span class="s0">;</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_R</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">tableMultiply</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">/</span><span class="s4">8</span><span class="s0">|</span><span class="s4">0</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">4</span><span class="s0">*(</span><span class="s4">7</span><span class="s0">-</span><span class="s2">r</span><span class="s0">%</span><span class="s4">8</span><span class="s0">)&amp;</span><span class="s4">15</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">_m</span><span class="s0">[</span><span class="s2">r</span><span class="s0">][</span><span class="s2">a</span><span class="s0">];</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^=</span><span class="s2">n</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]^=</span><span class="s2">n</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^=</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]^=</span><span class="s2">n</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">ghash</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]^=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]^=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s1">this</span><span class="s0">.</span><span class="s2">tableMultiply</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">generateHashTable</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">8</span><span class="s0">/</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">4</span><span class="s0">*</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">16</span><span class="s0">*</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">-</span><span class="s2">s</span><span class="s0">%</span><span class="s2">a</span><span class="s0">)*</span><span class="s2">t</span><span class="s0">;</span><span class="s2">o</span><span class="s0">[</span><span class="s2">s</span><span class="s0">/</span><span class="s2">a</span><span class="s0">|</span><span class="s4">0</span><span class="s0">]=</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">c</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s1">this</span><span class="s0">.</span><span class="s2">generateSubHashTable</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">multiply</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">gcm</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">generateSubHashTable</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">n</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s1">this</span><span class="s0">.</span><span class="s2">pow</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">2</span><span class="s0">*</span><span class="s2">i</span><span class="s0">],</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=[]),</span><span class="s2">i</span><span class="s0">&gt;&gt;=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s4">2</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">+</span><span class="s2">s</span><span class="s0">]=[</span><span class="s2">o</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^</span><span class="s2">c</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]^</span><span class="s2">c</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^</span><span class="s2">c</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]^</span><span class="s2">c</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]]}</span><span class="s2">i</span><span class="s0">*=</span><span class="s4">2</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">^</span><span class="s2">a</span><span class="s0">];</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=[</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]^</span><span class="s2">u</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]^</span><span class="s2">u</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]^</span><span class="s2">u</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]^</span><span class="s2">u</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]]}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">14</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">21</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;&gt;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">+(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">+</span><span class="s2">r</span><span class="s0">;</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">n</span><span class="s0">/</span><span class="s4">16</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">n</span><span class="s0">/</span><span class="s4">20</span><span class="s0">);</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s3">&quot;MD5&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">);</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">y</span><span class="s0">&lt;</span><span class="s2">f</span><span class="s0">;++</span><span class="s2">y</span><span class="s0">)</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()+</span><span class="s2">r</span><span class="s0">),</span><span class="s2">d</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">());</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s3">&quot;SHA1&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">);</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">l</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">y</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">y</span><span class="s0">&lt;</span><span class="s2">h</span><span class="s0">;++</span><span class="s2">y</span><span class="s0">)</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()+</span><span class="s2">r</span><span class="s0">),</span><span class="s2">g</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">());</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">g</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">},</span><span class="s2">i</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">try</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">deflate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">s</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">try</span><span class="s0">{</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">inflate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">o</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">case </span><span class="s4">1</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s4">2</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s4">3</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt24</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s4">4</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))},</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putInt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">={</span><span class="s2">Versions</span><span class="s0">:{</span><span class="s2">TLS_1_0</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s4">1</span><span class="s0">},</span><span class="s2">TLS_1_1</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s4">2</span><span class="s0">},</span><span class="s2">TLS_1_2</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s4">3</span><span class="s0">}}};</span><span class="s2">u</span><span class="s0">.</span><span class="s2">SupportedVersions</span><span class="s0">=[</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_0</span><span class="s0">],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Version</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">SupportedVersions</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MaxFragment</span><span class="s0">=</span><span class="s4">15360</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">={</span><span class="s2">server</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">client</span><span class="s0">:</span><span class="s4">1</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">PRFAlgorithm</span><span class="s0">={</span><span class="s2">tls_prf_sha256</span><span class="s0">:</span><span class="s4">0</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">BulkCipherAlgorithm</span><span class="s0">={</span><span class="s2">none</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">rc4</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">des3</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">aes</span><span class="s0">:</span><span class="s4">2</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherType</span><span class="s0">={</span><span class="s2">stream</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">block</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">aead</span><span class="s0">:</span><span class="s4">2</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MACAlgorithm</span><span class="s0">={</span><span class="s2">none</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">hmac_md5</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">hmac_sha1</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">hmac_sha256</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">hmac_sha384</span><span class="s0">:</span><span class="s4">3</span><span class="s0">,</span><span class="s2">hmac_sha512</span><span class="s0">:</span><span class="s4">4</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CompressionMethod</span><span class="s0">={</span><span class="s2">none</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">deflate</span><span class="s0">:</span><span class="s4">1</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">={</span><span class="s2">change_cipher_spec</span><span class="s0">:</span><span class="s4">20</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:</span><span class="s4">21</span><span class="s0">,</span><span class="s2">handshake</span><span class="s0">:</span><span class="s4">22</span><span class="s0">,</span><span class="s2">application_data</span><span class="s0">:</span><span class="s4">23</span><span class="s0">,</span><span class="s2">heartbeat</span><span class="s0">:</span><span class="s4">24</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">={</span><span class="s2">hello_request</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">client_hello</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">server_hello</span><span class="s0">:</span><span class="s4">2</span><span class="s0">,</span><span class="s2">certificate</span><span class="s0">:</span><span class="s4">11</span><span class="s0">,</span><span class="s2">server_key_exchange</span><span class="s0">:</span><span class="s4">12</span><span class="s0">,</span><span class="s2">certificate_request</span><span class="s0">:</span><span class="s4">13</span><span class="s0">,</span><span class="s2">server_hello_done</span><span class="s0">:</span><span class="s4">14</span><span class="s0">,</span><span class="s2">certificate_verify</span><span class="s0">:</span><span class="s4">15</span><span class="s0">,</span><span class="s2">client_key_exchange</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s2">finished</span><span class="s0">:</span><span class="s4">20</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">={},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">={</span><span class="s2">warning</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">fatal</span><span class="s0">:</span><span class="s4">2</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">={</span><span class="s2">close_notify</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">unexpected_message</span><span class="s0">:</span><span class="s4">10</span><span class="s0">,</span><span class="s2">bad_record_mac</span><span class="s0">:</span><span class="s4">20</span><span class="s0">,</span><span class="s2">decryption_failed</span><span class="s0">:</span><span class="s4">21</span><span class="s0">,</span><span class="s2">record_overflow</span><span class="s0">:</span><span class="s4">22</span><span class="s0">,</span><span class="s2">decompression_failure</span><span class="s0">:</span><span class="s4">30</span><span class="s0">,</span><span class="s2">handshake_failure</span><span class="s0">:</span><span class="s4">40</span><span class="s0">,</span><span class="s2">bad_certificate</span><span class="s0">:</span><span class="s4">42</span><span class="s0">,</span><span class="s2">unsupported_certificate</span><span class="s0">:</span><span class="s4">43</span><span class="s0">,</span><span class="s2">certificate_revoked</span><span class="s0">:</span><span class="s4">44</span><span class="s0">,</span><span class="s2">certificate_expired</span><span class="s0">:</span><span class="s4">45</span><span class="s0">,</span><span class="s2">certificate_unknown</span><span class="s0">:</span><span class="s4">46</span><span class="s0">,</span><span class="s2">illegal_parameter</span><span class="s0">:</span><span class="s4">47</span><span class="s0">,</span><span class="s2">unknown_ca</span><span class="s0">:</span><span class="s4">48</span><span class="s0">,</span><span class="s2">access_denied</span><span class="s0">:</span><span class="s4">49</span><span class="s0">,</span><span class="s2">decode_error</span><span class="s0">:</span><span class="s4">50</span><span class="s0">,</span><span class="s2">decrypt_error</span><span class="s0">:</span><span class="s4">51</span><span class="s0">,</span><span class="s2">export_restriction</span><span class="s0">:</span><span class="s4">60</span><span class="s0">,</span><span class="s2">protocol_version</span><span class="s0">:</span><span class="s4">70</span><span class="s0">,</span><span class="s2">insufficient_security</span><span class="s0">:</span><span class="s4">71</span><span class="s0">,</span><span class="s2">internal_error</span><span class="s0">:</span><span class="s4">80</span><span class="s0">,</span><span class="s2">user_canceled</span><span class="s0">:</span><span class="s4">90</span><span class="s0">,</span><span class="s2">no_renegotiation</span><span class="s0">:</span><span class="s4">100</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HeartbeatMessageType</span><span class="s0">={</span><span class="s2">heartbeat_request</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">heartbeat_response</span><span class="s0">:</span><span class="s4">2</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">={},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getCipherSuite</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleUnexpected</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">open</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Unexpected message. Received TLS record out of order.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unexpected_message</span><span class="s0">}})},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHelloRequest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshakes</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createAlert</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">warning</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">no_renegotiation</span><span class="s0">})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">parseHelloMessage</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">38</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s2">i</span><span class="s0">?</span><span class="s3">&quot;Invalid ServerHello message. Message too short.&quot;</span><span class="s0">:</span><span class="s3">&quot;Invalid ClientHello message. Message too short.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}});</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()},</span><span class="s2">random</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">32</span><span class="s0">)),</span><span class="s2">session_id</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s4">1</span><span class="s0">),</span><span class="s2">extensions</span><span class="s0">:[]},</span><span class="s2">i</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cipher_suite</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">compression_method</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()):(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cipher_suites</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s4">2</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">compression_methods</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s4">1</span><span class="s0">)),(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">-(</span><span class="s2">c</span><span class="s0">-</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()))&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s4">2</span><span class="s0">);</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">type</span><span class="s0">:[</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()],</span><span class="s2">data</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s4">2</span><span class="s0">)});</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">){</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">[</span><span class="s2">p</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">type</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">type</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">data</span><span class="s0">,</span><span class="s4">2</span><span class="s0">);</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">h</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">())</span><span class="s1">break</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">server_name</span><span class="s0">.</span><span class="s2">serverNameList</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s4">2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())}}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">||</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;TLS version change is disallowed during renegotiation.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">protocol_version</span><span class="s0">}});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getCipherSuite</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cipher_suite</span><span class="s0">);</span><span class="s1">else for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cipher_suites</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getCipherSuite</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">2</span><span class="s0">)),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">););</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;No cipher suites in common.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">handshake_failure</span><span class="s0">},</span><span class="s2">cipherSuite</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">cipher_suite</span><span class="s0">)});</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">compressionMethod</span><span class="s0">=</span><span class="s2">i</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">compression_method</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CompressionMethod</span><span class="s0">.</span><span class="s2">none</span><span class="s0">}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSecurityParameters</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">:</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s2">a</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRandom</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">={</span><span class="s2">entity</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">,</span><span class="s2">prf_algorithm</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">PRFAlgorithm</span><span class="s0">.</span><span class="s2">tls_prf_sha256</span><span class="s0">,</span><span class="s2">bulk_cipher_algorithm</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">cipher_type</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">enc_key_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">block_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">fixed_iv_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">record_iv_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">mac_algorithm</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">mac_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">mac_key_length</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">compression_algorithm</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">compressionMethod</span><span class="s0">,</span><span class="s2">pre_master_secret</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">master_secret</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">client_random</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">server_random</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerHello</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">parseHelloMessage</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">&lt;=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">))</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Incompatible TLS version.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">protocol_version</span><span class="s0">}});</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">;</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">session_id</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">server_random</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()):(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSecurityParameters</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleClientHello</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">parseHelloMessage</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">session_id</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">&amp;&amp;(</span><span class="s1">null</span><span class="s0">===(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">.</span><span class="s2">getSession</span><span class="s0">(</span><span class="s2">i</span><span class="s0">))?</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">:(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">||</span><span class="s2">s</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">&gt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">)&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">)),</span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">32</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientHelloVersion</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">={},</span><span class="s2">s</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">SupportedVersions</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;!((</span><span class="s2">o</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">SupportedVersions</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]).</span><span class="s2">minor</span><span class="s0">&lt;=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">);++</span><span class="s2">c</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">={</span><span class="s2">major</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">major</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">}</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">S</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()):(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyClient</span><span class="s0">?</span><span class="s2">m</span><span class="s0">:</span><span class="s2">C</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSecurityParameters</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">open</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerHello</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">?(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">change_cipher_spec</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createChangeCipherSpec</span><span class="s0">()})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnectionState</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createFinished</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}))):(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">||(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerKeyExchange</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyClient</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificateRequest</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerHelloDone</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})))),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">3</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid Certificate message. Message too short.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}});</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">c</span><span class="s0">={</span><span class="s2">certificate_list</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s4">3</span><span class="s0">)},</span><span class="s2">l</span><span class="s0">=[];</span><span class="s1">try</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certificate_list</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certificate_list</span><span class="s0">,</span><span class="s4">3</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not parse certificate list.&quot;</span><span class="s0">,</span><span class="s2">cause</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}})}</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">;!</span><span class="s2">f</span><span class="s0">&amp;&amp;!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyClient</span><span class="s0">||</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s4">0</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">f</span><span class="s0">?</span><span class="s2">p</span><span class="s0">:</span><span class="s2">C</span><span class="s0">:(</span><span class="s2">f</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">=</span><span class="s2">l</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">verifyCertificateChain</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">f</span><span class="s0">?</span><span class="s2">p</span><span class="s0">:</span><span class="s2">C</span><span class="s0">)):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s2">f</span><span class="s0">?</span><span class="s3">&quot;No server certificate provided.&quot;</span><span class="s0">:</span><span class="s3">&quot;No client certificate provided.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}}),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerKeyExchange</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid key parameters. Only RSA is supported.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">}});</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">f</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleClientKeyExchange</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">48</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid key parameters. Only RSA is supported.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">}});</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">i</span><span class="s0">={</span><span class="s2">enc_pre_master_secret</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s4">2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getPrivateKey</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getPrivateKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not get private key.&quot;</span><span class="s0">,</span><span class="s2">cause</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}})}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;No private key set.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}});</span><span class="s1">try</span><span class="s0">{</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">enc_pre_master_secret</span><span class="s0">);</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientHelloVersion</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">major</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)||</span><span class="s2">l</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">1</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;TLS version rollback attack detected.&quot;</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">48</span><span class="s0">)}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">S</span><span class="s0">,</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">E</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificateRequest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">3</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid CertificateRequest. Message too short.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}});</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">n</span><span class="s0">={</span><span class="s2">certificate_types</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s4">1</span><span class="s0">),</span><span class="s2">certificate_authorities</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s4">2</span><span class="s0">)};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">certificateRequest</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificateVerify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid CertificateVerify. Message too short.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}});</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">={</span><span class="s2">signature</span><span class="s0">:</span><span class="s2">o</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s4">2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">c</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">try</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">,</span><span class="s3">&quot;NONE&quot;</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;CertificateVerify signature does not match.&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Bad signature in CertificateVerify.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">handshake_failure</span><span class="s0">}})}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">S</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerHelloDone</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid ServerHelloDone message. Invalid length.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">record_overflow</span><span class="s0">}});</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">={</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;No server certificate provided. Not enough security.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">insufficient_security</span><span class="s0">}},</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">.</span><span class="s2">description</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">)</span><span class="s1">return</span><span class="s0">(</span><span class="s2">i</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">)&amp;&amp;(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)?</span><span class="s3">&quot;number&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">.</span><span class="s2">description</span><span class="s0">=</span><span class="s2">i</span><span class="s0">):(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">message</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">message</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">.</span><span class="s2">description</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">))),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">certificateRequest</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createClientKeyExchange</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">v</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">certificateRequest</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">&amp;&amp;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificateVerify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">change_cipher_spec</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createChangeCipherSpec</span><span class="s0">()})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnectionState</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createFinished</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()};</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">certificateRequest</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">)</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s1">null</span><span class="s0">);</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getClientSignature</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleChangeCipherSpec</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">())</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid ChangeCipherSpec message received.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">}});</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">||!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnectionState</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">read</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">.</span><span class="s2">read</span><span class="s0">,(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s2">y</span><span class="s0">:</span><span class="s2">T</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleFinished</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s2">i</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">()).</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">());</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">c</span><span class="s0">?</span><span class="s3">&quot;server finished&quot;</span><span class="s0">:</span><span class="s3">&quot;client finished&quot;</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">master_secret</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s4">12</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()!==</span><span class="s2">o</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid verify_data in Finished message.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decrypt_error</span><span class="s0">}});</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">||!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">&amp;&amp;!</span><span class="s2">c</span><span class="s0">)&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">change_cipher_spec</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createChangeCipherSpec</span><span class="s0">()})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">write</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">.</span><span class="s2">write</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">pending</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createFinished</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}))),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=</span><span class="s2">c</span><span class="s0">?</span><span class="s2">g</span><span class="s0">:</span><span class="s2">I</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshakes</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">peerCertificate</span><span class="s0">=</span><span class="s2">c</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">isConnected</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">connected</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleAlert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">n</span><span class="s0">={</span><span class="s2">level</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">description</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()};</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">description</span><span class="s0">){</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">close_notify</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Connection closed.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unexpected_message</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Unexpected message.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_record_mac</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Bad record MAC.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decryption_failed</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Decryption failed.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">record_overflow</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Record overflow.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decompression_failure</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Decompression failed.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">handshake_failure</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Handshake failure.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Bad certificate.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Unsupported certificate.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_revoked</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Certificate revoked.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Certificate expired.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_unknown</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Certificate unknown.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">illegal_parameter</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Illegal parameter.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Unknown certificate authority.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">access_denied</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Access denied.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decode_error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Decode error.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decrypt_error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Decrypt error.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">export_restriction</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Export restriction.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">protocol_version</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Unsupported protocol version.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">insufficient_security</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Insufficient security.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Internal error.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">user_canceled</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;User canceled.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">no_renegotiation</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Renegotiation not supported.&quot;</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;Unknown error.&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">description</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">close_notify</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">close</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">origin</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">?</span><span class="s3">&quot;server&quot;</span><span class="s0">:</span><span class="s3">&quot;client&quot;</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHandshake</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt24</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">read</span><span class="s0">-=</span><span class="s4">4</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+</span><span class="s4">4</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">read</span><span class="s0">+=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">n </span><span class="s1">in </span><span class="s2">K</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">][</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">]?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">server</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">open</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">extensions</span><span class="s0">:{</span><span class="s2">server_name</span><span class="s0">:{</span><span class="s2">serverNameList</span><span class="s0">:[]}},</span><span class="s2">cipherSuite</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">compressionMethod</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">serverCertificate</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">clientCertificate</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">md5</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">sha1</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">()}),</span><span class="s2">n</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">hello_request</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">certificate_verify</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">finished</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">K</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">][</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">][</span><span class="s2">n</span><span class="s0">](</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)):</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleUnexpected</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleApplicationData</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dataReady</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHeartbeat</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HeartbeatMessageType</span><span class="s0">.</span><span class="s2">heartbeat_request</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">||</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">();</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">heartbeat</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createHeartbeat</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HeartbeatMessageType</span><span class="s0">.</span><span class="s2">heartbeat_response</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HeartbeatMessageType</span><span class="s0">.</span><span class="s2">heartbeat_response</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expectedHeartbeatPayload</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">heartbeatReceived</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">heartbeatReceived</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">))}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">process</span><span class="s0">()};</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">5</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s4">6</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s4">7</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s4">3</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s4">5</span><span class="s0">,</span><span class="s2">I</span><span class="s0">=</span><span class="s4">6</span><span class="s0">,</span><span class="s2">A</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleUnexpected</span><span class="s0">,</span><span class="s2">B</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleChangeCipherSpec</span><span class="s0">,</span><span class="s2">b</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleAlert</span><span class="s0">,</span><span class="s2">N</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHandshake</span><span class="s0">,</span><span class="s2">R</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleApplicationData</span><span class="s0">,</span><span class="s2">w</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHeartbeat</span><span class="s0">,</span><span class="s2">_</span><span class="s0">=[];</span><span class="s2">_</span><span class="s0">[</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">]=[[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">B</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">R</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">]],</span><span class="s2">_</span><span class="s0">[</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">server</span><span class="s0">]=[[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">B</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">R</span><span class="s0">,</span><span class="s2">w</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">w</span><span class="s0">]];</span><span class="s1">var </span><span class="s2">L</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleHelloRequest</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerHello</span><span class="s0">,</span><span class="s2">U</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificate</span><span class="s0">,</span><span class="s2">D</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerKeyExchange</span><span class="s0">,</span><span class="s2">P</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificateRequest</span><span class="s0">,</span><span class="s2">V</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleServerHelloDone</span><span class="s0">,</span><span class="s2">O</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleFinished</span><span class="s0">,</span><span class="s2">K</span><span class="s0">=[];</span><span class="s2">K</span><span class="s0">[</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">]=[[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">k</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">U</span><span class="s0">,</span><span class="s2">D</span><span class="s0">,</span><span class="s2">P</span><span class="s0">,</span><span class="s2">V</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">D</span><span class="s0">,</span><span class="s2">P</span><span class="s0">,</span><span class="s2">V</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">P</span><span class="s0">,</span><span class="s2">V</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">V</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">O</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">L</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">]];</span><span class="s1">var </span><span class="s2">x</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleClientHello</span><span class="s0">,</span><span class="s2">M</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleClientKeyExchange</span><span class="s0">,</span><span class="s2">F</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleCertificateVerify</span><span class="s0">;</span><span class="s2">K</span><span class="s0">[</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">server</span><span class="s0">]=[[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">x</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">U</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">M</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">F</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">O</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">],[</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">A</span><span class="s0">]],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">generateKeys</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">server_random</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">resuming</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">master_secret</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">,</span><span class="s3">&quot;master secret&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s4">48</span><span class="s0">).</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">server_random</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">2</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mac_key_length</span><span class="s0">+</span><span class="s4">2</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">enc_key_length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_0</span><span class="s0">.</span><span class="s2">major</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_0</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">*</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fixed_iv_length</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">master_secret</span><span class="s0">,</span><span class="s3">&quot;key expansion&quot;</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">c</span><span class="s0">={</span><span class="s2">client_write_MAC_key</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mac_key_length</span><span class="s0">),</span><span class="s2">server_write_MAC_key</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">mac_key_length</span><span class="s0">),</span><span class="s2">client_write_key</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">enc_key_length</span><span class="s0">),</span><span class="s2">server_write_key</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">enc_key_length</span><span class="s0">)};</span><span class="s1">return </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">client_write_IV</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fixed_iv_length</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">server_write_IV</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fixed_iv_length</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnectionState</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">={</span><span class="s2">sequenceNumber</span><span class="s0">:[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">],</span><span class="s2">macKey</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">macLength</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">macFunction</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">cipherState</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">cipherFunction</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">compressionState</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">compressFunction</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">},</span><span class="s2">updateSequenceNumber</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s4">4294967295</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">,++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]):++</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]}};</span><span class="s1">return </span><span class="s2">e</span><span class="s0">},</span><span class="s2">a</span><span class="s0">={</span><span class="s2">read</span><span class="s0">:</span><span class="s2">r</span><span class="s0">(),</span><span class="s2">write</span><span class="s0">:</span><span class="s2">r</span><span class="s0">()};</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">cipherFunction</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">compressFunction</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not decompress record.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">decompression_failure</span><span class="s0">}}):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not decrypt record or bad MAC.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_record_mac</span><span class="s0">}}),!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">compressFunction</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">)?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">cipherFunction</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">)||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not encrypt record.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}}):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not compress record.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}}),!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">.</span><span class="s2">initSecurityParameters</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">generateKeys</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">macKey</span><span class="s0">=</span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_MAC_key</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_MAC_key</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">macKey</span><span class="s0">=</span><span class="s2">t</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_MAC_key</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_MAC_key</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">.</span><span class="s2">initConnectionState</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">compression_algorithm</span><span class="s0">){</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">CompressionMethod</span><span class="s0">.</span><span class="s2">none</span><span class="s0">:</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">CompressionMethod</span><span class="s0">.</span><span class="s2">deflate</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">compressFunction</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">compressFunction</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported compression algorithm.&quot;</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRandom</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=+</span><span class="s2">e</span><span class="s0">+</span><span class="s4">6e4</span><span class="s0">*</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getTimezoneOffset</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">28</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">?{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">},</span><span class="s2">length</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">fragment</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">data</span><span class="s0">}:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createAlert</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">level</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">description</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">r</span><span class="s0">})},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createClientHello</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientHelloVersion</span><span class="s0">={</span><span class="s2">major</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipherSuites</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipherSuites</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])}</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CompressionMethod</span><span class="s0">.</span><span class="s2">none</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">virtualHost</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">p</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">f</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">virtualHost</span><span class="s0">));</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">c</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">f</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">h</span><span class="s0">),</span><span class="s2">l</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">d</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">d</span><span class="s0">+=</span><span class="s4">2</span><span class="s0">);</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">y</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s4">1</span><span class="s0">+</span><span class="s4">2</span><span class="s0">+</span><span class="s4">4</span><span class="s0">+</span><span class="s4">28</span><span class="s0">+</span><span class="s4">2</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s2">d</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">v</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">client_hello</span><span class="s0">),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">g</span><span class="s0">),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">d</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">v</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerHello</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s4">1</span><span class="s0">+</span><span class="s4">2</span><span class="s0">+</span><span class="s4">4</span><span class="s0">+</span><span class="s4">28</span><span class="s0">+</span><span class="s4">2</span><span class="s0">+</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">server_hello</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">server_random</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">cipherSuite</span><span class="s0">.</span><span class="s2">id</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">compressionMethod</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getCertificate</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">certificateRequest</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">extensions</span><span class="s0">.</span><span class="s2">server_name</span><span class="s0">.</span><span class="s2">serverNameList</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getCertificate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">));</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)||(</span><span class="s2">n</span><span class="s0">=[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">o</span><span class="s0">])[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;X509 CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;TRUSTED CERTIFICATE&quot;</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert certificate from PEM; PEM header type is not &quot;CERTIFICATE&quot;, &quot;X509 CERTIFICATE&quot;, or &quot;TRUSTED CERTIFICATE&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">p</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">p</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert certificate from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">body</span><span class="s0">);</span><span class="s1">null</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),!</span><span class="s4">1</span><span class="s0">));</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">c</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s2">f</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">h</span><span class="s0">)}</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">r</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">=</span><span class="s2">n</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">=</span><span class="s2">n</span><span class="s0">}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not send certificate list.&quot;</span><span class="s0">,</span><span class="s2">cause</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}})}</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s4">3</span><span class="s0">+</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">y</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">certificate</span><span class="s0">),</span><span class="s2">y</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">d</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">y</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createClientKeyExchange</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientHelloVersion</span><span class="s0">.</span><span class="s2">major</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientHelloVersion</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">46</span><span class="s0">));</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">serverCertificate</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">pre_master_secret</span><span class="s0">)).</span><span class="s2">length</span><span class="s0">+</span><span class="s4">2</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">client_key_exchange</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">i</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerKeyExchange</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getClientSignature</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSignature</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSignature</span><span class="s0">||</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getPrivateKey</span><span class="s0">)</span><span class="s1">try</span><span class="s0">{</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getPrivateKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">clientCertificate</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Could not get private key.&quot;</span><span class="s0">,</span><span class="s2">cause</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}})}</span><span class="s1">null</span><span class="s0">===</span><span class="s2">n</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;No private key set.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">internal_error</span><span class="s0">}}):</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSignature</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificateVerify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">+</span><span class="s4">2</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">certificate_verify</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createCertificateRequest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">.</span><span class="s2">certs</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">distinguishedNameToAsn1</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">subject</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">1</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()+</span><span class="s4">2</span><span class="s0">+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">certificate_request</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">p</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createServerHelloDone</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">server_hello_done</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createChangeCipherSpec</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createFinished</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">());</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s3">&quot;client finished&quot;</span><span class="s0">:</span><span class="s3">&quot;server finished&quot;</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">master_secret</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s4">12</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HandshakeType</span><span class="s0">.</span><span class="s2">finished</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">putInt24</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">o</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createHeartbeat</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">16</span><span class="s0">,</span><span class="s2">i</span><span class="s0">-</span><span class="s2">r</span><span class="s0">-</span><span class="s4">3</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">change_cipher_spec</span><span class="s0">)){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">}</span><span class="s1">var </span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MaxFragment</span><span class="s0">)</span><span class="s2">n</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">else</span><span class="s0">{</span><span class="s2">n</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">();</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MaxFragment</span><span class="s0">;)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MaxFragment</span><span class="s0">))})),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">MaxFragment</span><span class="s0">);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}))}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">records</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}}},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">records</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">records</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">records</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">fragment</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">records</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsDataReady</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">j</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s0">!</span><span class="s4">0</span><span class="s0">:</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_revoked</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_revoked</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_unknown</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_unknown</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">G </span><span class="s1">in </span><span class="s2">u</span><span class="s0">.</span><span class="s2">verifyCertificateChain</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={};</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyOptions</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyOptions</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s2">j</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">&amp;&amp;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;The application rejected the certificate.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">send</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">={</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">message</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">message</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">message</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">.</span><span class="s2">description</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">),</span><span class="s2">s</span><span class="s0">}</span><span class="s2">i</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s0">!</span><span class="s4">0</span><span class="s0">:</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unsupported_certificate</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_revoked</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_revoked</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_expired</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">certificate_unknown</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">certificate_unknown</span><span class="s0">;</span><span class="s1">case </span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">unknown_ca</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateError</span><span class="s0">.</span><span class="s2">bad_certificate</span><span class="s0">}}(</span><span class="s2">i</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">verifyCertificateChain</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">;(</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">))&amp;&amp;(</span><span class="s2">i</span><span class="s0">={</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">j</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}}),</span><span class="s3">&quot;send&quot;</span><span class="s1">in </span><span class="s2">i</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">send</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;alert&quot;</span><span class="s1">in </span><span class="s2">i</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">={</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">j</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">error</span><span class="s0">)}),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">return</span><span class="s0">!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSessionCache</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSession</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">setSession</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">order</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n </span><span class="s1">in</span><span class="s0">(</span><span class="s2">r</span><span class="s0">={}).</span><span class="s2">cache</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">capacity</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s2">t</span><span class="s0">||</span><span class="s4">100</span><span class="s0">,</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&lt;=</span><span class="s2">t</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">):</span><span class="s1">delete </span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getSession</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">?</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">):</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">n </span><span class="s1">in </span><span class="s2">r</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s1">in </span><span class="s2">t</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s1">delete </span><span class="s2">r</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]===</span><span class="s2">n</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s4">1</span><span class="s0">);</span><span class="s1">break</span><span class="s0">}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">setSession</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">capacity</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">shift</span><span class="s0">();</span><span class="s1">delete </span><span class="s2">r</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]}</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">order</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">cache</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnection</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">)?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">createCaStore</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">caStore</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">createCaStore</span><span class="s0">();</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipherSuites</span><span class="s0">||</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n </span><span class="s1">in </span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">server</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">server</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">?</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSessionCache</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">):</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">},</span><span class="s2">entity</span><span class="s0">:</span><span class="s2">i</span><span class="s0">,</span><span class="s2">sessionId</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sessionId</span><span class="s0">,</span><span class="s2">caStore</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">sessionCache</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">cipherSuites</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">connected</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">connected</span><span class="s0">,</span><span class="s2">virtualHost</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">virtualHost</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">verifyClient</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyClient</span><span class="s0">||!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">verify</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">||</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">},</span><span class="s2">verifyOptions</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">verifyOptions</span><span class="s0">||{},</span><span class="s2">getCertificate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getCertificate</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">getPrivateKey</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getPrivateKey</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">getSignature</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getSignature</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">input</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">tlsData</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">data</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">tlsDataReady</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">tlsDataReady</span><span class="s0">,</span><span class="s2">dataReady</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">dataReady</span><span class="s0">,</span><span class="s2">heartbeatReceived</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">heartbeatReceived</span><span class="s0">,</span><span class="s2">closed</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">closed</span><span class="s0">,</span><span class="s2">error</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">r</span><span class="s0">.</span><span class="s2">origin</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">origin</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">?</span><span class="s3">&quot;client&quot;</span><span class="s0">:</span><span class="s3">&quot;server&quot;</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">send</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createAlert</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">alert</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">t</span><span class="s0">));</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">close</span><span class="s0">(!</span><span class="s4">1</span><span class="s0">)},</span><span class="s2">deflate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">deflate</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">inflate</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">inflate</span><span class="s0">||</span><span class="s1">null</span><span class="s0">,</span><span class="s2">reset</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">o</span><span class="s0">.</span><span class="s2">version</span><span class="s0">={</span><span class="s2">major</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">,</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">peerCertificate</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">state</span><span class="s0">={</span><span class="s2">pending</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">current</span><span class="s0">:</span><span class="s1">null</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">=(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">,</span><span class="s4">0</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">records</span><span class="s0">=[],</span><span class="s2">o</span><span class="s0">.</span><span class="s2">open</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshakes</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isConnected</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">=!(</span><span class="s2">e</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">input</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">tlsData</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">data</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnectionState</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}};</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reset</span><span class="s0">();</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Cannot initiate handshake as a server.&quot;</span><span class="s0">,</span><span class="s2">fatal</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Handshake already in progress.&quot;</span><span class="s0">,</span><span class="s2">fatal</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">});</span><span class="s1">else</span><span class="s0">{</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">&amp;&amp;!</span><span class="s2">o</span><span class="s0">.</span><span class="s2">open</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshakes</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">.</span><span class="s2">getSession</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">)),</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">.</span><span class="s2">getSession</span><span class="s0">())&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">cipherSuite</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">compressionMethod</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">serverCertificate</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">certificateRequest</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">clientCertificate</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">sp</span><span class="s0">:{},</span><span class="s2">md5</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">sha1</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">()},</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">client_random</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRandom</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">open</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">handshake</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createClientHello</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">process</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">input</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">||(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">ready</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">isEmpty</span><span class="s0">()&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">input</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">5</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s4">5</span><span class="s0">-</span><span class="s2">n</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">version</span><span class="s0">:{</span><span class="s2">major</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">minor</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">()},</span><span class="s2">length</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt16</span><span class="s0">(),</span><span class="s2">fragment</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">ready</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">};</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">&amp;&amp;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">i</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Incompatible TLS version.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">protocol_version</span><span class="s0">}})}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}(</span><span class="s2">o</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">ready</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">input</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s2">a</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">state</span><span class="s0">.</span><span class="s2">current</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">)&amp;&amp;(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">type</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragmented</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">error</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,{</span><span class="s2">message</span><span class="s0">:</span><span class="s3">&quot;Invalid fragmented record.&quot;</span><span class="s0">,</span><span class="s2">send</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">alert</span><span class="s0">:{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">fatal</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">unexpected_message</span><span class="s0">}})),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">ready</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}(</span><span class="s2">o</span><span class="s0">)),!</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">&amp;&amp;</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">.</span><span class="s2">ready</span><span class="s0">&amp;&amp;</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">-</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">change_cipher_spec</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">_</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">][</span><span class="s2">e</span><span class="s0">.</span><span class="s2">expect</span><span class="s0">];</span><span class="s2">r </span><span class="s1">in </span><span class="s2">a</span><span class="s0">?</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">](</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">):</span><span class="s2">u</span><span class="s0">.</span><span class="s2">handleUnexpected</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">record</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">prepare</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">application_data</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">prepareHeartbeatRequest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">expectedHeartbeatPayload</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createRecord</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">type</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">ContentType</span><span class="s0">.</span><span class="s2">heartbeat</span><span class="s0">,</span><span class="s2">data</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createHeartbeat</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">HeartbeatMessageType</span><span class="s0">.</span><span class="s2">heartbeat_request</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)},</span><span class="s2">o</span><span class="s0">.</span><span class="s2">close</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">.</span><span class="s2">fail</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">version</span><span class="s0">,</span><span class="s2">sp</span><span class="s0">:</span><span class="s2">o</span><span class="s0">.</span><span class="s2">session</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sp</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">sessionCache</span><span class="s0">.</span><span class="s2">setSession</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">id</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">o</span><span class="s0">.</span><span class="s2">open</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">open</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">input</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">(),(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isConnected</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">)&amp;&amp;(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">isConnected</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">handshaking</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">queue</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createAlert</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">level</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Level</span><span class="s0">.</span><span class="s2">warning</span><span class="s0">,</span><span class="s2">description</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">Alert</span><span class="s0">.</span><span class="s2">Description</span><span class="s0">.</span><span class="s2">close_notify</span><span class="s0">})),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">flush</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">closed</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reset</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">o</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">||{},</span><span class="s2">u</span><span class="s0">)</span><span class="s3">&quot;function&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">u</span><span class="s0">[</span><span class="s2">G</span><span class="s0">]&amp;&amp;(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">[</span><span class="s2">G</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">G</span><span class="s0">]);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">.</span><span class="s2">prf_tls1</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">.</span><span class="s2">hmac_sha1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s3">&quot;SHA1&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">type</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">major</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">.</span><span class="s2">createSessionCache</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createSessionCache</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">.</span><span class="s2">createConnection</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">createConnection</span><span class="s0">},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">22</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">15</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">28</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">18</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">11</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">17</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">pemToDer</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert PEM to DER; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">body</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;RSA PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert private key from PEM; PEM header type is not &quot;PRIVATE KEY&quot; or &quot;RSA PRIVATE KEY&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert private key from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">body</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;RSA PRIVATE KEY&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyInfoToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;PRIVATE KEY&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">10</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">15</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">25</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">11</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">)</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">,</span><span class="s2">c</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedPrivateKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedPrivateKeyInfo.encryptionAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encryptionOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;encryptionParams&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedPrivateKeyInfo.encryptedData&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encryptedData&quot;</span><span class="s0">}]},</span><span class="s2">u</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.keyDerivationFunc&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.keyDerivationFunc.oid&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;kdfOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params.salt&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;kdfSalt&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params.iterationCount&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;kdfIterationCount&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params.keyLength&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;keyLength&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params.prf&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.params.prf.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;prfOid&quot;</span><span class="s0">}]}]}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.encryptionScheme&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.encryptionScheme.oid&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encOid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PBES2Algorithms.encryptionScheme.iv&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encIv&quot;</span><span class="s0">}]}]},</span><span class="s2">l</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;pkcs-12PbeParams&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;pkcs-12PbeParams.salt&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;salt&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;pkcs-12PbeParams.iterations&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;iterations&quot;</span><span class="s0">}]};</span><span class="s1">function </span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">start</span><span class="s0">().</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">).</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)])){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported PRF OID.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">supported</span><span class="s0">=[</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA224&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA256&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA384&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA512&quot;</span><span class="s0">],</span><span class="s2">r</span><span class="s0">}}</span><span class="s1">else </span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">;</span><span class="s1">return </span><span class="s2">h</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;hmacWithSHA224&quot;</span><span class="s0">:</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;hmacWithSHA256&quot;</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;hmacWithSHA384&quot;</span><span class="s0">:</span><span class="s1">case</span><span class="s3">&quot;hmacWithSHA512&quot;</span><span class="s0">:</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">8</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported PRF algorithm.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">supported</span><span class="s0">=[</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA224&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA256&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA384&quot;</span><span class="s0">,</span><span class="s3">&quot;hmacWithSHA512&quot;</span><span class="s0">],</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">||!(</span><span class="s2">e </span><span class="s1">in </span><span class="s2">t</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unknown hash algorithm: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">[</span><span class="s2">e</span><span class="s0">].</span><span class="s2">create</span><span class="s0">()}</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptPrivateKeyInfo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{}).</span><span class="s2">saltSize</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">saltSize</span><span class="s0">||</span><span class="s4">8</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">count</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">count</span><span class="s0">||</span><span class="s4">2048</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">||</span><span class="s3">&quot;aes128&quot;</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prfAlgorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prfAlgorithm</span><span class="s0">||</span><span class="s3">&quot;sha1&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">saltSize</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">count</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s3">&quot;aes&quot;</span><span class="s0">)||</span><span class="s3">&quot;des&quot;</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;aes128&quot;</span><span class="s0">:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes192&quot;</span><span class="s0">:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes256&quot;</span><span class="s0">:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">o</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;des&quot;</span><span class="s0">:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">desCBC</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">T</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot encrypt private key. Unknown encryption algorithm.&quot;</span><span class="s0">)).</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">T</span><span class="s0">}</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s3">&quot;hmacWith&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">prfAlgorithm</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s2">v</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs5</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">m</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">d</span><span class="s0">);(</span><span class="s2">I</span><span class="s0">=</span><span class="s2">g</span><span class="s0">(</span><span class="s2">C</span><span class="s0">)).</span><span class="s2">start</span><span class="s0">(</span><span class="s2">E</span><span class="s0">),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">I</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())]);</span><span class="s3">&quot;hmacWithSHA1&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">))),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]));</span><span class="s1">return </span><span class="s2">o</span><span class="s0">}(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">v</span><span class="s0">);</span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">pkcs5PBES2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">pkcs5PBKDF2</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">S</span><span class="s0">]),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">E</span><span class="s0">)])])])}</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">T</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;3des&quot;</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">T</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot encrypt private key. Unknown encryption algorithm.&quot;</span><span class="s0">)).</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">T</span><span class="s0">;</span><span class="s2">n</span><span class="s0">=</span><span class="s4">24</span><span class="s0">;</span><span class="s1">var </span><span class="s2">I</span><span class="s0">,</span><span class="s2">A</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">(</span><span class="s2">l</span><span class="s0">);</span><span class="s2">C</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);(</span><span class="s2">I</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">(</span><span class="s2">C</span><span class="s0">)).</span><span class="s2">start</span><span class="s0">(</span><span class="s2">E</span><span class="s0">),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">I</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">[</span><span class="s3">&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;</span><span class="s0">]).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())])])}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">c</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)])},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">decryptPrivateKeyInfo</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">={},</span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">u</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">}</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encryptionOid</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipher</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encryptionParams</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encryptedData</span><span class="s0">);</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">f</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">()&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">output</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptedPrivateKeyToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;ENCRYPTED PRIVATE KEY&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptedPrivateKeyFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;ENCRYPTED PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert encrypted private key from PEM; PEM header type is &quot;ENCRYPTED PRIVATE KEY&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert encrypted private key from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">body</span><span class="s0">)},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptRsaPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||{}).</span><span class="s2">legacy</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">wrapRsaPrivateKey</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">privateKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">return </span><span class="s2">n</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptPrivateKeyInfo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">encryptedPrivateKeyToPem</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;aes128&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;AES-128-CBC&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes192&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;AES-192-CBC&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes256&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;AES-256-CBC&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;3des&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;DES-EDE3-CBC&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;des&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;DES-CBC&quot;</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not encrypt RSA private key; unsupported encryption algorithm &quot;'</span><span class="s0">+</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">p</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">p</span><span class="s0">}</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">l</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">opensslDeriveBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">),</span><span class="s2">u</span><span class="s0">));</span><span class="s2">f</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">c</span><span class="s0">),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">privateKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">();</span><span class="s1">var </span><span class="s2">h</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;RSA PRIVATE KEY&quot;</span><span class="s0">,</span><span class="s2">procType</span><span class="s0">:{</span><span class="s2">version</span><span class="s0">:</span><span class="s3">&quot;4&quot;</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">},</span><span class="s2">dekInfo</span><span class="s0">:{</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">parameters</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">c</span><span class="s0">).</span><span class="s2">toUpperCase</span><span class="s0">()},</span><span class="s2">body</span><span class="s0">:</span><span class="s2">f</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">h</span><span class="s0">)},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">decryptRsaPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;ENCRYPTED PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;RSA PRIVATE KEY&quot;</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert private key from PEM; PEM header type is not &quot;ENCRYPTED PRIVATE KEY&quot;, &quot;PRIVATE KEY&quot;, or &quot;RSA PRIVATE KEY&quot;.'</span><span class="s0">)).</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;DES-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;DES-EDE3-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;AES-128-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;AES-192-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;AES-256-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;RC2-40-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">5</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">40</span><span class="s0">)};</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;RC2-64-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">64</span><span class="s0">)};</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;RC2-128-CBC&quot;</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">128</span><span class="s0">)};</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">u</span><span class="s0">;</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not decrypt private key; unsupported encryption algorithm &quot;'</span><span class="s0">+</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">)).</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">u</span><span class="s0">}</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dekInfo</span><span class="s0">.</span><span class="s2">parameters</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">c</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">opensslDeriveBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">8</span><span class="s0">),</span><span class="s2">o</span><span class="s0">));</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">body</span><span class="s0">)),!</span><span class="s2">p</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">())</span><span class="s1">return </span><span class="s2">r</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">else </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">body</span><span class="s0">;</span><span class="s1">return null</span><span class="s0">!==(</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;ENCRYPTED PRIVATE KEY&quot;</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">type</span><span class="s0">?</span><span class="s2">s</span><span class="s0">.</span><span class="s2">decryptPrivateKeyInfo</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">t</span><span class="s0">):</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">))&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">==</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;sha1&quot;</span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'&quot;sha1&quot; hash algorithm unavailable.'</span><span class="s0">);</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">()}</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!=</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s2">f</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">));</span><span class="s2">f</span><span class="s0">.</span><span class="s2">putInt16</span><span class="s0">(</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">y</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s2">y</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">l</span><span class="s0">);</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">l</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">d</span><span class="s0">/</span><span class="s2">l</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">g</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s2">v</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">%</span><span class="s2">d</span><span class="s0">));</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s2">l</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">h</span><span class="s0">/</span><span class="s2">l</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">m</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s2">C</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">%</span><span class="s2">h</span><span class="s0">));</span><span class="s1">var </span><span class="s2">E</span><span class="s0">=</span><span class="s2">v</span><span class="s0">;</span><span class="s2">E</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">C</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">i</span><span class="s0">/</span><span class="s2">u</span><span class="s0">),</span><span class="s2">T</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">T</span><span class="s0">&lt;=</span><span class="s2">S</span><span class="s0">;</span><span class="s2">T</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">I</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s2">I</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">E</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">A</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">A</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;</span><span class="s2">A</span><span class="s0">++)</span><span class="s2">s</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">I</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">I</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">();</span><span class="s1">var </span><span class="s2">B</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">;</span><span class="s2">c</span><span class="s0">++)</span><span class="s2">B</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">I</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">%</span><span class="s2">u</span><span class="s0">));</span><span class="s1">var </span><span class="s2">b</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">d</span><span class="s0">/</span><span class="s2">l</span><span class="s0">)+</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">h</span><span class="s0">/</span><span class="s2">l</span><span class="s0">),</span><span class="s2">N</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">b</span><span class="s0">;</span><span class="s2">o</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">R</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">(</span><span class="s2">E</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)),</span><span class="s2">w</span><span class="s0">=</span><span class="s4">511</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">B</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">--)</span><span class="s2">w</span><span class="s0">&gt;&gt;=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">B</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">)+</span><span class="s2">R</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">c</span><span class="s0">),</span><span class="s2">R</span><span class="s0">.</span><span class="s2">setAt</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">w</span><span class="s0">);</span><span class="s2">N</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">R</span><span class="s0">)}</span><span class="s2">E</span><span class="s0">=</span><span class="s2">N</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">I</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">p</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">i</span><span class="s0">),</span><span class="s2">p</span><span class="s0">},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">pkcs5PBES2</span><span class="s0">:</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipherForPBES2</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;</span><span class="s0">]:</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;pbewithSHAAnd40BitRC2-CBC&quot;</span><span class="s0">]:</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipherForPKCS12PBE</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read encrypted PBE data block. Unsupported OID.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">a</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">supportedOids</span><span class="s0">=[</span><span class="s3">&quot;pkcs5PBES2&quot;</span><span class="s0">,</span><span class="s3">&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;</span><span class="s0">,</span><span class="s3">&quot;pbewithSHAAnd40BitRC2-CBC&quot;</span><span class="s0">],</span><span class="s2">a</span><span class="s0">}},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipherForPBES2</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">={},</span><span class="s2">c</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">kdfOid</span><span class="s0">))!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">pkcs5PBKDF2</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read encrypted private key. Unsupported key derivation function OID.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">supportedOids</span><span class="s0">=[</span><span class="s3">&quot;pkcs5PBKDF2&quot;</span><span class="s0">],</span><span class="s2">n</span><span class="s0">;</span><span class="s1">if</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">encOid</span><span class="s0">))!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">]&amp;&amp;</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">]&amp;&amp;</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">]&amp;&amp;</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">]&amp;&amp;</span><span class="s2">e</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">desCBC</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read encrypted private key. Unsupported encryption scheme OID.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">supportedOids</span><span class="s0">=[</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">,</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">,</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">,</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">,</span><span class="s3">&quot;desCBC&quot;</span><span class="s0">],</span><span class="s2">n</span><span class="s0">;</span><span class="s1">var </span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">kdfSalt</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">kdfIterationCount</span><span class="s0">);</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">d</span><span class="s0">=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;&lt;</span><span class="s4">3</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]){</span><span class="s1">case</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;desCBC&quot;</span><span class="s0">:</span><span class="s2">l</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">}</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">prfOid</span><span class="s0">),</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs5</span><span class="s0">.</span><span class="s2">pbkdf2</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">y</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">encIv</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s2">p</span><span class="s0">(</span><span class="s2">g</span><span class="s0">);</span><span class="s1">return </span><span class="s2">m</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">v</span><span class="s0">),</span><span class="s2">m</span><span class="s0">},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipherForPKCS12PBE</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">={},</span><span class="s2">o</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">i</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">o</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">y</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">y</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">salt</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">iterations</span><span class="s0">);</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">d</span><span class="s0">=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getInt</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;&lt;</span><span class="s4">3</span><span class="s0">),</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;pbeWithSHAAnd3-KeyTripleDES-CBC&quot;</span><span class="s0">]:</span><span class="s2">c</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">startDecrypting</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">s</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;pbewithSHAAnd40BitRC2-CBC&quot;</span><span class="s0">]:</span><span class="s2">c</span><span class="s0">=</span><span class="s4">5</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">40</span><span class="s0">);</span><span class="s1">return </span><span class="s2">r</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">r</span><span class="s0">};</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">y</span><span class="s0">;</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">y</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS #12 PBE data block. Unsupported OID.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">y</span><span class="s0">}</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">prfOid</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">g</span><span class="s0">);</span><span class="s1">return </span><span class="s2">g</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">p</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">g</span><span class="s0">))},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">opensslDeriveBytes</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">==</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;md5&quot;</span><span class="s1">in </span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'&quot;md5&quot; hash algorithm unavailable.'</span><span class="s0">);</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">()}</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=[</span><span class="s2">p</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">+</span><span class="s2">t</span><span class="s0">)],</span><span class="s2">s</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">,</span><span class="s2">s</span><span class="s0">+=</span><span class="s4">16</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">p</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s2">o</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">e</span><span class="s0">+</span><span class="s2">t</span><span class="s0">));</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">=</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">s</span><span class="s0">||(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">128</span><span class="s0">),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s4">64</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">1116352408</span><span class="s0">,</span><span class="s4">1899447441</span><span class="s0">,</span><span class="s4">3049323471</span><span class="s0">,</span><span class="s4">3921009573</span><span class="s0">,</span><span class="s4">961987163</span><span class="s0">,</span><span class="s4">1508970993</span><span class="s0">,</span><span class="s4">2453635748</span><span class="s0">,</span><span class="s4">2870763221</span><span class="s0">,</span><span class="s4">3624381080</span><span class="s0">,</span><span class="s4">310598401</span><span class="s0">,</span><span class="s4">607225278</span><span class="s0">,</span><span class="s4">1426881987</span><span class="s0">,</span><span class="s4">1925078388</span><span class="s0">,</span><span class="s4">2162078206</span><span class="s0">,</span><span class="s4">2614888103</span><span class="s0">,</span><span class="s4">3248222580</span><span class="s0">,</span><span class="s4">3835390401</span><span class="s0">,</span><span class="s4">4022224774</span><span class="s0">,</span><span class="s4">264347078</span><span class="s0">,</span><span class="s4">604807628</span><span class="s0">,</span><span class="s4">770255983</span><span class="s0">,</span><span class="s4">1249150122</span><span class="s0">,</span><span class="s4">1555081692</span><span class="s0">,</span><span class="s4">1996064986</span><span class="s0">,</span><span class="s4">2554220882</span><span class="s0">,</span><span class="s4">2821834349</span><span class="s0">,</span><span class="s4">2952996808</span><span class="s0">,</span><span class="s4">3210313671</span><span class="s0">,</span><span class="s4">3336571891</span><span class="s0">,</span><span class="s4">3584528711</span><span class="s0">,</span><span class="s4">113926993</span><span class="s0">,</span><span class="s4">338241895</span><span class="s0">,</span><span class="s4">666307205</span><span class="s0">,</span><span class="s4">773529912</span><span class="s0">,</span><span class="s4">1294757372</span><span class="s0">,</span><span class="s4">1396182291</span><span class="s0">,</span><span class="s4">1695183700</span><span class="s0">,</span><span class="s4">1986661051</span><span class="s0">,</span><span class="s4">2177026350</span><span class="s0">,</span><span class="s4">2456956037</span><span class="s0">,</span><span class="s4">2730485921</span><span class="s0">,</span><span class="s4">2820302411</span><span class="s0">,</span><span class="s4">3259730800</span><span class="s0">,</span><span class="s4">3345764771</span><span class="s0">,</span><span class="s4">3516065817</span><span class="s0">,</span><span class="s4">3600352804</span><span class="s0">,</span><span class="s4">4094571909</span><span class="s0">,</span><span class="s4">275423344</span><span class="s0">,</span><span class="s4">430227734</span><span class="s0">,</span><span class="s4">506948616</span><span class="s0">,</span><span class="s4">659060556</span><span class="s0">,</span><span class="s4">883997877</span><span class="s0">,</span><span class="s4">958139571</span><span class="s0">,</span><span class="s4">1322822218</span><span class="s0">,</span><span class="s4">1537002063</span><span class="s0">,</span><span class="s4">1747873779</span><span class="s0">,</span><span class="s4">1955562222</span><span class="s0">,</span><span class="s4">2024104815</span><span class="s0">,</span><span class="s4">2227730452</span><span class="s0">,</span><span class="s4">2361852424</span><span class="s0">,</span><span class="s4">2428436474</span><span class="s0">,</span><span class="s4">2756734187</span><span class="s0">,</span><span class="s4">3204031479</span><span class="s0">,</span><span class="s4">3329325298</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">64</span><span class="s0">),</span><span class="s2">n</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s3">&quot;sha256&quot;</span><span class="s0">,</span><span class="s2">blockLength</span><span class="s0">:</span><span class="s4">64</span><span class="s0">,</span><span class="s2">digestLength</span><span class="s0">:</span><span class="s4">32</span><span class="s0">,</span><span class="s2">messageLength</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">fullMessageLength</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">messageLengthSize</span><span class="s0">:</span><span class="s4">8</span><span class="s0">,</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength64</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s4">1779033703</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s4">3144134277</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s4">1013904242</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s4">2773480762</span><span class="s0">,</span><span class="s2">h4</span><span class="s0">:</span><span class="s4">1359893119</span><span class="s0">,</span><span class="s2">h5</span><span class="s0">:</span><span class="s4">2600822924</span><span class="s0">,</span><span class="s2">h6</span><span class="s0">:</span><span class="s4">528734635</span><span class="s0">,</span><span class="s2">h7</span><span class="s0">:</span><span class="s4">1541459225</span><span class="s0">},</span><span class="s2">n</span><span class="s0">}};</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">){</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">i</span><span class="s0">));</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=[</span><span class="s2">o</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">u</span><span class="s0">)</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]+=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">2048</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s2">u</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">l</span><span class="s0">+=(</span><span class="s2">o</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">p</span><span class="s0">+</span><span class="s4">1</span><span class="s0">])/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">l</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">o</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">l</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">={</span><span class="s2">h0</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">h1</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">h2</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">h3</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">,</span><span class="s2">h4</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">,</span><span class="s2">h5</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h5</span><span class="s0">,</span><span class="s2">h6</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h6</span><span class="s0">,</span><span class="s2">h7</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h7</span><span class="s0">};</span><span class="s2">c</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">);</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h5</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h6</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">h7</span><span class="s0">),</span><span class="s2">h</span><span class="s0">},</span><span class="s2">n</span><span class="s0">};</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">function </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">v</span><span class="s0">&gt;=</span><span class="s4">64</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=((</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">-</span><span class="s4">2</span><span class="s0">])&gt;&gt;&gt;</span><span class="s4">17</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&lt;&lt;</span><span class="s4">15</span><span class="s0">)^(</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">19</span><span class="s0">|</span><span class="s2">a</span><span class="s0">&lt;&lt;</span><span class="s4">13</span><span class="s0">)^</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">10</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=((</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">-</span><span class="s4">15</span><span class="s0">])&gt;&gt;&gt;</span><span class="s4">7</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">25</span><span class="s0">)^(</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">18</span><span class="s0">|</span><span class="s2">n</span><span class="s0">&lt;&lt;</span><span class="s4">14</span><span class="s0">)^</span><span class="s2">n</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">3</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">-</span><span class="s4">7</span><span class="s0">]+</span><span class="s2">n</span><span class="s0">+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">-</span><span class="s4">16</span><span class="s0">]|</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h5</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h6</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h7</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">i</span><span class="s0">=(</span><span class="s2">u</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">u</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">)^(</span><span class="s2">u</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">13</span><span class="s0">|</span><span class="s2">u</span><span class="s0">&lt;&lt;</span><span class="s4">19</span><span class="s0">)^(</span><span class="s2">u</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">22</span><span class="s0">|</span><span class="s2">u</span><span class="s0">&lt;&lt;</span><span class="s4">10</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">u</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">|</span><span class="s2">p</span><span class="s0">&amp;(</span><span class="s2">u</span><span class="s0">^</span><span class="s2">l</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">g</span><span class="s0">+((</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">6</span><span class="s0">|</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">26</span><span class="s0">)^(</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">11</span><span class="s0">|</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">21</span><span class="s0">)^(</span><span class="s2">h</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">25</span><span class="s0">|</span><span class="s2">h</span><span class="s0">&lt;&lt;</span><span class="s4">7</span><span class="s0">))+(</span><span class="s2">y</span><span class="s0">^</span><span class="s2">h</span><span class="s0">&amp;(</span><span class="s2">d</span><span class="s0">^</span><span class="s2">y</span><span class="s0">))+</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">c</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">f</span><span class="s0">+</span><span class="s2">a</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">+(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">+</span><span class="s2">s</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h0</span><span class="s0">+</span><span class="s2">u</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h1</span><span class="s0">+</span><span class="s2">l</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h2</span><span class="s0">+</span><span class="s2">p</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h3</span><span class="s0">+</span><span class="s2">f</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h4</span><span class="s0">+</span><span class="s2">h</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h5</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h5</span><span class="s0">+</span><span class="s2">d</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h6</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h6</span><span class="s0">+</span><span class="s2">y</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h7</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">h7</span><span class="s0">+</span><span class="s2">g</span><span class="s0">|</span><span class="s4">0</span><span class="s0">,</span><span class="s2">v</span><span class="s0">-=</span><span class="s4">64</span><span class="s0">}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isNodejs</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">options</span><span class="s0">.</span><span class="s2">usePureJavaScript</span><span class="s0">||</span><span class="s2">process</span><span class="s0">.</span><span class="s2">versions</span><span class="s0">[</span><span class="s3">&quot;node-webkit&quot;</span><span class="s0">]||(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">16</span><span class="s0">)),(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">||{}).</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={</span><span class="s2">plugin</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">seed</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">time</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">reseeds</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">generated</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">keyBytes</span><span class="s0">:</span><span class="s3">&quot;&quot;</span><span class="s0">},</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">32</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">messageLength</span><span class="s0">&gt;=</span><span class="s4">32</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">();</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s4">32</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">messageLength</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">collect</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFileSync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">c</span><span class="s0">(){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reseeds</span><span class="s0">=</span><span class="s4">4294967295</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reseeds</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reseeds</span><span class="s0">+</span><span class="s4">1</span><span class="s0">;</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyBytes</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">reseeds</span><span class="s0">%</span><span class="s2">r</span><span class="s0">==</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s2">a</span><span class="s0">].</span><span class="s2">start</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">&lt;&lt;=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyBytes</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyBytes</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatKey</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">keyBytes</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatSeed</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generated</span><span class="s0">=</span><span class="s4">0</span><span class="s0">}</span><span class="s1">function </span><span class="s2">u</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">globalScope</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">crypto</span><span class="s0">||</span><span class="s2">r</span><span class="s0">.</span><span class="s2">msCrypto</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getRandomValues</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">getRandomValues</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)});</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s2">e</span><span class="s0">;){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">min</span><span class="s0">(</span><span class="s2">e</span><span class="s0">-</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s4">65536</span><span class="s0">)/</span><span class="s4">4</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Uint32Array</span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">s</span><span class="s0">));</span><span class="s1">try</span><span class="s0">{</span><span class="s2">t</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">])}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">QuotaExceededError</span><span class="s0">&amp;&amp;</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">QuotaExceededError</span><span class="s0">))</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s4">65536</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">random</span><span class="s0">());</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s2">e</span><span class="s0">;){</span><span class="s2">l</span><span class="s0">=</span><span class="s4">16807</span><span class="s0">*(</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">f</span><span class="s0">),</span><span class="s2">l</span><span class="s0">+=(</span><span class="s4">32767</span><span class="s0">&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">16807</span><span class="s0">*(</span><span class="s2">f</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">)))&lt;&lt;</span><span class="s4">16</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s4">4294967295</span><span class="s0">&amp;(</span><span class="s2">l</span><span class="s0">=(</span><span class="s4">2147483647</span><span class="s0">&amp;(</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">u</span><span class="s0">&gt;&gt;</span><span class="s4">15</span><span class="s0">))+(</span><span class="s2">l</span><span class="s0">&gt;&gt;</span><span class="s4">31</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">3</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">p</span><span class="s0">=</span><span class="s2">f</span><span class="s0">&gt;&gt;&gt;(</span><span class="s2">c</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">),</span><span class="s2">p</span><span class="s0">^=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s4">256</span><span class="s0">*</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">random</span><span class="s0">()),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">p</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pool</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">generateSync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">increment</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatKey</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatSeed</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s1">function </span><span class="s2">l</span><span class="s0">(</span><span class="s2">p</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">(</span><span class="s2">p</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;=</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">r</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generated</span><span class="s0">&gt;</span><span class="s4">1048575</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">null</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">nextTick</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(){!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">messageLength</span><span class="s0">&gt;=</span><span class="s4">32</span><span class="s0">)</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">();</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">32</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">messageLength</span><span class="s0">&lt;&lt;</span><span class="s4">5</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFile</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">return </span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">collect</span><span class="s0">(</span><span class="s2">a</span><span class="s0">),</span><span class="s2">c</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">()}))}(</span><span class="s2">l</span><span class="s0">)}));</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generated</span><span class="s0">+=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">u</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">f</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">i</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">))),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">)),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)}()},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generateSync</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">increment</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatKey</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">plugin</span><span class="s0">.</span><span class="s2">formatSeed</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&lt;</span><span class="s2">e</span><span class="s0">;){</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generated</span><span class="s0">&gt;</span><span class="s4">1048575</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s1">null</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">();</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generated</span><span class="s0">+=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">c</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">u</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">n</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">))),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">?(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">n</span><span class="s0">.</span><span class="s2">randomBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">())}))},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFileSync</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">randomBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">).</span><span class="s2">toString</span><span class="s0">()}):(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">try</span><span class="s0">{</span><span class="s2">t</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">(</span><span class="s2">e</span><span class="s0">))}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">t</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFileSync</span><span class="s0">=</span><span class="s2">u</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">collect</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pools</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pool</span><span class="s0">].</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s4">1</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pool</span><span class="s0">=</span><span class="s4">31</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pool</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">pool</span><span class="s0">+</span><span class="s4">1</span><span class="s0">},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">collectInt</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;</span><span class="s2">n</span><span class="s0">+=</span><span class="s4">8</span><span class="s0">)</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&gt;&gt;</span><span class="s2">n</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">collect</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">registerWorker</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">===</span><span class="s2">self</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFile</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">self</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,(</span><span class="s1">function </span><span class="s2">e</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">&amp;&amp;(</span><span class="s2">self</span><span class="s0">.</span><span class="s2">removeEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">t</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">.</span><span class="s2">err</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">))})),</span><span class="s2">self</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">({</span><span class="s2">forge</span><span class="s0">:{</span><span class="s2">prng</span><span class="s0">:{</span><span class="s2">needed</span><span class="s0">:</span><span class="s2">e</span><span class="s0">}}})};</span><span class="s1">else</span><span class="s0">{</span><span class="s2">e</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">data</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">seedFile</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">forge</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">.</span><span class="s2">needed</span><span class="s0">,(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">({</span><span class="s2">forge</span><span class="s0">:{</span><span class="s2">prng</span><span class="s0">:{</span><span class="s2">err</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">bytes</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}}})}))}))}},</span><span class="s2">t</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=[</span><span class="s4">217</span><span class="s0">,</span><span class="s4">120</span><span class="s0">,</span><span class="s4">249</span><span class="s0">,</span><span class="s4">196</span><span class="s0">,</span><span class="s4">25</span><span class="s0">,</span><span class="s4">221</span><span class="s0">,</span><span class="s4">181</span><span class="s0">,</span><span class="s4">237</span><span class="s0">,</span><span class="s4">40</span><span class="s0">,</span><span class="s4">233</span><span class="s0">,</span><span class="s4">253</span><span class="s0">,</span><span class="s4">121</span><span class="s0">,</span><span class="s4">74</span><span class="s0">,</span><span class="s4">160</span><span class="s0">,</span><span class="s4">216</span><span class="s0">,</span><span class="s4">157</span><span class="s0">,</span><span class="s4">198</span><span class="s0">,</span><span class="s4">126</span><span class="s0">,</span><span class="s4">55</span><span class="s0">,</span><span class="s4">131</span><span class="s0">,</span><span class="s4">43</span><span class="s0">,</span><span class="s4">118</span><span class="s0">,</span><span class="s4">83</span><span class="s0">,</span><span class="s4">142</span><span class="s0">,</span><span class="s4">98</span><span class="s0">,</span><span class="s4">76</span><span class="s0">,</span><span class="s4">100</span><span class="s0">,</span><span class="s4">136</span><span class="s0">,</span><span class="s4">68</span><span class="s0">,</span><span class="s4">139</span><span class="s0">,</span><span class="s4">251</span><span class="s0">,</span><span class="s4">162</span><span class="s0">,</span><span class="s4">23</span><span class="s0">,</span><span class="s4">154</span><span class="s0">,</span><span class="s4">89</span><span class="s0">,</span><span class="s4">245</span><span class="s0">,</span><span class="s4">135</span><span class="s0">,</span><span class="s4">179</span><span class="s0">,</span><span class="s4">79</span><span class="s0">,</span><span class="s4">19</span><span class="s0">,</span><span class="s4">97</span><span class="s0">,</span><span class="s4">69</span><span class="s0">,</span><span class="s4">109</span><span class="s0">,</span><span class="s4">141</span><span class="s0">,</span><span class="s4">9</span><span class="s0">,</span><span class="s4">129</span><span class="s0">,</span><span class="s4">125</span><span class="s0">,</span><span class="s4">50</span><span class="s0">,</span><span class="s4">189</span><span class="s0">,</span><span class="s4">143</span><span class="s0">,</span><span class="s4">64</span><span class="s0">,</span><span class="s4">235</span><span class="s0">,</span><span class="s4">134</span><span class="s0">,</span><span class="s4">183</span><span class="s0">,</span><span class="s4">123</span><span class="s0">,</span><span class="s4">11</span><span class="s0">,</span><span class="s4">240</span><span class="s0">,</span><span class="s4">149</span><span class="s0">,</span><span class="s4">33</span><span class="s0">,</span><span class="s4">34</span><span class="s0">,</span><span class="s4">92</span><span class="s0">,</span><span class="s4">107</span><span class="s0">,</span><span class="s4">78</span><span class="s0">,</span><span class="s4">130</span><span class="s0">,</span><span class="s4">84</span><span class="s0">,</span><span class="s4">214</span><span class="s0">,</span><span class="s4">101</span><span class="s0">,</span><span class="s4">147</span><span class="s0">,</span><span class="s4">206</span><span class="s0">,</span><span class="s4">96</span><span class="s0">,</span><span class="s4">178</span><span class="s0">,</span><span class="s4">28</span><span class="s0">,</span><span class="s4">115</span><span class="s0">,</span><span class="s4">86</span><span class="s0">,</span><span class="s4">192</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">167</span><span class="s0">,</span><span class="s4">140</span><span class="s0">,</span><span class="s4">241</span><span class="s0">,</span><span class="s4">220</span><span class="s0">,</span><span class="s4">18</span><span class="s0">,</span><span class="s4">117</span><span class="s0">,</span><span class="s4">202</span><span class="s0">,</span><span class="s4">31</span><span class="s0">,</span><span class="s4">59</span><span class="s0">,</span><span class="s4">190</span><span class="s0">,</span><span class="s4">228</span><span class="s0">,</span><span class="s4">209</span><span class="s0">,</span><span class="s4">66</span><span class="s0">,</span><span class="s4">61</span><span class="s0">,</span><span class="s4">212</span><span class="s0">,</span><span class="s4">48</span><span class="s0">,</span><span class="s4">163</span><span class="s0">,</span><span class="s4">60</span><span class="s0">,</span><span class="s4">182</span><span class="s0">,</span><span class="s4">38</span><span class="s0">,</span><span class="s4">111</span><span class="s0">,</span><span class="s4">191</span><span class="s0">,</span><span class="s4">14</span><span class="s0">,</span><span class="s4">218</span><span class="s0">,</span><span class="s4">70</span><span class="s0">,</span><span class="s4">105</span><span class="s0">,</span><span class="s4">7</span><span class="s0">,</span><span class="s4">87</span><span class="s0">,</span><span class="s4">39</span><span class="s0">,</span><span class="s4">242</span><span class="s0">,</span><span class="s4">29</span><span class="s0">,</span><span class="s4">155</span><span class="s0">,</span><span class="s4">188</span><span class="s0">,</span><span class="s4">148</span><span class="s0">,</span><span class="s4">67</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">248</span><span class="s0">,</span><span class="s4">17</span><span class="s0">,</span><span class="s4">199</span><span class="s0">,</span><span class="s4">246</span><span class="s0">,</span><span class="s4">144</span><span class="s0">,</span><span class="s4">239</span><span class="s0">,</span><span class="s4">62</span><span class="s0">,</span><span class="s4">231</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">195</span><span class="s0">,</span><span class="s4">213</span><span class="s0">,</span><span class="s4">47</span><span class="s0">,</span><span class="s4">200</span><span class="s0">,</span><span class="s4">102</span><span class="s0">,</span><span class="s4">30</span><span class="s0">,</span><span class="s4">215</span><span class="s0">,</span><span class="s4">8</span><span class="s0">,</span><span class="s4">232</span><span class="s0">,</span><span class="s4">234</span><span class="s0">,</span><span class="s4">222</span><span class="s0">,</span><span class="s4">128</span><span class="s0">,</span><span class="s4">82</span><span class="s0">,</span><span class="s4">238</span><span class="s0">,</span><span class="s4">247</span><span class="s0">,</span><span class="s4">132</span><span class="s0">,</span><span class="s4">170</span><span class="s0">,</span><span class="s4">114</span><span class="s0">,</span><span class="s4">172</span><span class="s0">,</span><span class="s4">53</span><span class="s0">,</span><span class="s4">77</span><span class="s0">,</span><span class="s4">106</span><span class="s0">,</span><span class="s4">42</span><span class="s0">,</span><span class="s4">150</span><span class="s0">,</span><span class="s4">26</span><span class="s0">,</span><span class="s4">210</span><span class="s0">,</span><span class="s4">113</span><span class="s0">,</span><span class="s4">90</span><span class="s0">,</span><span class="s4">21</span><span class="s0">,</span><span class="s4">73</span><span class="s0">,</span><span class="s4">116</span><span class="s0">,</span><span class="s4">75</span><span class="s0">,</span><span class="s4">159</span><span class="s0">,</span><span class="s4">208</span><span class="s0">,</span><span class="s4">94</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">24</span><span class="s0">,</span><span class="s4">164</span><span class="s0">,</span><span class="s4">236</span><span class="s0">,</span><span class="s4">194</span><span class="s0">,</span><span class="s4">224</span><span class="s0">,</span><span class="s4">65</span><span class="s0">,</span><span class="s4">110</span><span class="s0">,</span><span class="s4">15</span><span class="s0">,</span><span class="s4">81</span><span class="s0">,</span><span class="s4">203</span><span class="s0">,</span><span class="s4">204</span><span class="s0">,</span><span class="s4">36</span><span class="s0">,</span><span class="s4">145</span><span class="s0">,</span><span class="s4">175</span><span class="s0">,</span><span class="s4">80</span><span class="s0">,</span><span class="s4">161</span><span class="s0">,</span><span class="s4">244</span><span class="s0">,</span><span class="s4">112</span><span class="s0">,</span><span class="s4">57</span><span class="s0">,</span><span class="s4">153</span><span class="s0">,</span><span class="s4">124</span><span class="s0">,</span><span class="s4">58</span><span class="s0">,</span><span class="s4">133</span><span class="s0">,</span><span class="s4">35</span><span class="s0">,</span><span class="s4">184</span><span class="s0">,</span><span class="s4">180</span><span class="s0">,</span><span class="s4">122</span><span class="s0">,</span><span class="s4">252</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">54</span><span class="s0">,</span><span class="s4">91</span><span class="s0">,</span><span class="s4">37</span><span class="s0">,</span><span class="s4">85</span><span class="s0">,</span><span class="s4">151</span><span class="s0">,</span><span class="s4">49</span><span class="s0">,</span><span class="s4">45</span><span class="s0">,</span><span class="s4">93</span><span class="s0">,</span><span class="s4">250</span><span class="s0">,</span><span class="s4">152</span><span class="s0">,</span><span class="s4">227</span><span class="s0">,</span><span class="s4">138</span><span class="s0">,</span><span class="s4">146</span><span class="s0">,</span><span class="s4">174</span><span class="s0">,</span><span class="s4">5</span><span class="s0">,</span><span class="s4">223</span><span class="s0">,</span><span class="s4">41</span><span class="s0">,</span><span class="s4">16</span><span class="s0">,</span><span class="s4">103</span><span class="s0">,</span><span class="s4">108</span><span class="s0">,</span><span class="s4">186</span><span class="s0">,</span><span class="s4">201</span><span class="s0">,</span><span class="s4">211</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">230</span><span class="s0">,</span><span class="s4">207</span><span class="s0">,</span><span class="s4">225</span><span class="s0">,</span><span class="s4">158</span><span class="s0">,</span><span class="s4">168</span><span class="s0">,</span><span class="s4">44</span><span class="s0">,</span><span class="s4">99</span><span class="s0">,</span><span class="s4">22</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">63</span><span class="s0">,</span><span class="s4">88</span><span class="s0">,</span><span class="s4">226</span><span class="s0">,</span><span class="s4">137</span><span class="s0">,</span><span class="s4">169</span><span class="s0">,</span><span class="s4">13</span><span class="s0">,</span><span class="s4">56</span><span class="s0">,</span><span class="s4">52</span><span class="s0">,</span><span class="s4">27</span><span class="s0">,</span><span class="s4">171</span><span class="s0">,</span><span class="s4">51</span><span class="s0">,</span><span class="s4">255</span><span class="s0">,</span><span class="s4">176</span><span class="s0">,</span><span class="s4">187</span><span class="s0">,</span><span class="s4">72</span><span class="s0">,</span><span class="s4">12</span><span class="s0">,</span><span class="s4">95</span><span class="s0">,</span><span class="s4">185</span><span class="s0">,</span><span class="s4">177</span><span class="s0">,</span><span class="s4">205</span><span class="s0">,</span><span class="s4">46</span><span class="s0">,</span><span class="s4">197</span><span class="s0">,</span><span class="s4">243</span><span class="s0">,</span><span class="s4">219</span><span class="s0">,</span><span class="s4">71</span><span class="s0">,</span><span class="s4">229</span><span class="s0">,</span><span class="s4">165</span><span class="s0">,</span><span class="s4">156</span><span class="s0">,</span><span class="s4">119</span><span class="s0">,</span><span class="s4">10</span><span class="s0">,</span><span class="s4">166</span><span class="s0">,</span><span class="s4">32</span><span class="s0">,</span><span class="s4">104</span><span class="s0">,</span><span class="s4">254</span><span class="s0">,</span><span class="s4">127</span><span class="s0">,</span><span class="s4">193</span><span class="s0">,</span><span class="s4">173</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=[</span><span class="s4">1</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s4">5</span><span class="s0">],</span><span class="s2">s</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;&lt;</span><span class="s2">t</span><span class="s0">&amp;</span><span class="s4">65535</span><span class="s0">|(</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&gt;&gt;</span><span class="s4">16</span><span class="s0">-</span><span class="s2">t</span><span class="s0">},</span><span class="s2">o</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return</span><span class="s0">(</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">)&gt;&gt;</span><span class="s2">t</span><span class="s0">|</span><span class="s2">e</span><span class="s0">&lt;&lt;</span><span class="s4">16</span><span class="s0">-</span><span class="s2">t</span><span class="s0">&amp;</span><span class="s4">65535</span><span class="s0">};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">expandKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s4">128</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">o</span><span class="s0">/</span><span class="s4">8</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">255</span><span class="s0">&gt;&gt;(</span><span class="s4">7</span><span class="s0">&amp;</span><span class="s2">o</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">s</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">128</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">putByte</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)+</span><span class="s2">i</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">-</span><span class="s2">s</span><span class="s0">)&amp;</span><span class="s4">255</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setAt</span><span class="s0">(</span><span class="s4">128</span><span class="s0">-</span><span class="s2">c</span><span class="s0">,</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s4">128</span><span class="s0">-</span><span class="s2">c</span><span class="s0">)&amp;</span><span class="s2">u</span><span class="s0">]),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">127</span><span class="s0">-</span><span class="s2">c</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">--)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">setAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)^</span><span class="s2">i</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">+</span><span class="s2">c</span><span class="s0">)]);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">};</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">expandKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++)</span><span class="s2">y</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">());</span><span class="s2">r</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]+=</span><span class="s2">y</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]+(</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">])+(~</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">],</span><span class="s2">i</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]),</span><span class="s2">l</span><span class="s0">++},</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]+=</span><span class="s2">y</span><span class="s0">[</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]]}):(</span><span class="s2">n</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">3</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">--)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">],</span><span class="s2">i</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]-=</span><span class="s2">y</span><span class="s0">[</span><span class="s2">l</span><span class="s0">]+(</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">])+(~</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]),</span><span class="s2">l</span><span class="s0">--},</span><span class="s2">c</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">3</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">--)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]-=</span><span class="s2">y</span><span class="s0">[</span><span class="s4">63</span><span class="s0">&amp;</span><span class="s2">e</span><span class="s0">[(</span><span class="s2">u</span><span class="s0">+</span><span class="s4">3</span><span class="s0">)%</span><span class="s4">4</span><span class="s0">]]});</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">();</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">d</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">?</span><span class="s2">a</span><span class="s0">^=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">():</span><span class="s2">d</span><span class="s0">.</span><span class="s2">putInt16Le</span><span class="s0">(</span><span class="s2">a</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">65535</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">)}</span><span class="s2">l</span><span class="s0">=</span><span class="s2">r</span><span class="s0">?</span><span class="s4">0</span><span class="s0">:</span><span class="s4">63</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">][</span><span class="s4">0</span><span class="s0">];</span><span class="s2">i</span><span class="s0">++)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">][</span><span class="s4">1</span><span class="s0">](</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;</span><span class="s2">u</span><span class="s0">++)</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">d</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">?</span><span class="s2">d</span><span class="s0">.</span><span class="s2">putInt16Le</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]):</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]^=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">getInt16Le</span><span class="s0">()),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putInt16Le</span><span class="s0">(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">u</span><span class="s0">])},</span><span class="s2">v</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return </span><span class="s2">v</span><span class="s0">={</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)),</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">e</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">output</span><span class="s0">=</span><span class="s2">h</span><span class="s0">},</span><span class="s2">update</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">p</span><span class="s0">||</span><span class="s2">f</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()&gt;=</span><span class="s4">8</span><span class="s0">;)</span><span class="s2">g</span><span class="s0">([[</span><span class="s4">5</span><span class="s0">,</span><span class="s2">n</span><span class="s0">],[</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">],[</span><span class="s4">6</span><span class="s0">,</span><span class="s2">n</span><span class="s0">],[</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">],[</span><span class="s4">5</span><span class="s0">,</span><span class="s2">n</span><span class="s0">]])},</span><span class="s2">finish</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s4">8</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,!</span><span class="s2">r</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">8</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()?</span><span class="s4">8</span><span class="s0">:</span><span class="s4">8</span><span class="s0">-</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">f</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">p</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">v</span><span class="s0">.</span><span class="s2">update</span><span class="s0">()),!</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()))</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">(</span><span class="s4">8</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,!</span><span class="s2">r</span><span class="s0">);</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">);</span><span class="s2">i</span><span class="s0">&gt;</span><span class="s2">n</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">:</span><span class="s2">h</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}}};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">startEncrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">128</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">startDecrypting</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s4">128</span><span class="s0">);</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">rc2</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">)}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs1</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">r</span><span class="s0">||(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">());</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">/</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s2">s</span><span class="s0">&gt;&gt;</span><span class="s4">24</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">,</span><span class="s2">s</span><span class="s0">&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">,</span><span class="s2">s</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">&amp;</span><span class="s4">255</span><span class="s0">,</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">s</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">+</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">+=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">encode_rsa_oaep</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">label</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">seed</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">md</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">.</span><span class="s2">md</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">.</span><span class="s2">md</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">?</span><span class="s2">o</span><span class="s0">.</span><span class="s2">start</span><span class="s0">():</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">||(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">u</span><span class="s0">-</span><span class="s4">2</span><span class="s0">*</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">-</span><span class="s4">2</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s2">l</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">g</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;RSAES-OAEP input message length is too long.&quot;</span><span class="s0">)).</span><span class="s2">length</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">g</span><span class="s0">.</span><span class="s2">maxLength</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">g</span><span class="s0">;</span><span class="s2">n</span><span class="s0">||(</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;raw&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">l</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">d</span><span class="s0">&lt;</span><span class="s2">h</span><span class="s0">;</span><span class="s2">d</span><span class="s0">++)</span><span class="s2">f</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\0</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">p</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()+</span><span class="s2">f</span><span class="s0">+</span><span class="s3">&quot;&quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">){</span><span class="s1">var </span><span class="s2">g</span><span class="s0">;</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">g</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid RSAES-OAEP seed. The seed length must match the digest length.&quot;</span><span class="s0">)).</span><span class="s2">seedLength</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">g</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">g</span><span class="s0">}}</span><span class="s1">else </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">);</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">u</span><span class="s0">-</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s2">y</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">C</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">m</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">C</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">return</span><span class="s3">&quot;</span><span class="s1">\0</span><span class="s3">&quot;</span><span class="s0">+</span><span class="s2">E</span><span class="s0">+</span><span class="s2">m</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">decode_rsa_oaep</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">?(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">):</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">label</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">md</span><span class="s0">||</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">&amp;&amp;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">.</span><span class="s2">md</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">.</span><span class="s2">md</span><span class="s0">));</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">c</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">m</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;RSAES-OAEP encoded message length is invalid.&quot;</span><span class="s0">)).</span><span class="s2">length</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">m</span><span class="s0">.</span><span class="s2">expectedLength</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">m</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">s</span><span class="s0">?</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">():</span><span class="s2">s</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">||(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">),</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">*</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">+</span><span class="s4">2</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;RSAES-OAEP key is too short for the hash function.&quot;</span><span class="s0">);</span><span class="s2">n</span><span class="s0">||(</span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;raw&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">+</span><span class="s4">1</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s4">1</span><span class="s0">+</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">p</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">i</span><span class="s0">(</span><span class="s2">d</span><span class="s0">,</span><span class="s2">c</span><span class="s0">-</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">xorBytes</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">g</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s3">&quot;</span><span class="s1">\0</span><span class="s3">&quot;</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">C</span><span class="s0">&lt;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">;++</span><span class="s2">C</span><span class="s0">)</span><span class="s2">m</span><span class="s0">|=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">C</span><span class="s0">)!==</span><span class="s2">v</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s2">C</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">E</span><span class="s0">=</span><span class="s4">1</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">;</span><span class="s2">T</span><span class="s0">&lt;</span><span class="s2">g</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">T</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">I</span><span class="s0">=</span><span class="s2">g</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">T</span><span class="s0">),</span><span class="s2">A</span><span class="s0">=</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">I</span><span class="s0">^</span><span class="s4">1</span><span class="s0">,</span><span class="s2">B</span><span class="s0">=</span><span class="s2">E</span><span class="s0">?</span><span class="s4">65534</span><span class="s0">:</span><span class="s4">0</span><span class="s0">;</span><span class="s2">m</span><span class="s0">|=</span><span class="s2">I</span><span class="s0">&amp;</span><span class="s2">B</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">E</span><span class="s0">&amp;=</span><span class="s2">A</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">m</span><span class="s0">||</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">g</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">S</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid RSAES-OAEP padding.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">g</span><span class="s0">.</span><span class="s2">substring</span><span class="s0">(</span><span class="s2">S</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">12</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">;</span><span class="s1">else</span><span class="s0">{</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">||{},</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=[</span><span class="s4">6</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">2</span><span class="s0">,</span><span class="s4">4</span><span class="s0">,</span><span class="s4">6</span><span class="s0">,</span><span class="s4">2</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">r</span><span class="s0">(</span><span class="s1">null</span><span class="s0">);</span><span class="s2">i</span><span class="s0">.</span><span class="s2">fromInt</span><span class="s0">(</span><span class="s4">30</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">|</span><span class="s2">t</span><span class="s0">};</span><span class="s2">t</span><span class="s0">.</span><span class="s2">generateProbablePrime</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s3">&quot;function&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">={});</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">algorithm</span><span class="s0">||</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">prng</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">,</span><span class="s2">u</span><span class="s0">={</span><span class="s2">nextBytes</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}};</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;PRIMEINC&quot;</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;workers&quot;</span><span class="s1">in </span><span class="s2">n</span><span class="s0">)</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">Worker</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">workers</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">workLoad</span><span class="s0">||</span><span class="s4">100</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s4">30</span><span class="s0">*</span><span class="s2">l</span><span class="s0">/</span><span class="s4">8</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">workerScript</span><span class="s0">||</span><span class="s3">&quot;forge/prime.worker.js&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">===</span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">estimateCores</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">2</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">t</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">h</span><span class="s0">()}));</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(){</span><span class="s2">u</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">max</span><span class="s0">(</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">Worker</span><span class="s0">(</span><span class="s2">f</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">].</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">&quot;message&quot;</span><span class="s0">,</span><span class="s2">h</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">o</span><span class="s0">){</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">data</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">found</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">f</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">f</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">f</span><span class="s0">].</span><span class="s2">terminate</span><span class="s0">();</span><span class="s1">return </span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">new </span><span class="s2">r</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">prime</span><span class="s0">,</span><span class="s4">16</span><span class="s0">))}</span><span class="s2">s</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()&gt;</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">));</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">);</span><span class="s2">n</span><span class="s0">.</span><span class="s2">target</span><span class="s0">.</span><span class="s2">postMessage</span><span class="s0">({</span><span class="s2">hex</span><span class="s0">:</span><span class="s2">h</span><span class="s0">,</span><span class="s2">workLoad</span><span class="s0">:</span><span class="s2">l</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s2">p</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}}}</span><span class="s2">h</span><span class="s0">()}(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">options</span><span class="s0">,</span><span class="s2">n</span><span class="s0">);</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid prime generation algorithm: &quot;</span><span class="s0">+</span><span class="s2">i</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)}}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return </span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">100</span><span class="s0">?</span><span class="s4">27</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">150</span><span class="s0">?</span><span class="s4">18</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">200</span><span class="s0">?</span><span class="s4">15</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">250</span><span class="s0">?</span><span class="s4">12</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">300</span><span class="s0">?</span><span class="s4">9</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">350</span><span class="s0">?</span><span class="s4">8</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">400</span><span class="s0">?</span><span class="s4">7</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">500</span><span class="s0">?</span><span class="s4">6</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">600</span><span class="s0">?</span><span class="s4">5</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">800</span><span class="s0">?</span><span class="s4">4</span><span class="s0">:</span><span class="s2">e</span><span class="s0">&lt;=</span><span class="s4">1250</span><span class="s0">?</span><span class="s4">3</span><span class="s0">:</span><span class="s4">2</span><span class="s0">}(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">());</span><span class="s3">&quot;millerRabinTests&quot;</span><span class="s1">in </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">millerRabinTests</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">10</span><span class="s0">;</span><span class="s3">&quot;maxBlockTime&quot;</span><span class="s1">in </span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">maxBlockTime</span><span class="s0">),</span><span class="s1">function </span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=+</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">;</span><span class="s1">do</span><span class="s0">{</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()&gt;</span><span class="s2">r</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">c</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">isProbablePrime</span><span class="s0">(</span><span class="s2">o</span><span class="s0">))</span><span class="s1">return </span><span class="s2">l</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s2">t</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">++%</span><span class="s4">8</span><span class="s0">],</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s4">0</span><span class="s0">||+</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">-</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">);</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">setImmediate</span><span class="s0">((</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">e</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)}))}(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">r</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">testBit</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">bitwiseTo</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">.</span><span class="s2">shiftLeft</span><span class="s0">(</span><span class="s2">n</span><span class="s0">),</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">dAddOffset</span><span class="s0">(</span><span class="s4">31</span><span class="s0">-</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">i</span><span class="s0">).</span><span class="s2">byteValue</span><span class="s0">(),</span><span class="s4">0</span><span class="s0">),</span><span class="s2">a</span><span class="s0">}}()},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">29</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">22</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">11</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">17</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs12</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs12</span><span class="s0">||{},</span><span class="s2">o</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo.contentType&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;contentType&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo.content&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;content&quot;</span><span class="s0">}]},</span><span class="s2">c</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;version&quot;</span><span class="s0">},</span><span class="s2">o</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;mac&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.mac&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.mac.digestAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.mac.digestAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;macAlgorithm&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.mac.digestAlgorithm.parameters&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;macAlgorithmParameters&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.mac.digest&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;macDigest&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.macSalt&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;macSalt&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PFX.macData.iterations&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;macIterations&quot;</span><span class="s0">}]}]},</span><span class="s2">u</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SafeBag&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SafeBag.bagId&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;bagId&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SafeBag.bagValue&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;bagValue&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SafeBag.bagAttributes&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;bagAttributes&quot;</span><span class="s0">}]},</span><span class="s2">l</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Attribute&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Attribute.attrId&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;oid&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;Attribute.attrValues&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;values&quot;</span><span class="s0">}]},</span><span class="s2">p</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertBag&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertBag.certId&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;certId&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertBag.certValue&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;CertBag.certValue[0]&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;cert&quot;</span><span class="s0">}]}]};</span><span class="s1">function </span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">safeBags</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">safeBags</span><span class="s0">[</span><span class="s2">s</span><span class="s0">];</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">||(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">?</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]&amp;&amp;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">[</span><span class="s2">t</span><span class="s0">].</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}</span><span class="s1">function </span><span class="s2">h</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">r</span><span class="s0">].</span><span class="s2">value</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">composed</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">}</span><span class="s1">function </span><span class="s2">d</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={},</span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">encryptedDataValidator</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read EncryptedContentInfo.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 EncryptedContentInfo ContentType is not Data.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">;</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">encAlgorithm</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">getCipher</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">r</span><span class="s0">.</span><span class="s2">encParameter</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">encryptedContentAsn1</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">value</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">p</span><span class="s0">),!</span><span class="s2">u</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Failed to decrypt PKCS#12 SafeContents.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">u</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">function </span><span class="s2">y</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">)</span><span class="s1">return</span><span class="s0">[];</span><span class="s1">if</span><span class="s0">((</span><span class="s2">e</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)).</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">||!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">c</span><span class="s0">={},</span><span class="s2">l</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">l</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read SafeBag.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">v</span><span class="s0">;</span><span class="s1">var </span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">bagId</span><span class="s0">),</span><span class="s2">attributes</span><span class="s0">:</span><span class="s2">g</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">bagAttributes</span><span class="s0">)};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">d</span><span class="s0">);</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">bagValue</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">pkcs8ShroudedKeyBag</span><span class="s0">:</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===(</span><span class="s2">y</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">decryptPrivateKeyInfo</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?&quot;</span><span class="s0">);</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">keyBag</span><span class="s0">:</span><span class="s1">try</span><span class="s0">{</span><span class="s2">d</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">(</span><span class="s2">y</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">d</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">d</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">=</span><span class="s2">y</span><span class="s0">}</span><span class="s1">continue</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">certBag</span><span class="s0">:</span><span class="s2">f</span><span class="s0">=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certId</span><span class="s0">)!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">x509Certificate</span><span class="s0">){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported certificate type, only X.509 supported.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">e</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">certId</span><span class="s0">),</span><span class="s2">e</span><span class="s0">}</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">try</span><span class="s0">{</span><span class="s2">d</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">d</span><span class="s0">.</span><span class="s2">cert</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">d</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">=</span><span class="s2">r</span><span class="s0">}};</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">v</span><span class="s0">;</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported PKCS#12 SafeBag type.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">d</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">v</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">f</span><span class="s0">&amp;&amp;!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">y</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">l</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#12 &quot;</span><span class="s0">+</span><span class="s2">f</span><span class="s0">.</span><span class="s2">name</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">v</span><span class="s0">;</span><span class="s2">h</span><span class="s0">()}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}</span><span class="s1">function </span><span class="s2">g</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">={},</span><span class="s2">s</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">l</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">s</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#12 BagAttribute.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">o</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oid</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]){</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]]=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]].</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">values</span><span class="s0">[</span><span class="s2">u</span><span class="s0">].</span><span class="s2">value</span><span class="s0">)}}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s2">s</span><span class="s0">.</span><span class="s2">pkcs12FromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">?(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">):</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">u</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,[]))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">;</span><span class="s1">var </span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">={</span><span class="s2">version</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">safeContents</span><span class="s0">:[],</span><span class="s2">getBags</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">={};</span><span class="s1">return</span><span class="s3">&quot;localKeyId&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">?</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">localKeyId</span><span class="s0">:</span><span class="s3">&quot;localKeyIdHex&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">localKeyIdHex</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;!(</span><span class="s3">&quot;friendlyName&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">)&amp;&amp;</span><span class="s3">&quot;bagType&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bagType</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bagType</span><span class="s0">)),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">localKeyId</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">,</span><span class="s3">&quot;localKeyId&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bagType</span><span class="s0">)),</span><span class="s3">&quot;friendlyName&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">friendlyName</span><span class="s0">=</span><span class="s2">f</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">,</span><span class="s3">&quot;friendlyName&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">friendlyName</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bagType</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">},</span><span class="s2">getBagsByFriendlyName</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">f</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">,</span><span class="s3">&quot;friendlyName&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">getBagsByLocalKeyId</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">f</span><span class="s0">(</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">,</span><span class="s3">&quot;localKeyId&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}};</span><span class="s1">if</span><span class="s0">(</span><span class="s4">3</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 PFX of version other than 3 not supported.&quot;</span><span class="s0">)).</span><span class="s2">version</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">l</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">)!==</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">)</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Only PKCS#12 PFX in password integrity mode supported.&quot;</span><span class="s0">)).</span><span class="s2">oid</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">),</span><span class="s2">l</span><span class="s0">;</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">g</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">||</span><span class="s2">g</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 authSafe content data is not an OCTET STRING.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">g</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s2">g</span><span class="s0">),</span><span class="s2">u</span><span class="s0">.</span><span class="s2">mac</span><span class="s0">){</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">macAlgorithm</span><span class="s0">);</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">C</span><span class="s0">){</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">:</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">20</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">:</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">32</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">:</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">48</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">:</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">64</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">:</span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">m</span><span class="s0">=</span><span class="s4">16</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">===</span><span class="s2">v</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 uses unsupported MAC algorithm: &quot;</span><span class="s0">+</span><span class="s2">C</span><span class="s0">);</span><span class="s1">var </span><span class="s2">E</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">macSalt</span><span class="s0">),</span><span class="s2">S</span><span class="s0">=</span><span class="s3">&quot;macIterations&quot;</span><span class="s1">in </span><span class="s2">u</span><span class="s0">?</span><span class="s2">parseInt</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">macIterations</span><span class="s0">),</span><span class="s4">16</span><span class="s0">):</span><span class="s4">1</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">generateKey</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">E</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s2">S</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">v</span><span class="s0">),</span><span class="s2">I</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">I</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">v</span><span class="s0">,</span><span class="s2">T</span><span class="s0">),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">g</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">I</span><span class="s0">.</span><span class="s2">getMac</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()!==</span><span class="s2">u</span><span class="s0">.</span><span class="s2">macDigest</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 MAC could not be verified. Invalid password?&quot;</span><span class="s0">)}</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">if</span><span class="s0">((</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)).</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">||</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">||!</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">constructed</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s2">s</span><span class="s0">],</span><span class="s2">u</span><span class="s0">={},</span><span class="s2">l</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">))</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read ContentInfo.&quot;</span><span class="s0">)).</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">v</span><span class="s0">;</span><span class="s1">var </span><span class="s2">p</span><span class="s0">={</span><span class="s2">encrypted</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},</span><span class="s2">f</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">)){</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">:</span><span class="s1">if</span><span class="s0">(</span><span class="s2">g</span><span class="s0">.</span><span class="s2">tagClass</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">||</span><span class="s2">g</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#12 SafeContents Data is not an OCTET STRING.&quot;</span><span class="s0">);</span><span class="s2">f</span><span class="s0">=</span><span class="s2">h</span><span class="s0">(</span><span class="s2">g</span><span class="s0">).</span><span class="s2">value</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">encryptedData</span><span class="s0">:</span><span class="s2">f</span><span class="s0">=</span><span class="s2">d</span><span class="s0">(</span><span class="s2">g</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">encrypted</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">var </span><span class="s2">v</span><span class="s0">;</span><span class="s1">throw</span><span class="s0">(</span><span class="s2">v</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported PKCS#12 contentType.&quot;</span><span class="s0">)).</span><span class="s2">contentType</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">),</span><span class="s2">v</span><span class="s0">}</span><span class="s2">p</span><span class="s0">.</span><span class="s2">safeBags</span><span class="s0">=</span><span class="s2">y</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">safeContents</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">p</span><span class="s0">)}}(</span><span class="s2">p</span><span class="s0">,</span><span class="s2">g</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">p</span><span class="s0">},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toPkcs12Asn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">){(</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">||{}).</span><span class="s2">saltSize</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">saltSize</span><span class="s0">||</span><span class="s4">8</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">count</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">count</span><span class="s0">||</span><span class="s4">2048</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">||</span><span class="s2">o</span><span class="s0">.</span><span class="s2">encAlgorithm</span><span class="s0">||</span><span class="s3">&quot;aes128&quot;</span><span class="s0">,</span><span class="s3">&quot;useMac&quot;</span><span class="s1">in </span><span class="s2">o</span><span class="s0">||(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">useMac</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s3">&quot;localKeyId&quot;</span><span class="s1">in </span><span class="s2">o</span><span class="s0">||(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">localKeyId</span><span class="s0">=</span><span class="s1">null</span><span class="s0">),</span><span class="s3">&quot;generateLocalKeyId&quot;</span><span class="s1">in </span><span class="s2">o</span><span class="s0">||(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">generateLocalKeyId</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">localKeyId</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">)</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">u</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">generateLocalKeyId</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">l</span><span class="s0">&amp;&amp;(</span><span class="s2">l</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)),(</span><span class="s2">N</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">()).</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">l</span><span class="s0">)).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">N</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">()}</span><span class="s1">else </span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">20</span><span class="s0">);</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=[];</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">u</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">localKeyId</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)])])),</span><span class="s3">&quot;friendlyName&quot;</span><span class="s1">in </span><span class="s2">o</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">friendlyName</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BMPSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">o</span><span class="s0">.</span><span class="s2">friendlyName</span><span class="s0">)])])),</span><span class="s2">p</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">));</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=[],</span><span class="s2">h</span><span class="s0">=[];</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)?</span><span class="s2">t</span><span class="s0">:[</span><span class="s2">t</span><span class="s0">]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=[],</span><span class="s2">y</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">y</span><span class="s0">&lt;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">y</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">h</span><span class="s0">[</span><span class="s2">y</span><span class="s0">])&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">));</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s4">0</span><span class="s0">===</span><span class="s2">y</span><span class="s0">?</span><span class="s2">c</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">m</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">certBag</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">x509Certificate</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">v</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])])]),</span><span class="s2">g</span><span class="s0">]);</span><span class="s2">d</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">m</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">d</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">var </span><span class="s2">C</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">d</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">C</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])]);</span><span class="s2">f</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">E</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">T</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">wrapRsaPrivateKey</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">privateKeyToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s2">S</span><span class="s0">=</span><span class="s1">null</span><span class="s0">===</span><span class="s2">r</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">keyBag</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">T</span><span class="s0">]),</span><span class="s2">c</span><span class="s0">]):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">pkcs8ShroudedKeyBag</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptPrivateKeyInfo</span><span class="s0">(</span><span class="s2">T</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">o</span><span class="s0">)]),</span><span class="s2">c</span><span class="s0">]);</span><span class="s1">var </span><span class="s2">I</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">S</span><span class="s0">]),</span><span class="s2">A</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">I</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])]);</span><span class="s2">f</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">A</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">B</span><span class="s0">,</span><span class="s2">b</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">useMac</span><span class="s0">){</span><span class="s1">var </span><span class="s2">N</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">R</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">saltSize</span><span class="s0">)),</span><span class="s2">w</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">count</span><span class="s0">,</span><span class="s2">_</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">generateKey</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">R</span><span class="s0">,</span><span class="s4">3</span><span class="s0">,</span><span class="s2">w</span><span class="s0">,</span><span class="s4">20</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">());</span><span class="s2">_</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">N</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">_</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">b</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">L</span><span class="s0">=</span><span class="s2">_</span><span class="s0">.</span><span class="s2">getMac</span><span class="s0">();</span><span class="s2">B</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">L</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">R</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">w</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s4">3</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">b</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())])]),</span><span class="s2">B</span><span class="s0">])},</span><span class="s2">s</span><span class="s0">.</span><span class="s2">generateKey</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pbe</span><span class="s0">.</span><span class="s2">generatePkcs12Key</span><span class="s0">},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7asn1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7asn1</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">=</span><span class="s2">i</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo.ContentType&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;contentType&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;ContentInfo.content&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;content&quot;</span><span class="s0">}]};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">contentInfoValidator</span><span class="s0">=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">var </span><span class="s2">o</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo.contentType&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;contentType&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo.contentEncryptionAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo.contentEncryptionAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encAlgorithm&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo.contentEncryptionAlgorithm.parameter&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;encParameter&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedContentInfo.encryptedContent&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encryptedContent&quot;</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;encryptedContentAsn1&quot;</span><span class="s0">}]};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">envelopedDataValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EnvelopedData&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EnvelopedData.Version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;version&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EnvelopedData.RecipientInfos&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;recipientInfos&quot;</span><span class="s0">}].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedDataValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedData&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;EncryptedData.Version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;version&quot;</span><span class="s0">}].</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">c</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.issuerAndSerialNumber&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.issuerAndSerialNumber.issuer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;issuer&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.issuerAndSerialNumber.serialNumber&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;serial&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.digestAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.digestAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;digestAlgorithm&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.digestAlgorithm.parameter&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;digestParameter&quot;</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.authenticatedAttributes&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;authenticatedAttributes&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.digestEncryptionAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;signatureAlgorithm&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.encryptedDigest&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;signature&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignerInfo.unauthenticatedAttributes&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;unauthenticatedAttributes&quot;</span><span class="s0">}]};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">signedDataValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData.Version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;version&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData.DigestAlgorithms&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;digestAlgorithms&quot;</span><span class="s0">},</span><span class="s2">s</span><span class="s0">,{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData.Certificates&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;certificates&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData.CertificateRevocationLists&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;crls&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SignedData.SignerInfos&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;signerInfos&quot;</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[</span><span class="s2">c</span><span class="s0">]}]},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">recipientInfoValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;version&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.issuerAndSerial&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.issuerAndSerial.issuer&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;issuer&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.issuerAndSerial.serialNumber&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;serial&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.keyEncryptionAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.keyEncryptionAlgorithm.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encAlgorithm&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.keyEncryptionAlgorithm.parameter&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;encParameter&quot;</span><span class="s0">,</span><span class="s2">optional</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;RecipientInfo.encryptedKey&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;encKey&quot;</span><span class="s0">}]}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">||{},(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">||{}).</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">return</span><span class="s0">{</span><span class="s2">generate</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">r</span><span class="s0">/</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;</span><span class="s2">s</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">+</span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">())}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">r</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">||{};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">=</span><span class="s2">n</span><span class="s0">;</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">||{};</span><span class="s2">i</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s3">&quot;SHA-384&quot;</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">||{</span><span class="s2">create</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s3">&quot;SHA-512/256&quot;</span><span class="s0">)}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s3">&quot;sha512/256&quot;</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">[</span><span class="s3">&quot;sha512/256&quot;</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha224</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha224</span><span class="s0">||{</span><span class="s2">create</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s3">&quot;SHA-512/224&quot;</span><span class="s0">)}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s3">&quot;sha512/224&quot;</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">algorithms</span><span class="s0">[</span><span class="s3">&quot;sha512/224&quot;</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">sha224</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">||(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">128</span><span class="s0">),</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s4">128</span><span class="s0">),</span><span class="s2">c</span><span class="s0">=[[</span><span class="s4">1116352408</span><span class="s0">,</span><span class="s4">3609767458</span><span class="s0">],[</span><span class="s4">1899447441</span><span class="s0">,</span><span class="s4">602891725</span><span class="s0">],[</span><span class="s4">3049323471</span><span class="s0">,</span><span class="s4">3964484399</span><span class="s0">],[</span><span class="s4">3921009573</span><span class="s0">,</span><span class="s4">2173295548</span><span class="s0">],[</span><span class="s4">961987163</span><span class="s0">,</span><span class="s4">4081628472</span><span class="s0">],[</span><span class="s4">1508970993</span><span class="s0">,</span><span class="s4">3053834265</span><span class="s0">],[</span><span class="s4">2453635748</span><span class="s0">,</span><span class="s4">2937671579</span><span class="s0">],[</span><span class="s4">2870763221</span><span class="s0">,</span><span class="s4">3664609560</span><span class="s0">],[</span><span class="s4">3624381080</span><span class="s0">,</span><span class="s4">2734883394</span><span class="s0">],[</span><span class="s4">310598401</span><span class="s0">,</span><span class="s4">1164996542</span><span class="s0">],[</span><span class="s4">607225278</span><span class="s0">,</span><span class="s4">1323610764</span><span class="s0">],[</span><span class="s4">1426881987</span><span class="s0">,</span><span class="s4">3590304994</span><span class="s0">],[</span><span class="s4">1925078388</span><span class="s0">,</span><span class="s4">4068182383</span><span class="s0">],[</span><span class="s4">2162078206</span><span class="s0">,</span><span class="s4">991336113</span><span class="s0">],[</span><span class="s4">2614888103</span><span class="s0">,</span><span class="s4">633803317</span><span class="s0">],[</span><span class="s4">3248222580</span><span class="s0">,</span><span class="s4">3479774868</span><span class="s0">],[</span><span class="s4">3835390401</span><span class="s0">,</span><span class="s4">2666613458</span><span class="s0">],[</span><span class="s4">4022224774</span><span class="s0">,</span><span class="s4">944711139</span><span class="s0">],[</span><span class="s4">264347078</span><span class="s0">,</span><span class="s4">2341262773</span><span class="s0">],[</span><span class="s4">604807628</span><span class="s0">,</span><span class="s4">2007800933</span><span class="s0">],[</span><span class="s4">770255983</span><span class="s0">,</span><span class="s4">1495990901</span><span class="s0">],[</span><span class="s4">1249150122</span><span class="s0">,</span><span class="s4">1856431235</span><span class="s0">],[</span><span class="s4">1555081692</span><span class="s0">,</span><span class="s4">3175218132</span><span class="s0">],[</span><span class="s4">1996064986</span><span class="s0">,</span><span class="s4">2198950837</span><span class="s0">],[</span><span class="s4">2554220882</span><span class="s0">,</span><span class="s4">3999719339</span><span class="s0">],[</span><span class="s4">2821834349</span><span class="s0">,</span><span class="s4">766784016</span><span class="s0">],[</span><span class="s4">2952996808</span><span class="s0">,</span><span class="s4">2566594879</span><span class="s0">],[</span><span class="s4">3210313671</span><span class="s0">,</span><span class="s4">3203337956</span><span class="s0">],[</span><span class="s4">3336571891</span><span class="s0">,</span><span class="s4">1034457026</span><span class="s0">],[</span><span class="s4">3584528711</span><span class="s0">,</span><span class="s4">2466948901</span><span class="s0">],[</span><span class="s4">113926993</span><span class="s0">,</span><span class="s4">3758326383</span><span class="s0">],[</span><span class="s4">338241895</span><span class="s0">,</span><span class="s4">168717936</span><span class="s0">],[</span><span class="s4">666307205</span><span class="s0">,</span><span class="s4">1188179964</span><span class="s0">],[</span><span class="s4">773529912</span><span class="s0">,</span><span class="s4">1546045734</span><span class="s0">],[</span><span class="s4">1294757372</span><span class="s0">,</span><span class="s4">1522805485</span><span class="s0">],[</span><span class="s4">1396182291</span><span class="s0">,</span><span class="s4">2643833823</span><span class="s0">],[</span><span class="s4">1695183700</span><span class="s0">,</span><span class="s4">2343527390</span><span class="s0">],[</span><span class="s4">1986661051</span><span class="s0">,</span><span class="s4">1014477480</span><span class="s0">],[</span><span class="s4">2177026350</span><span class="s0">,</span><span class="s4">1206759142</span><span class="s0">],[</span><span class="s4">2456956037</span><span class="s0">,</span><span class="s4">344077627</span><span class="s0">],[</span><span class="s4">2730485921</span><span class="s0">,</span><span class="s4">1290863460</span><span class="s0">],[</span><span class="s4">2820302411</span><span class="s0">,</span><span class="s4">3158454273</span><span class="s0">],[</span><span class="s4">3259730800</span><span class="s0">,</span><span class="s4">3505952657</span><span class="s0">],[</span><span class="s4">3345764771</span><span class="s0">,</span><span class="s4">106217008</span><span class="s0">],[</span><span class="s4">3516065817</span><span class="s0">,</span><span class="s4">3606008344</span><span class="s0">],[</span><span class="s4">3600352804</span><span class="s0">,</span><span class="s4">1432725776</span><span class="s0">],[</span><span class="s4">4094571909</span><span class="s0">,</span><span class="s4">1467031594</span><span class="s0">],[</span><span class="s4">275423344</span><span class="s0">,</span><span class="s4">851169720</span><span class="s0">],[</span><span class="s4">430227734</span><span class="s0">,</span><span class="s4">3100823752</span><span class="s0">],[</span><span class="s4">506948616</span><span class="s0">,</span><span class="s4">1363258195</span><span class="s0">],[</span><span class="s4">659060556</span><span class="s0">,</span><span class="s4">3750685593</span><span class="s0">],[</span><span class="s4">883997877</span><span class="s0">,</span><span class="s4">3785050280</span><span class="s0">],[</span><span class="s4">958139571</span><span class="s0">,</span><span class="s4">3318307427</span><span class="s0">],[</span><span class="s4">1322822218</span><span class="s0">,</span><span class="s4">3812723403</span><span class="s0">],[</span><span class="s4">1537002063</span><span class="s0">,</span><span class="s4">2003034995</span><span class="s0">],[</span><span class="s4">1747873779</span><span class="s0">,</span><span class="s4">3602036899</span><span class="s0">],[</span><span class="s4">1955562222</span><span class="s0">,</span><span class="s4">1575990012</span><span class="s0">],[</span><span class="s4">2024104815</span><span class="s0">,</span><span class="s4">1125592928</span><span class="s0">],[</span><span class="s4">2227730452</span><span class="s0">,</span><span class="s4">2716904306</span><span class="s0">],[</span><span class="s4">2361852424</span><span class="s0">,</span><span class="s4">442776044</span><span class="s0">],[</span><span class="s4">2428436474</span><span class="s0">,</span><span class="s4">593698344</span><span class="s0">],[</span><span class="s4">2756734187</span><span class="s0">,</span><span class="s4">3733110249</span><span class="s0">],[</span><span class="s4">3204031479</span><span class="s0">,</span><span class="s4">2999351573</span><span class="s0">],[</span><span class="s4">3329325298</span><span class="s0">,</span><span class="s4">3815920427</span><span class="s0">],[</span><span class="s4">3391569614</span><span class="s0">,</span><span class="s4">3928383900</span><span class="s0">],[</span><span class="s4">3515267271</span><span class="s0">,</span><span class="s4">566280711</span><span class="s0">],[</span><span class="s4">3940187606</span><span class="s0">,</span><span class="s4">3454069534</span><span class="s0">],[</span><span class="s4">4118630271</span><span class="s0">,</span><span class="s4">4000239992</span><span class="s0">],[</span><span class="s4">116418474</span><span class="s0">,</span><span class="s4">1914138554</span><span class="s0">],[</span><span class="s4">174292421</span><span class="s0">,</span><span class="s4">2731055270</span><span class="s0">],[</span><span class="s4">289380356</span><span class="s0">,</span><span class="s4">3203993006</span><span class="s0">],[</span><span class="s4">460393269</span><span class="s0">,</span><span class="s4">320620315</span><span class="s0">],[</span><span class="s4">685471733</span><span class="s0">,</span><span class="s4">587496836</span><span class="s0">],[</span><span class="s4">852142971</span><span class="s0">,</span><span class="s4">1086792851</span><span class="s0">],[</span><span class="s4">1017036298</span><span class="s0">,</span><span class="s4">365543100</span><span class="s0">],[</span><span class="s4">1126000580</span><span class="s0">,</span><span class="s4">2618297676</span><span class="s0">],[</span><span class="s4">1288033470</span><span class="s0">,</span><span class="s4">3409855158</span><span class="s0">],[</span><span class="s4">1501505948</span><span class="s0">,</span><span class="s4">4234509866</span><span class="s0">],[</span><span class="s4">1607167915</span><span class="s0">,</span><span class="s4">987167468</span><span class="s0">],[</span><span class="s4">1816402316</span><span class="s0">,</span><span class="s4">1246189591</span><span class="s0">]],(</span><span class="s2">u</span><span class="s0">={})[</span><span class="s3">&quot;SHA-512&quot;</span><span class="s0">]=[[</span><span class="s4">1779033703</span><span class="s0">,</span><span class="s4">4089235720</span><span class="s0">],[</span><span class="s4">3144134277</span><span class="s0">,</span><span class="s4">2227873595</span><span class="s0">],[</span><span class="s4">1013904242</span><span class="s0">,</span><span class="s4">4271175723</span><span class="s0">],[</span><span class="s4">2773480762</span><span class="s0">,</span><span class="s4">1595750129</span><span class="s0">],[</span><span class="s4">1359893119</span><span class="s0">,</span><span class="s4">2917565137</span><span class="s0">],[</span><span class="s4">2600822924</span><span class="s0">,</span><span class="s4">725511199</span><span class="s0">],[</span><span class="s4">528734635</span><span class="s0">,</span><span class="s4">4215389547</span><span class="s0">],[</span><span class="s4">1541459225</span><span class="s0">,</span><span class="s4">327033209</span><span class="s0">]],</span><span class="s2">u</span><span class="s0">[</span><span class="s3">&quot;SHA-384&quot;</span><span class="s0">]=[[</span><span class="s4">3418070365</span><span class="s0">,</span><span class="s4">3238371032</span><span class="s0">],[</span><span class="s4">1654270250</span><span class="s0">,</span><span class="s4">914150663</span><span class="s0">],[</span><span class="s4">2438529370</span><span class="s0">,</span><span class="s4">812702999</span><span class="s0">],[</span><span class="s4">355462360</span><span class="s0">,</span><span class="s4">4144912697</span><span class="s0">],[</span><span class="s4">1731405415</span><span class="s0">,</span><span class="s4">4290775857</span><span class="s0">],[</span><span class="s4">2394180231</span><span class="s0">,</span><span class="s4">1750603025</span><span class="s0">],[</span><span class="s4">3675008525</span><span class="s0">,</span><span class="s4">1694076839</span><span class="s0">],[</span><span class="s4">1203062813</span><span class="s0">,</span><span class="s4">3204075428</span><span class="s0">]],</span><span class="s2">u</span><span class="s0">[</span><span class="s3">&quot;SHA-512/256&quot;</span><span class="s0">]=[[</span><span class="s4">573645204</span><span class="s0">,</span><span class="s4">4230739756</span><span class="s0">],[</span><span class="s4">2673172387</span><span class="s0">,</span><span class="s4">3360449730</span><span class="s0">],[</span><span class="s4">596883563</span><span class="s0">,</span><span class="s4">1867755857</span><span class="s0">],[</span><span class="s4">2520282905</span><span class="s0">,</span><span class="s4">1497426621</span><span class="s0">],[</span><span class="s4">2519219938</span><span class="s0">,</span><span class="s4">2827943907</span><span class="s0">],[</span><span class="s4">3193839141</span><span class="s0">,</span><span class="s4">1401305490</span><span class="s0">],[</span><span class="s4">721525244</span><span class="s0">,</span><span class="s4">746961066</span><span class="s0">],[</span><span class="s4">246885852</span><span class="s0">,</span><span class="s4">2177182882</span><span class="s0">]],</span><span class="s2">u</span><span class="s0">[</span><span class="s3">&quot;SHA-512/224&quot;</span><span class="s0">]=[[</span><span class="s4">2352822216</span><span class="s0">,</span><span class="s4">424955298</span><span class="s0">],[</span><span class="s4">1944164710</span><span class="s0">,</span><span class="s4">2312950998</span><span class="s0">],[</span><span class="s4">502970286</span><span class="s0">,</span><span class="s4">855612546</span><span class="s0">],[</span><span class="s4">1738396948</span><span class="s0">,</span><span class="s4">1479516111</span><span class="s0">],[</span><span class="s4">258812777</span><span class="s0">,</span><span class="s4">2077511080</span><span class="s0">],[</span><span class="s4">2011393907</span><span class="s0">,</span><span class="s4">79989058</span><span class="s0">],[</span><span class="s4">1067287976</span><span class="s0">,</span><span class="s4">1780299464</span><span class="s0">],[</span><span class="s4">286451373</span><span class="s0">,</span><span class="s4">2446758561</span><span class="s0">]],</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s3">&quot;SHA-512&quot;</span><span class="s0">),!(</span><span class="s2">e </span><span class="s1">in </span><span class="s2">u</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid SHA-512 algorithm: &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">u</span><span class="s0">[</span><span class="s2">e</span><span class="s0">],</span><span class="s2">r</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">80</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s4">80</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s4">2</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s4">64</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">case</span><span class="s3">&quot;SHA-384&quot;</span><span class="s0">:</span><span class="s2">f</span><span class="s0">=</span><span class="s4">48</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;SHA-512/256&quot;</span><span class="s0">:</span><span class="s2">f</span><span class="s0">=</span><span class="s4">32</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case</span><span class="s3">&quot;SHA-512/224&quot;</span><span class="s0">:</span><span class="s2">f</span><span class="s0">=</span><span class="s4">28</span><span class="s0">}</span><span class="s1">var </span><span class="s2">h</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s3">&quot;-&quot;</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">).</span><span class="s2">toLowerCase</span><span class="s0">(),</span><span class="s2">blockLength</span><span class="s0">:</span><span class="s4">128</span><span class="s0">,</span><span class="s2">digestLength</span><span class="s0">:</span><span class="s2">f</span><span class="s0">,</span><span class="s2">messageLength</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">fullMessageLength</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">messageLengthSize</span><span class="s0">:</span><span class="s4">16</span><span class="s0">,</span><span class="s2">start</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">h</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">messageLength128</span><span class="s0">=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">/</span><span class="s4">4</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return </span><span class="s2">h</span><span class="s0">}};</span><span class="s1">return </span><span class="s2">h</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">update</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;utf8&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">));</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">messageLength</span><span class="s0">+=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=[</span><span class="s2">s</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">o</span><span class="s0">)</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]+=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">s</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">l</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">read</span><span class="s0">&gt;</span><span class="s4">2048</span><span class="s0">||</span><span class="s4">0</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">())&amp;&amp;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">compact</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">},</span><span class="s2">h</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">h</span><span class="s0">.</span><span class="s2">messageLengthSize</span><span class="s0">&amp;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">substr</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">blockLength</span><span class="s0">-</span><span class="s2">c</span><span class="s0">));</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">u</span><span class="s0">+=(</span><span class="s2">o</span><span class="s0">=</span><span class="s4">8</span><span class="s0">*</span><span class="s2">h</span><span class="s0">.</span><span class="s2">fullMessageLength</span><span class="s0">[</span><span class="s2">p</span><span class="s0">+</span><span class="s4">1</span><span class="s0">])/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">u</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">o</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">u</span><span class="s0">);</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Array</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">f</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">p</span><span class="s0">].</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">l</span><span class="s0">(</span><span class="s2">f</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">d</span><span class="s0">=</span><span class="s3">&quot;SHA-512&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">:</span><span class="s3">&quot;SHA-384&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">?</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">2</span><span class="s0">:</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">4</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">d</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">y</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">[</span><span class="s2">p</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">p</span><span class="s0">===</span><span class="s2">d</span><span class="s0">-</span><span class="s4">1</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;SHA-512/224&quot;</span><span class="s0">===</span><span class="s2">e</span><span class="s0">||</span><span class="s2">y</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">f</span><span class="s0">[</span><span class="s2">p</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">y</span><span class="s0">},</span><span class="s2">h</span><span class="s0">};</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">function </span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">l</span><span class="s0">,</span><span class="s2">p</span><span class="s0">,</span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">,</span><span class="s2">d</span><span class="s0">,</span><span class="s2">y</span><span class="s0">,</span><span class="s2">g</span><span class="s0">,</span><span class="s2">v</span><span class="s0">,</span><span class="s2">m</span><span class="s0">,</span><span class="s2">C</span><span class="s0">,</span><span class="s2">E</span><span class="s0">,</span><span class="s2">S</span><span class="s0">,</span><span class="s2">T</span><span class="s0">,</span><span class="s2">I</span><span class="s0">,</span><span class="s2">A</span><span class="s0">,</span><span class="s2">B</span><span class="s0">,</span><span class="s2">b</span><span class="s0">,</span><span class="s2">N</span><span class="s0">,</span><span class="s2">R</span><span class="s0">,</span><span class="s2">w</span><span class="s0">,</span><span class="s2">_</span><span class="s0">,</span><span class="s2">L</span><span class="s0">,</span><span class="s2">k</span><span class="s0">,</span><span class="s2">U</span><span class="s0">,</span><span class="s2">D</span><span class="s0">,</span><span class="s2">P</span><span class="s0">,</span><span class="s2">V</span><span class="s0">,</span><span class="s2">O</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">O</span><span class="s0">&gt;=</span><span class="s4">128</span><span class="s0">;){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">_</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">_</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">_</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getInt32</span><span class="s0">()&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">_</span><span class="s0">&lt;</span><span class="s4">80</span><span class="s0">;++</span><span class="s2">_</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=(((</span><span class="s2">L</span><span class="s0">=(</span><span class="s2">U</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">-</span><span class="s4">2</span><span class="s0">])[</span><span class="s4">0</span><span class="s0">])&gt;&gt;&gt;</span><span class="s4">19</span><span class="s0">|(</span><span class="s2">k</span><span class="s0">=</span><span class="s2">U</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])&lt;&lt;</span><span class="s4">13</span><span class="s0">)^(</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">29</span><span class="s0">|</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">)^</span><span class="s2">L</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">6</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=((</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">13</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">19</span><span class="s0">)^(</span><span class="s2">k</span><span class="s0">&lt;&lt;</span><span class="s4">3</span><span class="s0">|</span><span class="s2">L</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">29</span><span class="s0">)^(</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">26</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">6</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=(((</span><span class="s2">L</span><span class="s0">=(</span><span class="s2">P</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">-</span><span class="s4">15</span><span class="s0">])[</span><span class="s4">0</span><span class="s0">])&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">|(</span><span class="s2">k</span><span class="s0">=</span><span class="s2">P</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])&lt;&lt;</span><span class="s4">31</span><span class="s0">)^(</span><span class="s2">L</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&lt;&lt;</span><span class="s4">24</span><span class="s0">)^</span><span class="s2">L</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">7</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=((</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">31</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">1</span><span class="s0">)^(</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">24</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">)^(</span><span class="s2">L</span><span class="s0">&lt;&lt;</span><span class="s4">25</span><span class="s0">|</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">7</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">D</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">-</span><span class="s4">7</span><span class="s0">],</span><span class="s2">V</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">-</span><span class="s4">16</span><span class="s0">],</span><span class="s2">k</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+</span><span class="s2">D</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">s</span><span class="s0">+</span><span class="s2">V</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">+</span><span class="s2">D</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">i</span><span class="s0">+</span><span class="s2">V</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">d</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">y</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">g</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">v</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">m</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">C</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">E</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">S</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">T</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">I</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">A</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">B</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">b</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">N</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">R</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">0</span><span class="s0">],</span><span class="s2">w</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">_</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">_</span><span class="s0">&lt;</span><span class="s4">80</span><span class="s0">;++</span><span class="s2">_</span><span class="s0">)</span><span class="s2">l</span><span class="s0">=((</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">14</span><span class="s0">|</span><span class="s2">I</span><span class="s0">&lt;&lt;</span><span class="s4">18</span><span class="s0">)^(</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">18</span><span class="s0">|</span><span class="s2">I</span><span class="s0">&lt;&lt;</span><span class="s4">14</span><span class="s0">)^(</span><span class="s2">I</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">9</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">23</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=(</span><span class="s2">b</span><span class="s0">^</span><span class="s2">T</span><span class="s0">&amp;(</span><span class="s2">A</span><span class="s0">^</span><span class="s2">b</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=((</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">28</span><span class="s0">|</span><span class="s2">y</span><span class="s0">&lt;&lt;</span><span class="s4">4</span><span class="s0">)^(</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">|</span><span class="s2">d</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">)^(</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">7</span><span class="s0">|</span><span class="s2">d</span><span class="s0">&lt;&lt;</span><span class="s4">25</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=((</span><span class="s2">d</span><span class="s0">&lt;&lt;</span><span class="s4">4</span><span class="s0">|</span><span class="s2">y</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">28</span><span class="s0">)^(</span><span class="s2">y</span><span class="s0">&lt;&lt;</span><span class="s4">30</span><span class="s0">|</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">2</span><span class="s0">)^(</span><span class="s2">y</span><span class="s0">&lt;&lt;</span><span class="s4">25</span><span class="s0">|</span><span class="s2">d</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">7</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=(</span><span class="s2">d</span><span class="s0">&amp;</span><span class="s2">g</span><span class="s0">|</span><span class="s2">m</span><span class="s0">&amp;(</span><span class="s2">d</span><span class="s0">^</span><span class="s2">g</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=(</span><span class="s2">y</span><span class="s0">&amp;</span><span class="s2">v</span><span class="s0">|</span><span class="s2">C</span><span class="s0">&amp;(</span><span class="s2">y</span><span class="s0">^</span><span class="s2">v</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">w</span><span class="s0">+(((</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">18</span><span class="s0">|</span><span class="s2">I</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">14</span><span class="s0">)^(</span><span class="s2">T</span><span class="s0">&lt;&lt;</span><span class="s4">14</span><span class="s0">|</span><span class="s2">I</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">18</span><span class="s0">)^(</span><span class="s2">I</span><span class="s0">&lt;&lt;</span><span class="s4">23</span><span class="s0">|</span><span class="s2">T</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">9</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)+((</span><span class="s2">N</span><span class="s0">^</span><span class="s2">I</span><span class="s0">&amp;(</span><span class="s2">B</span><span class="s0">^</span><span class="s2">N</span><span class="s0">))&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">1</span><span class="s0">],</span><span class="s2">a</span><span class="s0">=</span><span class="s2">R</span><span class="s0">+</span><span class="s2">l</span><span class="s0">+</span><span class="s2">p</span><span class="s0">+</span><span class="s2">c</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">t</span><span class="s0">[</span><span class="s2">_</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">o</span><span class="s0">+</span><span class="s2">f</span><span class="s0">+((</span><span class="s2">k</span><span class="s0">=</span><span class="s2">u</span><span class="s0">+</span><span class="s2">h</span><span class="s0">)/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">R</span><span class="s0">=</span><span class="s2">b</span><span class="s0">,</span><span class="s2">w</span><span class="s0">=</span><span class="s2">N</span><span class="s0">,</span><span class="s2">b</span><span class="s0">=</span><span class="s2">A</span><span class="s0">,</span><span class="s2">N</span><span class="s0">=</span><span class="s2">B</span><span class="s0">,</span><span class="s2">A</span><span class="s0">=</span><span class="s2">T</span><span class="s0">,</span><span class="s2">B</span><span class="s0">=</span><span class="s2">I</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s2">E</span><span class="s0">+</span><span class="s2">a</span><span class="s0">+((</span><span class="s2">k</span><span class="s0">=</span><span class="s2">S</span><span class="s0">+</span><span class="s2">n</span><span class="s0">)/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">I</span><span class="s0">=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s2">m</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s2">C</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s2">v</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s2">a</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+((</span><span class="s2">k</span><span class="s0">=</span><span class="s2">n</span><span class="s0">+</span><span class="s2">s</span><span class="s0">)/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">;</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">y</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">d</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">v</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">g</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">C</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">m</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">S</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">E</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">I</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">T</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">B</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">A</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">N</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">b</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]+</span><span class="s2">w</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]+</span><span class="s2">R</span><span class="s0">+(</span><span class="s2">k</span><span class="s0">/</span><span class="s4">4294967296</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">)&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">k</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">0</span><span class="s0">,</span><span class="s2">O</span><span class="s0">-=</span><span class="s4">128</span><span class="s0">}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">33</span><span class="s0">)},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">36</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">13</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">10</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">38</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">40</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">41</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">42</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">30</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">15</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">26</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">28</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">43</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">21</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">27</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">24</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">18</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">25</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">44</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">20</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">)},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return this</span><span class="s0">}();</span><span class="s1">try</span><span class="s0">{</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s1">new </span><span class="s2">Function</span><span class="s0">(</span><span class="s3">&quot;return this&quot;</span><span class="s0">)()}</span><span class="s1">catch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;object&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">window</span><span class="s0">)}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">r</span><span class="s0">},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={};</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s1">var </span><span class="s2">a</span><span class="s0">={};</span><span class="s2">r</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;alphabet&quot; must be a string.'</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;number&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">r</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;maxline&quot; must be a number.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e </span><span class="s1">instanceof </span><span class="s2">Uint8Array</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">)</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">%</span><span class="s2">i</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">u</span><span class="s0">/</span><span class="s2">i</span><span class="s0">|</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">u</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">%</span><span class="s2">i</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">u</span><span class="s0">/</span><span class="s2">i</span><span class="s0">|</span><span class="s4">0</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&amp;&amp;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">s</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">n</span><span class="s0">)</span><span class="s2">a</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]]}</span><span class="s1">else </span><span class="s2">a</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">o</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">%</span><span class="s2">a</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">/</span><span class="s2">a</span><span class="s0">|</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">o</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">o</span><span class="s0">%</span><span class="s2">a</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">o</span><span class="s0">/</span><span class="s2">a</span><span class="s0">|</span><span class="s4">0</span><span class="s0">}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&amp;&amp;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]];</span><span class="s1">return </span><span class="s2">c</span><span class="s0">}(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">RegExp</span><span class="s0">(</span><span class="s3">&quot;.{1,&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">+</span><span class="s3">&quot;}&quot;</span><span class="s0">,</span><span class="s3">&quot;g&quot;</span><span class="s0">);</span><span class="s2">a</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s2">l</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">},</span><span class="s2">r</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;input&quot; must be a string.'</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;alphabet&quot; must be a string.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">){</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=[];</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)]=</span><span class="s2">n</span><span class="s0">}</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">replace</span><span class="s0">(</span><span class="s5">/\s/g</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">charAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span><span class="s2">n</span><span class="s0">++){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">c</span><span class="s0">)</span><span class="s1">return</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s2">c</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">)</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">o</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]*</span><span class="s2">i</span><span class="s0">,</span><span class="s2">o</span><span class="s0">[</span><span class="s2">u</span><span class="s0">]=</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">,</span><span class="s2">l</span><span class="s0">&gt;&gt;=</span><span class="s4">8</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(;</span><span class="s2">l</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">;)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">l</span><span class="s0">),</span><span class="s2">l</span><span class="s0">&gt;&gt;=</span><span class="s4">8</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">e</span><span class="s0">[</span><span class="s2">p</span><span class="s0">]===</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">)</span><span class="s2">o</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s1">return</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">Buffer</span><span class="s0">?</span><span class="s2">Buffer</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reverse</span><span class="s0">()):</span><span class="s1">new </span><span class="s2">Uint8Array</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">reverse</span><span class="s0">())}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">20</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">;</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">entity</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">tls</span><span class="s0">.</span><span class="s2">ConnectionEnd</span><span class="s0">.</span><span class="s2">client</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">={</span><span class="s2">init</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">cipher</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createDecipher</span><span class="s0">(</span><span class="s3">&quot;AES-CBC&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_key</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_key</span><span class="s0">),</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">i</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_IV</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_IV</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">={</span><span class="s2">init</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">cipher</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">.</span><span class="s2">createCipher</span><span class="s0">(</span><span class="s3">&quot;AES-CBC&quot;</span><span class="s0">,</span><span class="s2">i</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_key</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_key</span><span class="s0">),</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">i</span><span class="s0">?</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">client_write_IV</span><span class="s0">:</span><span class="s2">r</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">.</span><span class="s2">server_write_IV</span><span class="s0">},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">cipherFunction</span><span class="s0">=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">cipherFunction</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">macLength</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">macLength</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">mac_length</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">read</span><span class="s0">.</span><span class="s2">macFunction</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">write</span><span class="s0">.</span><span class="s2">macFunction</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">hmac_sha1</span><span class="s0">}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macFunction</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macKey</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">updateSequenceNumber</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_0</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">init</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">init</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">;</span><span class="s1">return </span><span class="s2">c</span><span class="s0">.</span><span class="s2">start</span><span class="s0">({</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">&gt;=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_1</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">&amp;&amp;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">),</span><span class="s2">c</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">c</span><span class="s0">.</span><span class="s2">output</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">),</span><span class="s2">i</span><span class="s0">}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">e</span><span class="s0">-</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()%</span><span class="s2">e</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">return</span><span class="s0">!</span><span class="s4">0</span><span class="s0">}</span><span class="s1">function </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">last</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">-</span><span class="s2">i</span><span class="s0">;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;++</span><span class="s2">s</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)==</span><span class="s2">i</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">i</span><span class="s0">+</span><span class="s4">1</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}</span><span class="s1">function </span><span class="s2">u</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">===</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Versions</span><span class="s0">.</span><span class="s2">TLS_1_0</span><span class="s0">.</span><span class="s2">minor</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">init</span><span class="s0">?</span><span class="s1">null</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">init</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">cipherState</span><span class="s0">.</span><span class="s2">cipher</span><span class="s0">;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">start</span><span class="s0">({</span><span class="s2">iv</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">(</span><span class="s2">c</span><span class="s0">);</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macLength</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">o</span><span class="s0">),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s2">l</span><span class="s0">&gt;=</span><span class="s2">o</span><span class="s0">?(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">l</span><span class="s0">-</span><span class="s2">o</span><span class="s0">),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">output</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fragment</span><span class="s0">.</span><span class="s2">length</span><span class="s0">();</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macFunction</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macKey</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">sequenceNumber</span><span class="s0">,</span><span class="s2">e</span><span class="s0">);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">updateSequenceNumber</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s3">&quot;SHA1&quot;</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s1">null</span><span class="s0">,</span><span class="s1">null</span><span class="s0">),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">r</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">===</span><span class="s2">r</span><span class="s0">}(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">macKey</span><span class="s0">,</span><span class="s2">u</span><span class="s0">,</span><span class="s2">p</span><span class="s0">)&amp;&amp;</span><span class="s2">i</span><span class="s0">}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">.</span><span class="s2">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">47</span><span class="s0">],</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;TLS_RSA_WITH_AES_128_CBC_SHA&quot;</span><span class="s0">,</span><span class="s2">initSecurityParameters</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bulk_cipher_algorithm</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">BulkCipherAlgorithm</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher_type</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">CipherType</span><span class="s0">.</span><span class="s2">block</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">enc_key_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">block_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fixed_iv_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record_iv_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_algorithm</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">MACAlgorithm</span><span class="s0">.</span><span class="s2">hmac_sha1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_length</span><span class="s0">=</span><span class="s4">20</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_key_length</span><span class="s0">=</span><span class="s4">20</span><span class="s0">},</span><span class="s2">initConnectionState</span><span class="s0">:</span><span class="s2">i</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">CipherSuites</span><span class="s0">.</span><span class="s2">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="s0">={</span><span class="s2">id</span><span class="s0">:[</span><span class="s4">0</span><span class="s0">,</span><span class="s4">53</span><span class="s0">],</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;TLS_RSA_WITH_AES_256_CBC_SHA&quot;</span><span class="s0">,</span><span class="s2">initSecurityParameters</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">bulk_cipher_algorithm</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">BulkCipherAlgorithm</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">cipher_type</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">CipherType</span><span class="s0">.</span><span class="s2">block</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">enc_key_length</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">block_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">fixed_iv_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">record_iv_length</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_algorithm</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">MACAlgorithm</span><span class="s0">.</span><span class="s2">hmac_sha1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_length</span><span class="s0">=</span><span class="s4">20</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">mac_key_length</span><span class="s0">=</span><span class="s4">20</span><span class="s0">},</span><span class="s2">initConnectionState</span><span class="s0">:</span><span class="s2">i</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">30</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">mgf1</span><span class="s0">},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">12</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">31</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">39</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">publicKeyValidator</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">privateKeyValidator</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">o</span><span class="s0">)</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">;</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s3">&quot;undefined&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">Buffer</span><span class="s0">?</span><span class="s2">Uint8Array</span><span class="s0">:</span><span class="s2">Buffer</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">||{},</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">ed25519</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">ed25519</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">ed25519</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">ed25519</span><span class="s0">;</span><span class="s1">function </span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">Uint8Array</span><span class="s0">||</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">u</span><span class="s0">)</span><span class="s1">return </span><span class="s2">t</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.message&quot; or &quot;options.md&quot; not specified.'</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;binary&quot;</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.encoding&quot; must be &quot;binary&quot; or &quot;utf8&quot;.'</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">Buffer</span><span class="s0">)</span><span class="s1">return </span><span class="s2">Buffer</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">c</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(!(</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">c</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.message&quot; must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with &quot;options.encoding&quot; specifying its encoding.'</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">at</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">return </span><span class="s2">a</span><span class="s0">}</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">={},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">HASH_BYTE_LENGTH</span><span class="s0">=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">l</span><span class="s0">.</span><span class="s2">generateKeyPair</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{}).</span><span class="s2">seed</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;seed&quot; must be '</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">+</span><span class="s3">&quot; bytes in length.&quot;</span><span class="s0">)}</span><span class="s1">else if</span><span class="s0">(!(</span><span class="s2">t </span><span class="s1">instanceof </span><span class="s2">Uint8Array</span><span class="s0">))</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;seed&quot; must be a node.js Buffer, Uint8Array, or a binary string.'</span><span class="s0">);</span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">});</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=[</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">()],</span><span class="s2">n</span><span class="s0">=</span><span class="s2">E</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s4">32</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;=</span><span class="s4">248</span><span class="s0">,</span><span class="s2">n</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]&amp;=</span><span class="s4">127</span><span class="s0">,</span><span class="s2">n</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]|=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">L</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">B</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">+</span><span class="s4">32</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]}(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),{</span><span class="s2">publicKey</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">privateKey</span><span class="s0">:</span><span class="s2">n</span><span class="s0">}},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">privateKeyFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">s</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid Key.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">}</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">privateKeyOid</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">EdDSA25519</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid OID &quot;'</span><span class="s0">+</span><span class="s2">i</span><span class="s0">+</span><span class="s3">'&quot;; OID must be &quot;'</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">;</span><span class="s1">return</span><span class="s0">{</span><span class="s2">privateKeyBytes</span><span class="s0">:</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">c</span><span class="s0">).</span><span class="s2">value</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">})}},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">publicKeyFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid Key.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">n</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">}</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKeyOid</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">EdDSA25519</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">!==</span><span class="s2">o</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Invalid OID &quot;'</span><span class="s0">+</span><span class="s2">s</span><span class="s0">+</span><span class="s3">'&quot;; OID must be &quot;'</span><span class="s0">+</span><span class="s2">o</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">ed25519PublicKey</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Key length is invalid.&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">})},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">publicKeyFromPrivateKey</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{}).</span><span class="s2">privateKey</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.privateKey&quot; must have a byte length of '</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">32</span><span class="s0">+</span><span class="s2">a</span><span class="s0">];</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{}),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">privateKey</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">l</span><span class="s0">.</span><span class="s2">generateKeyPair</span><span class="s0">({</span><span class="s2">seed</span><span class="s0">:</span><span class="s2">r</span><span class="s0">}).</span><span class="s2">privateKey</span><span class="s0">;</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.privateKey&quot; must have a byte length of '</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SEED_BYTE_LENGTH</span><span class="s0">+</span><span class="s3">&quot; or &quot;</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PRIVATE_KEY_BYTE_LENGTH</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Float64Array</span><span class="s0">(</span><span class="s4">64</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=[</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">()],</span><span class="s2">c</span><span class="s0">=</span><span class="s2">E</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s4">32</span><span class="s0">);</span><span class="s2">c</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&amp;=</span><span class="s4">248</span><span class="s0">,</span><span class="s2">c</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]&amp;=</span><span class="s4">127</span><span class="s0">,</span><span class="s2">c</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]|=</span><span class="s4">64</span><span class="s0">;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">+</span><span class="s4">64</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s4">64</span><span class="s0">+</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s4">32</span><span class="s0">+</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">c</span><span class="s0">[</span><span class="s4">32</span><span class="s0">+</span><span class="s2">n</span><span class="s0">];</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subarray</span><span class="s0">(</span><span class="s4">32</span><span class="s0">),</span><span class="s2">r</span><span class="s0">+</span><span class="s4">32</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">T</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s2">L</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">B</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">32</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">var </span><span class="s2">p</span><span class="s0">=</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">+</span><span class="s4">64</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">T</span><span class="s0">(</span><span class="s2">p</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">32</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">l</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;</span><span class="s2">i</span><span class="s0">++)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s2">i</span><span class="s0">]+=</span><span class="s2">p</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]*</span><span class="s2">c</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">subarray</span><span class="s0">(</span><span class="s4">32</span><span class="s0">),</span><span class="s2">s</span><span class="s0">)}(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">n</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s1">return </span><span class="s2">n</span><span class="s0">},</span><span class="s2">l</span><span class="s0">.</span><span class="s2">verify</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">=</span><span class="s2">e</span><span class="s0">||{});</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.signature&quot; must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.'</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.signature&quot; must have a byte length of '</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">);</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">p</span><span class="s0">({</span><span class="s2">message</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">,</span><span class="s2">encoding</span><span class="s0">:</span><span class="s3">&quot;binary&quot;</span><span class="s0">});</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">length</span><span class="s0">!==</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'&quot;options.publicKey&quot; must have a byte length of '</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">PUBLIC_KEY_BYTE_LENGTH</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">SIGN_BYTE_LENGTH</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s4">32</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=[</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">()],</span><span class="s2">o</span><span class="s0">=[</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">()];</span><span class="s1">if</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">)</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();</span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">h</span><span class="s0">),</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">]+(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]&lt;&lt;</span><span class="s4">8</span><span class="s0">);</span><span class="s2">e</span><span class="s0">[</span><span class="s4">15</span><span class="s0">]&amp;=</span><span class="s4">32767</span><span class="s0">}(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">),</span><span class="s2">K</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">d</span><span class="s0">),</span><span class="s2">O</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">i</span><span class="s0">),</span><span class="s2">K</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">K</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">c</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">250</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">K</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s4">1</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]}(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">K</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">N</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)&amp;&amp;</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">C</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">K</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">N</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">))</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">w</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])===</span><span class="s2">t</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]&gt;&gt;</span><span class="s4">7</span><span class="s0">&amp;&amp;</span><span class="s2">O</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">f</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s4">0</span><span class="s0">}(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">a</span><span class="s0">))</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s4">32</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">T</span><span class="s0">(</span><span class="s2">c</span><span class="s0">),</span><span class="s2">_</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">L</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">subarray</span><span class="s0">(</span><span class="s4">32</span><span class="s0">)),</span><span class="s2">I</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">B</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">),</span><span class="s2">r</span><span class="s0">-=</span><span class="s4">64</span><span class="s0">,</span><span class="s2">R</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">return</span><span class="s0">-</span><span class="s4">1</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">+</span><span class="s4">64</span><span class="s0">];</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)&gt;=</span><span class="s4">0</span><span class="s0">};</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">h</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">d</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">30883</span><span class="s0">,</span><span class="s4">4953</span><span class="s0">,</span><span class="s4">19914</span><span class="s0">,</span><span class="s4">30187</span><span class="s0">,</span><span class="s4">55467</span><span class="s0">,</span><span class="s4">16705</span><span class="s0">,</span><span class="s4">2637</span><span class="s0">,</span><span class="s4">112</span><span class="s0">,</span><span class="s4">59544</span><span class="s0">,</span><span class="s4">30585</span><span class="s0">,</span><span class="s4">16505</span><span class="s0">,</span><span class="s4">36039</span><span class="s0">,</span><span class="s4">65139</span><span class="s0">,</span><span class="s4">11119</span><span class="s0">,</span><span class="s4">27886</span><span class="s0">,</span><span class="s4">20995</span><span class="s0">]),</span><span class="s2">y</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">61785</span><span class="s0">,</span><span class="s4">9906</span><span class="s0">,</span><span class="s4">39828</span><span class="s0">,</span><span class="s4">60374</span><span class="s0">,</span><span class="s4">45398</span><span class="s0">,</span><span class="s4">33411</span><span class="s0">,</span><span class="s4">5274</span><span class="s0">,</span><span class="s4">224</span><span class="s0">,</span><span class="s4">53552</span><span class="s0">,</span><span class="s4">61171</span><span class="s0">,</span><span class="s4">33010</span><span class="s0">,</span><span class="s4">6542</span><span class="s0">,</span><span class="s4">64743</span><span class="s0">,</span><span class="s4">22239</span><span class="s0">,</span><span class="s4">55772</span><span class="s0">,</span><span class="s4">9222</span><span class="s0">]),</span><span class="s2">g</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">54554</span><span class="s0">,</span><span class="s4">36645</span><span class="s0">,</span><span class="s4">11616</span><span class="s0">,</span><span class="s4">51542</span><span class="s0">,</span><span class="s4">42930</span><span class="s0">,</span><span class="s4">38181</span><span class="s0">,</span><span class="s4">51040</span><span class="s0">,</span><span class="s4">26924</span><span class="s0">,</span><span class="s4">56412</span><span class="s0">,</span><span class="s4">64982</span><span class="s0">,</span><span class="s4">57905</span><span class="s0">,</span><span class="s4">49316</span><span class="s0">,</span><span class="s4">21502</span><span class="s0">,</span><span class="s4">52590</span><span class="s0">,</span><span class="s4">14035</span><span class="s0">,</span><span class="s4">8553</span><span class="s0">]),</span><span class="s2">v</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">26200</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">,</span><span class="s4">26214</span><span class="s0">]),</span><span class="s2">m</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Float64Array</span><span class="s0">([</span><span class="s4">237</span><span class="s0">,</span><span class="s4">211</span><span class="s0">,</span><span class="s4">245</span><span class="s0">,</span><span class="s4">92</span><span class="s0">,</span><span class="s4">26</span><span class="s0">,</span><span class="s4">99</span><span class="s0">,</span><span class="s4">18</span><span class="s0">,</span><span class="s4">88</span><span class="s0">,</span><span class="s4">214</span><span class="s0">,</span><span class="s4">156</span><span class="s0">,</span><span class="s4">247</span><span class="s0">,</span><span class="s4">162</span><span class="s0">,</span><span class="s4">222</span><span class="s0">,</span><span class="s4">249</span><span class="s0">,</span><span class="s4">222</span><span class="s0">,</span><span class="s4">20</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">16</span><span class="s0">]),</span><span class="s2">C</span><span class="s0">=</span><span class="s2">P</span><span class="s0">([</span><span class="s4">41136</span><span class="s0">,</span><span class="s4">18958</span><span class="s0">,</span><span class="s4">6951</span><span class="s0">,</span><span class="s4">50414</span><span class="s0">,</span><span class="s4">58488</span><span class="s0">,</span><span class="s4">44335</span><span class="s0">,</span><span class="s4">6150</span><span class="s0">,</span><span class="s4">12099</span><span class="s0">,</span><span class="s4">55207</span><span class="s0">,</span><span class="s4">15867</span><span class="s0">,</span><span class="s4">153</span><span class="s0">,</span><span class="s4">11085</span><span class="s0">,</span><span class="s4">57099</span><span class="s0">,</span><span class="s4">20417</span><span class="s0">,</span><span class="s4">9344</span><span class="s0">,</span><span class="s4">11139</span><span class="s0">]);</span><span class="s1">function </span><span class="s2">E</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s1">new </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s3">&quot;binary&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">Buffer</span><span class="s0">)</span><span class="s1">return </span><span class="s2">Buffer</span><span class="s0">.</span><span class="s2">from</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s3">&quot;binary&quot;</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">constants</span><span class="s0">.</span><span class="s2">HASH_BYTE_LENGTH</span><span class="s0">),</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s2">o</span><span class="s0">);</span><span class="s1">return </span><span class="s2">s</span><span class="s0">}</span><span class="s1">function </span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">63</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&gt;=</span><span class="s4">32</span><span class="s0">;--</span><span class="s2">a</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">-</span><span class="s4">32</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">-</span><span class="s4">12</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]+=</span><span class="s2">r</span><span class="s0">-</span><span class="s4">16</span><span class="s0">*</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]*</span><span class="s2">m</span><span class="s0">[</span><span class="s2">n</span><span class="s0">-(</span><span class="s2">a</span><span class="s0">-</span><span class="s4">32</span><span class="s0">)],</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]+</span><span class="s4">128</span><span class="s0">&gt;&gt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]-=</span><span class="s4">256</span><span class="s0">*</span><span class="s2">r</span><span class="s0">;</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]+=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]+=</span><span class="s2">r</span><span class="s0">-(</span><span class="s2">t</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]&gt;&gt;</span><span class="s4">4</span><span class="s0">)*</span><span class="s2">m</span><span class="s0">[</span><span class="s2">n</span><span class="s0">],</span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&gt;&gt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]&amp;=</span><span class="s4">255</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]-=</span><span class="s2">r</span><span class="s0">*</span><span class="s2">m</span><span class="s0">[</span><span class="s2">n</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">32</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]+=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]&gt;&gt;</span><span class="s4">8</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">T</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Float64Array</span><span class="s0">(</span><span class="s4">64</span><span class="s0">),</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">64</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">S</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">I</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">i</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">o</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">c</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">u</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">l</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();</span><span class="s2">O</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">O</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">l</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">y</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">),</span><span class="s2">O</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">O</span><span class="s0">(</span><span class="s2">o</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">c</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">V</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">u</span><span class="s0">,</span><span class="s2">c</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">c</span><span class="s0">,</span><span class="s2">o</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">s</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">4</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">D</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">B</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">a</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">253</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">r</span><span class="s0">)</span><span class="s2">K</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s4">2</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s4">4</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]}(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">n</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">n</span><span class="s0">),</span><span class="s2">b</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">a</span><span class="s0">),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">31</span><span class="s0">]^=</span><span class="s2">w</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)&lt;&lt;</span><span class="s4">7</span><span class="s0">}</span><span class="s1">function </span><span class="s2">b</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">P</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">U</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">U</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">U</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">2</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]-</span><span class="s4">65517</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">15</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]-</span><span class="s4">65535</span><span class="s0">-(</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">]&amp;=</span><span class="s4">65535</span><span class="s0">;</span><span class="s2">i</span><span class="s0">[</span><span class="s4">15</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s4">15</span><span class="s0">]-</span><span class="s4">32767</span><span class="s0">-(</span><span class="s2">i</span><span class="s0">[</span><span class="s4">14</span><span class="s0">]&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s4">15</span><span class="s0">]&gt;&gt;</span><span class="s4">16</span><span class="s0">&amp;</span><span class="s4">1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">[</span><span class="s4">14</span><span class="s0">]&amp;=</span><span class="s4">65535</span><span class="s0">,</span><span class="s2">D</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s4">1</span><span class="s0">-</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">255</span><span class="s0">&amp;</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">],</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">*</span><span class="s2">r</span><span class="s0">+</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]&gt;&gt;</span><span class="s4">8</span><span class="s0">}</span><span class="s1">function </span><span class="s2">N</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s4">32</span><span class="s0">),</span><span class="s2">a</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s4">32</span><span class="s0">);</span><span class="s1">return </span><span class="s2">b</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">b</span><span class="s0">(</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">R</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s4">0</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">R</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">return function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">n</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">s</span><span class="s0">|=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">+</span><span class="s2">i</span><span class="s0">]^</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">+</span><span class="s2">i</span><span class="s0">];</span><span class="s1">return</span><span class="s0">(</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">s</span><span class="s0">-</span><span class="s4">1</span><span class="s0">&gt;&gt;&gt;</span><span class="s4">8</span><span class="s0">)-</span><span class="s4">1</span><span class="s0">}(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">,</span><span class="s4">32</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">w</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s1">new </span><span class="s2">u</span><span class="s0">(</span><span class="s4">32</span><span class="s0">);</span><span class="s1">return </span><span class="s2">b</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s4">1</span><span class="s0">&amp;</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">_</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">f</span><span class="s0">),</span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">h</span><span class="s0">),</span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">h</span><span class="s0">),</span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">f</span><span class="s0">),</span><span class="s2">n</span><span class="s0">=</span><span class="s4">255</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&gt;=</span><span class="s4">0</span><span class="s0">;--</span><span class="s2">n</span><span class="s0">)</span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">/</span><span class="s4">8</span><span class="s0">|</span><span class="s4">0</span><span class="s0">]&gt;&gt;(</span><span class="s4">7</span><span class="s0">&amp;</span><span class="s2">n</span><span class="s0">)&amp;</span><span class="s4">1</span><span class="s0">),</span><span class="s2">I</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">I</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">e</span><span class="s0">),</span><span class="s2">A</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">L</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=[</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">(),</span><span class="s2">P</span><span class="s0">()];</span><span class="s2">k</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">g</span><span class="s0">),</span><span class="s2">k</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">v</span><span class="s0">),</span><span class="s2">k</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">h</span><span class="s0">),</span><span class="s2">x</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">g</span><span class="s0">,</span><span class="s2">v</span><span class="s0">),</span><span class="s2">_</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">k</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;</span><span class="s2">r</span><span class="s0">++)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]=</span><span class="s4">0</span><span class="s0">|</span><span class="s2">t</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">U</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">1</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]+</span><span class="s2">a</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">r</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">r</span><span class="s0">-</span><span class="s4">65536</span><span class="s0">*</span><span class="s2">a</span><span class="s0">;</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]+=</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">+</span><span class="s4">37</span><span class="s0">*(</span><span class="s2">a</span><span class="s0">-</span><span class="s4">1</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">D</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=~(</span><span class="s2">r</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">a</span><span class="s0">=</span><span class="s2">n</span><span class="s0">&amp;(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]^</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]),</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">,</span><span class="s2">t</span><span class="s0">[</span><span class="s2">i</span><span class="s0">]^=</span><span class="s2">a</span><span class="s0">}</span><span class="s1">function </span><span class="s2">P</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Float64Array</span><span class="s0">(</span><span class="s4">16</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s2">t</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">t</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">t</span><span class="s0">)</span><span class="s2">r</span><span class="s0">[</span><span class="s2">t</span><span class="s0">]=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">t</span><span class="s0">];</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}</span><span class="s1">function </span><span class="s2">V</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]+</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">O</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s4">16</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">)</span><span class="s2">e</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]-</span><span class="s2">r</span><span class="s0">[</span><span class="s2">a</span><span class="s0">]}</span><span class="s1">function </span><span class="s2">K</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">x</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">,</span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">d</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">y</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">g</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">v</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">m</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">C</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">E</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">S</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">T</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">I</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">A</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">B</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">b</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">N</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">R</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">w</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">_</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">L</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">k</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">U</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">D</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">P</span><span class="s0">=</span><span class="s4">0</span><span class="s0">,</span><span class="s2">V</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">],</span><span class="s2">O</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">1</span><span class="s0">],</span><span class="s2">K</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">2</span><span class="s0">],</span><span class="s2">x</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">3</span><span class="s0">],</span><span class="s2">M</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">4</span><span class="s0">],</span><span class="s2">F</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">5</span><span class="s0">],</span><span class="s2">j</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">6</span><span class="s0">],</span><span class="s2">G</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">7</span><span class="s0">],</span><span class="s2">H</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">8</span><span class="s0">],</span><span class="s2">q</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">9</span><span class="s0">],</span><span class="s2">Q</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">10</span><span class="s0">],</span><span class="s2">z</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">11</span><span class="s0">],</span><span class="s2">Y</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">12</span><span class="s0">],</span><span class="s2">X</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">13</span><span class="s0">],</span><span class="s2">W</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">14</span><span class="s0">],</span><span class="s2">Z</span><span class="s0">=</span><span class="s2">r</span><span class="s0">[</span><span class="s4">15</span><span class="s0">];</span><span class="s2">i</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">0</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">s</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">o</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">s</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">1</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">o</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">o</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">2</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">3</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">u</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">u</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">4</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">l</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">5</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">p</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">6</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">f</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">7</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">h</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">8</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">d</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">9</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">y</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">10</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">g</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">11</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">L</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">v</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">12</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">L</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">k</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">m</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">13</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">L</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">k</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">U</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">C</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">14</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">,</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">,</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">,</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">,</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">,</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">,</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">,</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">,</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">,</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">,</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">,</span><span class="s2">L</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">,</span><span class="s2">k</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">,</span><span class="s2">U</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">,</span><span class="s2">D</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">,</span><span class="s2">E</span><span class="s0">+=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s4">15</span><span class="s0">])*</span><span class="s2">V</span><span class="s0">,</span><span class="s2">s</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">T</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">K</span><span class="s0">),</span><span class="s2">o</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">I</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">x</span><span class="s0">),</span><span class="s2">c</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">A</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">M</span><span class="s0">),</span><span class="s2">u</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">B</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">F</span><span class="s0">),</span><span class="s2">l</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">b</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">j</span><span class="s0">),</span><span class="s2">p</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">N</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">G</span><span class="s0">),</span><span class="s2">f</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">R</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">H</span><span class="s0">),</span><span class="s2">h</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">w</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">q</span><span class="s0">),</span><span class="s2">d</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">_</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Q</span><span class="s0">),</span><span class="s2">y</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">L</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">z</span><span class="s0">),</span><span class="s2">g</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">k</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Y</span><span class="s0">),</span><span class="s2">v</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">U</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">X</span><span class="s0">),</span><span class="s2">m</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">D</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">W</span><span class="s0">),</span><span class="s2">C</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">P</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">Z</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">+=</span><span class="s4">38</span><span class="s0">*(</span><span class="s2">S</span><span class="s0">+=</span><span class="s2">a</span><span class="s0">*</span><span class="s2">O</span><span class="s0">))+(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">)+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">o</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">c</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">l</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">l</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">p</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">p</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">f</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">f</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">h</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">h</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">d</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">d</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">y</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">y</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">g</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">g</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">v</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">v</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">m</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">m</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">C</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">C</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">E</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">E</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=(</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">+</span><span class="s4">37</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">))+(</span><span class="s2">n</span><span class="s0">=</span><span class="s4">1</span><span class="s0">)+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">s</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">o</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">o</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">c</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">c</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">u</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">u</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">l</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">l</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">p</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">p</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">f</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">f</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">h</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">h</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">d</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">d</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">y</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">y</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">g</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">g</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">v</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">v</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">m</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">m</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">C</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">C</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">E</span><span class="s0">=(</span><span class="s2">a</span><span class="s0">=</span><span class="s2">E</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s4">65535</span><span class="s0">)-</span><span class="s4">65536</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">a</span><span class="s0">/</span><span class="s4">65536</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">+=</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">+</span><span class="s4">37</span><span class="s0">*(</span><span class="s2">n</span><span class="s0">-</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">2</span><span class="s0">]=</span><span class="s2">o</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">3</span><span class="s0">]=</span><span class="s2">c</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">4</span><span class="s0">]=</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">5</span><span class="s0">]=</span><span class="s2">l</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">6</span><span class="s0">]=</span><span class="s2">p</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">7</span><span class="s0">]=</span><span class="s2">f</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">8</span><span class="s0">]=</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">9</span><span class="s0">]=</span><span class="s2">d</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">10</span><span class="s0">]=</span><span class="s2">y</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">11</span><span class="s0">]=</span><span class="s2">g</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">12</span><span class="s0">]=</span><span class="s2">v</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">13</span><span class="s0">]=</span><span class="s2">m</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">14</span><span class="s0">]=</span><span class="s2">C</span><span class="s0">,</span><span class="s2">e</span><span class="s0">[</span><span class="s4">15</span><span class="s0">]=</span><span class="s2">E</span><span class="s0">}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">privateKeyValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo.version&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyVersion&quot;</span><span class="s0">},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo.privateKeyAlgorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKeyOid&quot;</span><span class="s0">}]},{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;PrivateKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;privateKey&quot;</span><span class="s0">}]},</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKeyValidator</span><span class="s0">={</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureAsn1</span><span class="s0">:</span><span class="s3">&quot;subjectPublicKeyInfo&quot;</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;SubjectPublicKeyInfo.AlgorithmIdentifier&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">value</span><span class="s0">:[{</span><span class="s2">name</span><span class="s0">:</span><span class="s3">&quot;AlgorithmIdentifier.algorithm&quot;</span><span class="s0">,</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">capture</span><span class="s0">:</span><span class="s3">&quot;publicKeyOid&quot;</span><span class="s0">}]},{</span><span class="s2">tagClass</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">type</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">BITSTRING</span><span class="s0">,</span><span class="s2">constructed</span><span class="s0">:!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">composed</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">captureBitStringValue</span><span class="s0">:</span><span class="s3">&quot;ed25519PublicKey&quot;</span><span class="s0">}]}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">12</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">||{};</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">jsbn</span><span class="s0">.</span><span class="s2">BigInteger</span><span class="s0">;</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">n</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">i</span><span class="s0">/</span><span class="s2">n</span><span class="s0">)+</span><span class="s2">r</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s1">new </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">,</span><span class="s2">u</span><span class="s0">=</span><span class="s2">r</span><span class="s0">;</span><span class="s2">u</span><span class="s0">&lt;</span><span class="s2">o</span><span class="s0">;++</span><span class="s2">u</span><span class="s0">){</span><span class="s2">c</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">u</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">+</span><span class="s2">c</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">();</span><span class="s2">s</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">s</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">i</span><span class="s0">),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()}}</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">={},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">.</span><span class="s2">rsa</span><span class="s0">.</span><span class="s2">create</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">prng</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">,</span><span class="s2">i</span><span class="s0">={</span><span class="s2">encrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">ceil</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">.</span><span class="s2">bitLength</span><span class="s0">()/</span><span class="s4">8</span><span class="s0">);</span><span class="s1">do</span><span class="s0">{</span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">n</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">bytesToHex</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">getBytesSync</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)),</span><span class="s4">16</span><span class="s0">).</span><span class="s2">mod</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">while</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">compareTo</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">ONE</span><span class="s0">)&lt;=</span><span class="s4">0</span><span class="s0">);</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">-(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">))).</span><span class="s2">length</span><span class="s0">;</span><span class="s1">return </span><span class="s2">c</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">fillString</span><span class="s0">(</span><span class="s2">String</span><span class="s0">.</span><span class="s2">fromCharCode</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">c</span><span class="s0">)+</span><span class="s2">s</span><span class="s0">),{</span><span class="s2">encapsulation</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s3">&quot;NONE&quot;</span><span class="s0">),</span><span class="s2">key</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)}},</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;NONE&quot;</span><span class="s0">);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">generate</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">a</span><span class="s0">)}};</span><span class="s1">return </span><span class="s2">i</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">.</span><span class="s2">kdf1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">i</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">kem</span><span class="s0">.</span><span class="s2">kdf2</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">i</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">e</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestLength</span><span class="s0">)}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">||{},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">levels</span><span class="s0">=[</span><span class="s3">&quot;none&quot;</span><span class="s0">,</span><span class="s3">&quot;error&quot;</span><span class="s0">,</span><span class="s3">&quot;warning&quot;</span><span class="s0">,</span><span class="s3">&quot;info&quot;</span><span class="s0">,</span><span class="s3">&quot;debug&quot;</span><span class="s0">,</span><span class="s3">&quot;verbose&quot;</span><span class="s0">,</span><span class="s3">&quot;max&quot;</span><span class="s0">];</span><span class="s1">var </span><span class="s2">n</span><span class="s0">={},</span><span class="s2">i</span><span class="s0">=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">LEVEL_LOCKED</span><span class="s0">=</span><span class="s4">2</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">NO_LEVEL_CHECK</span><span class="s0">=</span><span class="s4">4</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">INTERPOLATE</span><span class="s0">=</span><span class="s4">8</span><span class="s0">;</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">levels</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">levels</span><span class="s0">[</span><span class="s2">o</span><span class="s0">];</span><span class="s2">n</span><span class="s0">[</span><span class="s2">c</span><span class="s0">]={</span><span class="s2">index</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">name</span><span class="s0">:</span><span class="s2">c</span><span class="s0">.</span><span class="s2">toUpperCase</span><span class="s0">()}}</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">logMessage</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">level</span><span class="s0">].</span><span class="s2">index</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">NO_LEVEL_CHECK</span><span class="s0">)</span><span class="s2">s</span><span class="s0">.</span><span class="s2">f</span><span class="s0">(</span><span class="s2">e</span><span class="s0">);</span><span class="s1">else </span><span class="s2">t</span><span class="s0">&lt;=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">s</span><span class="s0">.</span><span class="s2">level</span><span class="s0">].</span><span class="s2">index</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">f</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">e</span><span class="s0">)}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareStandard</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;standard&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">||(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">standard</span><span class="s0">=</span><span class="s2">n</span><span class="s0">[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">level</span><span class="s0">].</span><span class="s2">name</span><span class="s0">+</span><span class="s3">&quot; [&quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">category</span><span class="s0">+</span><span class="s3">&quot;] &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">)},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareFull</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(!(</span><span class="s3">&quot;full&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[</span><span class="s2">e</span><span class="s0">.</span><span class="s2">message</span><span class="s0">];</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">([]||!</span><span class="s4">1</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">full</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">format</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s1">this</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)}},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareStandardFull</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s3">&quot;standardFull&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">||(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareStandard</span><span class="s0">(</span><span class="s2">e</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">standardFull</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">standard</span><span class="s0">)};</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=[</span><span class="s3">&quot;error&quot;</span><span class="s0">,</span><span class="s3">&quot;warning&quot;</span><span class="s0">,</span><span class="s3">&quot;info&quot;</span><span class="s0">,</span><span class="s3">&quot;debug&quot;</span><span class="s0">,</span><span class="s3">&quot;verbose&quot;</span><span class="s0">];</span><span class="s1">for</span><span class="s0">(</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)!</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">[</span><span class="s2">e</span><span class="s0">]=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">Array</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">).</span><span class="s2">slice</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">i</span><span class="s0">={</span><span class="s2">timestamp</span><span class="s0">:</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">level</span><span class="s0">:</span><span class="s2">e</span><span class="s0">,</span><span class="s2">category</span><span class="s0">:</span><span class="s2">t</span><span class="s0">,</span><span class="s2">message</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">arguments</span><span class="s0">:</span><span class="s2">n</span><span class="s0">};</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">logMessage</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)}}(</span><span class="s2">u</span><span class="s0">[</span><span class="s2">o</span><span class="s0">]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">makeLogger</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={</span><span class="s2">flags</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">f</span><span class="s0">:</span><span class="s2">e</span><span class="s0">};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">setLevel</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s3">&quot;none&quot;</span><span class="s0">),</span><span class="s2">t</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">setLevel</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">&amp;&amp;!(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">LEVEL_LOCKED</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">levels</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">levels</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">level</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}}</span><span class="s1">return </span><span class="s2">r</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">lock</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">||</span><span class="s2">t</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">|=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">LEVEL_LOCKED</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">flags</span><span class="s0">&amp;=~</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">LEVEL_LOCKED</span><span class="s0">},</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">addLogger</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s2">i</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">console</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;log&quot;</span><span class="s1">in </span><span class="s2">console</span><span class="s0">){</span><span class="s1">var </span><span class="s2">l</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">console</span><span class="s0">.</span><span class="s2">error</span><span class="s0">&amp;&amp;</span><span class="s2">console</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">&amp;&amp;</span><span class="s2">console</span><span class="s0">.</span><span class="s2">info</span><span class="s0">&amp;&amp;</span><span class="s2">console</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">){</span><span class="s1">var </span><span class="s2">p</span><span class="s0">={</span><span class="s2">error</span><span class="s0">:</span><span class="s2">console</span><span class="s0">.</span><span class="s2">error</span><span class="s0">,</span><span class="s2">warning</span><span class="s0">:</span><span class="s2">console</span><span class="s0">.</span><span class="s2">warn</span><span class="s0">,</span><span class="s2">info</span><span class="s0">:</span><span class="s2">console</span><span class="s0">.</span><span class="s2">info</span><span class="s0">,</span><span class="s2">debug</span><span class="s0">:</span><span class="s2">console</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">,</span><span class="s2">verbose</span><span class="s0">:</span><span class="s2">console</span><span class="s0">.</span><span class="s2">debug</span><span class="s0">},</span><span class="s2">f</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareStandard</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">p</span><span class="s0">[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">level</span><span class="s0">],</span><span class="s2">n</span><span class="s0">=[</span><span class="s2">t</span><span class="s0">.</span><span class="s2">standard</span><span class="s0">];</span><span class="s2">n</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">concat</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">slice</span><span class="s0">()),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">console</span><span class="s0">,</span><span class="s2">n</span><span class="s0">)};</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">makeLogger</span><span class="s0">(</span><span class="s2">f</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">f</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">prepareStandardFull</span><span class="s0">(</span><span class="s2">t</span><span class="s0">),</span><span class="s2">console</span><span class="s0">.</span><span class="s2">log</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">standardFull</span><span class="s0">)};</span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">makeLogger</span><span class="s0">(</span><span class="s2">f</span><span class="s0">)}</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">setLevel</span><span class="s0">(</span><span class="s2">l</span><span class="s0">,</span><span class="s3">&quot;debug&quot;</span><span class="s0">),</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">addLogger</span><span class="s0">(</span><span class="s2">l</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">l</span><span class="s0">}</span><span class="s1">else </span><span class="s2">console</span><span class="s0">={</span><span class="s2">log</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){}};</span><span class="s1">if</span><span class="s0">(</span><span class="s1">null</span><span class="s0">!==</span><span class="s2">s</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;undefined&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">window</span><span class="s0">&amp;&amp;</span><span class="s2">window</span><span class="s0">.</span><span class="s2">location</span><span class="s0">){</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s1">new </span><span class="s2">URL</span><span class="s0">(</span><span class="s2">window</span><span class="s0">.</span><span class="s2">location</span><span class="s0">.</span><span class="s2">href</span><span class="s0">).</span><span class="s2">searchParams</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s3">&quot;console.level&quot;</span><span class="s0">)&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">setLevel</span><span class="s0">(</span><span class="s2">s</span><span class="s0">,</span><span class="s2">h</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s3">&quot;console.level&quot;</span><span class="s0">).</span><span class="s2">slice</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s3">&quot;console.lock&quot;</span><span class="s0">))</span><span class="s3">&quot;true&quot;</span><span class="s0">==</span><span class="s2">h</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s3">&quot;console.lock&quot;</span><span class="s0">).</span><span class="s2">slice</span><span class="s0">(-</span><span class="s4">1</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">]&amp;&amp;</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">lock</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s2">a</span><span class="s0">.</span><span class="s2">log</span><span class="s0">.</span><span class="s2">consoleLogger</span><span class="s0">=</span><span class="s2">s</span><span class="s0">},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">4</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">14</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">23</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">31</span><span class="s0">)},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">3</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">10</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">6</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">7</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">29</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">2</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">17</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pkcs7</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">recipientInfoValidator</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">}</span><span class="s1">return</span><span class="s0">{</span><span class="s2">version</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">issuer</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">RDNAttributesAsArray</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">),</span><span class="s2">serialNumber</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">serial</span><span class="s0">).</span><span class="s2">toHex</span><span class="s0">(),</span><span class="s2">encryptedContent</span><span class="s0">:{</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encAlgorithm</span><span class="s0">),</span><span class="s2">parameter</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encParameter</span><span class="s0">?</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encParameter</span><span class="s0">.</span><span class="s2">value</span><span class="s0">:</span><span class="s1">void </span><span class="s4">0</span><span class="s0">,</span><span class="s2">content</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encKey</span><span class="s0">}}}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=[],</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">)</span><span class="s2">r</span><span class="s0">.</span><span class="s2">push</span><span class="s0">((</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">[</span><span class="s2">i</span><span class="s0">],</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">distinguishedNameToAsn1</span><span class="s0">({</span><span class="s2">attributes</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">}),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">))]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">)])));</span><span class="s1">return </span><span class="s2">r</span><span class="s0">}</span><span class="s1">function </span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">distinguishedNameToAsn1</span><span class="s0">({</span><span class="s2">attributes</span><span class="s0">:</span><span class="s2">e</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">}),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">))]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestAlgorithm</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)])]);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">authenticatedAttributesAsn1</span><span class="s0">&amp;&amp;</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">authenticatedAttributesAsn1</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signatureAlgorithm</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)])),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">unauthenticatedAttributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">i</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">i</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">unauthenticatedAttributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">i</span><span class="s0">){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">unauthenticatedAttributes</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span><span class="s2">r</span><span class="s0">.</span><span class="s2">values</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">(</span><span class="s2">s</span><span class="s0">))}</span><span class="s2">t</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}</span><span class="s1">function </span><span class="s2">u</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">messageDigest</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">signingTime</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s3">&quot;1950-01-01T00:00:00Z&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s3">&quot;2050-01-01T00:00:00Z&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">value</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">parse</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s2">s</span><span class="s0">=</span><span class="s2">isNaN</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)?</span><span class="s4">13</span><span class="s0">===</span><span class="s2">s</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">utcTimeToDate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">generalizedTimeToDate</span><span class="s0">(</span><span class="s2">s</span><span class="s0">):</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}</span><span class="s2">t</span><span class="s0">=</span><span class="s2">s</span><span class="s0">&gt;=</span><span class="s2">r</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">UTCTIME</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToUtcTime</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)):</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">GENERALIZEDTIME</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">dateToGeneralizedTime</span><span class="s0">(</span><span class="s2">s</span><span class="s0">))}</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">t</span><span class="s0">])])}</span><span class="s1">function </span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">={};</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,[])){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">s</span><span class="s0">,</span><span class="s2">s</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">)!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported PKCS#7 message. Only wrapped ContentType Data supported.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">){</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.&quot;</span><span class="s0">);</span><span class="s2">o</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">value</span><span class="s0">}</span><span class="s1">else </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">={</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encAlgorithm</span><span class="s0">),</span><span class="s2">parameter</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">encParameter</span><span class="s0">.</span><span class="s2">value</span><span class="s0">),</span><span class="s2">content</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">){</span><span class="s2">o</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">isArray</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">))</span><span class="s1">for</span><span class="s0">(</span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.&quot;</span><span class="s0">);</span><span class="s2">o</span><span class="s0">+=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">[</span><span class="s2">c</span><span class="s0">].</span><span class="s2">value</span><span class="s0">}</span><span class="s1">else </span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">content</span><span class="s0">;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">version</span><span class="s0">.</span><span class="s2">charCodeAt</span><span class="s0">(</span><span class="s4">0</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">rawCapture</span><span class="s0">=</span><span class="s2">i</span><span class="s0">,</span><span class="s2">i</span><span class="s0">}</span><span class="s1">function </span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Symmetric key not available.&quot;</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">]:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">]:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">desCBC</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">]:</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createDecryptionCipher</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported symmetric cipher, OID &quot;</span><span class="s0">+</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">parameter</span><span class="s0">),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">),!</span><span class="s2">t</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Symmetric decryption failed.&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">output</span><span class="s0">}}</span><span class="s2">i</span><span class="s0">.</span><span class="s2">messageFromPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">decode</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;PKCS7&quot;</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Could not convert PKCS#7 message from PEM; PEM header type is not &quot;PKCS#7&quot;.'</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">r</span><span class="s0">.</span><span class="s2">headerType</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">type</span><span class="s0">,</span><span class="s2">r</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">&amp;&amp;</span><span class="s3">&quot;ENCRYPTED&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">procType</span><span class="s0">.</span><span class="s2">type</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not convert PKCS#7 message from PEM; PEM is encrypted.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">fromDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">body</span><span class="s0">);</span><span class="s1">return </span><span class="s2">i</span><span class="s0">.</span><span class="s2">messageFromAsn1</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">messageToPem</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s3">&quot;PKCS7&quot;</span><span class="s0">,</span><span class="s2">body</span><span class="s0">:</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">toAsn1</span><span class="s0">()).</span><span class="s2">getBytes</span><span class="s0">()};</span><span class="s1">return </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pem</span><span class="s0">.</span><span class="s2">encode</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,{</span><span class="s2">maxline</span><span class="s0">:</span><span class="s2">t</span><span class="s0">})},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">messageFromAsn1</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=[];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">n</span><span class="s0">.</span><span class="s2">validate</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">contentInfoValidator</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)){</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.&quot;</span><span class="s0">);</span><span class="s1">throw </span><span class="s2">s</span><span class="s0">.</span><span class="s2">errors</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">s</span><span class="s0">}</span><span class="s1">var </span><span class="s2">o</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">);</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">c</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">envelopedData</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createEnvelopedData</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">encryptedData</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createEncryptedData</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">signedData</span><span class="s0">:</span><span class="s2">o</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createSignedData</span><span class="s0">();</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Cannot read PKCS#7 message. ContentType with OID &quot;</span><span class="s0">+</span><span class="s2">c</span><span class="s0">+</span><span class="s3">&quot; is not (yet) supported.&quot;</span><span class="s0">)}</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">fromAsn1</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]),</span><span class="s2">o</span><span class="s0">},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createSignedData</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">signedData</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">certificates</span><span class="s0">:[],</span><span class="s2">crls</span><span class="s0">:[],</span><span class="s2">signers</span><span class="s0">:[],</span><span class="s2">digestAlgorithmIdentifiers</span><span class="s0">:[],</span><span class="s2">contentInfo</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">signerInfos</span><span class="s0">:[],</span><span class="s2">fromAsn1</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">signedDataValidator</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">crls</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestAlgorithmIdentifiers</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">=</span><span class="s1">null</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signerInfos</span><span class="s0">=[],</span><span class="s2">e</span><span class="s0">.</span><span class="s2">rawCapture</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">)</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">rawCapture</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">.</span><span class="s2">value</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">n</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">n</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromAsn1</span><span class="s0">(</span><span class="s2">r</span><span class="s0">[</span><span class="s2">n</span><span class="s0">]))},</span><span class="s2">toAsn1</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">();</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateToAsn1</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]));</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=[],</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestAlgorithmIdentifiers</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">])]);</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">&amp;&amp;</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">i</span><span class="s0">)),</span><span class="s2">s</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signerInfos</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">s</span><span class="s0">])},</span><span class="s2">addSigner</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certificate</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">certificate</span><span class="s0">;</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">i</span><span class="s0">&amp;&amp;(</span><span class="s2">i</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">i</span><span class="s0">)),</span><span class="s2">r</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">n</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">}</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">key</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">s</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not add PKCS#7 signer; no private key specified.&quot;</span><span class="s0">);</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">s</span><span class="s0">&amp;&amp;(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">privateKeyFromPem</span><span class="s0">(</span><span class="s2">s</span><span class="s0">));</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">digestAlgorithm</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">o</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha256</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha384</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">sha512</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">:</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not add PKCS#7 signer; unknown message digest algorithm: &quot;</span><span class="s0">+</span><span class="s2">o</span><span class="s0">)}</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">authenticatedAttributes</span><span class="s0">||[];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&gt;</span><span class="s4">0</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">c</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">){</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">c</span><span class="s0">[</span><span class="s2">p</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">||</span><span class="s2">f</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">contentType</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">||</span><span class="s2">f</span><span class="s0">.</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">messageDigest</span><span class="s0">);</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">l</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">u</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">u</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">l</span><span class="s0">)</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">u</span><span class="s0">||!</span><span class="s2">l</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.&quot;</span><span class="s0">)}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">key</span><span class="s0">:</span><span class="s2">s</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s4">1</span><span class="s0">,</span><span class="s2">issuer</span><span class="s0">:</span><span class="s2">r</span><span class="s0">,</span><span class="s2">serialNumber</span><span class="s0">:</span><span class="s2">n</span><span class="s0">,</span><span class="s2">digestAlgorithm</span><span class="s0">:</span><span class="s2">o</span><span class="s0">,</span><span class="s2">signatureAlgorithm</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">,</span><span class="s2">signature</span><span class="s0">:</span><span class="s1">null</span><span class="s0">,</span><span class="s2">authenticatedAttributes</span><span class="s0">:</span><span class="s2">c</span><span class="s0">,</span><span class="s2">unauthenticatedAttributes</span><span class="s0">:[]})},</span><span class="s2">sign</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{},</span><span class="s3">&quot;object&quot;</span><span class="s0">!=</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">||</span><span class="s1">null</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">)&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">())]),</span><span class="s3">&quot;content&quot;</span><span class="s1">in </span><span class="s2">e</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content </span><span class="s1">instanceof </span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">ByteBuffer</span><span class="s0">?</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">():</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encodeUtf8</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">)),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">detached</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">detachedContent</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">):</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">r</span><span class="s0">)]))));</span><span class="s4">0</span><span class="s0">!==</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">&amp;&amp;</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">;</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">detachedContent</span><span class="s0">?</span><span class="s2">e</span><span class="s0">.</span><span class="s2">detachedContent</span><span class="s0">:(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">1</span><span class="s0">]).</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(!</span><span class="s2">r</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Could not sign PKCS#7 message; there is no content to sign.&quot;</span><span class="s0">);</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">derToOid</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">contentInfo</span><span class="s0">.</span><span class="s2">value</span><span class="s0">[</span><span class="s4">0</span><span class="s0">].</span><span class="s2">value</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">o </span><span class="s1">in </span><span class="s2">s</span><span class="s0">.</span><span class="s2">getByte</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getBerValueLength</span><span class="s0">(</span><span class="s2">s</span><span class="s0">),</span><span class="s2">s</span><span class="s0">=</span><span class="s2">s</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">start</span><span class="s0">().</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s1">new </span><span class="s2">Date</span><span class="s0">,</span><span class="s2">p</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">p</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">p</span><span class="s0">){</span><span class="s1">var </span><span class="s2">f</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">[</span><span class="s2">p</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s4">0</span><span class="s0">===</span><span class="s2">f</span><span class="s0">.</span><span class="s2">authenticatedAttributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">!==</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.&quot;</span><span class="s0">)}</span><span class="s1">else</span><span class="s0">{</span><span class="s2">f</span><span class="s0">.</span><span class="s2">authenticatedAttributesAsn1</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]);</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">h</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[]),</span><span class="s2">d</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">d</span><span class="s0">&lt;</span><span class="s2">f</span><span class="s0">.</span><span class="s2">authenticatedAttributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">d</span><span class="s0">){</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">authenticatedAttributes</span><span class="s0">[</span><span class="s2">d</span><span class="s0">];</span><span class="s2">y</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">messageDigest</span><span class="s0">?</span><span class="s2">y</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">f</span><span class="s0">.</span><span class="s2">digestAlgorithm</span><span class="s0">].</span><span class="s2">digest</span><span class="s0">():</span><span class="s2">y</span><span class="s0">.</span><span class="s2">type</span><span class="s0">===</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">signingTime</span><span class="s0">&amp;&amp;(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">value</span><span class="s0">||(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">value</span><span class="s0">=</span><span class="s2">l</span><span class="s0">)),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">(</span><span class="s2">y</span><span class="s0">)),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">authenticatedAttributesAsn1</span><span class="s0">.</span><span class="s2">value</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">u</span><span class="s0">(</span><span class="s2">y</span><span class="s0">))}</span><span class="s2">s</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">toDer</span><span class="s0">(</span><span class="s2">h</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">(),</span><span class="s2">f</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">start</span><span class="s0">().</span><span class="s2">update</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)}</span><span class="s2">f</span><span class="s0">.</span><span class="s2">signature</span><span class="s0">=</span><span class="s2">f</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">sign</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">md</span><span class="s0">,</span><span class="s3">&quot;RSASSA-PKCS1-V1_5&quot;</span><span class="s0">)}</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signerInfos</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">c</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">)}(</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">={},</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">i</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">signers</span><span class="s0">[</span><span class="s2">r</span><span class="s0">];(</span><span class="s2">s</span><span class="s0">=</span><span class="s2">i</span><span class="s0">.</span><span class="s2">digestAlgorithm</span><span class="s0">)</span><span class="s1">in </span><span class="s2">t</span><span class="s0">||(</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]].</span><span class="s2">create</span><span class="s0">()),</span><span class="s4">0</span><span class="s0">===</span><span class="s2">i</span><span class="s0">.</span><span class="s2">authenticatedAttributes</span><span class="s0">.</span><span class="s2">length</span><span class="s0">?</span><span class="s2">i</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">t</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]:</span><span class="s2">i</span><span class="s0">.</span><span class="s2">md</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">[</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s2">s</span><span class="s0">]].</span><span class="s2">create</span><span class="s0">()}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s </span><span class="s1">in </span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestAlgorithmIdentifiers</span><span class="s0">=[],</span><span class="s2">t</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">digestAlgorithmIdentifiers</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">s</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">NULL</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s3">&quot;&quot;</span><span class="s0">)]));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}())},</span><span class="s2">verify</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#7 signature verification not yet implemented.&quot;</span><span class="s0">)},</span><span class="s2">addCertificate</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s3">&quot;string&quot;</span><span class="s0">==</span><span class="s1">typeof </span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">certificateFromPem</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">certificates</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)},</span><span class="s2">addCertificateRevokationList</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;PKCS#7 CRL support not yet implemented.&quot;</span><span class="s0">)}}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createEncryptedData</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">encryptedData</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">encryptedContent</span><span class="s0">:{</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">]},</span><span class="s2">fromAsn1</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">encryptedDataValidator</span><span class="s0">)},</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">t</span><span class="s0">),</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)}}},</span><span class="s2">i</span><span class="s0">.</span><span class="s2">createEnvelopedData</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s1">null</span><span class="s0">;</span><span class="s1">return </span><span class="s2">e</span><span class="s0">={</span><span class="s2">type</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">envelopedData</span><span class="s0">,</span><span class="s2">version</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">recipients</span><span class="s0">:[],</span><span class="s2">encryptedContent</span><span class="s0">:{</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">]},</span><span class="s2">fromAsn1</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">l</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">i</span><span class="s0">.</span><span class="s2">asn1</span><span class="s0">.</span><span class="s2">envelopedDataValidator</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">t</span><span class="s0">=[],</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">t</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]));</span><span class="s1">return </span><span class="s2">t</span><span class="s0">}(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">recipientInfos</span><span class="s0">.</span><span class="s2">value</span><span class="s0">)},</span><span class="s2">toAsn1</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(){</span><span class="s1">return </span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">type</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">INTEGER</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">integerToDer</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">version</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SET</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">)),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">data</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">SEQUENCE</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OID</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">oidToDer</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">).</span><span class="s2">getBytes</span><span class="s0">()),</span><span class="s2">t</span><span class="s0">.</span><span class="s2">parameter</span><span class="s0">?</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">parameter</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">()):</span><span class="s1">void </span><span class="s4">0</span><span class="s0">]),</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">CONTEXT_SPECIFIC</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,!</span><span class="s4">0</span><span class="s0">,[</span><span class="s2">n</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Class</span><span class="s0">.</span><span class="s2">UNIVERSAL</span><span class="s0">,</span><span class="s2">n</span><span class="s0">.</span><span class="s2">Type</span><span class="s0">.</span><span class="s2">OCTETSTRING</span><span class="s0">,!</span><span class="s4">1</span><span class="s0">,</span><span class="s2">t</span><span class="s0">.</span><span class="s2">content</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">())])]))])])]);</span><span class="s1">var </span><span class="s2">t</span><span class="s0">},</span><span class="s2">findRecipient</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">a</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">a</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">a</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">[</span><span class="s2">a</span><span class="s0">],</span><span class="s2">i</span><span class="s0">=</span><span class="s2">n</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">;</span><span class="s1">if</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">&amp;&amp;</span><span class="s2">i</span><span class="s0">.</span><span class="s2">length</span><span class="s0">===</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">s</span><span class="s0">=!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">o</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">o</span><span class="s0">&lt;</span><span class="s2">r</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">o</span><span class="s0">)</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">type</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">type</span><span class="s0">||</span><span class="s2">i</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">value</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">[</span><span class="s2">o</span><span class="s0">].</span><span class="s2">value</span><span class="s0">){</span><span class="s2">s</span><span class="s0">=!</span><span class="s4">1</span><span class="s0">;</span><span class="s1">break</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s2">s</span><span class="s0">)</span><span class="s1">return </span><span class="s2">n</span><span class="s0">}}</span><span class="s1">return null</span><span class="s0">},</span><span class="s2">decrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">t</span><span class="s0">&amp;&amp;</span><span class="s1">void </span><span class="s4">0</span><span class="s0">!==</span><span class="s2">r</span><span class="s0">)</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">:</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">desCBC</span><span class="s0">:</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">decrypt</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">n</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported asymmetric cipher, OID &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">)}</span><span class="s2">p</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">addRecipient</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">.</span><span class="s2">push</span><span class="s0">({</span><span class="s2">version</span><span class="s0">:</span><span class="s4">0</span><span class="s0">,</span><span class="s2">issuer</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">issuer</span><span class="s0">.</span><span class="s2">attributes</span><span class="s0">,</span><span class="s2">serialNumber</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">serialNumber</span><span class="s0">,</span><span class="s2">encryptedContent</span><span class="s0">:{</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">,</span><span class="s2">key</span><span class="s0">:</span><span class="s2">t</span><span class="s0">.</span><span class="s2">publicKey</span><span class="s0">}})},</span><span class="s2">encrypt</span><span class="s0">:</span><span class="s1">function</span><span class="s0">(</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">,</span><span class="s2">i</span><span class="s0">,</span><span class="s2">s</span><span class="s0">;</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">,</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes128-CBC&quot;</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes192-CBC&quot;</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;aes256-CBC&quot;</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">32</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">16</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">[</span><span class="s3">&quot;des-EDE3-CBC&quot;</span><span class="s0">]:</span><span class="s2">n</span><span class="s0">=</span><span class="s4">24</span><span class="s0">,</span><span class="s2">i</span><span class="s0">=</span><span class="s4">8</span><span class="s0">,</span><span class="s2">s</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">des</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">;</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported symmetric cipher, OID &quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">)}</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">t</span><span class="s0">)</span><span class="s2">t</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">));</span><span class="s1">else if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()!=</span><span class="s2">n</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Symmetric key has wrong length; got &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()+</span><span class="s3">&quot; bytes, expected &quot;</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;.&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">=</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">=</span><span class="s2">t</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">parameter</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">random</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">(</span><span class="s2">i</span><span class="s0">));</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">s</span><span class="s0">(</span><span class="s2">t</span><span class="s0">);</span><span class="s1">if</span><span class="s0">(</span><span class="s2">o</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">parameter</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">()),</span><span class="s2">o</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">content</span><span class="s0">),!</span><span class="s2">o</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">())</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Symmetric encryption failed.&quot;</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">output</span><span class="s0">}</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">c</span><span class="s0">&lt;</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;++</span><span class="s2">c</span><span class="s0">){</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">recipients</span><span class="s0">[</span><span class="s2">c</span><span class="s0">];</span><span class="s1">if</span><span class="s0">(</span><span class="s1">void </span><span class="s4">0</span><span class="s0">===</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">)</span><span class="s1">switch</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">){</span><span class="s1">case </span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">oids</span><span class="s0">.</span><span class="s2">rsaEncryption</span><span class="s0">:</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">content</span><span class="s0">=</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">encrypt</span><span class="s0">(</span><span class="s2">e</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">key</span><span class="s0">.</span><span class="s2">data</span><span class="s0">);</span><span class="s1">break</span><span class="s0">;</span><span class="s1">default</span><span class="s0">:</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">&quot;Unsupported asymmetric cipher, OID &quot;</span><span class="s0">+</span><span class="s2">u</span><span class="s0">.</span><span class="s2">encryptedContent</span><span class="s0">.</span><span class="s2">algorithm</span><span class="s0">)}}}}}},</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">a</span><span class="s0">=</span><span class="s2">r</span><span class="s0">(</span><span class="s4">0</span><span class="s0">);</span><span class="s2">r</span><span class="s0">(</span><span class="s4">5</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">14</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">9</span><span class="s0">),</span><span class="s2">r</span><span class="s0">(</span><span class="s4">1</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">e</span><span class="s0">.</span><span class="s2">exports</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">ssh</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">ssh</span><span class="s0">||{};</span><span class="s1">function </span><span class="s2">i</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">t</span><span class="s0">.</span><span class="s2">toString</span><span class="s0">(</span><span class="s4">16</span><span class="s0">);</span><span class="s2">r</span><span class="s0">[</span><span class="s4">0</span><span class="s0">]&gt;=</span><span class="s3">&quot;8&quot;</span><span class="s0">&amp;&amp;(</span><span class="s2">r</span><span class="s0">=</span><span class="s3">&quot;00&quot;</span><span class="s0">+</span><span class="s2">r</span><span class="s0">);</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">hexToBytes</span><span class="s0">(</span><span class="s2">r</span><span class="s0">);</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putBytes</span><span class="s0">(</span><span class="s2">n</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">s</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">length</span><span class="s0">),</span><span class="s2">e</span><span class="s0">.</span><span class="s2">putString</span><span class="s0">(</span><span class="s2">t</span><span class="s0">)}</span><span class="s1">function </span><span class="s2">o</span><span class="s0">(){</span><span class="s1">for</span><span class="s0">(</span><span class="s1">var </span><span class="s2">e</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">sha1</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">t</span><span class="s0">=</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">,</span><span class="s2">r</span><span class="s0">=</span><span class="s4">0</span><span class="s0">;</span><span class="s2">r</span><span class="s0">&lt;</span><span class="s2">t</span><span class="s0">;++</span><span class="s2">r</span><span class="s0">)</span><span class="s2">e</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">arguments</span><span class="s0">[</span><span class="s2">r</span><span class="s0">]);</span><span class="s1">return </span><span class="s2">e</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">()}</span><span class="s2">n</span><span class="s0">.</span><span class="s2">privateKeyToPutty</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,</span><span class="s2">r</span><span class="s0">){</span><span class="s1">var </span><span class="s2">n</span><span class="s0">=</span><span class="s3">&quot;&quot;</span><span class="s0">===(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;&quot;</span><span class="s0">)?</span><span class="s3">&quot;none&quot;</span><span class="s0">:</span><span class="s3">&quot;aes256-cbc&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">=</span><span class="s3">&quot;PuTTY-User-Key-File-2: ssh-rsa</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s2">c</span><span class="s0">+=</span><span class="s3">&quot;Encryption: &quot;</span><span class="s0">+</span><span class="s2">n</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s3">&quot;Comment: &quot;</span><span class="s0">+(</span><span class="s2">r</span><span class="s0">=</span><span class="s2">r</span><span class="s0">||</span><span class="s3">&quot;&quot;</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">u</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s3">&quot;ssh-rsa&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">u</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">);</span><span class="s1">var </span><span class="s2">l</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s4">64</span><span class="s0">),</span><span class="s2">p</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">l</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">66</span><span class="s0">)+</span><span class="s4">1</span><span class="s0">;</span><span class="s2">c</span><span class="s0">+=</span><span class="s3">&quot;Public-Lines: &quot;</span><span class="s0">+</span><span class="s2">p</span><span class="s0">+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">l</span><span class="s0">;</span><span class="s1">var </span><span class="s2">f</span><span class="s0">,</span><span class="s2">h</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">i</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">d</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">p</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">q</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">h</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">qInv</span><span class="s0">),</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">d</span><span class="s0">=</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()+</span><span class="s4">16</span><span class="s0">-</span><span class="s4">1</span><span class="s0">;</span><span class="s2">d</span><span class="s0">-=</span><span class="s2">d</span><span class="s0">%</span><span class="s4">16</span><span class="s0">;</span><span class="s1">var </span><span class="s2">y</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">());</span><span class="s2">y</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s2">y</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()-</span><span class="s2">d</span><span class="s0">+</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">h</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">y</span><span class="s0">);</span><span class="s1">var </span><span class="s2">g</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">g</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\0\0\0\0</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">)),</span><span class="s2">g</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">o</span><span class="s0">(</span><span class="s3">&quot;</span><span class="s1">\0\0\0</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">));</span><span class="s1">var </span><span class="s2">v</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">aes</span><span class="s0">.</span><span class="s2">createEncryptionCipher</span><span class="s0">(</span><span class="s2">g</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s4">8</span><span class="s0">),</span><span class="s3">&quot;CBC&quot;</span><span class="s0">);</span><span class="s2">v</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">().</span><span class="s2">fillWithByte</span><span class="s0">(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">16</span><span class="s0">)),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">copy</span><span class="s0">()),</span><span class="s2">v</span><span class="s0">.</span><span class="s2">finish</span><span class="s0">();</span><span class="s1">var </span><span class="s2">m</span><span class="s0">=</span><span class="s2">v</span><span class="s0">.</span><span class="s2">output</span><span class="s0">;</span><span class="s2">m</span><span class="s0">.</span><span class="s2">truncate</span><span class="s0">(</span><span class="s4">16</span><span class="s0">),</span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">m</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s4">64</span><span class="s0">)}</span><span class="s1">else </span><span class="s2">f</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">(),</span><span class="s4">64</span><span class="s0">);</span><span class="s2">c</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">Private-Lines: &quot;</span><span class="s0">+(</span><span class="s2">p</span><span class="s0">=</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">floor</span><span class="s0">(</span><span class="s2">f</span><span class="s0">.</span><span class="s2">length</span><span class="s0">/</span><span class="s4">66</span><span class="s0">)+</span><span class="s4">1</span><span class="s0">)+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">,</span><span class="s2">c</span><span class="s0">+=</span><span class="s2">f</span><span class="s0">;</span><span class="s1">var </span><span class="s2">C</span><span class="s0">=</span><span class="s2">o</span><span class="s0">(</span><span class="s3">&quot;putty-private-key-file-mac-key&quot;</span><span class="s0">,</span><span class="s2">t</span><span class="s0">),</span><span class="s2">E</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s3">&quot;ssh-rsa&quot;</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">n</span><span class="s0">),</span><span class="s2">s</span><span class="s0">(</span><span class="s2">E</span><span class="s0">,</span><span class="s2">r</span><span class="s0">),</span><span class="s2">E</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">u</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">E</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">u</span><span class="s0">),</span><span class="s2">E</span><span class="s0">.</span><span class="s2">putInt32</span><span class="s0">(</span><span class="s2">h</span><span class="s0">.</span><span class="s2">length</span><span class="s0">()),</span><span class="s2">E</span><span class="s0">.</span><span class="s2">putBuffer</span><span class="s0">(</span><span class="s2">h</span><span class="s0">);</span><span class="s1">var </span><span class="s2">S</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">hmac</span><span class="s0">.</span><span class="s2">create</span><span class="s0">();</span><span class="s1">return </span><span class="s2">S</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(</span><span class="s3">&quot;sha1&quot;</span><span class="s0">,</span><span class="s2">C</span><span class="s0">),</span><span class="s2">S</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">E</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">()),</span><span class="s2">c</span><span class="s0">+=</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">Private-MAC: &quot;</span><span class="s0">+</span><span class="s2">S</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">().</span><span class="s2">toHex</span><span class="s0">()+</span><span class="s3">&quot;</span><span class="s1">\r\n</span><span class="s3">&quot;</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">publicKeyToOpenSSH</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||</span><span class="s3">&quot;&quot;</span><span class="s0">;</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s1">return </span><span class="s2">s</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s3">&quot;ssh-rsa&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">r</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">),</span><span class="s3">&quot;ssh-rsa &quot;</span><span class="s0">+</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">encode64</span><span class="s0">(</span><span class="s2">r</span><span class="s0">.</span><span class="s2">bytes</span><span class="s0">())+</span><span class="s3">&quot; &quot;</span><span class="s0">+</span><span class="s2">t</span><span class="s0">},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">privateKeyToOpenSSH</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">return </span><span class="s2">t</span><span class="s0">?</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">encryptRsaPrivateKey</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">,{</span><span class="s2">legacy</span><span class="s0">:!</span><span class="s4">0</span><span class="s0">,</span><span class="s2">algorithm</span><span class="s0">:</span><span class="s3">&quot;aes128&quot;</span><span class="s0">}):</span><span class="s2">a</span><span class="s0">.</span><span class="s2">pki</span><span class="s0">.</span><span class="s2">privateKeyToPem</span><span class="s0">(</span><span class="s2">e</span><span class="s0">)},</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getPublicKeyFingerprint</span><span class="s0">=</span><span class="s1">function</span><span class="s0">(</span><span class="s2">e</span><span class="s0">,</span><span class="s2">t</span><span class="s0">){</span><span class="s1">var </span><span class="s2">r</span><span class="s0">=(</span><span class="s2">t</span><span class="s0">=</span><span class="s2">t</span><span class="s0">||{}).</span><span class="s2">md</span><span class="s0">||</span><span class="s2">a</span><span class="s0">.</span><span class="s2">md</span><span class="s0">.</span><span class="s2">md5</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(),</span><span class="s2">n</span><span class="s0">=</span><span class="s2">a</span><span class="s0">.</span><span class="s2">util</span><span class="s0">.</span><span class="s2">createBuffer</span><span class="s0">();</span><span class="s2">s</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s3">&quot;ssh-rsa&quot;</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">e</span><span class="s0">),</span><span class="s2">i</span><span class="s0">(</span><span class="s2">n</span><span class="s0">,</span><span class="s2">e</span><span class="s0">.</span><span class="s2">n</span><span class="s0">),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">start</span><span class="s0">(),</span><span class="s2">r</span><span class="s0">.</span><span class="s2">update</span><span class="s0">(</span><span class="s2">n</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">());</span><span class="s1">var </span><span class="s2">o</span><span class="s0">=</span><span class="s2">r</span><span class="s0">.</span><span class="s2">digest</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;hex&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">){</span><span class="s1">var </span><span class="s2">c</span><span class="s0">=</span><span class="s2">o</span><span class="s0">.</span><span class="s2">toHex</span><span class="s0">();</span><span class="s1">return </span><span class="s2">t</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">?</span><span class="s2">c</span><span class="s0">.</span><span class="s2">match</span><span class="s0">(</span><span class="s5">/.{2}/g</span><span class="s0">).</span><span class="s2">join</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">delimiter</span><span class="s0">):</span><span class="s2">c</span><span class="s0">}</span><span class="s1">if</span><span class="s0">(</span><span class="s3">&quot;binary&quot;</span><span class="s0">===</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">)</span><span class="s1">return </span><span class="s2">o</span><span class="s0">.</span><span class="s2">getBytes</span><span class="s0">();</span><span class="s1">if</span><span class="s0">(</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">)</span><span class="s1">throw new </span><span class="s2">Error</span><span class="s0">(</span><span class="s3">'Unknown encoding &quot;'</span><span class="s0">+</span><span class="s2">t</span><span class="s0">.</span><span class="s2">encoding</span><span class="s0">+</span><span class="s3">'&quot;.'</span><span class="s0">);</span><span class="s1">return </span><span class="s2">o</span><span class="s0">}}])}));</span>
<span class="s6">//# sourceMappingURL=forge.min.js.map</span></pre>
</body>
</html>