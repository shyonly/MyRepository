<html>
<head>
<title>ResizeObserver.global.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #7a7e85;}
.s6 { color: #67a37c; font-style: italic;}
.s7 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ResizeObserver.global.js</font>
</center></td></tr></table>
<pre><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">global</span><span class="s0">, </span><span class="s2">factory</span><span class="s0">) {</span>
    <span class="s1">typeof </span><span class="s2">exports </span><span class="s0">=== </span><span class="s3">'object' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">module </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">? </span><span class="s2">module</span><span class="s0">.</span><span class="s2">exports </span><span class="s0">= </span><span class="s2">factory</span><span class="s0">() :</span>
    <span class="s1">typeof </span><span class="s2">define </span><span class="s0">=== </span><span class="s3">'function' </span><span class="s0">&amp;&amp; </span><span class="s2">define</span><span class="s0">.</span><span class="s2">amd </span><span class="s0">? </span><span class="s2">define</span><span class="s0">(</span><span class="s2">factory</span><span class="s0">) :</span>
    <span class="s0">(</span><span class="s2">global</span><span class="s0">.</span><span class="s2">ResizeObserver </span><span class="s0">= </span><span class="s2">factory</span><span class="s0">());</span>
<span class="s0">}(</span><span class="s1">this</span><span class="s0">, (</span><span class="s1">function </span><span class="s0">() { </span><span class="s3">'use strict'</span><span class="s0">;</span>

<span class="s4">/**</span>
 <span class="s4">* A collection of shims that provide minimal functionality of the ES6 collections.</span>
 <span class="s4">*</span>
 <span class="s4">* These implementations are not meant to be used outside of the ResizeObserver</span>
 <span class="s4">* modules as they cover only a limited range of use cases.</span>
 <span class="s4">*/</span>
<span class="s5">/* eslint-disable require-jsdoc, valid-jsdoc */</span>
<span class="s1">var </span><span class="s2">MapShim </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">Map </span><span class="s0">!== </span><span class="s3">'undefined'</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">Map</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s4">/**</span>
     <span class="s4">* Returns index in provided array that matches the specified key.</span>
     <span class="s4">*</span>
     <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Array&lt;Array&gt;} arr</span>
     <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} key</span>
     <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{number}</span>
     <span class="s4">*/</span>
    <span class="s1">function </span><span class="s2">getIndex</span><span class="s0">(</span><span class="s2">arr</span><span class="s0">, </span><span class="s2">key</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">result </span><span class="s0">= -</span><span class="s7">1</span><span class="s0">;</span>

        <span class="s2">arr</span><span class="s0">.</span><span class="s2">some</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">entry</span><span class="s0">, </span><span class="s2">index</span><span class="s0">) {</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">entry</span><span class="s0">[</span><span class="s7">0</span><span class="s0">] === </span><span class="s2">key</span><span class="s0">) {</span>
                <span class="s2">result </span><span class="s0">= </span><span class="s2">index</span><span class="s0">;</span>

                <span class="s1">return true</span><span class="s0">;</span>
            <span class="s0">}</span>

            <span class="s1">return false</span><span class="s0">;</span>
        <span class="s0">});</span>

        <span class="s1">return </span><span class="s2">result</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s0">(</span><span class="s1">function </span><span class="s0">() {</span>
        <span class="s1">function </span><span class="s2">anonymous</span><span class="s0">() {</span>
            <span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__ </span><span class="s0">= [];</span>
        <span class="s0">}</span>

        <span class="s1">var </span><span class="s2">prototypeAccessors </span><span class="s0">= { </span><span class="s2">size</span><span class="s0">: { </span><span class="s2">configurable</span><span class="s0">: </span><span class="s1">true </span><span class="s0">} };</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean}</span>
         <span class="s4">*/</span>
        <span class="s2">prototypeAccessors</span><span class="s0">.</span><span class="s2">size</span><span class="s0">.</span><span class="s2">get </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
            <span class="s1">return this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">.</span><span class="s2">length</span><span class="s0">;</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} key</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{*}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">get </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">getIndex</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">, </span><span class="s2">key</span><span class="s0">);</span>
            <span class="s1">var </span><span class="s2">entry </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">[</span><span class="s2">index</span><span class="s0">];</span>

            <span class="s1">return </span><span class="s2">entry </span><span class="s0">&amp;&amp; </span><span class="s2">entry</span><span class="s0">[</span><span class="s7">1</span><span class="s0">];</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} key</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} value</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">set </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">key</span><span class="s0">, </span><span class="s2">value</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">getIndex</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">, </span><span class="s2">key</span><span class="s0">);</span>

            <span class="s1">if </span><span class="s0">(~</span><span class="s2">index</span><span class="s0">) {</span>
                <span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">[</span><span class="s2">index</span><span class="s0">][</span><span class="s7">1</span><span class="s0">] = </span><span class="s2">value</span><span class="s0">;</span>
            <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
                <span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">.</span><span class="s2">push</span><span class="s0">([</span><span class="s2">key</span><span class="s0">, </span><span class="s2">value</span><span class="s0">]);</span>
            <span class="s0">}</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} key</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">delete </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">entries </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">;</span>
            <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">getIndex</span><span class="s0">(</span><span class="s2">entries</span><span class="s0">, </span><span class="s2">key</span><span class="s0">);</span>

            <span class="s1">if </span><span class="s0">(~</span><span class="s2">index</span><span class="s0">) {</span>
                <span class="s2">entries</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">index</span><span class="s0">, </span><span class="s7">1</span><span class="s0">);</span>
            <span class="s0">}</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} key</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">has </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
            <span class="s1">return </span><span class="s0">!!~</span><span class="s2">getIndex</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">, </span><span class="s2">key</span><span class="s0">);</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clear </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
            <span class="s1">this</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s7">0</span><span class="s0">);</span>
        <span class="s0">};</span>

        <span class="s4">/**</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Function} callback</span>
         <span class="s4">* </span><span class="s6">@param </span><span class="s4">{*} [ctx=null]</span>
         <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
         <span class="s4">*/</span>
        <span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">forEach </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">callback</span><span class="s0">, </span><span class="s2">ctx</span><span class="s0">) {</span>
            <span class="s1">var </span><span class="s2">this$1 </span><span class="s0">= </span><span class="s1">this</span><span class="s0">;</span>
            <span class="s1">if </span><span class="s0">( </span><span class="s2">ctx </span><span class="s0">=== </span><span class="s1">void </span><span class="s7">0 </span><span class="s0">) </span><span class="s2">ctx </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>

            <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s7">0</span><span class="s0">, </span><span class="s2">list </span><span class="s0">= </span><span class="s2">this$1</span><span class="s0">.</span><span class="s2">__entries__</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">list</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i </span><span class="s0">+= </span><span class="s7">1</span><span class="s0">) {</span>
                <span class="s1">var </span><span class="s2">entry </span><span class="s0">= </span><span class="s2">list</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>

                <span class="s2">callback</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">ctx</span><span class="s0">, </span><span class="s2">entry</span><span class="s0">[</span><span class="s7">1</span><span class="s0">], </span><span class="s2">entry</span><span class="s0">[</span><span class="s7">0</span><span class="s0">]);</span>
            <span class="s0">}</span>
        <span class="s0">};</span>

        <span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperties</span><span class="s0">( </span><span class="s2">anonymous</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">, </span><span class="s2">prototypeAccessors </span><span class="s0">);</span>

        <span class="s1">return </span><span class="s2">anonymous</span><span class="s0">;</span>
    <span class="s0">}());</span>
<span class="s0">})();</span>

<span class="s4">/**</span>
 <span class="s4">* Detects whether window and document objects are available in current environment.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">isBrowser </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">window </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">document </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">&amp;&amp; </span><span class="s2">window</span><span class="s0">.</span><span class="s2">document </span><span class="s0">=== </span><span class="s2">document</span><span class="s0">;</span>

<span class="s5">// Returns global object of a current environment.</span>
<span class="s1">var </span><span class="s2">global$1 </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">global </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">&amp;&amp; </span><span class="s2">global</span><span class="s0">.</span><span class="s2">Math </span><span class="s0">=== </span><span class="s2">Math</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">global</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">self </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">&amp;&amp; </span><span class="s2">self</span><span class="s0">.</span><span class="s2">Math </span><span class="s0">=== </span><span class="s2">Math</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">self</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">window </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">&amp;&amp; </span><span class="s2">window</span><span class="s0">.</span><span class="s2">Math </span><span class="s0">=== </span><span class="s2">Math</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">window</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s5">// eslint-disable-next-line no-new-func</span>
    <span class="s1">return </span><span class="s2">Function</span><span class="s0">(</span><span class="s3">'return this'</span><span class="s0">)();</span>
<span class="s0">})();</span>

<span class="s4">/**</span>
 <span class="s4">* A shim for the requestAnimationFrame which falls back to the setTimeout if</span>
 <span class="s4">* first one is not supported.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{number} Requests' identifier.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">requestAnimationFrame$1 </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">requestAnimationFrame </span><span class="s0">=== </span><span class="s3">'function'</span><span class="s0">) {</span>
        <span class="s5">// It's required to use a bounded function because IE sometimes throws</span>
        <span class="s5">// an &quot;Invalid calling object&quot; error if rAF is invoked without the global</span>
        <span class="s5">// object on the left hand side.</span>
        <span class="s1">return </span><span class="s2">requestAnimationFrame</span><span class="s0">.</span><span class="s2">bind</span><span class="s0">(</span><span class="s2">global$1</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">return function </span><span class="s0">(</span><span class="s2">callback</span><span class="s0">) { </span><span class="s1">return </span><span class="s2">setTimeout</span><span class="s0">(</span><span class="s1">function </span><span class="s0">() { </span><span class="s1">return </span><span class="s2">callback</span><span class="s0">(</span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">()); }, </span><span class="s7">1000 </span><span class="s0">/ </span><span class="s7">60</span><span class="s0">); };</span>
<span class="s0">})();</span>

<span class="s5">// Defines minimum timeout before adding a trailing call.</span>
<span class="s1">var </span><span class="s2">trailingTimeout </span><span class="s0">= </span><span class="s7">2</span><span class="s0">;</span>

<span class="s4">/**</span>
 <span class="s4">* Creates a wrapper function which ensures that provided callback will be</span>
 <span class="s4">* invoked only once during the specified delay period.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Function} callback - Function to be invoked after the delay period.</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number} delay - Delay after which to invoke callback.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{Function}</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">throttle </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">callback</span><span class="s0">, </span><span class="s2">delay</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">leadingCall </span><span class="s0">= </span><span class="s1">false</span><span class="s0">,</span>
        <span class="s2">trailingCall </span><span class="s0">= </span><span class="s1">false</span><span class="s0">,</span>
        <span class="s2">lastCallTime </span><span class="s0">= </span><span class="s7">0</span><span class="s0">;</span>

    <span class="s4">/**</span>
     <span class="s4">* Invokes the original callback function and schedules new invocation if</span>
     <span class="s4">* the &quot;proxy&quot; was called during current request.</span>
     <span class="s4">*</span>
     <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
     <span class="s4">*/</span>
    <span class="s1">function </span><span class="s2">resolvePending</span><span class="s0">() {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">leadingCall</span><span class="s0">) {</span>
            <span class="s2">leadingCall </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>

            <span class="s2">callback</span><span class="s0">();</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">trailingCall</span><span class="s0">) {</span>
            <span class="s2">proxy</span><span class="s0">();</span>
        <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s4">/**</span>
     <span class="s4">* Callback invoked after the specified delay. It will further postpone</span>
     <span class="s4">* invocation of the original function delegating it to the</span>
     <span class="s4">* requestAnimationFrame.</span>
     <span class="s4">*</span>
     <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
     <span class="s4">*/</span>
    <span class="s1">function </span><span class="s2">timeoutCallback</span><span class="s0">() {</span>
        <span class="s2">requestAnimationFrame$1</span><span class="s0">(</span><span class="s2">resolvePending</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s4">/**</span>
     <span class="s4">* Schedules invocation of the original function.</span>
     <span class="s4">*</span>
     <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
     <span class="s4">*/</span>
    <span class="s1">function </span><span class="s2">proxy</span><span class="s0">() {</span>
        <span class="s1">var </span><span class="s2">timeStamp </span><span class="s0">= </span><span class="s2">Date</span><span class="s0">.</span><span class="s2">now</span><span class="s0">();</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">leadingCall</span><span class="s0">) {</span>
            <span class="s5">// Reject immediately following calls.</span>
            <span class="s1">if </span><span class="s0">(</span><span class="s2">timeStamp </span><span class="s0">- </span><span class="s2">lastCallTime </span><span class="s0">&lt; </span><span class="s2">trailingTimeout</span><span class="s0">) {</span>
                <span class="s1">return</span><span class="s0">;</span>
            <span class="s0">}</span>

            <span class="s5">// Schedule new call to be in invoked when the pending one is resolved.</span>
            <span class="s5">// This is important for &quot;transitions&quot; which never actually start</span>
            <span class="s5">// immediately so there is a chance that we might miss one if change</span>
            <span class="s5">// happens amids the pending invocation.</span>
            <span class="s2">trailingCall </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
        <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
            <span class="s2">leadingCall </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
            <span class="s2">trailingCall </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>

            <span class="s2">setTimeout</span><span class="s0">(</span><span class="s2">timeoutCallback</span><span class="s0">, </span><span class="s2">delay</span><span class="s0">);</span>
        <span class="s0">}</span>

        <span class="s2">lastCallTime </span><span class="s0">= </span><span class="s2">timeStamp</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">proxy</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s5">// Minimum delay before invoking the update of observers.</span>
<span class="s1">var </span><span class="s2">REFRESH_DELAY </span><span class="s0">= </span><span class="s7">20</span><span class="s0">;</span>

<span class="s5">// A list of substrings of CSS properties used to find transition events that</span>
<span class="s5">// might affect dimensions of observed elements.</span>
<span class="s1">var </span><span class="s2">transitionKeys </span><span class="s0">= [</span><span class="s3">'top'</span><span class="s0">, </span><span class="s3">'right'</span><span class="s0">, </span><span class="s3">'bottom'</span><span class="s0">, </span><span class="s3">'left'</span><span class="s0">, </span><span class="s3">'width'</span><span class="s0">, </span><span class="s3">'height'</span><span class="s0">, </span><span class="s3">'size'</span><span class="s0">, </span><span class="s3">'weight'</span><span class="s0">];</span>

<span class="s5">// Check if MutationObserver is available.</span>
<span class="s1">var </span><span class="s2">mutationObserverSupported </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">MutationObserver </span><span class="s0">!== </span><span class="s3">'undefined'</span><span class="s0">;</span>

<span class="s4">/**</span>
 <span class="s4">* Singleton controller class which handles updates of ResizeObserver instances.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">ResizeObserverController </span><span class="s0">= </span><span class="s1">function</span><span class="s0">() {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">connected_ </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationEventsAdded_ </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_ </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">observers_ </span><span class="s0">= [];</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">onTransitionEnd_ </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">onTransitionEnd_</span><span class="s0">.</span><span class="s2">bind</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">refresh </span><span class="s0">= </span><span class="s2">throttle</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">.</span><span class="s2">bind</span><span class="s0">(</span><span class="s1">this</span><span class="s0">), </span><span class="s2">REFRESH_DELAY</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Adds observer to observers list.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{ResizeObserverSPI} observer - Observer to be added.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Holds reference to the controller's instance.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{ResizeObserverController}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Keeps reference to the instance of MutationObserver.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{MutationObserver}</span>
 <span class="s4">*/</span>

<span class="s4">/**</span>
 <span class="s4">* Indicates whether DOM listeners have been added.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{boolean}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">addObserver </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">observer</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!~</span><span class="s1">this</span><span class="s0">.</span><span class="s2">observers_</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">observer</span><span class="s0">)) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">observers_</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">observer</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s5">// Add listeners if they haven't been added yet.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">connected_</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">connect_</span><span class="s0">();</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Removes observer from observers list.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{ResizeObserverSPI} observer - Observer to be removed.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">removeObserver </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">observer</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">observers </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">observers_</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">index </span><span class="s0">= </span><span class="s2">observers</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">observer</span><span class="s0">);</span>

    <span class="s5">// Remove observer if it's present in registry.</span>
    <span class="s1">if </span><span class="s0">(~</span><span class="s2">index</span><span class="s0">) {</span>
        <span class="s2">observers</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s2">index</span><span class="s0">, </span><span class="s7">1</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s5">// Remove listeners if controller has no connected observers.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">observers</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&amp;&amp; </span><span class="s1">this</span><span class="s0">.</span><span class="s2">connected_</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">disconnect_</span><span class="s0">();</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Invokes the update of observers. It will continue running updates insofar</span>
 <span class="s4">* it detects changes.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">refresh </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">var </span><span class="s2">changesDetected </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">updateObservers_</span><span class="s0">();</span>

    <span class="s5">// Continue running updates if changes have been detected as there might</span>
    <span class="s5">// be future ones caused by CSS transitions.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">changesDetected</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">();</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Updates every observer from observers list and notifies them of queued</span>
 <span class="s4">* entries.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean} Returns &quot;true&quot; if any observer has detected changes in</span>
 <span class="s4">*  dimensions of it's elements.</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">updateObservers_ </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Collect observers that have active observations.</span>
    <span class="s1">var </span><span class="s2">activeObservers </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">observers_</span><span class="s0">.</span><span class="s2">filter</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">observer</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">observer</span><span class="s0">.</span><span class="s2">gatherActive</span><span class="s0">(), </span><span class="s2">observer</span><span class="s0">.</span><span class="s2">hasActive</span><span class="s0">();</span>
    <span class="s0">});</span>

    <span class="s5">// Deliver notifications in a separate cycle in order to avoid any</span>
    <span class="s5">// collisions between observers, e.g. when multiple instances of</span>
    <span class="s5">// ResizeObserver are tracking the same element and the callback of one</span>
    <span class="s5">// of them changes content dimensions of the observed target. Sometimes</span>
    <span class="s5">// this may result in notifications being blocked for the rest of observers.</span>
    <span class="s2">activeObservers</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">observer</span><span class="s0">) { </span><span class="s1">return </span><span class="s2">observer</span><span class="s0">.</span><span class="s2">broadcastActive</span><span class="s0">(); });</span>

    <span class="s1">return </span><span class="s2">activeObservers</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s7">0</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Initializes DOM listeners.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">connect_ </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Do nothing if running in a non-browser environment or if listeners</span>
    <span class="s5">// have been already added.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">isBrowser </span><span class="s0">|| </span><span class="s1">this</span><span class="s0">.</span><span class="s2">connected_</span><span class="s0">) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s5">// Subscription to the &quot;Transitionend&quot; event is used as a workaround for</span>
    <span class="s5">// delayed transitions. This way it's possible to capture at least the</span>
    <span class="s5">// final state of an element.</span>
    <span class="s2">document</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">'transitionend'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">onTransitionEnd_</span><span class="s0">);</span>

    <span class="s2">window</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">'resize'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">);</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">mutationObserverSupported</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_ </span><span class="s0">= </span><span class="s1">new </span><span class="s2">MutationObserver</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">);</span>

        <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_</span><span class="s0">.</span><span class="s2">observe</span><span class="s0">(</span><span class="s2">document</span><span class="s0">, {</span>
            <span class="s2">attributes</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
            <span class="s2">childList</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
            <span class="s2">characterData</span><span class="s0">: </span><span class="s1">true</span><span class="s0">,</span>
            <span class="s2">subtree</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">});</span>
    <span class="s0">} </span><span class="s1">else </span><span class="s0">{</span>
        <span class="s2">document</span><span class="s0">.</span><span class="s2">addEventListener</span><span class="s0">(</span><span class="s3">'DOMSubtreeModified'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">);</span>

        <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationEventsAdded_ </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">connected_ </span><span class="s0">= </span><span class="s1">true</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Removes DOM listeners.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">disconnect_ </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Do nothing if running in a non-browser environment or if listeners</span>
    <span class="s5">// have been already removed.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">isBrowser </span><span class="s0">|| !</span><span class="s1">this</span><span class="s0">.</span><span class="s2">connected_</span><span class="s0">) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s2">document</span><span class="s0">.</span><span class="s2">removeEventListener</span><span class="s0">(</span><span class="s3">'transitionend'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">onTransitionEnd_</span><span class="s0">);</span>
    <span class="s2">window</span><span class="s0">.</span><span class="s2">removeEventListener</span><span class="s0">(</span><span class="s3">'resize'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">);</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_</span><span class="s0">.</span><span class="s2">disconnect</span><span class="s0">();</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">mutationEventsAdded_</span><span class="s0">) {</span>
        <span class="s2">document</span><span class="s0">.</span><span class="s2">removeEventListener</span><span class="s0">(</span><span class="s3">'DOMSubtreeModified'</span><span class="s0">, </span><span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationsObserver_ </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">mutationEventsAdded_ </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">connected_ </span><span class="s0">= </span><span class="s1">false</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* &quot;Transitionend&quot; event handler.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{TransitionEvent} event</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">onTransitionEnd_ </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">ref</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">propertyName </span><span class="s0">= </span><span class="s2">ref</span><span class="s0">.</span><span class="s2">propertyName</span><span class="s0">; </span><span class="s1">if </span><span class="s0">( </span><span class="s2">propertyName </span><span class="s0">=== </span><span class="s1">void </span><span class="s7">0 </span><span class="s0">) </span><span class="s2">propertyName </span><span class="s0">= </span><span class="s3">''</span><span class="s0">;</span>

    <span class="s5">// Detect whether transition may affect dimensions of an element.</span>
    <span class="s1">var </span><span class="s2">isReflowProperty </span><span class="s0">= </span><span class="s2">transitionKeys</span><span class="s0">.</span><span class="s2">some</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">key</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s0">!!~</span><span class="s2">propertyName</span><span class="s0">.</span><span class="s2">indexOf</span><span class="s0">(</span><span class="s2">key</span><span class="s0">);</span>
    <span class="s0">});</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">isReflowProperty</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">();</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Returns instance of the ResizeObserverController.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{ResizeObserverController}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">getInstance </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">instance_</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">instance_ </span><span class="s0">= </span><span class="s1">new </span><span class="s2">ResizeObserverController</span><span class="s0">();</span>
    <span class="s0">}</span>

    <span class="s1">return this</span><span class="s0">.</span><span class="s2">instance_</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">instance_ </span><span class="s0">= </span><span class="s1">null</span><span class="s0">;</span>

<span class="s4">/**</span>
 <span class="s4">* Defines non-writable/enumerable properties of the provided target object.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Object} target - Object for which to define properties.</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Object} props - Properties to be defined.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{Object} Target object.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">defineConfigurable </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">, </span><span class="s2">props</span><span class="s0">) {</span>
    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s7">0</span><span class="s0">, </span><span class="s2">list </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">keys</span><span class="s0">(</span><span class="s2">props</span><span class="s0">); </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">list</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i </span><span class="s0">+= </span><span class="s7">1</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">key </span><span class="s0">= </span><span class="s2">list</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>

        <span class="s2">Object</span><span class="s0">.</span><span class="s2">defineProperty</span><span class="s0">(</span><span class="s2">target</span><span class="s0">, </span><span class="s2">key</span><span class="s0">, {</span>
            <span class="s2">value</span><span class="s0">: </span><span class="s2">props</span><span class="s0">[</span><span class="s2">key</span><span class="s0">],</span>
            <span class="s2">enumerable</span><span class="s0">: </span><span class="s1">false</span><span class="s0">,</span>
            <span class="s2">writable</span><span class="s0">: </span><span class="s1">false</span><span class="s0">,</span>
            <span class="s2">configurable</span><span class="s0">: </span><span class="s1">true</span>
        <span class="s0">});</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">target</span><span class="s0">;</span>
<span class="s0">});</span>

<span class="s4">/**</span>
 <span class="s4">* Returns the global object associated with provided element.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Object} target</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{Object}</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">getWindowOf </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s5">// Assume that the element is an instance of Node, which means that it</span>
    <span class="s5">// has the &quot;ownerDocument&quot; property from which we can retrieve a</span>
    <span class="s5">// corresponding global object.</span>
    <span class="s1">var </span><span class="s2">ownerGlobal </span><span class="s0">= </span><span class="s2">target </span><span class="s0">&amp;&amp; </span><span class="s2">target</span><span class="s0">.</span><span class="s2">ownerDocument </span><span class="s0">&amp;&amp; </span><span class="s2">target</span><span class="s0">.</span><span class="s2">ownerDocument</span><span class="s0">.</span><span class="s2">defaultView</span><span class="s0">;</span>

    <span class="s5">// Return the local global object if it's not possible extract one from</span>
    <span class="s5">// provided element.</span>
    <span class="s1">return </span><span class="s2">ownerGlobal </span><span class="s0">|| </span><span class="s2">global$1</span><span class="s0">;</span>
<span class="s0">});</span>

<span class="s5">// Placeholder of an empty content rectangle.</span>
<span class="s1">var </span><span class="s2">emptyRect </span><span class="s0">= </span><span class="s2">createRectInit</span><span class="s0">(</span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">);</span>

<span class="s4">/**</span>
 <span class="s4">* Converts provided string to a number.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number|string} value</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{number}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">toFloat</span><span class="s0">(</span><span class="s2">value</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">parseFloat</span><span class="s0">(</span><span class="s2">value</span><span class="s0">) || </span><span class="s7">0</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Extracts borders size from provided styles.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{CSSStyleDeclaration} styles</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{...string} positions - Borders positions (top, right, ...)</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{number}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">getBordersSize</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">positions </span><span class="s0">= [], </span><span class="s2">len </span><span class="s0">= </span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length </span><span class="s0">- </span><span class="s7">1</span><span class="s0">;</span>
    <span class="s1">while </span><span class="s0">( </span><span class="s2">len</span><span class="s0">-- &gt; </span><span class="s7">0 </span><span class="s0">) </span><span class="s2">positions</span><span class="s0">[ </span><span class="s2">len </span><span class="s0">] = </span><span class="s2">arguments</span><span class="s0">[ </span><span class="s2">len </span><span class="s0">+ </span><span class="s7">1 </span><span class="s0">];</span>

    <span class="s1">return </span><span class="s2">positions</span><span class="s0">.</span><span class="s2">reduce</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">size</span><span class="s0">, </span><span class="s2">position</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">value </span><span class="s0">= </span><span class="s2">styles</span><span class="s0">[</span><span class="s3">'border-' </span><span class="s0">+ </span><span class="s2">position </span><span class="s0">+ </span><span class="s3">'-width'</span><span class="s0">];</span>

        <span class="s1">return </span><span class="s2">size </span><span class="s0">+ </span><span class="s2">toFloat</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
    <span class="s0">}, </span><span class="s7">0</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Extracts paddings sizes from provided styles.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{CSSStyleDeclaration} styles</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{Object} Paddings box.</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">getPaddings</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">positions </span><span class="s0">= [</span><span class="s3">'top'</span><span class="s0">, </span><span class="s3">'right'</span><span class="s0">, </span><span class="s3">'bottom'</span><span class="s0">, </span><span class="s3">'left'</span><span class="s0">];</span>
    <span class="s1">var </span><span class="s2">paddings </span><span class="s0">= {};</span>

    <span class="s1">for </span><span class="s0">(</span><span class="s1">var </span><span class="s2">i </span><span class="s0">= </span><span class="s7">0</span><span class="s0">, </span><span class="s2">list </span><span class="s0">= </span><span class="s2">positions</span><span class="s0">; </span><span class="s2">i </span><span class="s0">&lt; </span><span class="s2">list</span><span class="s0">.</span><span class="s2">length</span><span class="s0">; </span><span class="s2">i </span><span class="s0">+= </span><span class="s7">1</span><span class="s0">) {</span>
        <span class="s1">var </span><span class="s2">position </span><span class="s0">= </span><span class="s2">list</span><span class="s0">[</span><span class="s2">i</span><span class="s0">];</span>

        <span class="s1">var </span><span class="s2">value </span><span class="s0">= </span><span class="s2">styles</span><span class="s0">[</span><span class="s3">'padding-' </span><span class="s0">+ </span><span class="s2">position</span><span class="s0">];</span>

        <span class="s2">paddings</span><span class="s0">[</span><span class="s2">position</span><span class="s0">] = </span><span class="s2">toFloat</span><span class="s0">(</span><span class="s2">value</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">paddings</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Calculates content rectangle of provided SVG element.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{SVGGraphicsElement} target - Element content rectangle of which needs</span>
 <span class="s4">*      to be calculated.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectInit}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">getSVGContentRect</span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">bbox </span><span class="s0">= </span><span class="s2">target</span><span class="s0">.</span><span class="s2">getBBox</span><span class="s0">();</span>

    <span class="s1">return </span><span class="s2">createRectInit</span><span class="s0">(</span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">, </span><span class="s2">bbox</span><span class="s0">.</span><span class="s2">width</span><span class="s0">, </span><span class="s2">bbox</span><span class="s0">.</span><span class="s2">height</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Calculates content rectangle of provided HTMLElement.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{HTMLElement} target - Element for which to calculate the content rectangle.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectInit}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">getHTMLElementContentRect</span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s5">// Client width &amp; height properties can't be</span>
    <span class="s5">// used exclusively as they provide rounded values.</span>
    <span class="s1">var </span><span class="s2">clientWidth </span><span class="s0">= </span><span class="s2">target</span><span class="s0">.</span><span class="s2">clientWidth</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">clientHeight </span><span class="s0">= </span><span class="s2">target</span><span class="s0">.</span><span class="s2">clientHeight</span><span class="s0">;</span>

    <span class="s5">// By this condition we can catch all non-replaced inline, hidden and</span>
    <span class="s5">// detached elements. Though elements with width &amp; height properties less</span>
    <span class="s5">// than 0.5 will be discarded as well.</span>
    <span class="s5">//</span>
    <span class="s5">// Without it we would need to implement separate methods for each of</span>
    <span class="s5">// those cases and it's not possible to perform a precise and performance</span>
    <span class="s5">// effective test for hidden elements. E.g. even jQuery's ':visible' filter</span>
    <span class="s5">// gives wrong results for elements with width &amp; height less than 0.5.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">clientWidth </span><span class="s0">&amp;&amp; !</span><span class="s2">clientHeight</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">emptyRect</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">styles </span><span class="s0">= </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">getComputedStyle</span><span class="s0">(</span><span class="s2">target</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">paddings </span><span class="s0">= </span><span class="s2">getPaddings</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">);</span>
    <span class="s1">var </span><span class="s2">horizPad </span><span class="s0">= </span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">left </span><span class="s0">+ </span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">right</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">vertPad </span><span class="s0">= </span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">top </span><span class="s0">+ </span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">bottom</span><span class="s0">;</span>

    <span class="s5">// Computed styles of width &amp; height are being used because they are the</span>
    <span class="s5">// only dimensions available to JS that contain non-rounded values. It could</span>
    <span class="s5">// be possible to utilize the getBoundingClientRect if only it's data wasn't</span>
    <span class="s5">// affected by CSS transformations let alone paddings, borders and scroll bars.</span>
    <span class="s1">var </span><span class="s2">width </span><span class="s0">= </span><span class="s2">toFloat</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">.</span><span class="s2">width</span><span class="s0">),</span>
        <span class="s2">height </span><span class="s0">= </span><span class="s2">toFloat</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">.</span><span class="s2">height</span><span class="s0">);</span>

    <span class="s5">// Width &amp; height include paddings and borders when the 'border-box' box</span>
    <span class="s5">// model is applied (except for IE).</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">styles</span><span class="s0">.</span><span class="s2">boxSizing </span><span class="s0">=== </span><span class="s3">'border-box'</span><span class="s0">) {</span>
        <span class="s5">// Following conditions are required to handle Internet Explorer which</span>
        <span class="s5">// doesn't include paddings and borders to computed CSS dimensions.</span>
        <span class="s5">//</span>
        <span class="s5">// We can say that if CSS dimensions + paddings are equal to the &quot;client&quot;</span>
        <span class="s5">// properties then it's either IE, and thus we don't need to subtract</span>
        <span class="s5">// anything, or an element merely doesn't have paddings/borders styles.</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">round</span><span class="s0">(</span><span class="s2">width </span><span class="s0">+ </span><span class="s2">horizPad</span><span class="s0">) !== </span><span class="s2">clientWidth</span><span class="s0">) {</span>
            <span class="s2">width </span><span class="s0">-= </span><span class="s2">getBordersSize</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">, </span><span class="s3">'left'</span><span class="s0">, </span><span class="s3">'right'</span><span class="s0">) + </span><span class="s2">horizPad</span><span class="s0">;</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">round</span><span class="s0">(</span><span class="s2">height </span><span class="s0">+ </span><span class="s2">vertPad</span><span class="s0">) !== </span><span class="s2">clientHeight</span><span class="s0">) {</span>
            <span class="s2">height </span><span class="s0">-= </span><span class="s2">getBordersSize</span><span class="s0">(</span><span class="s2">styles</span><span class="s0">, </span><span class="s3">'top'</span><span class="s0">, </span><span class="s3">'bottom'</span><span class="s0">) + </span><span class="s2">vertPad</span><span class="s0">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s5">// Following steps can't be applied to the document's root element as its</span>
    <span class="s5">// client[Width/Height] properties represent viewport area of the window.</span>
    <span class="s5">// Besides, it's as well not necessary as the &lt;html&gt; itself neither has</span>
    <span class="s5">// rendered scroll bars nor it can be clipped.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">isDocumentElement</span><span class="s0">(</span><span class="s2">target</span><span class="s0">)) {</span>
        <span class="s5">// In some browsers (only in Firefox, actually) CSS width &amp; height</span>
        <span class="s5">// include scroll bars size which can be removed at this step as scroll</span>
        <span class="s5">// bars are the only difference between rounded dimensions + paddings</span>
        <span class="s5">// and &quot;client&quot; properties, though that is not always true in Chrome.</span>
        <span class="s1">var </span><span class="s2">vertScrollbar </span><span class="s0">= </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">round</span><span class="s0">(</span><span class="s2">width </span><span class="s0">+ </span><span class="s2">horizPad</span><span class="s0">) - </span><span class="s2">clientWidth</span><span class="s0">;</span>
        <span class="s1">var </span><span class="s2">horizScrollbar </span><span class="s0">= </span><span class="s2">Math</span><span class="s0">.</span><span class="s2">round</span><span class="s0">(</span><span class="s2">height </span><span class="s0">+ </span><span class="s2">vertPad</span><span class="s0">) - </span><span class="s2">clientHeight</span><span class="s0">;</span>

        <span class="s5">// Chrome has a rather weird rounding of &quot;client&quot; properties.</span>
        <span class="s5">// E.g. for an element with content width of 314.2px it sometimes gives</span>
        <span class="s5">// the client width of 315px and for the width of 314.7px it may give</span>
        <span class="s5">// 314px. And it doesn't happen all the time. So just ignore this delta</span>
        <span class="s5">// as a non-relevant.</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(</span><span class="s2">vertScrollbar</span><span class="s0">) !== </span><span class="s7">1</span><span class="s0">) {</span>
            <span class="s2">width </span><span class="s0">-= </span><span class="s2">vertScrollbar</span><span class="s0">;</span>
        <span class="s0">}</span>

        <span class="s1">if </span><span class="s0">(</span><span class="s2">Math</span><span class="s0">.</span><span class="s2">abs</span><span class="s0">(</span><span class="s2">horizScrollbar</span><span class="s0">) !== </span><span class="s7">1</span><span class="s0">) {</span>
            <span class="s2">height </span><span class="s0">-= </span><span class="s2">horizScrollbar</span><span class="s0">;</span>
        <span class="s0">}</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">createRectInit</span><span class="s0">(</span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">left</span><span class="s0">, </span><span class="s2">paddings</span><span class="s0">.</span><span class="s2">top</span><span class="s0">, </span><span class="s2">width</span><span class="s0">, </span><span class="s2">height</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Checks whether provided element is an instance of the SVGGraphicsElement.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Element} target - Element to be checked.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean}</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">isSVGGraphicsElement </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Some browsers, namely IE and Edge, don't have the SVGGraphicsElement</span>
    <span class="s5">// interface.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">SVGGraphicsElement </span><span class="s0">!== </span><span class="s3">'undefined'</span><span class="s0">) {</span>
        <span class="s1">return function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">) { </span><span class="s1">return </span><span class="s2">target </span><span class="s1">instanceof </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">SVGGraphicsElement</span><span class="s0">; };</span>
    <span class="s0">}</span>

    <span class="s5">// If it's so, then check that element is at least an instance of the</span>
    <span class="s5">// SVGElement and that it has the &quot;getBBox&quot; method.</span>
    <span class="s5">// eslint-disable-next-line no-extra-parens</span>
    <span class="s1">return function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">) { </span><span class="s1">return </span><span class="s2">target </span><span class="s1">instanceof </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">SVGElement </span><span class="s0">&amp;&amp; </span><span class="s1">typeof </span><span class="s2">target</span><span class="s0">.</span><span class="s2">getBBox </span><span class="s0">=== </span><span class="s3">'function'</span><span class="s0">; };</span>
<span class="s0">})();</span>

<span class="s4">/**</span>
 <span class="s4">* Checks whether provided element is a document element (&lt;html&gt;).</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Element} target - Element to be checked.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">isDocumentElement</span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s2">target </span><span class="s0">=== </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">document</span><span class="s0">.</span><span class="s2">documentElement</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Calculates an appropriate content rectangle for provided html or svg element.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Element} target - Element content rectangle of which needs to be calculated.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectInit}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">getContentRect</span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">isBrowser</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">emptyRect</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s2">isSVGGraphicsElement</span><span class="s0">(</span><span class="s2">target</span><span class="s0">)) {</span>
        <span class="s1">return </span><span class="s2">getSVGContentRect</span><span class="s0">(</span><span class="s2">target</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">return </span><span class="s2">getHTMLElementContentRect</span><span class="s0">(</span><span class="s2">target</span><span class="s0">);</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Creates rectangle with an interface of the DOMRectReadOnly.</span>
 <span class="s4">* Spec: https://drafts.fxtf.org/geometry/#domrectreadonly</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectReadOnly}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">createReadOnlyRect</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">x </span><span class="s0">= </span><span class="s2">ref</span><span class="s0">.</span><span class="s2">x</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">y </span><span class="s0">= </span><span class="s2">ref</span><span class="s0">.</span><span class="s2">y</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">width </span><span class="s0">= </span><span class="s2">ref</span><span class="s0">.</span><span class="s2">width</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">height </span><span class="s0">= </span><span class="s2">ref</span><span class="s0">.</span><span class="s2">height</span><span class="s0">;</span>

    <span class="s5">// If DOMRectReadOnly is available use it as a prototype for the rectangle.</span>
    <span class="s1">var </span><span class="s2">Constr </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">DOMRectReadOnly </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">? </span><span class="s2">DOMRectReadOnly </span><span class="s0">: </span><span class="s2">Object</span><span class="s0">;</span>
    <span class="s1">var </span><span class="s2">rect </span><span class="s0">= </span><span class="s2">Object</span><span class="s0">.</span><span class="s2">create</span><span class="s0">(</span><span class="s2">Constr</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">);</span>

    <span class="s5">// Rectangle's properties are not writable and non-enumerable.</span>
    <span class="s2">defineConfigurable</span><span class="s0">(</span><span class="s2">rect</span><span class="s0">, {</span>
        <span class="s2">x</span><span class="s0">: </span><span class="s2">x</span><span class="s0">, </span><span class="s2">y</span><span class="s0">: </span><span class="s2">y</span><span class="s0">, </span><span class="s2">width</span><span class="s0">: </span><span class="s2">width</span><span class="s0">, </span><span class="s2">height</span><span class="s0">: </span><span class="s2">height</span><span class="s0">,</span>
        <span class="s2">top</span><span class="s0">: </span><span class="s2">y</span><span class="s0">,</span>
        <span class="s2">right</span><span class="s0">: </span><span class="s2">x </span><span class="s0">+ </span><span class="s2">width</span><span class="s0">,</span>
        <span class="s2">bottom</span><span class="s0">: </span><span class="s2">height </span><span class="s0">+ </span><span class="s2">y</span><span class="s0">,</span>
        <span class="s2">left</span><span class="s0">: </span><span class="s2">x</span>
    <span class="s0">});</span>

    <span class="s1">return </span><span class="s2">rect</span><span class="s0">;</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.</span>
 <span class="s4">* Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number} x - X coordinate.</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number} y - Y coordinate.</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number} width - Rectangle's width.</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{number} height - Rectangle's height.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectInit}</span>
 <span class="s4">*/</span>
<span class="s1">function </span><span class="s2">createRectInit</span><span class="s0">(</span><span class="s2">x</span><span class="s0">, </span><span class="s2">y</span><span class="s0">, </span><span class="s2">width</span><span class="s0">, </span><span class="s2">height</span><span class="s0">) {</span>
    <span class="s1">return </span><span class="s0">{ </span><span class="s2">x</span><span class="s0">: </span><span class="s2">x</span><span class="s0">, </span><span class="s2">y</span><span class="s0">: </span><span class="s2">y</span><span class="s0">, </span><span class="s2">width</span><span class="s0">: </span><span class="s2">width</span><span class="s0">, </span><span class="s2">height</span><span class="s0">: </span><span class="s2">height </span><span class="s0">};</span>
<span class="s0">}</span>

<span class="s4">/**</span>
 <span class="s4">* Class that is responsible for computations of the content rectangle of</span>
 <span class="s4">* provided DOM element and for keeping track of it's changes.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">ResizeObservation </span><span class="s0">= </span><span class="s1">function</span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastWidth </span><span class="s0">= </span><span class="s7">0</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastHeight </span><span class="s0">= </span><span class="s7">0</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">contentRect_ </span><span class="s0">= </span><span class="s2">createRectInit</span><span class="s0">(</span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">, </span><span class="s7">0</span><span class="s0">);</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">target </span><span class="s0">= </span><span class="s2">target</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Updates content rectangle and tells whether it's width or height properties</span>
 <span class="s4">* have changed since the last broadcast.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Reference to the last observed content rectangle.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{DOMRectInit}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Broadcasted width of content rectangle.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@type </span><span class="s4">{number}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObservation</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">isActive </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">var </span><span class="s2">rect </span><span class="s0">= </span><span class="s2">getContentRect</span><span class="s0">(</span><span class="s1">this</span><span class="s0">.</span><span class="s2">target</span><span class="s0">);</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">contentRect_ </span><span class="s0">= </span><span class="s2">rect</span><span class="s0">;</span>

    <span class="s1">return </span><span class="s2">rect</span><span class="s0">.</span><span class="s2">width </span><span class="s0">!== </span><span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastWidth </span><span class="s0">|| </span><span class="s2">rect</span><span class="s0">.</span><span class="s2">height </span><span class="s0">!== </span><span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastHeight</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Updates 'broadcastWidth' and 'broadcastHeight' properties with a data</span>
 <span class="s4">* from the corresponding properties of the last observed content rectangle.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{DOMRectInit} Last observed content rectangle.</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObservation</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">broadcastRect </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">var </span><span class="s2">rect </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">contentRect_</span><span class="s0">;</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastWidth </span><span class="s0">= </span><span class="s2">rect</span><span class="s0">.</span><span class="s2">width</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">broadcastHeight </span><span class="s0">= </span><span class="s2">rect</span><span class="s0">.</span><span class="s2">height</span><span class="s0">;</span>

    <span class="s1">return </span><span class="s2">rect</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">ResizeObserverEntry </span><span class="s0">= </span><span class="s1">function</span><span class="s0">(</span><span class="s2">target</span><span class="s0">, </span><span class="s2">rectInit</span><span class="s0">) {</span>
    <span class="s1">var </span><span class="s2">contentRect </span><span class="s0">= </span><span class="s2">createReadOnlyRect</span><span class="s0">(</span><span class="s2">rectInit</span><span class="s0">);</span>

    <span class="s5">// According to the specification following properties are not writable</span>
    <span class="s5">// and are also not enumerable in the native implementation.</span>
    <span class="s5">//</span>
    <span class="s5">// Property accessors are not being used as they'd require to define a</span>
    <span class="s5">// private WeakMap storage which may cause memory leaks in browsers that</span>
    <span class="s5">// don't support this type of collections.</span>
    <span class="s2">defineConfigurable</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, { </span><span class="s2">target</span><span class="s0">: </span><span class="s2">target</span><span class="s0">, </span><span class="s2">contentRect</span><span class="s0">: </span><span class="s2">contentRect </span><span class="s0">});</span>
<span class="s0">};</span>

<span class="s1">var </span><span class="s2">ResizeObserverSPI </span><span class="s0">= </span><span class="s1">function</span><span class="s0">(</span><span class="s2">callback</span><span class="s0">, </span><span class="s2">controller</span><span class="s0">, </span><span class="s2">callbackCtx</span><span class="s0">) {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">activeObservations_ </span><span class="s0">= [];</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">observations_ </span><span class="s0">= </span><span class="s1">new </span><span class="s2">MapShim</span><span class="s0">();</span>

    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">callback </span><span class="s0">!== </span><span class="s3">'function'</span><span class="s0">) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'The callback provided as parameter 1 is not a function.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">callback_ </span><span class="s0">= </span><span class="s2">callback</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">controller_ </span><span class="s0">= </span><span class="s2">controller</span><span class="s0">;</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">callbackCtx_ </span><span class="s0">= </span><span class="s2">callbackCtx</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Starts observing provided element.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Element} target - Element to be observed.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Registry of the ResizeObservation instances.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{Map&lt;Element, ResizeObservation&gt;}</span>
 <span class="s4">*/</span>


<span class="s4">/**</span>
 <span class="s4">* Public ResizeObserver instance which will be passed to the callback</span>
 <span class="s4">* function and used as a value of it's &quot;this&quot; binding.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{ResizeObserver}</span>
 <span class="s4">*/</span>

<span class="s4">/**</span>
 <span class="s4">* Collection of resize observations that have detected changes in dimensions</span>
 <span class="s4">* of elements.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@private </span><span class="s4">{Array&lt;ResizeObservation&gt;}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">observe </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'1 argument required, but only 0 present.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s5">// Do nothing if current environment doesn't have the Element interface.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">Element </span><span class="s0">=== </span><span class="s3">'undefined' </span><span class="s0">|| !(</span><span class="s2">Element </span><span class="s1">instanceof </span><span class="s2">Object</span><span class="s0">)) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(!(</span><span class="s2">target </span><span class="s1">instanceof </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">Element</span><span class="s0">)) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'parameter 1 is not of type &quot;Element&quot;.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">observations </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">observations_</span><span class="s0">;</span>

    <span class="s5">// Do nothing if element is already being observed.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s2">observations</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">target</span><span class="s0">)) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s2">observations</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s2">target</span><span class="s0">, </span><span class="s1">new </span><span class="s2">ResizeObservation</span><span class="s0">(</span><span class="s2">target</span><span class="s0">));</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">controller_</span><span class="s0">.</span><span class="s2">addObserver</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>

    <span class="s5">// Force the update of observations.</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">controller_</span><span class="s0">.</span><span class="s2">refresh</span><span class="s0">();</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Stops observing provided element.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@param </span><span class="s4">{Element} target - Element to stop observing.</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">unobserve </span><span class="s0">= </span><span class="s1">function </span><span class="s0">(</span><span class="s2">target</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'1 argument required, but only 0 present.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s5">// Do nothing if current environment doesn't have the Element interface.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">Element </span><span class="s0">=== </span><span class="s3">'undefined' </span><span class="s0">|| !(</span><span class="s2">Element </span><span class="s1">instanceof </span><span class="s2">Object</span><span class="s0">)) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">if </span><span class="s0">(!(</span><span class="s2">target </span><span class="s1">instanceof </span><span class="s2">getWindowOf</span><span class="s0">(</span><span class="s2">target</span><span class="s0">).</span><span class="s2">Element</span><span class="s0">)) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'parameter 1 is not of type &quot;Element&quot;.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">observations </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">observations_</span><span class="s0">;</span>

    <span class="s5">// Do nothing if element is not being observed.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">observations</span><span class="s0">.</span><span class="s2">has</span><span class="s0">(</span><span class="s2">target</span><span class="s0">)) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s2">observations</span><span class="s0">.</span><span class="s2">delete</span><span class="s0">(</span><span class="s2">target</span><span class="s0">);</span>

    <span class="s1">if </span><span class="s0">(!</span><span class="s2">observations</span><span class="s0">.</span><span class="s2">size</span><span class="s0">) {</span>
        <span class="s1">this</span><span class="s0">.</span><span class="s2">controller_</span><span class="s0">.</span><span class="s2">removeObserver</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
    <span class="s0">}</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Stops observing all elements.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">disconnect </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">clearActive</span><span class="s0">();</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">observations_</span><span class="s0">.</span><span class="s2">clear</span><span class="s0">();</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">controller_</span><span class="s0">.</span><span class="s2">removeObserver</span><span class="s0">(</span><span class="s1">this</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Collects observation instances the associated element of which has changed</span>
 <span class="s4">* it's content rectangle.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">gatherActive </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
        <span class="s1">var </span><span class="s2">this$1 </span><span class="s0">= </span><span class="s1">this</span><span class="s0">;</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">clearActive</span><span class="s0">();</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">observations_</span><span class="s0">.</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">observation</span><span class="s0">) {</span>
        <span class="s1">if </span><span class="s0">(</span><span class="s2">observation</span><span class="s0">.</span><span class="s2">isActive</span><span class="s0">()) {</span>
            <span class="s2">this$1</span><span class="s0">.</span><span class="s2">activeObservations_</span><span class="s0">.</span><span class="s2">push</span><span class="s0">(</span><span class="s2">observation</span><span class="s0">);</span>
        <span class="s0">}</span>
    <span class="s0">});</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Invokes initial callback function with a list of ResizeObserverEntry</span>
 <span class="s4">* instances collected from active resize observations.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">broadcastActive </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Do nothing if observer doesn't have active observations.</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s1">this</span><span class="s0">.</span><span class="s2">hasActive</span><span class="s0">()) {</span>
        <span class="s1">return</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">ctx </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">callbackCtx_</span><span class="s0">;</span>

    <span class="s5">// Create ResizeObserverEntry instance for every active observation.</span>
    <span class="s1">var </span><span class="s2">entries </span><span class="s0">= </span><span class="s1">this</span><span class="s0">.</span><span class="s2">activeObservations_</span><span class="s0">.</span><span class="s2">map</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">observation</span><span class="s0">) {</span>
        <span class="s1">return new </span><span class="s2">ResizeObserverEntry</span><span class="s0">(</span><span class="s2">observation</span><span class="s0">.</span><span class="s2">target</span><span class="s0">, </span><span class="s2">observation</span><span class="s0">.</span><span class="s2">broadcastRect</span><span class="s0">());</span>
    <span class="s0">});</span>

    <span class="s1">this</span><span class="s0">.</span><span class="s2">callback_</span><span class="s0">.</span><span class="s2">call</span><span class="s0">(</span><span class="s2">ctx</span><span class="s0">, </span><span class="s2">entries</span><span class="s0">, </span><span class="s2">ctx</span><span class="s0">);</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">clearActive</span><span class="s0">();</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Clears the collection of active observations.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{void}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">clearActive </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">this</span><span class="s0">.</span><span class="s2">activeObservations_</span><span class="s0">.</span><span class="s2">splice</span><span class="s0">(</span><span class="s7">0</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s4">/**</span>
 <span class="s4">* Tells whether observer has active observations.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s6">@returns </span><span class="s4">{boolean}</span>
 <span class="s4">*/</span>
<span class="s2">ResizeObserverSPI</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">.</span><span class="s2">hasActive </span><span class="s0">= </span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s1">return this</span><span class="s0">.</span><span class="s2">activeObservations_</span><span class="s0">.</span><span class="s2">length </span><span class="s0">&gt; </span><span class="s7">0</span><span class="s0">;</span>
<span class="s0">};</span>

<span class="s5">// Registry of internal observers. If WeakMap is not available use current shim</span>
<span class="s5">// for the Map collection as it has all required methods and because WeakMap</span>
<span class="s5">// can't be fully polyfilled anyway.</span>
<span class="s1">var </span><span class="s2">observers </span><span class="s0">= </span><span class="s1">typeof </span><span class="s2">WeakMap </span><span class="s0">!== </span><span class="s3">'undefined' </span><span class="s0">? </span><span class="s1">new </span><span class="s2">WeakMap</span><span class="s0">() : </span><span class="s1">new </span><span class="s2">MapShim</span><span class="s0">();</span>

<span class="s4">/**</span>
 <span class="s4">* ResizeObserver API. Encapsulates the ResizeObserver SPI implementation</span>
 <span class="s4">* exposing only those methods and properties that are defined in the spec.</span>
 <span class="s4">*/</span>
<span class="s1">var </span><span class="s2">ResizeObserver </span><span class="s0">= </span><span class="s1">function</span><span class="s0">(</span><span class="s2">callback</span><span class="s0">) {</span>
    <span class="s1">if </span><span class="s0">(!(</span><span class="s1">this instanceof </span><span class="s2">ResizeObserver</span><span class="s0">)) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'Cannot call a class as a function.'</span><span class="s0">);</span>
    <span class="s0">}</span>
    <span class="s1">if </span><span class="s0">(!</span><span class="s2">arguments</span><span class="s0">.</span><span class="s2">length</span><span class="s0">) {</span>
        <span class="s1">throw new </span><span class="s2">TypeError</span><span class="s0">(</span><span class="s3">'1 argument required, but only 0 present.'</span><span class="s0">);</span>
    <span class="s0">}</span>

    <span class="s1">var </span><span class="s2">controller </span><span class="s0">= </span><span class="s2">ResizeObserverController</span><span class="s0">.</span><span class="s2">getInstance</span><span class="s0">();</span>
    <span class="s1">var </span><span class="s2">observer </span><span class="s0">= </span><span class="s1">new </span><span class="s2">ResizeObserverSPI</span><span class="s0">(</span><span class="s2">callback</span><span class="s0">, </span><span class="s2">controller</span><span class="s0">, </span><span class="s1">this</span><span class="s0">);</span>

    <span class="s2">observers</span><span class="s0">.</span><span class="s2">set</span><span class="s0">(</span><span class="s1">this</span><span class="s0">, </span><span class="s2">observer</span><span class="s0">);</span>
<span class="s0">};</span>

<span class="s5">// Expose public methods of ResizeObserver.</span>
<span class="s0">[</span><span class="s3">'observe'</span><span class="s0">, </span><span class="s3">'unobserve'</span><span class="s0">, </span><span class="s3">'disconnect'</span><span class="s0">].</span><span class="s2">forEach</span><span class="s0">(</span><span class="s1">function </span><span class="s0">(</span><span class="s2">method</span><span class="s0">) {</span>
    <span class="s2">ResizeObserver</span><span class="s0">.</span><span class="s2">prototype</span><span class="s0">[</span><span class="s2">method</span><span class="s0">] = </span><span class="s1">function </span><span class="s0">() {</span>
        <span class="s1">return </span><span class="s0">(</span><span class="s2">ref </span><span class="s0">= </span><span class="s2">observers</span><span class="s0">.</span><span class="s2">get</span><span class="s0">(</span><span class="s1">this</span><span class="s0">))[</span><span class="s2">method</span><span class="s0">].</span><span class="s2">apply</span><span class="s0">(</span><span class="s2">ref</span><span class="s0">, </span><span class="s2">arguments</span><span class="s0">);</span>
        <span class="s1">var </span><span class="s2">ref</span><span class="s0">;</span>
    <span class="s0">};</span>
<span class="s0">});</span>

<span class="s1">var </span><span class="s2">index </span><span class="s0">= (</span><span class="s1">function </span><span class="s0">() {</span>
    <span class="s5">// Export existing implementation if available.</span>
    <span class="s1">if </span><span class="s0">(</span><span class="s1">typeof </span><span class="s2">global$1</span><span class="s0">.</span><span class="s2">ResizeObserver </span><span class="s0">!== </span><span class="s3">'undefined'</span><span class="s0">) {</span>
        <span class="s1">return </span><span class="s2">global$1</span><span class="s0">.</span><span class="s2">ResizeObserver</span><span class="s0">;</span>
    <span class="s0">}</span>

    <span class="s2">global$1</span><span class="s0">.</span><span class="s2">ResizeObserver </span><span class="s0">= </span><span class="s2">ResizeObserver</span><span class="s0">;</span>

    <span class="s1">return </span><span class="s2">ResizeObserver</span><span class="s0">;</span>
<span class="s0">})();</span>

<span class="s1">return </span><span class="s2">index</span><span class="s0">;</span>

<span class="s0">})));</span>
</pre>
</body>
</html>