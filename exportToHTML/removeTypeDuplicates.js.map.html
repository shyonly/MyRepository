<html>
<head>
<title>removeTypeDuplicates.js.map</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #6aab73;}
.s2 { color: #2aacb8;}
.s3 { color: #cf8e6d;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
removeTypeDuplicates.js.map</font>
</center></td></tr></table>
<pre><span class="s0">{</span><span class="s1">&quot;version&quot;</span><span class="s0">:</span><span class="s2">3</span><span class="s0">,</span><span class="s1">&quot;names&quot;</span><span class="s0">:[</span><span class="s1">&quot;_index&quot;</span><span class="s0">,</span><span class="s1">&quot;require&quot;</span><span class="s0">,</span><span class="s1">&quot;getQualifiedName&quot;</span><span class="s0">,</span><span class="s1">&quot;node&quot;</span><span class="s0">,</span><span class="s1">&quot;isIdentifier&quot;</span><span class="s0">,</span><span class="s1">&quot;name&quot;</span><span class="s0">,</span><span class="s1">&quot;right&quot;</span><span class="s0">,</span><span class="s1">&quot;left&quot;</span><span class="s0">,</span><span class="s1">&quot;removeTypeDuplicates&quot;</span><span class="s0">,</span><span class="s1">&quot;nodesIn&quot;</span><span class="s0">,</span><span class="s1">&quot;nodes&quot;</span><span class="s0">,</span><span class="s1">&quot;Array&quot;</span><span class="s0">,</span><span class="s1">&quot;from&quot;</span><span class="s0">,</span><span class="s1">&quot;generics&quot;</span><span class="s0">,</span><span class="s1">&quot;Map&quot;</span><span class="s0">,</span><span class="s1">&quot;bases&quot;</span><span class="s0">,</span><span class="s1">&quot;typeGroups&quot;</span><span class="s0">,</span><span class="s1">&quot;Set&quot;</span><span class="s0">,</span><span class="s1">&quot;types&quot;</span><span class="s0">,</span><span class="s1">&quot;i&quot;</span><span class="s0">,</span><span class="s1">&quot;length&quot;</span><span class="s0">,</span><span class="s1">&quot;indexOf&quot;</span><span class="s0">,</span><span class="s1">&quot;isTSAnyKeyword&quot;</span><span class="s0">,</span><span class="s1">&quot;isTSBaseType&quot;</span><span class="s0">,</span><span class="s1">&quot;set&quot;</span><span class="s0">,</span><span class="s1">&quot;type&quot;</span><span class="s0">,</span><span class="s1">&quot;isTSUnionType&quot;</span><span class="s0">,</span><span class="s1">&quot;has&quot;</span><span class="s0">,</span><span class="s1">&quot;push&quot;</span><span class="s0">,</span><span class="s1">&quot;add&quot;</span><span class="s0">,</span><span class="s1">&quot;isTSTypeReference&quot;</span><span class="s0">,</span><span class="s1">&quot;typeParameters&quot;</span><span class="s0">,</span><span class="s1">&quot;typeName&quot;</span><span class="s0">,</span><span class="s1">&quot;existing&quot;</span><span class="s0">,</span><span class="s1">&quot;get&quot;</span><span class="s0">,</span><span class="s1">&quot;params&quot;</span><span class="s0">,</span><span class="s1">&quot;baseType&quot;</span><span class="s0">,</span><span class="s1">&quot;genericName&quot;</span><span class="s0">],</span><span class="s1">&quot;sources&quot;</span><span class="s0">:[</span><span class="s1">&quot;../../../src/modifications/typescript/removeTypeDuplicates.ts&quot;</span><span class="s0">],</span><span class="s1">&quot;sourcesContent&quot;</span><span class="s0">:[</span><span class="s1">&quot;import {</span><span class="s3">\n  </span><span class="s1">isIdentifier,</span><span class="s3">\n  </span><span class="s1">isTSAnyKeyword,</span><span class="s3">\n  </span><span class="s1">isTSTypeReference,</span><span class="s3">\n  </span><span class="s1">isTSUnionType,</span><span class="s3">\n  </span><span class="s1">isTSBaseType,</span><span class="s3">\n</span><span class="s1">} from </span><span class="s3">\&quot;</span><span class="s1">../../validators/generated/index.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n</span><span class="s1">import type * as t from </span><span class="s3">\&quot;</span><span class="s1">../../index.ts</span><span class="s3">\&quot;</span><span class="s1">;</span><span class="s3">\n\n</span><span class="s1">function getQualifiedName(node: t.TSTypeReference[</span><span class="s3">\&quot;</span><span class="s1">typeName</span><span class="s3">\&quot;</span><span class="s1">]): string {</span><span class="s3">\n  </span><span class="s1">return isIdentifier(node)</span><span class="s3">\n    </span><span class="s1">? node.name</span><span class="s3">\n    </span><span class="s1">: `${node.right.name}.${getQualifiedName(node.left)}`;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n\n</span><span class="s1">/**</span><span class="s3">\n </span><span class="s1">* Dedupe type annotations.</span><span class="s3">\n </span><span class="s1">*/</span><span class="s3">\n</span><span class="s1">export default function removeTypeDuplicates(</span><span class="s3">\n  </span><span class="s1">nodesIn: ReadonlyArray&lt;t.TSType&gt;,</span><span class="s3">\n</span><span class="s1">): Array&lt;t.TSType&gt; {</span><span class="s3">\n  </span><span class="s1">const nodes = Array.from(nodesIn);</span><span class="s3">\n\n  </span><span class="s1">const generics = new Map&lt;string, t.TSTypeReference&gt;();</span><span class="s3">\n  </span><span class="s1">const bases = new Map&lt;t.TSBaseType[</span><span class="s3">\&quot;</span><span class="s1">type</span><span class="s3">\&quot;</span><span class="s1">], t.TSBaseType&gt;();</span><span class="s3">\n\n  </span><span class="s1">// store union type groups to circular references</span><span class="s3">\n  </span><span class="s1">const typeGroups = new Set&lt;t.TSType[]&gt;();</span><span class="s3">\n\n  </span><span class="s1">const types: t.TSType[] = [];</span><span class="s3">\n\n  </span><span class="s1">for (let i = 0; i &lt; nodes.length; i++) {</span><span class="s3">\n    </span><span class="s1">const node = nodes[i];</span><span class="s3">\n    </span><span class="s1">if (!node) continue;</span><span class="s3">\n\n    </span><span class="s1">// detect duplicates</span><span class="s3">\n    </span><span class="s1">if (types.indexOf(node) &gt;= 0) {</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// this type matches anything</span><span class="s3">\n    </span><span class="s1">if (isTSAnyKeyword(node)) {</span><span class="s3">\n      </span><span class="s1">return [node];</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// Analogue of FlowBaseAnnotation</span><span class="s3">\n    </span><span class="s1">if (isTSBaseType(node)) {</span><span class="s3">\n      </span><span class="s1">bases.set(node.type, node);</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">if (isTSUnionType(node)) {</span><span class="s3">\n      </span><span class="s1">if (!typeGroups.has(node.types)) {</span><span class="s3">\n        </span><span class="s1">nodes.push(...node.types);</span><span class="s3">\n        </span><span class="s1">typeGroups.add(node.types);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">// todo: support merging tuples: number[]</span><span class="s3">\n    </span><span class="s1">if (isTSTypeReference(node) &amp;&amp; node.typeParameters) {</span><span class="s3">\n      </span><span class="s1">const name = getQualifiedName(node.typeName);</span><span class="s3">\n\n      </span><span class="s1">if (generics.has(name)) {</span><span class="s3">\n        </span><span class="s1">let existing: t.TypeScript = generics.get(name);</span><span class="s3">\n        </span><span class="s1">if (existing.typeParameters) {</span><span class="s3">\n          </span><span class="s1">if (node.typeParameters) {</span><span class="s3">\n            </span><span class="s1">existing.typeParameters.params.push(...node.typeParameters.params);</span><span class="s3">\n            </span><span class="s1">existing.typeParameters.params = removeTypeDuplicates(</span><span class="s3">\n              </span><span class="s1">existing.typeParameters.params,</span><span class="s3">\n            </span><span class="s1">);</span><span class="s3">\n          </span><span class="s1">}</span><span class="s3">\n        </span><span class="s1">} else {</span><span class="s3">\n          </span><span class="s1">existing = node.typeParameters;</span><span class="s3">\n        </span><span class="s1">}</span><span class="s3">\n      </span><span class="s1">} else {</span><span class="s3">\n        </span><span class="s1">generics.set(name, node);</span><span class="s3">\n      </span><span class="s1">}</span><span class="s3">\n\n      </span><span class="s1">continue;</span><span class="s3">\n    </span><span class="s1">}</span><span class="s3">\n\n    </span><span class="s1">types.push(node);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// add back in bases</span><span class="s3">\n  </span><span class="s1">for (const [, baseType] of bases) {</span><span class="s3">\n    </span><span class="s1">types.push(baseType);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">// add back in generics</span><span class="s3">\n  </span><span class="s1">for (const [, genericName] of generics) {</span><span class="s3">\n    </span><span class="s1">types.push(genericName);</span><span class="s3">\n  </span><span class="s1">}</span><span class="s3">\n\n  </span><span class="s1">return types;</span><span class="s3">\n</span><span class="s1">}</span><span class="s3">\n</span><span class="s1">&quot;</span><span class="s0">],</span><span class="s1">&quot;mappings&quot;</span><span class="s0">:</span><span class="s1">&quot;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&quot;</span><span class="s0">}</span></pre>
</body>
</html>